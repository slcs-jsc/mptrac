<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPTRAC: mptrac.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="MPTRAC_48px.png"/></td>
  <td id="projectalign">
   <div id="projectname">MPTRAC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mptrac.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>MPTRAC library declarations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;gsl/gsl_fft_complex.h&gt;</code><br />
<code>#include &lt;gsl/gsl_math.h&gt;</code><br />
<code>#include &lt;gsl/gsl_randist.h&gt;</code><br />
<code>#include &lt;gsl/gsl_rng.h&gt;</code><br />
<code>#include &lt;gsl/gsl_sort.h&gt;</code><br />
<code>#include &lt;gsl/gsl_spline.h&gt;</code><br />
<code>#include &lt;gsl/gsl_statistics.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;netcdf.h&gt;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;sys/time.h&gt;</code><br />
</div>
<p><a href="mptrac_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structctl__t.html">ctl_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control parameters.  <a href="structctl__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structatm__t.html">atm_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Air parcel data.  <a href="structatm__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structparticle__t.html">particle_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Particle data.  <a href="structparticle__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcache__t.html">cache_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cache data structure.  <a href="structcache__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structclim__photo__t.html">clim_photo_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Climatological data in the form of photolysis rates.  <a href="structclim__photo__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structclim__ts__t.html">clim_ts_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Climatological data in the form of time series.  <a href="structclim__ts__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structclim__zm__t.html">clim_zm_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Climatological data in the form of zonal means.  <a href="structclim__zm__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structclim__t.html">clim_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Climatological data.  <a href="structclim__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmet__t.html">met_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Meteo data structure.  <a href="structmet__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdd__t.html">dd_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Domain decomposition data structure.  <a href="structdd__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ada6230d3c1696537923dc5a9446d7521"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ada6230d3c1696537923dc5a9446d7521">MPI_Datatype</a>&#160;&#160;&#160;void*</td></tr>
<tr class="memdesc:ada6230d3c1696537923dc5a9446d7521"><td class="mdescLeft">&#160;</td><td class="mdescRight">Placeholder when MPI is not available.  <a href="mptrac_8h.html#ada6230d3c1696537923dc5a9446d7521">More...</a><br /></td></tr>
<tr class="separator:ada6230d3c1696537923dc5a9446d7521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aa74f0eae3fc2645b1fd1ec7efe0c8c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a5aa74f0eae3fc2645b1fd1ec7efe0c8c">codes_handle</a>&#160;&#160;&#160;void*</td></tr>
<tr class="memdesc:a5aa74f0eae3fc2645b1fd1ec7efe0c8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Placeholder when ECCODES is not available.  <a href="mptrac_8h.html#a5aa74f0eae3fc2645b1fd1ec7efe0c8c">More...</a><br /></td></tr>
<tr class="separator:a5aa74f0eae3fc2645b1fd1ec7efe0c8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a174754c04acfba9e1f66ba249e68643a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a174754c04acfba9e1f66ba249e68643a">AVO</a>&#160;&#160;&#160;6.02214076e23</td></tr>
<tr class="memdesc:a174754c04acfba9e1f66ba249e68643a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Avogadro constant [1/mol].  <a href="mptrac_8h.html#a174754c04acfba9e1f66ba249e68643a">More...</a><br /></td></tr>
<tr class="separator:a174754c04acfba9e1f66ba249e68643a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af48c8f42b5451a04703d55d62ea50a3e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af48c8f42b5451a04703d55d62ea50a3e">CPD</a>&#160;&#160;&#160;1003.5</td></tr>
<tr class="memdesc:af48c8f42b5451a04703d55d62ea50a3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specific heat of dry air at constant pressure [J/(kg K)].  <a href="mptrac_8h.html#af48c8f42b5451a04703d55d62ea50a3e">More...</a><br /></td></tr>
<tr class="separator:af48c8f42b5451a04703d55d62ea50a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ebf6899d6c1c8b7b9d09be872c05aae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a>&#160;&#160;&#160;(<a class="el" href="mptrac_8h.html#a1c4cf7d6c3605ff72cd8b9a63379d4ea">MH2O</a> / <a class="el" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a>)</td></tr>
<tr class="memdesc:a6ebf6899d6c1c8b7b9d09be872c05aae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ratio of the specific gas constant of dry air and water vapor [1].  <a href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">More...</a><br /></td></tr>
<tr class="separator:a6ebf6899d6c1c8b7b9d09be872c05aae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6440afc9207bc5eba00d9161ff744e16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a>&#160;&#160;&#160;9.80665</td></tr>
<tr class="memdesc:a6440afc9207bc5eba00d9161ff744e16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard gravity [m/s^2].  <a href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">More...</a><br /></td></tr>
<tr class="separator:a6440afc9207bc5eba00d9161ff744e16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2091e935ef46727f066804a98a0d039f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a>&#160;&#160;&#160;7.0</td></tr>
<tr class="memdesc:a2091e935ef46727f066804a98a0d039f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scale height [km].  <a href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">More...</a><br /></td></tr>
<tr class="separator:a2091e935ef46727f066804a98a0d039f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ac8f6cd3cf230202ce5aba9df2d6e1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a60ac8f6cd3cf230202ce5aba9df2d6e1">LV</a>&#160;&#160;&#160;2501000.</td></tr>
<tr class="memdesc:a60ac8f6cd3cf230202ce5aba9df2d6e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Latent heat of vaporization of water [J/kg].  <a href="mptrac_8h.html#a60ac8f6cd3cf230202ce5aba9df2d6e1">More...</a><br /></td></tr>
<tr class="separator:a60ac8f6cd3cf230202ce5aba9df2d6e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3566596468c1f46bc90ad143b5c9e203"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a3566596468c1f46bc90ad143b5c9e203">KARMAN</a>&#160;&#160;&#160;0.40</td></tr>
<tr class="memdesc:a3566596468c1f46bc90ad143b5c9e203"><td class="mdescLeft">&#160;</td><td class="mdescRight">Karman's constant.  <a href="mptrac_8h.html#a3566596468c1f46bc90ad143b5c9e203">More...</a><br /></td></tr>
<tr class="separator:a3566596468c1f46bc90ad143b5c9e203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1841fd1a462d245d8c73dce55e2f45da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1841fd1a462d245d8c73dce55e2f45da">KB</a>&#160;&#160;&#160;1.3806504e-23</td></tr>
<tr class="memdesc:a1841fd1a462d245d8c73dce55e2f45da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boltzmann constant [kg m^2/(K s^2)].  <a href="mptrac_8h.html#a1841fd1a462d245d8c73dce55e2f45da">More...</a><br /></td></tr>
<tr class="separator:a1841fd1a462d245d8c73dce55e2f45da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11702dcb3f3ec928229185eb96686127"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a>&#160;&#160;&#160;28.9644</td></tr>
<tr class="memdesc:a11702dcb3f3ec928229185eb96686127"><td class="mdescLeft">&#160;</td><td class="mdescRight">Molar mass of dry air [g/mol].  <a href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">More...</a><br /></td></tr>
<tr class="separator:a11702dcb3f3ec928229185eb96686127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c4cf7d6c3605ff72cd8b9a63379d4ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1c4cf7d6c3605ff72cd8b9a63379d4ea">MH2O</a>&#160;&#160;&#160;18.01528</td></tr>
<tr class="memdesc:a1c4cf7d6c3605ff72cd8b9a63379d4ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Molar mass of water vapor [g/mol].  <a href="mptrac_8h.html#a1c4cf7d6c3605ff72cd8b9a63379d4ea">More...</a><br /></td></tr>
<tr class="separator:a1c4cf7d6c3605ff72cd8b9a63379d4ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5770de64e81ecf3f35d559357f67a76"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aa5770de64e81ecf3f35d559357f67a76">MO3</a>&#160;&#160;&#160;48.00</td></tr>
<tr class="memdesc:aa5770de64e81ecf3f35d559357f67a76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Molar mass of ozone [g/mol].  <a href="mptrac_8h.html#aa5770de64e81ecf3f35d559357f67a76">More...</a><br /></td></tr>
<tr class="separator:aa5770de64e81ecf3f35d559357f67a76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1583b00a62bc1138f99bbfcd8ef81a6a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">P0</a>&#160;&#160;&#160;1013.25</td></tr>
<tr class="memdesc:a1583b00a62bc1138f99bbfcd8ef81a6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard pressure [hPa].  <a href="mptrac_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">More...</a><br /></td></tr>
<tr class="separator:a1583b00a62bc1138f99bbfcd8ef81a6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a3f049b718d26a32f16ed72716d588"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a30a3f049b718d26a32f16ed72716d588">RA</a>&#160;&#160;&#160;(1e3 * <a class="el" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> / <a class="el" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a>)</td></tr>
<tr class="memdesc:a30a3f049b718d26a32f16ed72716d588"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specific gas constant of dry air [J/(kg K)].  <a href="mptrac_8h.html#a30a3f049b718d26a32f16ed72716d588">More...</a><br /></td></tr>
<tr class="separator:a30a3f049b718d26a32f16ed72716d588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0600e3f227b6e9a3ae26f4d6e2a0581e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a>&#160;&#160;&#160;6367.421</td></tr>
<tr class="memdesc:a0600e3f227b6e9a3ae26f4d6e2a0581e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mean radius of Earth [km].  <a href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">More...</a><br /></td></tr>
<tr class="separator:a0600e3f227b6e9a3ae26f4d6e2a0581e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e71def3baefc10ec36f1dd48da4050e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a>&#160;&#160;&#160;8.3144598</td></tr>
<tr class="memdesc:a7e71def3baefc10ec36f1dd48da4050e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ideal gas constant [J/(mol K)].  <a href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">More...</a><br /></td></tr>
<tr class="separator:a7e71def3baefc10ec36f1dd48da4050e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad41b89d4eb6d63a0def5e5fd2a5ab326"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a>&#160;&#160;&#160;273.15</td></tr>
<tr class="memdesc:ad41b89d4eb6d63a0def5e5fd2a5ab326"><td class="mdescLeft">&#160;</td><td class="mdescRight">Standard temperature [K].  <a href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">More...</a><br /></td></tr>
<tr class="separator:ad41b89d4eb6d63a0def5e5fd2a5ab326"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb5bf6fbe6405b09bad71e89e1da5850"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>&#160;&#160;&#160;140</td></tr>
<tr class="memdesc:adb5bf6fbe6405b09bad71e89e1da5850"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of pressure levels for meteo data.  <a href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">More...</a><br /></td></tr>
<tr class="separator:adb5bf6fbe6405b09bad71e89e1da5850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c2e35fdcd9091ccada629895fa1d034"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>&#160;&#160;&#160;1444</td></tr>
<tr class="memdesc:a6c2e35fdcd9091ccada629895fa1d034"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of longitudes for meteo data.  <a href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">More...</a><br /></td></tr>
<tr class="separator:a6c2e35fdcd9091ccada629895fa1d034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a423a96c51fa2ea8a6406113803acbbc1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>&#160;&#160;&#160;724</td></tr>
<tr class="memdesc:a423a96c51fa2ea8a6406113803acbbc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of latitudes for meteo data.  <a href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">More...</a><br /></td></tr>
<tr class="separator:a423a96c51fa2ea8a6406113803acbbc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05b49c662c073f89e86804f7856622a0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>&#160;&#160;&#160;5000</td></tr>
<tr class="memdesc:a05b49c662c073f89e86804f7856622a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length of ASCII data lines.  <a href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">More...</a><br /></td></tr>
<tr class="separator:a05b49c662c073f89e86804f7856622a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d2af32106d1fe82729714d3aa28a1c4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1d2af32106d1fe82729714d3aa28a1c4">METVAR</a>&#160;&#160;&#160;13</td></tr>
<tr class="memdesc:a1d2af32106d1fe82729714d3aa28a1c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of 3-D meteorological variables.  <a href="mptrac_8h.html#a1d2af32106d1fe82729714d3aa28a1c4">More...</a><br /></td></tr>
<tr class="separator:a1d2af32106d1fe82729714d3aa28a1c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab04c88bedc6b2be8ddfe7aa8d3e93f06"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a>&#160;&#160;&#160;10000000</td></tr>
<tr class="memdesc:ab04c88bedc6b2be8ddfe7aa8d3e93f06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of atmospheric data points.  <a href="mptrac_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">More...</a><br /></td></tr>
<tr class="separator:ab04c88bedc6b2be8ddfe7aa8d3e93f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68c2775fc4d7385df9c7bb96d23b482b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>&#160;&#160;&#160;15</td></tr>
<tr class="memdesc:a68c2775fc4d7385df9c7bb96d23b482b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of quantities per data point.  <a href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">More...</a><br /></td></tr>
<tr class="separator:a68c2775fc4d7385df9c7bb96d23b482b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7d0bf1acdf6b0da23c3ccd8ce8f6caa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ad7d0bf1acdf6b0da23c3ccd8ce8f6caa">NCSI</a>&#160;&#160;&#160;1000000</td></tr>
<tr class="memdesc:ad7d0bf1acdf6b0da23c3ccd8ce8f6caa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of data points for CSI calculation.  <a href="mptrac_8h.html#ad7d0bf1acdf6b0da23c3ccd8ce8f6caa">More...</a><br /></td></tr>
<tr class="separator:ad7d0bf1acdf6b0da23c3ccd8ce8f6caa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd69f988ec51453efc614485237c23a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>&#160;&#160;&#160;2000</td></tr>
<tr class="memdesc:a1dd69f988ec51453efc614485237c23a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of data points for ensemble analysis.  <a href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">More...</a><br /></td></tr>
<tr class="separator:a1dd69f988ec51453efc614485237c23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e6d37e546b0cac9bffdd01ec84f53dd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>&#160;&#160;&#160;10000000</td></tr>
<tr class="memdesc:a4e6d37e546b0cac9bffdd01ec84f53dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of observation data points.  <a href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">More...</a><br /></td></tr>
<tr class="separator:a4e6d37e546b0cac9bffdd01ec84f53dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51ca9914034cd3e92903476fd4eebbd6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a51ca9914034cd3e92903476fd4eebbd6">NTHREADS</a>&#160;&#160;&#160;512</td></tr>
<tr class="memdesc:a51ca9914034cd3e92903476fd4eebbd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of OpenMP threads.  <a href="mptrac_8h.html#a51ca9914034cd3e92903476fd4eebbd6">More...</a><br /></td></tr>
<tr class="separator:a51ca9914034cd3e92903476fd4eebbd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5bc792e372b15e7a1d3efe6daac9aec"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ac5bc792e372b15e7a1d3efe6daac9aec">CY</a>&#160;&#160;&#160;250</td></tr>
<tr class="memdesc:ac5bc792e372b15e7a1d3efe6daac9aec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of latitudes for climatological data.  <a href="mptrac_8h.html#ac5bc792e372b15e7a1d3efe6daac9aec">More...</a><br /></td></tr>
<tr class="separator:ac5bc792e372b15e7a1d3efe6daac9aec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae27556d9109b33480031038071c8b4b0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae27556d9109b33480031038071c8b4b0">CO3</a>&#160;&#160;&#160;30</td></tr>
<tr class="memdesc:ae27556d9109b33480031038071c8b4b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of total column ozone data for climatological data.  <a href="mptrac_8h.html#ae27556d9109b33480031038071c8b4b0">More...</a><br /></td></tr>
<tr class="separator:ae27556d9109b33480031038071c8b4b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6594e57d1fff186da0a254a3742dcff7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a6594e57d1fff186da0a254a3742dcff7">CP</a>&#160;&#160;&#160;70</td></tr>
<tr class="memdesc:a6594e57d1fff186da0a254a3742dcff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of pressure levels for climatological data.  <a href="mptrac_8h.html#a6594e57d1fff186da0a254a3742dcff7">More...</a><br /></td></tr>
<tr class="separator:a6594e57d1fff186da0a254a3742dcff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7d97769fe58e5913e640ffed1d36fbf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af7d97769fe58e5913e640ffed1d36fbf">CSZA</a>&#160;&#160;&#160;50</td></tr>
<tr class="memdesc:af7d97769fe58e5913e640ffed1d36fbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of solar zenith angles for climatological data.  <a href="mptrac_8h.html#af7d97769fe58e5913e640ffed1d36fbf">More...</a><br /></td></tr>
<tr class="separator:af7d97769fe58e5913e640ffed1d36fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e463881fb9033a2fb65f3782d4e1c01"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a7e463881fb9033a2fb65f3782d4e1c01">CT</a>&#160;&#160;&#160;12</td></tr>
<tr class="memdesc:a7e463881fb9033a2fb65f3782d4e1c01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of time steps for climatological data.  <a href="mptrac_8h.html#a7e463881fb9033a2fb65f3782d4e1c01">More...</a><br /></td></tr>
<tr class="separator:a7e463881fb9033a2fb65f3782d4e1c01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d9ce8cebc572a42e7b4ab9e92c3a350"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a9d9ce8cebc572a42e7b4ab9e92c3a350">CTS</a>&#160;&#160;&#160;1000</td></tr>
<tr class="memdesc:a9d9ce8cebc572a42e7b4ab9e92c3a350"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of data points of climatological time series.  <a href="mptrac_8h.html#a9d9ce8cebc572a42e7b4ab9e92c3a350">More...</a><br /></td></tr>
<tr class="separator:a9d9ce8cebc572a42e7b4ab9e92c3a350"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf22cd7d4f17a9d16554023c6c82b8b7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#adf22cd7d4f17a9d16554023c6c82b8b7">DD_NPART</a>&#160;&#160;&#160;100000</td></tr>
<tr class="memdesc:adf22cd7d4f17a9d16554023c6c82b8b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of particles to send and recieve in domain decomposition.  <a href="mptrac_8h.html#adf22cd7d4f17a9d16554023c6c82b8b7">More...</a><br /></td></tr>
<tr class="separator:adf22cd7d4f17a9d16554023c6c82b8b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe0e9afb861a649aaba5efb3b9ac7d57"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#afe0e9afb861a649aaba5efb3b9ac7d57">DD_NNMAX</a>&#160;&#160;&#160;26</td></tr>
<tr class="memdesc:afe0e9afb861a649aaba5efb3b9ac7d57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of neighbours to communicate with in domain decomposition.  <a href="mptrac_8h.html#afe0e9afb861a649aaba5efb3b9ac7d57">More...</a><br /></td></tr>
<tr class="separator:afe0e9afb861a649aaba5efb3b9ac7d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07d4ce392f2c0e5bab856f6f354813a8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a07d4ce392f2c0e5bab856f6f354813a8">DD_NPOLE</a>&#160;&#160;&#160;-2</td></tr>
<tr class="memdesc:a07d4ce392f2c0e5bab856f6f354813a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant indicating the North pole [-].  <a href="mptrac_8h.html#a07d4ce392f2c0e5bab856f6f354813a8">More...</a><br /></td></tr>
<tr class="separator:a07d4ce392f2c0e5bab856f6f354813a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2544a6f3c2d54d8e61493db6d56ec16c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2544a6f3c2d54d8e61493db6d56ec16c">DD_SPOLE</a>&#160;&#160;&#160;-3</td></tr>
<tr class="memdesc:a2544a6f3c2d54d8e61493db6d56ec16c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant indicating the South pole [-].  <a href="mptrac_8h.html#a2544a6f3c2d54d8e61493db6d56ec16c">More...</a><br /></td></tr>
<tr class="separator:a2544a6f3c2d54d8e61493db6d56ec16c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aee3e5daf3b1051597d21ab093adbd0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(ptr,  type,  n)</td></tr>
<tr class="memdesc:a9aee3e5daf3b1051597d21ab093adbd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for a pointer with error handling.  <a href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">More...</a><br /></td></tr>
<tr class="separator:a9aee3e5daf3b1051597d21ab093adbd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56fa16148a574bac429287eb4612aa2e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a>(ix,  iy,  ny)&#160;&#160;&#160;  ((ix) * (ny) + (iy))</td></tr>
<tr class="memdesc:a56fa16148a574bac429287eb4612aa2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro for computing the linear index of a 2D array element.  <a href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">More...</a><br /></td></tr>
<tr class="separator:a56fa16148a574bac429287eb4612aa2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a81bdec7708d9599d0dcfa7a41caa26"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix,  iy,  ny,  iz,  nz)&#160;&#160;&#160;  (((ix)*(ny) + (iy)) * (nz) + (iz))</td></tr>
<tr class="memdesc:a0a81bdec7708d9599d0dcfa7a41caa26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the linear index of a 3D array element.  <a href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">More...</a><br /></td></tr>
<tr class="separator:a0a81bdec7708d9599d0dcfa7a41caa26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6fd608dae29bc65e5c4ad1480f7b891"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ad6fd608dae29bc65e5c4ad1480f7b891">ARRHENIUS</a>(a,  b,  t)&#160;&#160;&#160;  ((a) * exp( -(b) / (t)))</td></tr>
<tr class="memdesc:ad6fd608dae29bc65e5c4ad1480f7b891"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the Arrhenius rate constant.  <a href="mptrac_8h.html#ad6fd608dae29bc65e5c4ad1480f7b891">More...</a><br /></td></tr>
<tr class="separator:ad6fd608dae29bc65e5c4ad1480f7b891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49fc908b537b2bfd13462453f83267c0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a49fc908b537b2bfd13462453f83267c0">CLAMP</a>(v,  lo,  hi)&#160;&#160;&#160;  (((v) &lt; (lo)) ? (lo) : (((v) &gt; (hi)) ? (hi) : (v)))</td></tr>
<tr class="memdesc:a49fc908b537b2bfd13462453f83267c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clamp a value to a specified range.  <a href="mptrac_8h.html#a49fc908b537b2bfd13462453f83267c0">More...</a><br /></td></tr>
<tr class="separator:a49fc908b537b2bfd13462453f83267c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af32eb4cf0330afcdd3e0f3d195737a3c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af32eb4cf0330afcdd3e0f3d195737a3c">DEG2DX</a>(dlon,  lat)&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a> * <a class="el" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(dlon) * cos(<a class="el" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(lat)))</td></tr>
<tr class="memdesc:af32eb4cf0330afcdd3e0f3d195737a3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a longitude difference to a distance in the x-direction (east-west) at a specific latitude.  <a href="mptrac_8h.html#af32eb4cf0330afcdd3e0f3d195737a3c">More...</a><br /></td></tr>
<tr class="separator:af32eb4cf0330afcdd3e0f3d195737a3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b3bf18cdd34775ace994db9a97474b1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a6b3bf18cdd34775ace994db9a97474b1">DEG2DY</a>(dlat)&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a> * <a class="el" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(dlat))</td></tr>
<tr class="memdesc:a6b3bf18cdd34775ace994db9a97474b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a latitude difference to a distance in the y-direction (north-south).  <a href="mptrac_8h.html#a6b3bf18cdd34775ace994db9a97474b1">More...</a><br /></td></tr>
<tr class="separator:a6b3bf18cdd34775ace994db9a97474b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3616a5af1a14b0a5a1b2f542066ae45"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(deg)&#160;&#160;&#160;  ((deg) * (M_PI / 180.0))</td></tr>
<tr class="memdesc:aa3616a5af1a14b0a5a1b2f542066ae45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts degrees to radians.  <a href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">More...</a><br /></td></tr>
<tr class="separator:aa3616a5af1a14b0a5a1b2f542066ae45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d2bccab2674c0b9fee6d3107952fc8a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a5d2bccab2674c0b9fee6d3107952fc8a">DP2DZ</a>(dp,  p)&#160;&#160;&#160;  (- (dp) * <a class="el" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a> / (p))</td></tr>
<tr class="memdesc:a5d2bccab2674c0b9fee6d3107952fc8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a pressure difference to a height difference in the vertical direction.  <a href="mptrac_8h.html#a5d2bccab2674c0b9fee6d3107952fc8a">More...</a><br /></td></tr>
<tr class="separator:a5d2bccab2674c0b9fee6d3107952fc8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b22b78dc1239748a44cbd2db4862ef4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a6b22b78dc1239748a44cbd2db4862ef4">DX2DEG</a>(dx,  lat)</td></tr>
<tr class="memdesc:a6b22b78dc1239748a44cbd2db4862ef4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a distance in kilometers to degrees longitude at a given latitude.  <a href="mptrac_8h.html#a6b22b78dc1239748a44cbd2db4862ef4">More...</a><br /></td></tr>
<tr class="separator:a6b22b78dc1239748a44cbd2db4862ef4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7f0e2b08c22c7da133b53aaad9861ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">DY2DEG</a>(dy)&#160;&#160;&#160;  ((dy) * 180. / (M_PI * <a class="el" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a>))</td></tr>
<tr class="memdesc:af7f0e2b08c22c7da133b53aaad9861ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a distance in kilometers to degrees latitude.  <a href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">More...</a><br /></td></tr>
<tr class="separator:af7f0e2b08c22c7da133b53aaad9861ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d7cc5a9d3263cea4b432e83ab58c286"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8d7cc5a9d3263cea4b432e83ab58c286">DZ2DP</a>(dz,  p)&#160;&#160;&#160;  (-(dz) * (p) / <a class="el" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a>)</td></tr>
<tr class="memdesc:a8d7cc5a9d3263cea4b432e83ab58c286"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a change in altitude to a change in pressure.  <a href="mptrac_8h.html#a8d7cc5a9d3263cea4b432e83ab58c286">More...</a><br /></td></tr>
<tr class="separator:a8d7cc5a9d3263cea4b432e83ab58c286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae733a5a3a9e9a85474da2105655a0dc4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae733a5a3a9e9a85474da2105655a0dc4">DIST</a>(a,  b)&#160;&#160;&#160;  sqrt(<a class="el" href="mptrac_8h.html#af003cf5f79f68880f39a9a95d69f19bb">DIST2</a>(a, b))</td></tr>
<tr class="memdesc:ae733a5a3a9e9a85474da2105655a0dc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the distance between two points in Cartesian coordinates.  <a href="mptrac_8h.html#ae733a5a3a9e9a85474da2105655a0dc4">More...</a><br /></td></tr>
<tr class="separator:ae733a5a3a9e9a85474da2105655a0dc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af003cf5f79f68880f39a9a95d69f19bb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af003cf5f79f68880f39a9a95d69f19bb">DIST2</a>(a,  b)&#160;&#160;&#160;  ((a[0]-b[0])*(a[0]-b[0])+(a[1]-b[1])*(a[1]-b[1])+(a[2]-b[2])*(a[2]-b[2]))</td></tr>
<tr class="memdesc:af003cf5f79f68880f39a9a95d69f19bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the squared Euclidean distance between two points in Cartesian coordinates.  <a href="mptrac_8h.html#af003cf5f79f68880f39a9a95d69f19bb">More...</a><br /></td></tr>
<tr class="separator:af003cf5f79f68880f39a9a95d69f19bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f872a4cdfaa577c03b9dea8201028e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">DOTP</a>(a,  b)&#160;&#160;&#160;  (a[0]*b[0]+a[1]*b[1]+a[2]*b[2])</td></tr>
<tr class="memdesc:a2f872a4cdfaa577c03b9dea8201028e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the dot product of two vectors.  <a href="mptrac_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">More...</a><br /></td></tr>
<tr class="separator:a2f872a4cdfaa577c03b9dea8201028e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeabba41ec64b3f196c1e6802e22f265d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aeabba41ec64b3f196c1e6802e22f265d">ECC</a>(cmd)</td></tr>
<tr class="memdesc:aeabba41ec64b3f196c1e6802e22f265d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute an ECCODES command and check for errors.  <a href="mptrac_8h.html#aeabba41ec64b3f196c1e6802e22f265d">More...</a><br /></td></tr>
<tr class="separator:aeabba41ec64b3f196c1e6802e22f265d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ef36660c77a006dcb280b1cfd2e9945"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a9ef36660c77a006dcb280b1cfd2e9945">ECC_READ_2D</a>(variable,  target,  scaling_factor,  found_flag)</td></tr>
<tr class="memdesc:a9ef36660c77a006dcb280b1cfd2e9945"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes 2-D data from a grib message into the meteo struct.  <a href="mptrac_8h.html#a9ef36660c77a006dcb280b1cfd2e9945">More...</a><br /></td></tr>
<tr class="separator:a9ef36660c77a006dcb280b1cfd2e9945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d623ce25098e81e4de78bbb09b10f5b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2d623ce25098e81e4de78bbb09b10f5b">ECC_READ_3D</a>(variable,  level,  target,  scaling_factor,  found_flag)</td></tr>
<tr class="memdesc:a2d623ce25098e81e4de78bbb09b10f5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes 3D data from a grib message into the meteo struct.  <a href="mptrac_8h.html#a2d623ce25098e81e4de78bbb09b10f5b">More...</a><br /></td></tr>
<tr class="separator:a2d623ce25098e81e4de78bbb09b10f5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff4e721b49a057c4e4a3a6f56cc06469"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aff4e721b49a057c4e4a3a6f56cc06469">FMOD</a>(x,  y)&#160;&#160;&#160;  ((x) - (int) ((x) / (y)) * (y))</td></tr>
<tr class="memdesc:aff4e721b49a057c4e4a3a6f56cc06469"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the floating-point remainder of dividing x by y.  <a href="mptrac_8h.html#aff4e721b49a057c4e4a3a6f56cc06469">More...</a><br /></td></tr>
<tr class="separator:aff4e721b49a057c4e4a3a6f56cc06469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e3272a6f873b919d4f6d8982042a50"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(ptr,  type,  size,  in)</td></tr>
<tr class="memdesc:a68e3272a6f873b919d4f6d8982042a50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read data from a file stream and store it in memory.  <a href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">More...</a><br /></td></tr>
<tr class="separator:a68e3272a6f873b919d4f6d8982042a50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e67562ddd8fb52548a4ca02d3640bac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(ptr,  type,  size,  out)</td></tr>
<tr class="memdesc:a1e67562ddd8fb52548a4ca02d3640bac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write data from memory to a file stream.  <a href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">More...</a><br /></td></tr>
<tr class="separator:a1e67562ddd8fb52548a4ca02d3640bac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a1d95aec47889277a6bf1e25f366c24"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>&#160;&#160;&#160;  double cw[4] = {0.0, 0.0, 0.0, 0.0}; int ci[3] = {0, 0, 0};</td></tr>
<tr class="memdesc:a3a1d95aec47889277a6bf1e25f366c24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize arrays for interpolation.  <a href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">More...</a><br /></td></tr>
<tr class="separator:a3a1d95aec47889277a6bf1e25f366c24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4d615b798ce84f6ee2eb42df3c90998"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(var,  init)</td></tr>
<tr class="memdesc:ab4d615b798ce84f6ee2eb42df3c90998"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform 2D interpolation for a meteorological variable.  <a href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">More...</a><br /></td></tr>
<tr class="separator:ab4d615b798ce84f6ee2eb42df3c90998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48e10ecee070acb7be2df6a8ca3d9764"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(var,  init)</td></tr>
<tr class="memdesc:a48e10ecee070acb7be2df6a8ca3d9764"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform 3D interpolation for a meteorological variable.  <a href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">More...</a><br /></td></tr>
<tr class="separator:a48e10ecee070acb7be2df6a8ca3d9764"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2db66d3f79b89cb80d81f0ff4b8104be"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2db66d3f79b89cb80d81f0ff4b8104be">INTPOL_SPACE_ALL</a>(p,  lon,  lat)</td></tr>
<tr class="memdesc:a2db66d3f79b89cb80d81f0ff4b8104be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate multiple meteorological variables in space.  <a href="mptrac_8h.html#a2db66d3f79b89cb80d81f0ff4b8104be">More...</a><br /></td></tr>
<tr class="separator:a2db66d3f79b89cb80d81f0ff4b8104be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a983e27f3f3845d3e6bc38716aab60cdd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a983e27f3f3845d3e6bc38716aab60cdd">INTPOL_TIME_ALL</a>(time,  p,  lon,  lat)</td></tr>
<tr class="memdesc:a983e27f3f3845d3e6bc38716aab60cdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate multiple meteorological variables in time.  <a href="mptrac_8h.html#a983e27f3f3845d3e6bc38716aab60cdd">More...</a><br /></td></tr>
<tr class="separator:a983e27f3f3845d3e6bc38716aab60cdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25d1c99b30b81c5705cff2f3dd224a1d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a25d1c99b30b81c5705cff2f3dd224a1d">LAPSE</a>(p1,  t1,  p2,  t2)</td></tr>
<tr class="memdesc:a25d1c99b30b81c5705cff2f3dd224a1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate lapse rate.  <a href="mptrac_8h.html#a25d1c99b30b81c5705cff2f3dd224a1d">More...</a><br /></td></tr>
<tr class="separator:a25d1c99b30b81c5705cff2f3dd224a1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebaef4a0f8136be064bf1d29ce1ced83"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(x0,  y0,  x1,  y1,  x)&#160;&#160;&#160;  ((y0)+((y1)-(y0))/((x1)-(x0))*((x)-(x0)))</td></tr>
<tr class="memdesc:aebaef4a0f8136be064bf1d29ce1ced83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear interpolation.  <a href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">More...</a><br /></td></tr>
<tr class="separator:aebaef4a0f8136be064bf1d29ce1ced83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(a,  b)&#160;&#160;&#160;  (((a)&gt;(b))?(a):(b))</td></tr>
<tr class="memdesc:afa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro to determine the maximum of two values.  <a href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">More...</a><br /></td></tr>
<tr class="separator:afa99ec4acc4ecb2dc3c2d05da15d0e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7efc33e26d9ab0d99a61ade0e7f15893"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a7efc33e26d9ab0d99a61ade0e7f15893">MET_HEADER</a></td></tr>
<tr class="memdesc:a7efc33e26d9ab0d99a61ade0e7f15893"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write header for meteorological data file.  <a href="mptrac_8h.html#a7efc33e26d9ab0d99a61ade0e7f15893">More...</a><br /></td></tr>
<tr class="separator:a7efc33e26d9ab0d99a61ade0e7f15893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acffbd305ee72dcd4593c0d8af64a4f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(a,  b)&#160;&#160;&#160;  (((a)&lt;(b))?(a):(b))</td></tr>
<tr class="memdesc:a3acffbd305ee72dcd4593c0d8af64a4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro to determine the minimum of two values.  <a href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">More...</a><br /></td></tr>
<tr class="separator:a3acffbd305ee72dcd4593c0d8af64a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a241767dd865cc665eeee896fb598eb9f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a241767dd865cc665eeee896fb598eb9f">MOLEC_DENS</a>(p,  t)&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a174754c04acfba9e1f66ba249e68643a">AVO</a> * 1e-6 * ((p) * 100) / (<a class="el" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> * (t)))</td></tr>
<tr class="memdesc:a241767dd865cc665eeee896fb598eb9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the density of a gas molecule.  <a href="mptrac_8h.html#a241767dd865cc665eeee896fb598eb9f">More...</a><br /></td></tr>
<tr class="separator:a241767dd865cc665eeee896fb598eb9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2678db26e1acda0cccd79553b9cc9b51"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(cmd)</td></tr>
<tr class="memdesc:a2678db26e1acda0cccd79553b9cc9b51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute a NetCDF command and check for errors.  <a href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">More...</a><br /></td></tr>
<tr class="separator:a2678db26e1acda0cccd79553b9cc9b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca20163a6d11e1ee94426b2e44d5c17"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(varname,  type,  ndims,  dims,  long_name,  units,  level,  quant)</td></tr>
<tr class="memdesc:acca20163a6d11e1ee94426b2e44d5c17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define a NetCDF variable with attributes.  <a href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">More...</a><br /></td></tr>
<tr class="separator:acca20163a6d11e1ee94426b2e44d5c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7d3c9758dc177ab607539de4625d6ca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(varname,  ptr,  force)</td></tr>
<tr class="memdesc:ad7d3c9758dc177ab607539de4625d6ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a double-precision variable from a NetCDF file.  <a href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">More...</a><br /></td></tr>
<tr class="separator:ad7d3c9758dc177ab607539de4625d6ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2af2081610570f29a5d50b3864b4f9c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(dimname,  ptr,  min,  max,  check)</td></tr>
<tr class="memdesc:af2af2081610570f29a5d50b3864b4f9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inquire the length of a dimension in a NetCDF file.  <a href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">More...</a><br /></td></tr>
<tr class="separator:af2af2081610570f29a5d50b3864b4f9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8b2166768c41952fc7e05faef7bb593"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(varname,  ptr,  hyperslab)</td></tr>
<tr class="memdesc:ae8b2166768c41952fc7e05faef7bb593"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write double precision data to a NetCDF variable.  <a href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">More...</a><br /></td></tr>
<tr class="separator:ae8b2166768c41952fc7e05faef7bb593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e202b5cb2a0adea56392860c4ffb86"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ac0e202b5cb2a0adea56392860c4ffb86">NC_PUT_FLOAT</a>(varname,  ptr,  hyperslab)</td></tr>
<tr class="memdesc:ac0e202b5cb2a0adea56392860c4ffb86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a float array to a NetCDF file.  <a href="mptrac_8h.html#ac0e202b5cb2a0adea56392860c4ffb86">More...</a><br /></td></tr>
<tr class="separator:ac0e202b5cb2a0adea56392860c4ffb86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ed28cecbf584b977168813e9e2e0e32"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a3ed28cecbf584b977168813e9e2e0e32">NC_PUT_INT</a>(varname,  ptr,  hyperslab)</td></tr>
<tr class="memdesc:a3ed28cecbf584b977168813e9e2e0e32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write integer data to a NetCDF variable.  <a href="mptrac_8h.html#a3ed28cecbf584b977168813e9e2e0e32">More...</a><br /></td></tr>
<tr class="separator:a3ed28cecbf584b977168813e9e2e0e32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96e012265aff69f99407f69b8e1abb58"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a96e012265aff69f99407f69b8e1abb58">NC_PUT_ATT</a>(varname,  attname,  text)</td></tr>
<tr class="memdesc:a96e012265aff69f99407f69b8e1abb58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a text attribute to a NetCDF variable.  <a href="mptrac_8h.html#a96e012265aff69f99407f69b8e1abb58">More...</a><br /></td></tr>
<tr class="separator:a96e012265aff69f99407f69b8e1abb58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a218e2f27b530e30c0905d28be265e00f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a218e2f27b530e30c0905d28be265e00f">NC_PUT_ATT_GLOBAL</a>(attname,  text)&#160;&#160;&#160;  <a class="el" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_put_att_text(ncid, NC_GLOBAL, attname, strnlen(text, <a class="el" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>), text));</td></tr>
<tr class="memdesc:a218e2f27b530e30c0905d28be265e00f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a global text attribute to a NetCDF file.  <a href="mptrac_8h.html#a218e2f27b530e30c0905d28be265e00f">More...</a><br /></td></tr>
<tr class="separator:a218e2f27b530e30c0905d28be265e00f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04481815cacab8fbbb9109b21b6f57ec"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a04481815cacab8fbbb9109b21b6f57ec">NN</a>(x0,  y0,  x1,  y1,  x)&#160;&#160;&#160;  (fabs((x) - (x0)) &lt;= fabs((x) - (x1)) ? (y0) : (y1))</td></tr>
<tr class="memdesc:a04481815cacab8fbbb9109b21b6f57ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform nearest-neighbor interpolation.  <a href="mptrac_8h.html#a04481815cacab8fbbb9109b21b6f57ec">More...</a><br /></td></tr>
<tr class="separator:a04481815cacab8fbbb9109b21b6f57ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11241b8a58cfbbe8cc92e1db4aff45ab"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(ip0,  ip1,  check_dt, ...)</td></tr>
<tr class="memdesc:a11241b8a58cfbbe8cc92e1db4aff45ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loop over particle indices with OpenACC acceleration.  <a href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">More...</a><br /></td></tr>
<tr class="separator:a11241b8a58cfbbe8cc92e1db4aff45ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e1d0f42ad38aba63907665ccdd43b86"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>(z)&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">P0</a> * exp(-(z) / <a class="el" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a>))</td></tr>
<tr class="memdesc:a5e1d0f42ad38aba63907665ccdd43b86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute pressure at given altitude.  <a href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">More...</a><br /></td></tr>
<tr class="separator:a5e1d0f42ad38aba63907665ccdd43b86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc5ae7e10b1b021fb68397df5bad0a64"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#adc5ae7e10b1b021fb68397df5bad0a64">PSAT</a>(t)&#160;&#160;&#160;  (6.112 * exp(17.62 * ((t) - <a class="el" href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a>) / (243.12 + (t) - <a class="el" href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a>)))</td></tr>
<tr class="memdesc:adc5ae7e10b1b021fb68397df5bad0a64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute saturation pressure over water.  <a href="mptrac_8h.html#adc5ae7e10b1b021fb68397df5bad0a64">More...</a><br /></td></tr>
<tr class="separator:adc5ae7e10b1b021fb68397df5bad0a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70eb939aa0b84d808a49a4a18111ae9f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a70eb939aa0b84d808a49a4a18111ae9f">PSICE</a>(t)&#160;&#160;&#160;  (6.112 * exp(22.46 * ((t) - <a class="el" href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a>) / (272.62 + (t) - <a class="el" href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a>)))</td></tr>
<tr class="memdesc:a70eb939aa0b84d808a49a4a18111ae9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute saturation pressure over ice (WMO, 2018).  <a href="mptrac_8h.html#a70eb939aa0b84d808a49a4a18111ae9f">More...</a><br /></td></tr>
<tr class="separator:a70eb939aa0b84d808a49a4a18111ae9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f71059c62f3f9c3db1f6eb5f94dd7a8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">PW</a>(p,  h2o)&#160;&#160;&#160;  ((p) * <a class="el" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>((h2o), 0.1e-6) / (1. + (1. - <a class="el" href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a>) * <a class="el" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>((h2o), 0.1e-6)))</td></tr>
<tr class="memdesc:a1f71059c62f3f9c3db1f6eb5f94dd7a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate partial water vapor pressure.  <a href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">More...</a><br /></td></tr>
<tr class="separator:a1f71059c62f3f9c3db1f6eb5f94dd7a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc958134b53425ec947541bb72ac8b1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aacc958134b53425ec947541bb72ac8b1">RAD2DEG</a>(rad)&#160;&#160;&#160;  ((rad) * (180.0 / M_PI))</td></tr>
<tr class="memdesc:aacc958134b53425ec947541bb72ac8b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts radians to degrees.  <a href="mptrac_8h.html#aacc958134b53425ec947541bb72ac8b1">More...</a><br /></td></tr>
<tr class="separator:aacc958134b53425ec947541bb72ac8b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab72fd70a37f29f2192b751999b6c7cc2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ab72fd70a37f29f2192b751999b6c7cc2">RH</a>(p,  t,  h2o)&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">PW</a>(p, h2o) / <a class="el" href="mptrac_8h.html#adc5ae7e10b1b021fb68397df5bad0a64">PSAT</a>(t) * 100.)</td></tr>
<tr class="memdesc:ab72fd70a37f29f2192b751999b6c7cc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute relative humidity over water.  <a href="mptrac_8h.html#ab72fd70a37f29f2192b751999b6c7cc2">More...</a><br /></td></tr>
<tr class="separator:ab72fd70a37f29f2192b751999b6c7cc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9431567784929c9e462e16f393e04088"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a9431567784929c9e462e16f393e04088">RHICE</a>(p,  t,  h2o)&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">PW</a>(p, h2o) / <a class="el" href="mptrac_8h.html#a70eb939aa0b84d808a49a4a18111ae9f">PSICE</a>(t) * 100.)</td></tr>
<tr class="memdesc:a9431567784929c9e462e16f393e04088"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute relative humidity over ice.  <a href="mptrac_8h.html#a9431567784929c9e462e16f393e04088">More...</a><br /></td></tr>
<tr class="separator:a9431567784929c9e462e16f393e04088"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae088e183d18a16fd6ab469d48ce3f06a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae088e183d18a16fd6ab469d48ce3f06a">RHO</a>(p,  t)&#160;&#160;&#160;  (100. * (p) / (<a class="el" href="mptrac_8h.html#a30a3f049b718d26a32f16ed72716d588">RA</a> * (t)))</td></tr>
<tr class="memdesc:ae088e183d18a16fd6ab469d48ce3f06a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute density of air.  <a href="mptrac_8h.html#ae088e183d18a16fd6ab469d48ce3f06a">More...</a><br /></td></tr>
<tr class="separator:ae088e183d18a16fd6ab469d48ce3f06a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c741a27b379cebf498901dc7d271296"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt,  val)</td></tr>
<tr class="memdesc:a9c741a27b379cebf498901dc7d271296"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set atmospheric quantity value.  <a href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">More...</a><br /></td></tr>
<tr class="separator:a9c741a27b379cebf498901dc7d271296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e28faf41ab5f04f2f81ea7008565ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt,  name,  longname,  unit)</td></tr>
<tr class="memdesc:a83e28faf41ab5f04f2f81ea7008565ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set atmospheric quantity index.  <a href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">More...</a><br /></td></tr>
<tr class="separator:a83e28faf41ab5f04f2f81ea7008565ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b5bc0bd14e22c0329d967e3c6657bd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a47b5bc0bd14e22c0329d967e3c6657bd">SH</a>(h2o)&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> * <a class="el" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>((h2o), 0.1e-6))</td></tr>
<tr class="memdesc:a47b5bc0bd14e22c0329d967e3c6657bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute specific humidity from water vapor volume mixing ratio.  <a href="mptrac_8h.html#a47b5bc0bd14e22c0329d967e3c6657bd">More...</a><br /></td></tr>
<tr class="separator:a47b5bc0bd14e22c0329d967e3c6657bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7866fa5e4e0ee9b034e9dab6599a9cc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(x)&#160;&#160;&#160;  ((x)*(x))</td></tr>
<tr class="memdesc:aa7866fa5e4e0ee9b034e9dab6599a9cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the square of a value.  <a href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">More...</a><br /></td></tr>
<tr class="separator:aa7866fa5e4e0ee9b034e9dab6599a9cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addce2bf4f1107168ab1a7564756aa155"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#addce2bf4f1107168ab1a7564756aa155">SWAP</a>(x,  y,  type)&#160;&#160;&#160;  do {type tmp = x; x = y; y = tmp;} while(0);</td></tr>
<tr class="memdesc:addce2bf4f1107168ab1a7564756aa155"><td class="mdescLeft">&#160;</td><td class="mdescRight">Swap two values.  <a href="mptrac_8h.html#addce2bf4f1107168ab1a7564756aa155">More...</a><br /></td></tr>
<tr class="separator:addce2bf4f1107168ab1a7564756aa155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accf0b870a4ce9e19153c59f88898543a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#accf0b870a4ce9e19153c59f88898543a">TDEW</a>(p,  h2o)</td></tr>
<tr class="memdesc:accf0b870a4ce9e19153c59f88898543a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate dew point temperature.  <a href="mptrac_8h.html#accf0b870a4ce9e19153c59f88898543a">More...</a><br /></td></tr>
<tr class="separator:accf0b870a4ce9e19153c59f88898543a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a879f63fc7d15755d06ff79084410b6c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a879f63fc7d15755d06ff79084410b6c9">TICE</a>(p,  h2o)</td></tr>
<tr class="memdesc:a879f63fc7d15755d06ff79084410b6c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate frost point temperature (WMO, 2018).  <a href="mptrac_8h.html#a879f63fc7d15755d06ff79084410b6c9">More...</a><br /></td></tr>
<tr class="separator:a879f63fc7d15755d06ff79084410b6c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d6c988afa363960f9cb5f3b589d2ae4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>(p,  t)&#160;&#160;&#160;  ((t) * pow(1000. / (p), 0.286))</td></tr>
<tr class="memdesc:a7d6c988afa363960f9cb5f3b589d2ae4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute potential temperature.  <a href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">More...</a><br /></td></tr>
<tr class="separator:a7d6c988afa363960f9cb5f3b589d2ae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cbdab681e71d411200fb104480f4862"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8cbdab681e71d411200fb104480f4862">THETAVIRT</a>(p,  t,  h2o)&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(<a class="el" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>((p), (t)), <a class="el" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>((h2o), 0.1e-6)))</td></tr>
<tr class="memdesc:a8cbdab681e71d411200fb104480f4862"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute virtual potential temperature.  <a href="mptrac_8h.html#a8cbdab681e71d411200fb104480f4862">More...</a><br /></td></tr>
<tr class="separator:a8cbdab681e71d411200fb104480f4862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b61d1304377b77925b2802459ddae98"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(line,  tok,  format,  var)</td></tr>
<tr class="memdesc:a8b61d1304377b77925b2802459ddae98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get string tokens.  <a href="mptrac_8h.html#a8b61d1304377b77925b2802459ddae98">More...</a><br /></td></tr>
<tr class="separator:a8b61d1304377b77925b2802459ddae98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a068492d8c01b3b2d1aebf28ded97bb71"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(t,  h2o)&#160;&#160;&#160;  ((t) * (1. + (1. - <a class="el" href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a>) * <a class="el" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>((h2o), 0.1e-6)))</td></tr>
<tr class="memdesc:a068492d8c01b3b2d1aebf28ded97bb71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute virtual temperature.  <a href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">More...</a><br /></td></tr>
<tr class="separator:a068492d8c01b3b2d1aebf28ded97bb71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58b4f1573922a1f73dd4bf014fd441bf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(p)&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a> * log(<a class="el" href="mptrac_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">P0</a> / (p)))</td></tr>
<tr class="memdesc:a58b4f1573922a1f73dd4bf014fd441bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert pressure to altitude.  <a href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">More...</a><br /></td></tr>
<tr class="separator:a58b4f1573922a1f73dd4bf014fd441bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c73522db5d14433bd9ad2bd45d0de5f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8c73522db5d14433bd9ad2bd45d0de5f">ZDIFF</a>(lnp0,  t0,  h2o0,  lnp1,  t1,  h2o1)</td></tr>
<tr class="memdesc:a8c73522db5d14433bd9ad2bd45d0de5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate geopotential height difference.  <a href="mptrac_8h.html#a8c73522db5d14433bd9ad2bd45d0de5f">More...</a><br /></td></tr>
<tr class="separator:a8c73522db5d14433bd9ad2bd45d0de5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90ee947c906d48ce71affad259ac991d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a90ee947c906d48ce71affad259ac991d">ZETA</a>(ps,  p,  t)</td></tr>
<tr class="memdesc:a90ee947c906d48ce71affad259ac991d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the value of the zeta vertical coordinate.  <a href="mptrac_8h.html#a90ee947c906d48ce71affad259ac991d">More...</a><br /></td></tr>
<tr class="separator:a90ee947c906d48ce71affad259ac991d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c49f3ada06708693de9e60b449964c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aa0c49f3ada06708693de9e60b449964c">LOGLEV</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:aa0c49f3ada06708693de9e60b449964c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Level of log messages (0=none, 1=basic, 2=detailed, 3=debug).  <a href="mptrac_8h.html#aa0c49f3ada06708693de9e60b449964c">More...</a><br /></td></tr>
<tr class="separator:aa0c49f3ada06708693de9e60b449964c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaa1c3fa56061380a29889d703236251"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(level, ...)</td></tr>
<tr class="memdesc:acaa1c3fa56061380a29889d703236251"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a log message with a specified logging level.  <a href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">More...</a><br /></td></tr>
<tr class="separator:acaa1c3fa56061380a29889d703236251"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f75b971030a39ef811d3526a62b36b8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(...)</td></tr>
<tr class="memdesc:a8f75b971030a39ef811d3526a62b36b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a warning message with contextual information.  <a href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">More...</a><br /></td></tr>
<tr class="separator:a8f75b971030a39ef811d3526a62b36b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0ae69dee4a8bb2e616526b5ebe6875"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(...)</td></tr>
<tr class="memdesc:a3e0ae69dee4a8bb2e616526b5ebe6875"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print an error message with contextual information and terminate the program.  <a href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">More...</a><br /></td></tr>
<tr class="separator:a3e0ae69dee4a8bb2e616526b5ebe6875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19e6b556dec9bcdb4e422d57633ce731"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a19e6b556dec9bcdb4e422d57633ce731">PRINT</a>(format,  var)</td></tr>
<tr class="memdesc:a19e6b556dec9bcdb4e422d57633ce731"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the value of a variable with contextual information.  <a href="mptrac_8h.html#a19e6b556dec9bcdb4e422d57633ce731">More...</a><br /></td></tr>
<tr class="separator:a19e6b556dec9bcdb4e422d57633ce731"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14495ae1f9667df5d198613bcc8d092"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">NTIMER</a>&#160;&#160;&#160;100</td></tr>
<tr class="memdesc:ab14495ae1f9667df5d198613bcc8d092"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of timers.  <a href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">More...</a><br /></td></tr>
<tr class="separator:ab14495ae1f9667df5d198613bcc8d092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab84d08f557a59406c2b0969300937769"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ab84d08f557a59406c2b0969300937769">PRINT_TIMERS</a>&#160;&#160;&#160;  <a class="el" href="mptrac_8h.html#a6d6fa50cf378c33b8ba9575d17cffe9c">timer</a>(&quot;END&quot;, &quot;END&quot;, 1);</td></tr>
<tr class="memdesc:ab84d08f557a59406c2b0969300937769"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the current state of all timers.  <a href="mptrac_8h.html#ab84d08f557a59406c2b0969300937769">More...</a><br /></td></tr>
<tr class="separator:ab84d08f557a59406c2b0969300937769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b61365bd73a3cf3c059940b7e008749"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(id,  group)&#160;&#160;&#160;  <a class="el" href="mptrac_8h.html#a6d6fa50cf378c33b8ba9575d17cffe9c">timer</a>(id, group, 0);</td></tr>
<tr class="memdesc:a2b61365bd73a3cf3c059940b7e008749"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select and start a timer with specific attributes.  <a href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">More...</a><br /></td></tr>
<tr class="separator:a2b61365bd73a3cf3c059940b7e008749"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa4b5f89a098befae2a864decab80f133"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aa4b5f89a098befae2a864decab80f133">broadcast_large_data</a> (void *data, size_t N)</td></tr>
<tr class="memdesc:aa4b5f89a098befae2a864decab80f133"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broadcasts large data across all processes in an MPI communicator.  <a href="mptrac_8h.html#aa4b5f89a098befae2a864decab80f133">More...</a><br /></td></tr>
<tr class="separator:aa4b5f89a098befae2a864decab80f133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf98f7230de0893b8dc4833d3c83c7a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aaf98f7230de0893b8dc4833d3c83c7a4">cart2geo</a> (const double *x, double *z, double *lon, double *lat)</td></tr>
<tr class="memdesc:aaf98f7230de0893b8dc4833d3c83c7a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts Cartesian coordinates to geographic coordinates.  <a href="mptrac_8h.html#aaf98f7230de0893b8dc4833d3c83c7a4">More...</a><br /></td></tr>
<tr class="separator:aaf98f7230de0893b8dc4833d3c83c7a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ba00889eeb600010467d8b62de94a36"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a9ba00889eeb600010467d8b62de94a36">clim_oh</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structclim__t.html">clim_t</a> *clim, const double t, const double lon, const double lat, const double p)</td></tr>
<tr class="memdesc:a9ba00889eeb600010467d8b62de94a36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the hydroxyl radical (OH) concentration from climatology data, with an optional diurnal correction based on solar zenith angle.  <a href="mptrac_8h.html#a9ba00889eeb600010467d8b62de94a36">More...</a><br /></td></tr>
<tr class="separator:a9ba00889eeb600010467d8b62de94a36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba22251f4ea0fe56c2a59719998c650a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aba22251f4ea0fe56c2a59719998c650a">clim_oh_diurnal_correction</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structclim__t.html">clim_t</a> *clim)</td></tr>
<tr class="memdesc:aba22251f4ea0fe56c2a59719998c650a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a diurnal correction to the hydroxyl radical (OH) concentration in climatology data.  <a href="mptrac_8h.html#aba22251f4ea0fe56c2a59719998c650a">More...</a><br /></td></tr>
<tr class="separator:aba22251f4ea0fe56c2a59719998c650a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69a55a5bcd0af800ddc35cbe3b16cd15"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a69a55a5bcd0af800ddc35cbe3b16cd15">clim_photo</a> (const double rate[<a class="el" href="mptrac_8h.html#a6594e57d1fff186da0a254a3742dcff7">CP</a>][<a class="el" href="mptrac_8h.html#af7d97769fe58e5913e640ffed1d36fbf">CSZA</a>][<a class="el" href="mptrac_8h.html#ae27556d9109b33480031038071c8b4b0">CO3</a>], const <a class="el" href="structclim__photo__t.html">clim_photo_t</a> *photo, const double p, const double sza, const double o3c)</td></tr>
<tr class="memdesc:a69a55a5bcd0af800ddc35cbe3b16cd15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the photolysis rate for a given set of atmospheric conditions.  <a href="mptrac_8h.html#a69a55a5bcd0af800ddc35cbe3b16cd15">More...</a><br /></td></tr>
<tr class="separator:a69a55a5bcd0af800ddc35cbe3b16cd15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4531cb279e09061a6f34a73695c7b692"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a4531cb279e09061a6f34a73695c7b692">clim_tropo</a> (const <a class="el" href="structclim__t.html">clim_t</a> *clim, const double t, const double lat)</td></tr>
<tr class="memdesc:a4531cb279e09061a6f34a73695c7b692"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the tropopause pressure based on climatological data.  <a href="mptrac_8h.html#a4531cb279e09061a6f34a73695c7b692">More...</a><br /></td></tr>
<tr class="separator:a4531cb279e09061a6f34a73695c7b692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9cf40c6960c5078d1ea9e12a2fb0872"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aa9cf40c6960c5078d1ea9e12a2fb0872">clim_tropo_init</a> (<a class="el" href="structclim__t.html">clim_t</a> *clim)</td></tr>
<tr class="memdesc:aa9cf40c6960c5078d1ea9e12a2fb0872"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the tropopause data in the climatology structure.  <a href="mptrac_8h.html#aa9cf40c6960c5078d1ea9e12a2fb0872">More...</a><br /></td></tr>
<tr class="separator:aa9cf40c6960c5078d1ea9e12a2fb0872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbf877af94269d0aa1c94b7c50121df8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#acbf877af94269d0aa1c94b7c50121df8">clim_ts</a> (const <a class="el" href="structclim__ts__t.html">clim_ts_t</a> *ts, const double t)</td></tr>
<tr class="memdesc:acbf877af94269d0aa1c94b7c50121df8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates a time series of climatological variables.  <a href="mptrac_8h.html#acbf877af94269d0aa1c94b7c50121df8">More...</a><br /></td></tr>
<tr class="separator:acbf877af94269d0aa1c94b7c50121df8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41f5ab8ff7acad400fe7332b6b53288a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a> (const <a class="el" href="structclim__zm__t.html">clim_zm_t</a> *zm, const double t, const double lat, const double p)</td></tr>
<tr class="memdesc:a41f5ab8ff7acad400fe7332b6b53288a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates monthly mean zonal mean climatological variables.  <a href="mptrac_8h.html#a41f5ab8ff7acad400fe7332b6b53288a">More...</a><br /></td></tr>
<tr class="separator:a41f5ab8ff7acad400fe7332b6b53288a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e72346e130df723f0e0bec4eb739b14"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14">compress_cms</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const char *varname, float *array, const size_t nx, const size_t ny, const size_t np, const double *plev, const int decompress, FILE *inout)</td></tr>
<tr class="memdesc:a2e72346e130df723f0e0bec4eb739b14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compresses or decompresses a 3-D meteorological field using cmultiscale.  <a href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14">More...</a><br /></td></tr>
<tr class="separator:a2e72346e130df723f0e0bec4eb739b14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61bbe35a4ff7b797fdb64f9797a3ffd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a61bbe35a4ff7b797fdb64f9797a3ffd1">compress_pck</a> (const char *varname, float *array, const size_t nxy, const size_t nz, const int decompress, FILE *inout)</td></tr>
<tr class="memdesc:a61bbe35a4ff7b797fdb64f9797a3ffd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compresses or decompresses a 3D array of floats.  <a href="mptrac_8h.html#a61bbe35a4ff7b797fdb64f9797a3ffd1">More...</a><br /></td></tr>
<tr class="separator:a61bbe35a4ff7b797fdb64f9797a3ffd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae686ad6d0ce087fddcd62a7b87c768f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3">compress_sz3</a> (const char *varname, float *array, const int nx, const int ny, const int nz, const int precision, const double tolerance, const int decompress, FILE *inout)</td></tr>
<tr class="memdesc:ae686ad6d0ce087fddcd62a7b87c768f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compresses or decompresses a 3-D float array using the SZ3 library.  <a href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3">More...</a><br /></td></tr>
<tr class="separator:ae686ad6d0ce087fddcd62a7b87c768f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a412570d903373ea3f6ca36aa907f3d72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72">compress_zfp</a> (const char *varname, float *array, const int nx, const int ny, const int nz, const int precision, const double tolerance, const int decompress, FILE *inout)</td></tr>
<tr class="memdesc:a412570d903373ea3f6ca36aa907f3d72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compresses or decompresses a 3D array of floats using the ZFP library.  <a href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72">More...</a><br /></td></tr>
<tr class="separator:a412570d903373ea3f6ca36aa907f3d72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a057bb032e8b5df1b2a228b9b7931dd0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c">compress_zstd</a> (const char *varname, float *array, const size_t n, const int decompress, const int level, FILE *inout)</td></tr>
<tr class="memdesc:a057bb032e8b5df1b2a228b9b7931dd0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compresses or decompresses a float array using Zstandard (ZSTD).  <a href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c">More...</a><br /></td></tr>
<tr class="separator:a057bb032e8b5df1b2a228b9b7931dd0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c8c72b0bc66d214b4575c13a7a0eb6b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1c8c72b0bc66d214b4575c13a7a0eb6b">cos_sza</a> (const double sec, const double lon, const double lat)</td></tr>
<tr class="memdesc:a1c8c72b0bc66d214b4575c13a7a0eb6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the cosine of the solar zenith angle.  <a href="mptrac_8h.html#a1c8c72b0bc66d214b4575c13a7a0eb6b">More...</a><br /></td></tr>
<tr class="separator:a1c8c72b0bc66d214b4575c13a7a0eb6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0816a7fc51af1fbaf5146435baf29f82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a0816a7fc51af1fbaf5146435baf29f82">day2doy</a> (const int year, const int mon, const int day, int *doy)</td></tr>
<tr class="memdesc:a0816a7fc51af1fbaf5146435baf29f82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get day of year from date.  <a href="mptrac_8h.html#a0816a7fc51af1fbaf5146435baf29f82">More...</a><br /></td></tr>
<tr class="separator:a0816a7fc51af1fbaf5146435baf29f82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad70990693ea72717320cca5278d230fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ad70990693ea72717320cca5278d230fc">dd_assign_rect_subdomains_atm</a> (<a class="el" href="structatm__t.html">atm_t</a> *atm, <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structdd__t.html">dd_t</a> *dd, int init)</td></tr>
<tr class="memdesc:ad70990693ea72717320cca5278d230fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign atmospheric particles to rectangular subdomains.  <a href="mptrac_8h.html#ad70990693ea72717320cca5278d230fc">More...</a><br /></td></tr>
<tr class="separator:ad70990693ea72717320cca5278d230fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eac9efef5c2ad6768e59729a813f89e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8eac9efef5c2ad6768e59729a813f89e">dd_atm2particles</a> (<a class="el" href="structatm__t.html">atm_t</a> *atm, <a class="el" href="structparticle__t.html">particle_t</a> *particles, <a class="el" href="structctl__t.html">ctl_t</a> *ctl, int *nparticles, <a class="el" href="structcache__t.html">cache_t</a> *cache, int rank)</td></tr>
<tr class="memdesc:a8eac9efef5c2ad6768e59729a813f89e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts particles from an atmospheric state and prepares them for inter-domain transfer.  <a href="mptrac_8h.html#a8eac9efef5c2ad6768e59729a813f89e">More...</a><br /></td></tr>
<tr class="separator:a8eac9efef5c2ad6768e59729a813f89e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa30aab901e2920353694e0e14d8823c8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aa30aab901e2920353694e0e14d8823c8">dd_calc_subdomain_from_coords</a> (double lon, double lat, <a class="el" href="structmet__t.html">met_t</a> *met, <a class="el" href="structctl__t.html">ctl_t</a> *ctl, int mpi_size, int nx_glob, int ny_glob)</td></tr>
<tr class="memdesc:aa30aab901e2920353694e0e14d8823c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the destination subdomain (MPI rank) for a particle based on its geographic coordinates.  <a href="mptrac_8h.html#aa30aab901e2920353694e0e14d8823c8">More...</a><br /></td></tr>
<tr class="separator:aa30aab901e2920353694e0e14d8823c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4daa4b5e882b8dbde9e8bc8fba443c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ab4daa4b5e882b8dbde9e8bc8fba443c5">dd_communicate_particles</a> (<a class="el" href="structparticle__t.html">particle_t</a> *particles, int *nparticles, <a class="el" href="mptrac_8h.html#ada6230d3c1696537923dc5a9446d7521">MPI_Datatype</a> MPI_Particle, int *neighbours, int nneighbours, <a class="el" href="structctl__t.html">ctl_t</a> ctl)</td></tr>
<tr class="memdesc:ab4daa4b5e882b8dbde9e8bc8fba443c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Communicates particles between MPI processes.  <a href="mptrac_8h.html#ab4daa4b5e882b8dbde9e8bc8fba443c5">More...</a><br /></td></tr>
<tr class="separator:ab4daa4b5e882b8dbde9e8bc8fba443c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c01b33df34978b9434092c2a8bd6d2f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8c01b33df34978b9434092c2a8bd6d2f">dd_get_rect_neighbour</a> (const <a class="el" href="structctl__t.html">ctl_t</a> ctl, <a class="el" href="structdd__t.html">dd_t</a> *dd)</td></tr>
<tr class="memdesc:a8c01b33df34978b9434092c2a8bd6d2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines rectangular neighbouring ranks for MPI processes.  <a href="mptrac_8h.html#a8c01b33df34978b9434092c2a8bd6d2f">More...</a><br /></td></tr>
<tr class="separator:a8c01b33df34978b9434092c2a8bd6d2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a055f8ecc85c15a10e63d36f2d06eb3a8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a055f8ecc85c15a10e63d36f2d06eb3a8">dd_init</a> (<a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structdd__t.html">dd_t</a> *dd, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a055f8ecc85c15a10e63d36f2d06eb3a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes domain decomposition for parallel processing.  <a href="mptrac_8h.html#a055f8ecc85c15a10e63d36f2d06eb3a8">More...</a><br /></td></tr>
<tr class="separator:a055f8ecc85c15a10e63d36f2d06eb3a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81e8a5b50bf967bd3acc61f384549bc8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a81e8a5b50bf967bd3acc61f384549bc8">dd_is_periodic_longitude</a> (<a class="el" href="structmet__t.html">met_t</a> *met, int nx_glob)</td></tr>
<tr class="memdesc:a81e8a5b50bf967bd3acc61f384549bc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether the longitude grid is periodic (global coverage).  <a href="mptrac_8h.html#a81e8a5b50bf967bd3acc61f384549bc8">More...</a><br /></td></tr>
<tr class="separator:a81e8a5b50bf967bd3acc61f384549bc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a461d579646e5fba38e62a33f780a1ca4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a461d579646e5fba38e62a33f780a1ca4">dd_particles2atm</a> (<a class="el" href="structatm__t.html">atm_t</a> *atm, <a class="el" href="structparticle__t.html">particle_t</a> *particles, <a class="el" href="structctl__t.html">ctl_t</a> *ctl, int *nparticles, <a class="el" href="structcache__t.html">cache_t</a> *cache)</td></tr>
<tr class="memdesc:a461d579646e5fba38e62a33f780a1ca4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts particle data to atmospheric data.  <a href="mptrac_8h.html#a461d579646e5fba38e62a33f780a1ca4">More...</a><br /></td></tr>
<tr class="separator:a461d579646e5fba38e62a33f780a1ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae88ba4917bcc5964b59c20aa6c4717d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae88ba4917bcc5964b59c20aa6c4717d1">dd_register_MPI_type_particle</a> (<a class="el" href="mptrac_8h.html#ada6230d3c1696537923dc5a9446d7521">MPI_Datatype</a> *MPI_Particle)</td></tr>
<tr class="memdesc:ae88ba4917bcc5964b59c20aa6c4717d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a custom MPI datatype for particle structures.  <a href="mptrac_8h.html#ae88ba4917bcc5964b59c20aa6c4717d1">More...</a><br /></td></tr>
<tr class="separator:ae88ba4917bcc5964b59c20aa6c4717d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24daf9849621181ba5b8dcec1c187778"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a24daf9849621181ba5b8dcec1c187778">dd_sort</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structatm__t.html">atm_t</a> *atm, <a class="el" href="structdd__t.html">dd_t</a> *dd, int *nparticles, int *rank)</td></tr>
<tr class="memdesc:a24daf9849621181ba5b8dcec1c187778"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sort particles according to box index and target rank for neighbours.  <a href="mptrac_8h.html#a24daf9849621181ba5b8dcec1c187778">More...</a><br /></td></tr>
<tr class="separator:a24daf9849621181ba5b8dcec1c187778"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac97104a007f600d9912d8a6bd85abf4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ac97104a007f600d9912d8a6bd85abf4b">dd_sort_help</a> (double *a, <a class="el" href="structdd__t.html">dd_t</a> *dd, const int np)</td></tr>
<tr class="memdesc:ac97104a007f600d9912d8a6bd85abf4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reorder an array according to a permutation vector.  <a href="mptrac_8h.html#ac97104a007f600d9912d8a6bd85abf4b">More...</a><br /></td></tr>
<tr class="separator:ac97104a007f600d9912d8a6bd85abf4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab49cba44fc2caf4c419798b0ffc47f77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ab49cba44fc2caf4c419798b0ffc47f77">doy2day</a> (const int year, const int doy, int *mon, int *day)</td></tr>
<tr class="memdesc:ab49cba44fc2caf4c419798b0ffc47f77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a given day of the year (DOY) to a date (month and day).  <a href="mptrac_8h.html#ab49cba44fc2caf4c419798b0ffc47f77">More...</a><br /></td></tr>
<tr class="separator:ab49cba44fc2caf4c419798b0ffc47f77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d4d1bda2a510a5a0818cf09f5abccd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a5d4d1bda2a510a5a0818cf09f5abccd1">fft_help</a> (double *fcReal, double *fcImag, const int n)</td></tr>
<tr class="memdesc:a5d4d1bda2a510a5a0818cf09f5abccd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the Fast Fourier Transform (FFT) of a complex sequence.  <a href="mptrac_8h.html#a5d4d1bda2a510a5a0818cf09f5abccd1">More...</a><br /></td></tr>
<tr class="separator:a5d4d1bda2a510a5a0818cf09f5abccd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3aea782dfca9019f3f2d169f8cc0f6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a> (const double z, const double lon, const double lat, double *x)</td></tr>
<tr class="memdesc:ae3aea782dfca9019f3f2d169f8cc0f6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates.  <a href="mptrac_8h.html#ae3aea782dfca9019f3f2d169f8cc0f6d">More...</a><br /></td></tr>
<tr class="separator:ae3aea782dfca9019f3f2d169f8cc0f6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad0e01f51c815c87fccaae55195d8a35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aad0e01f51c815c87fccaae55195d8a35">get_met_help</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const double t, const int direct, const char *metbase, const double dt_met, char *filename)</td></tr>
<tr class="memdesc:aad0e01f51c815c87fccaae55195d8a35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a formatted filename for meteorological data files based on the input parameters.  <a href="mptrac_8h.html#aad0e01f51c815c87fccaae55195d8a35">More...</a><br /></td></tr>
<tr class="separator:aad0e01f51c815c87fccaae55195d8a35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac54a92b848d49b96ef6091df37b552f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ac54a92b848d49b96ef6091df37b552f2">get_met_replace</a> (char *orig, char *search, char *repl)</td></tr>
<tr class="memdesc:ac54a92b848d49b96ef6091df37b552f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces occurrences of a substring in a string with another substring.  <a href="mptrac_8h.html#ac54a92b848d49b96ef6091df37b552f2">More...</a><br /></td></tr>
<tr class="separator:ac54a92b848d49b96ef6091df37b552f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c47d6d6469c5ab48cf0d0585b257593"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2c47d6d6469c5ab48cf0d0585b257593">get_tropo</a> (const int met_tropo, <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met, const double *lons, const int nx, const double *lats, const int ny, double *pt, double *zt, double *tt, double *qt, double *o3t, double *ps, double *zs)</td></tr>
<tr class="memdesc:a2c47d6d6469c5ab48cf0d0585b257593"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate tropopause data.  <a href="mptrac_8h.html#a2c47d6d6469c5ab48cf0d0585b257593">More...</a><br /></td></tr>
<tr class="separator:a2c47d6d6469c5ab48cf0d0585b257593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0880745f22b8f99b19eeecf984df11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af0880745f22b8f99b19eeecf984df11d">intpol_check_lon_lat</a> (const double *lons, const int nlon, const double *lats, const int nlat, const double lon, const double lat, double *lon2, double *lat2)</td></tr>
<tr class="memdesc:af0880745f22b8f99b19eeecf984df11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjusts longitude and latitude to ensure they fall within valid bounds.  <a href="mptrac_8h.html#af0880745f22b8f99b19eeecf984df11d">More...</a><br /></td></tr>
<tr class="separator:af0880745f22b8f99b19eeecf984df11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52ad82091c3f977ba43c5983aa048667"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a52ad82091c3f977ba43c5983aa048667">intpol_met_4d_zeta</a> (const <a class="el" href="structmet__t.html">met_t</a> *met0, float height0[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], float array0[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const <a class="el" href="structmet__t.html">met_t</a> *met1, float height1[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], float array1[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const double ts, const double height, const double lon, const double lat, double *var, int *ci, double *cw, const int init)</td></tr>
<tr class="memdesc:a52ad82091c3f977ba43c5983aa048667"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates meteorological variables to a given position and time.  <a href="mptrac_8h.html#a52ad82091c3f977ba43c5983aa048667">More...</a><br /></td></tr>
<tr class="separator:a52ad82091c3f977ba43c5983aa048667"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72b3417d6665335c02591c365f88cad1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a> (const <a class="el" href="structmet__t.html">met_t</a> *met, float array[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const double p, const double lon, const double lat, double *var, int *ci, double *cw, const int init)</td></tr>
<tr class="memdesc:a72b3417d6665335c02591c365f88cad1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates meteorological variables in 3D space.  <a href="mptrac_8h.html#a72b3417d6665335c02591c365f88cad1">More...</a><br /></td></tr>
<tr class="separator:a72b3417d6665335c02591c365f88cad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d832e4cf4224c4166d2f083a7a02514"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1d832e4cf4224c4166d2f083a7a02514">intpol_met_space_2d</a> (const <a class="el" href="structmet__t.html">met_t</a> *met, float array[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>], const double lon, const double lat, double *var, int *ci, double *cw, const int init)</td></tr>
<tr class="memdesc:a1d832e4cf4224c4166d2f083a7a02514"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates meteorological variables in 2D space.  <a href="mptrac_8h.html#a1d832e4cf4224c4166d2f083a7a02514">More...</a><br /></td></tr>
<tr class="separator:a1d832e4cf4224c4166d2f083a7a02514"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5819df4f969928e2f45144e44feb50a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a> (const <a class="el" href="structmet__t.html">met_t</a> *met0, float array0[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const <a class="el" href="structmet__t.html">met_t</a> *met1, float array1[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const double ts, const double p, const double lon, const double lat, double *var, int *ci, double *cw, const int init)</td></tr>
<tr class="memdesc:a5819df4f969928e2f45144e44feb50a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates meteorological data in 3D space and time.  <a href="mptrac_8h.html#a5819df4f969928e2f45144e44feb50a6">More...</a><br /></td></tr>
<tr class="separator:a5819df4f969928e2f45144e44feb50a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab88b081ba4352a0566066ec4156b94c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ab88b081ba4352a0566066ec4156b94c6">intpol_met_time_2d</a> (const <a class="el" href="structmet__t.html">met_t</a> *met0, float array0[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>], const <a class="el" href="structmet__t.html">met_t</a> *met1, float array1[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>], const double ts, const double lon, const double lat, double *var, int *ci, double *cw, const int init)</td></tr>
<tr class="memdesc:ab88b081ba4352a0566066ec4156b94c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates meteorological data in 2D space and time.  <a href="mptrac_8h.html#ab88b081ba4352a0566066ec4156b94c6">More...</a><br /></td></tr>
<tr class="separator:ab88b081ba4352a0566066ec4156b94c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89361130320488e87e4eb614a138d6cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a89361130320488e87e4eb614a138d6cb">intpol_tropo_3d</a> (const double time0, float array0[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>], const double time1, float array1[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>], const double lons[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>], const double lats[<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>], const int nlon, const int nlat, const double time, const double lon, const double lat, const int method, double *var, double *sigma)</td></tr>
<tr class="memdesc:a89361130320488e87e4eb614a138d6cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates tropopause data in 3D (latitude, longitude, and time).  <a href="mptrac_8h.html#a89361130320488e87e4eb614a138d6cb">More...</a><br /></td></tr>
<tr class="separator:a89361130320488e87e4eb614a138d6cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc0c1829ca7770d2dd6342f2cdf10bb9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a> (const double jsec, int *year, int *mon, int *day, int *hour, int *min, int *sec, double *remain)</td></tr>
<tr class="memdesc:acc0c1829ca7770d2dd6342f2cdf10bb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts Julian seconds to calendar date and time components.  <a href="mptrac_8h.html#acc0c1829ca7770d2dd6342f2cdf10bb9">More...</a><br /></td></tr>
<tr class="separator:acc0c1829ca7770d2dd6342f2cdf10bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae61cf973263fcc45574daa27d0dec8cd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae61cf973263fcc45574daa27d0dec8cd">kernel_weight</a> (const double kz[<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const double kw[<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const int nk, const double p)</td></tr>
<tr class="memdesc:ae61cf973263fcc45574daa27d0dec8cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the kernel weight based on altitude and given kernel data.  <a href="mptrac_8h.html#ae61cf973263fcc45574daa27d0dec8cd">More...</a><br /></td></tr>
<tr class="separator:ae61cf973263fcc45574daa27d0dec8cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa485eb277a5ced6dac0ed77665c976c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#afa485eb277a5ced6dac0ed77665c976c">lapse_rate</a> (const double t, const double h2o)</td></tr>
<tr class="memdesc:afa485eb277a5ced6dac0ed77665c976c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the moist adiabatic lapse rate in Kelvin per kilometer.  <a href="mptrac_8h.html#afa485eb277a5ced6dac0ed77665c976c">More...</a><br /></td></tr>
<tr class="separator:afa485eb277a5ced6dac0ed77665c976c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51f61e053cfec3bdd62fa3a8110e046e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a51f61e053cfec3bdd62fa3a8110e046e">level_definitions</a> (<a class="el" href="structctl__t.html">ctl_t</a> *ctl)</td></tr>
<tr class="memdesc:a51f61e053cfec3bdd62fa3a8110e046e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines pressure levels for meteorological data.  <a href="mptrac_8h.html#a51f61e053cfec3bdd62fa3a8110e046e">More...</a><br /></td></tr>
<tr class="separator:a51f61e053cfec3bdd62fa3a8110e046e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e1b87dc3c93a23c89f739adf10b60dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a> (const double *xx, const int n, const double x)</td></tr>
<tr class="memdesc:a4e1b87dc3c93a23c89f739adf10b60dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locate the index of the interval containing a given value in a sorted array.  <a href="mptrac_8h.html#a4e1b87dc3c93a23c89f739adf10b60dc">More...</a><br /></td></tr>
<tr class="separator:a4e1b87dc3c93a23c89f739adf10b60dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b9ae6cda41f85d46c6333d039ee0861"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8b9ae6cda41f85d46c6333d039ee0861">locate_irr_float</a> (const float *xx, const int n, const double x, const int ig)</td></tr>
<tr class="memdesc:a8b9ae6cda41f85d46c6333d039ee0861"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locate the index of the interval containing a given value in an irregularly spaced array.  <a href="mptrac_8h.html#a8b9ae6cda41f85d46c6333d039ee0861">More...</a><br /></td></tr>
<tr class="separator:a8b9ae6cda41f85d46c6333d039ee0861"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a3c8ab98f21179741b274439786726d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a> (const double *xx, const int n, const double x)</td></tr>
<tr class="memdesc:a2a3c8ab98f21179741b274439786726d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locate the index of the interval containing a given value in a regular grid.  <a href="mptrac_8h.html#a2a3c8ab98f21179741b274439786726d">More...</a><br /></td></tr>
<tr class="separator:a2a3c8ab98f21179741b274439786726d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c56a2456275955981415456e631243f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2c56a2456275955981415456e631243f">locate_vert</a> (float profiles[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const int np, const int lon_ap_ind, const int lat_ap_ind, const double alt_ap, int *ind)</td></tr>
<tr class="memdesc:a2c56a2456275955981415456e631243f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locate the four vertical indizes of a box for a given height value.  <a href="mptrac_8h.html#a2c56a2456275955981415456e631243f">More...</a><br /></td></tr>
<tr class="separator:a2c56a2456275955981415456e631243f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16101092a4f867b18cf1d4feb3189d1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a16101092a4f867b18cf1d4feb3189d1d">module_advect</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a16101092a4f867b18cf1d4feb3189d1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advances particle positions using different advection schemes.  <a href="mptrac_8h.html#a16101092a4f867b18cf1d4feb3189d1d">More...</a><br /></td></tr>
<tr class="separator:a16101092a4f867b18cf1d4feb3189d1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f61eec2b48a2250ca25ff4657fa858d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a7f61eec2b48a2250ca25ff4657fa858d">module_advect_init</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a7f61eec2b48a2250ca25ff4657fa858d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the advection module by setting up pressure fields.  <a href="mptrac_8h.html#a7f61eec2b48a2250ca25ff4657fa858d">More...</a><br /></td></tr>
<tr class="separator:a7f61eec2b48a2250ca25ff4657fa858d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c775417ba44bae7a915616cc9df4615"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a7c775417ba44bae7a915616cc9df4615">module_bound_cond</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a7c775417ba44bae7a915616cc9df4615"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply boundary conditions to particles based on meteorological and climatological data.  <a href="mptrac_8h.html#a7c775417ba44bae7a915616cc9df4615">More...</a><br /></td></tr>
<tr class="separator:a7c775417ba44bae7a915616cc9df4615"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a904c7f663617b319b69d5ff6fe04507a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a904c7f663617b319b69d5ff6fe04507a">module_chem_grid</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:a904c7f663617b319b69d5ff6fe04507a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes gridded chemical tracer concentrations (volume mixing ratio) from individual air parcel mass data and assigns them back to the parcels.  <a href="mptrac_8h.html#a904c7f663617b319b69d5ff6fe04507a">More...</a><br /></td></tr>
<tr class="separator:a904c7f663617b319b69d5ff6fe04507a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a04fee6c403d3d912d89d9666c0fd7b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2a04fee6c403d3d912d89d9666c0fd7b">module_chem_init</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a2a04fee6c403d3d912d89d9666c0fd7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the chemistry modules by setting atmospheric composition.  <a href="mptrac_8h.html#a2a04fee6c403d3d912d89d9666c0fd7b">More...</a><br /></td></tr>
<tr class="separator:a2a04fee6c403d3d912d89d9666c0fd7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a799ef256c15dc112842d1dbc5afc787c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a799ef256c15dc112842d1dbc5afc787c">module_convection</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a799ef256c15dc112842d1dbc5afc787c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs convective mixing of atmospheric particles.  <a href="mptrac_8h.html#a799ef256c15dc112842d1dbc5afc787c">More...</a><br /></td></tr>
<tr class="separator:a799ef256c15dc112842d1dbc5afc787c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7dbcc9e4768175409c30a110dcd8308"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ac7dbcc9e4768175409c30a110dcd8308">module_dd</a> (<a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm, <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structdd__t.html">dd_t</a> *dd, <a class="el" href="structmet__t.html">met_t</a> **met)</td></tr>
<tr class="memdesc:ac7dbcc9e4768175409c30a110dcd8308"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manages domain decomposition and particle communication in parallel processing.  <a href="mptrac_8h.html#ac7dbcc9e4768175409c30a110dcd8308">More...</a><br /></td></tr>
<tr class="separator:ac7dbcc9e4768175409c30a110dcd8308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b4a2c668aae5a7ae522eab2489a464c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1b4a2c668aae5a7ae522eab2489a464c">module_decay</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a1b4a2c668aae5a7ae522eab2489a464c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulate exponential decay processes for atmospheric particles.  <a href="mptrac_8h.html#a1b4a2c668aae5a7ae522eab2489a464c">More...</a><br /></td></tr>
<tr class="separator:a1b4a2c668aae5a7ae522eab2489a464c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7d1bdf49d0da3ca1911eebe2a96a2ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ac7d1bdf49d0da3ca1911eebe2a96a2ac">module_diff_meso</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ac7d1bdf49d0da3ca1911eebe2a96a2ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulate mesoscale diffusion for atmospheric particles.  <a href="mptrac_8h.html#ac7d1bdf49d0da3ca1911eebe2a96a2ac">More...</a><br /></td></tr>
<tr class="separator:ac7d1bdf49d0da3ca1911eebe2a96a2ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae102581d80f5817f4c5ef356bde43184"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae102581d80f5817f4c5ef356bde43184">module_diff_pbl</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ae102581d80f5817f4c5ef356bde43184"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes particle diffusion within the planetary boundary layer (PBL).  <a href="mptrac_8h.html#ae102581d80f5817f4c5ef356bde43184">More...</a><br /></td></tr>
<tr class="separator:ae102581d80f5817f4c5ef356bde43184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3e7ae644cd3068669c3f7c7669f4a02"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ad3e7ae644cd3068669c3f7c7669f4a02">module_diff_turb</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structcache__t.html">cache_t</a> *cache, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ad3e7ae644cd3068669c3f7c7669f4a02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies turbulent diffusion processes to atmospheric particles.  <a href="mptrac_8h.html#ad3e7ae644cd3068669c3f7c7669f4a02">More...</a><br /></td></tr>
<tr class="separator:ad3e7ae644cd3068669c3f7c7669f4a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af237449d9c3c8fec9e5f062cdc579105"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af237449d9c3c8fec9e5f062cdc579105">module_dry_depo</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:af237449d9c3c8fec9e5f062cdc579105"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulate dry deposition of atmospheric particles.  <a href="mptrac_8h.html#af237449d9c3c8fec9e5f062cdc579105">More...</a><br /></td></tr>
<tr class="separator:af237449d9c3c8fec9e5f062cdc579105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeecfbf32977d527d934a778edd84f38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#adeecfbf32977d527d934a778edd84f38">module_h2o2_chem</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:adeecfbf32977d527d934a778edd84f38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform chemical reactions involving H2O2 within cloud particles.  <a href="mptrac_8h.html#adeecfbf32977d527d934a778edd84f38">More...</a><br /></td></tr>
<tr class="separator:adeecfbf32977d527d934a778edd84f38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51093927ceae5630067278cee548797f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a51093927ceae5630067278cee548797f">module_isosurf_init</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a51093927ceae5630067278cee548797f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the isosurface module based on atmospheric data.  <a href="mptrac_8h.html#a51093927ceae5630067278cee548797f">More...</a><br /></td></tr>
<tr class="separator:a51093927ceae5630067278cee548797f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae194c1be6a486d2bd92f5794637d53e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae194c1be6a486d2bd92f5794637d53e2">module_isosurf</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ae194c1be6a486d2bd92f5794637d53e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the isosurface module to adjust atmospheric properties.  <a href="mptrac_8h.html#ae194c1be6a486d2bd92f5794637d53e2">More...</a><br /></td></tr>
<tr class="separator:ae194c1be6a486d2bd92f5794637d53e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1de15701f752a97b1d2858125e851fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae1de15701f752a97b1d2858125e851fc">module_kpp_chem</a> (<a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ae1de15701f752a97b1d2858125e851fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">KPP chemistry module.  <a href="mptrac_8h.html#ae1de15701f752a97b1d2858125e851fc">More...</a><br /></td></tr>
<tr class="separator:ae1de15701f752a97b1d2858125e851fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a15f897588f202b09b4eea27b89f734"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1a15f897588f202b09b4eea27b89f734">module_meteo</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a1a15f897588f202b09b4eea27b89f734"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update atmospheric properties using meteorological data.  <a href="mptrac_8h.html#a1a15f897588f202b09b4eea27b89f734">More...</a><br /></td></tr>
<tr class="separator:a1a15f897588f202b09b4eea27b89f734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40777319fe0947dcf920f10de9d55085"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a40777319fe0947dcf920f10de9d55085">module_mixing</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:a40777319fe0947dcf920f10de9d55085"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update atmospheric properties through interparcel mixing.  <a href="mptrac_8h.html#a40777319fe0947dcf920f10de9d55085">More...</a><br /></td></tr>
<tr class="separator:a40777319fe0947dcf920f10de9d55085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a433c00a5ba68e33cc6ac08ee2217a76f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a433c00a5ba68e33cc6ac08ee2217a76f">module_mixing_help</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structatm__t.html">atm_t</a> *atm, const int *ixs, const int *iys, const int *izs, const int qnt_idx, const int use_ensemble)</td></tr>
<tr class="memdesc:a433c00a5ba68e33cc6ac08ee2217a76f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform subgrid-scale interparcel mixing of a given quantity.  <a href="mptrac_8h.html#a433c00a5ba68e33cc6ac08ee2217a76f">More...</a><br /></td></tr>
<tr class="separator:a433c00a5ba68e33cc6ac08ee2217a76f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae27eb9636b812ae9155ac23c86856d1b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae27eb9636b812ae9155ac23c86856d1b">module_oh_chem</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ae27eb9636b812ae9155ac23c86856d1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform hydroxyl chemistry calculations for atmospheric particles.  <a href="mptrac_8h.html#ae27eb9636b812ae9155ac23c86856d1b">More...</a><br /></td></tr>
<tr class="separator:ae27eb9636b812ae9155ac23c86856d1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8f2e9219b39e8eb46e7d5c9d8398e53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ab8f2e9219b39e8eb46e7d5c9d8398e53">module_position</a> (const <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ab8f2e9219b39e8eb46e7d5c9d8398e53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the positions and pressure levels of atmospheric particles.  <a href="mptrac_8h.html#ab8f2e9219b39e8eb46e7d5c9d8398e53">More...</a><br /></td></tr>
<tr class="separator:ab8f2e9219b39e8eb46e7d5c9d8398e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9430c769e61661f2da526feb29d2d032"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a9430c769e61661f2da526feb29d2d032">module_rng_init</a> (const int ntask)</td></tr>
<tr class="memdesc:a9430c769e61661f2da526feb29d2d032"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize random number generators for parallel tasks.  <a href="mptrac_8h.html#a9430c769e61661f2da526feb29d2d032">More...</a><br /></td></tr>
<tr class="separator:a9430c769e61661f2da526feb29d2d032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab313e4929e7379aca2aee1ee36873d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aab313e4929e7379aca2aee1ee36873d9">module_rng</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, double *rs, const size_t n, const int method)</td></tr>
<tr class="memdesc:aab313e4929e7379aca2aee1ee36873d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate random numbers using various methods and distributions.  <a href="mptrac_8h.html#aab313e4929e7379aca2aee1ee36873d9">More...</a><br /></td></tr>
<tr class="separator:aab313e4929e7379aca2aee1ee36873d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cdd8f72190aa0901f08f48afc240ee1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a6cdd8f72190aa0901f08f48afc240ee1">module_sedi</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a6cdd8f72190aa0901f08f48afc240ee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulate sedimentation of particles in the atmosphere.  <a href="mptrac_8h.html#a6cdd8f72190aa0901f08f48afc240ee1">More...</a><br /></td></tr>
<tr class="separator:a6cdd8f72190aa0901f08f48afc240ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a4606b5ab8abb85a6f4b833e9f13f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ac9a4606b5ab8abb85a6f4b833e9f13f2">module_sort</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ac9a4606b5ab8abb85a6f4b833e9f13f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sort particles according to box index.  <a href="mptrac_8h.html#ac9a4606b5ab8abb85a6f4b833e9f13f2">More...</a><br /></td></tr>
<tr class="separator:ac9a4606b5ab8abb85a6f4b833e9f13f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8540fc571513e0d8f82e268b80c6bd3b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8540fc571513e0d8f82e268b80c6bd3b">module_sort_help</a> (double *a, const int *p, const int np)</td></tr>
<tr class="memdesc:a8540fc571513e0d8f82e268b80c6bd3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reorder an array based on a given permutation.  <a href="mptrac_8h.html#a8540fc571513e0d8f82e268b80c6bd3b">More...</a><br /></td></tr>
<tr class="separator:a8540fc571513e0d8f82e268b80c6bd3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a186195c8bbbd5cac5c1f52eed531804c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a186195c8bbbd5cac5c1f52eed531804c">module_timesteps</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:a186195c8bbbd5cac5c1f52eed531804c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate time steps for air parcels based on specified conditions.  <a href="mptrac_8h.html#a186195c8bbbd5cac5c1f52eed531804c">More...</a><br /></td></tr>
<tr class="separator:a186195c8bbbd5cac5c1f52eed531804c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f42ca12ace33e1168edaaf4b96e5a60"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a3f42ca12ace33e1168edaaf4b96e5a60">module_timesteps_init</a> (<a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a3f42ca12ace33e1168edaaf4b96e5a60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize start time and time interval for time-stepping.  <a href="mptrac_8h.html#a3f42ca12ace33e1168edaaf4b96e5a60">More...</a><br /></td></tr>
<tr class="separator:a3f42ca12ace33e1168edaaf4b96e5a60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb66834f81688452a86c1a574bafca03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#adb66834f81688452a86c1a574bafca03">module_tracer_chem</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:adb66834f81688452a86c1a574bafca03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulate chemical reactions involving long-lived atmospheric tracers.  <a href="mptrac_8h.html#adb66834f81688452a86c1a574bafca03">More...</a><br /></td></tr>
<tr class="separator:adb66834f81688452a86c1a574bafca03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e35405aee5829cf062bd3cab20b0425"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a5e35405aee5829cf062bd3cab20b0425">module_wet_depo</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a5e35405aee5829cf062bd3cab20b0425"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform wet deposition calculations for air parcels.  <a href="mptrac_8h.html#a5e35405aee5829cf062bd3cab20b0425">More...</a><br /></td></tr>
<tr class="separator:a5e35405aee5829cf062bd3cab20b0425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05eca328a1d7b6ea06252dca2f83961d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a05eca328a1d7b6ea06252dca2f83961d">mptrac_alloc</a> (<a class="el" href="structctl__t.html">ctl_t</a> **ctl, <a class="el" href="structcache__t.html">cache_t</a> **cache, <a class="el" href="structclim__t.html">clim_t</a> **clim, <a class="el" href="structmet__t.html">met_t</a> **met0, <a class="el" href="structmet__t.html">met_t</a> **met1, <a class="el" href="structatm__t.html">atm_t</a> **atm, <a class="el" href="structdd__t.html">dd_t</a> **dd)</td></tr>
<tr class="memdesc:a05eca328a1d7b6ea06252dca2f83961d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates and initializes memory resources for MPTRAC.  <a href="mptrac_8h.html#a05eca328a1d7b6ea06252dca2f83961d">More...</a><br /></td></tr>
<tr class="separator:a05eca328a1d7b6ea06252dca2f83961d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba57d9fe55a3a455520de070702f8e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#adba57d9fe55a3a455520de070702f8e1">mptrac_free</a> (<a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm, <a class="el" href="structdd__t.html">dd_t</a> *dd)</td></tr>
<tr class="memdesc:adba57d9fe55a3a455520de070702f8e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees memory resources allocated for MPTRAC.  <a href="mptrac_8h.html#adba57d9fe55a3a455520de070702f8e1">More...</a><br /></td></tr>
<tr class="separator:adba57d9fe55a3a455520de070702f8e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8435d2ccfa5de00f6d8080d363737cd6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8435d2ccfa5de00f6d8080d363737cd6">mptrac_get_met</a> (<a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structclim__t.html">clim_t</a> *clim, const double t, <a class="el" href="structmet__t.html">met_t</a> **met0, <a class="el" href="structmet__t.html">met_t</a> **met1, <a class="el" href="structdd__t.html">dd_t</a> *dd)</td></tr>
<tr class="memdesc:a8435d2ccfa5de00f6d8080d363737cd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves meteorological data for the specified time.  <a href="mptrac_8h.html#a8435d2ccfa5de00f6d8080d363737cd6">More...</a><br /></td></tr>
<tr class="separator:a8435d2ccfa5de00f6d8080d363737cd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d693a955f788f652b4d961ee5a29a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a57d693a955f788f652b4d961ee5a29a7">mptrac_init</a> (<a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structatm__t.html">atm_t</a> *atm, const int ntask)</td></tr>
<tr class="memdesc:a57d693a955f788f652b4d961ee5a29a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the MPTRAC model and its associated components.  <a href="mptrac_8h.html#a57d693a955f788f652b4d961ee5a29a7">More...</a><br /></td></tr>
<tr class="separator:a57d693a955f788f652b4d961ee5a29a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96e5b8b7db1bad827222e732ac6d1633"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a96e5b8b7db1bad827222e732ac6d1633">mptrac_read_atm</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a96e5b8b7db1bad827222e732ac6d1633"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads air parcel data from a specified file into the given atmospheric structure.  <a href="mptrac_8h.html#a96e5b8b7db1bad827222e732ac6d1633">More...</a><br /></td></tr>
<tr class="separator:a96e5b8b7db1bad827222e732ac6d1633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fc9ec02bd18b27c2e225161d833c766"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8fc9ec02bd18b27c2e225161d833c766">mptrac_read_clim</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structclim__t.html">clim_t</a> *clim)</td></tr>
<tr class="memdesc:a8fc9ec02bd18b27c2e225161d833c766"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads various climatological data and populates the given climatology structure.  <a href="mptrac_8h.html#a8fc9ec02bd18b27c2e225161d833c766">More...</a><br /></td></tr>
<tr class="separator:a8fc9ec02bd18b27c2e225161d833c766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6e87e9f904fe4ad238e5a99ec9fbc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#adb6e87e9f904fe4ad238e5a99ec9fbc6">mptrac_read_ctl</a> (const char *filename, int argc, char *argv[], <a class="el" href="structctl__t.html">ctl_t</a> *ctl)</td></tr>
<tr class="memdesc:adb6e87e9f904fe4ad238e5a99ec9fbc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads control parameters from a configuration file and populates the given structure.  <a href="mptrac_8h.html#adb6e87e9f904fe4ad238e5a99ec9fbc6">More...</a><br /></td></tr>
<tr class="separator:adb6e87e9f904fe4ad238e5a99ec9fbc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad761ca965e59ad9246ab5825a3730058"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ad761ca965e59ad9246ab5825a3730058">mptrac_read_met</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met, <a class="el" href="structdd__t.html">dd_t</a> *dd)</td></tr>
<tr class="memdesc:ad761ca965e59ad9246ab5825a3730058"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads meteorological data from a file, supporting multiple formats and MPI broadcasting.  <a href="mptrac_8h.html#ad761ca965e59ad9246ab5825a3730058">More...</a><br /></td></tr>
<tr class="separator:ad761ca965e59ad9246ab5825a3730058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d7054e72e7ad37c35592d7469664f0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a3d7054e72e7ad37c35592d7469664f0a">mptrac_run_timestep</a> (<a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structcache__t.html">cache_t</a> *cache, <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> **met0, <a class="el" href="structmet__t.html">met_t</a> **met1, <a class="el" href="structatm__t.html">atm_t</a> *atm, double t, <a class="el" href="structdd__t.html">dd_t</a> *dd)</td></tr>
<tr class="memdesc:a3d7054e72e7ad37c35592d7469664f0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes a single timestep of the MPTRAC model simulation.  <a href="mptrac_8h.html#a3d7054e72e7ad37c35592d7469664f0a">More...</a><br /></td></tr>
<tr class="separator:a3d7054e72e7ad37c35592d7469664f0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07d1a762eeeef6c54d4dd68ac2477f9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a07d1a762eeeef6c54d4dd68ac2477f9d">mptrac_write_atm</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:a07d1a762eeeef6c54d4dd68ac2477f9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes air parcel data to a file in various formats.  <a href="mptrac_8h.html#a07d1a762eeeef6c54d4dd68ac2477f9d">More...</a><br /></td></tr>
<tr class="separator:a07d1a762eeeef6c54d4dd68ac2477f9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6582c1a228e229994f56b7e1a3ad7a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af6582c1a228e229994f56b7e1a3ad7a4">mptrac_write_met</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:af6582c1a228e229994f56b7e1a3ad7a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes meteorological data to a file, supporting multiple formats and compression options.  <a href="mptrac_8h.html#af6582c1a228e229994f56b7e1a3ad7a4">More...</a><br /></td></tr>
<tr class="separator:af6582c1a228e229994f56b7e1a3ad7a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9abd7a8f35bf3b0c211d8212675d09b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a9abd7a8f35bf3b0c211d8212675d09b1">mptrac_write_output</a> (const char *dirname, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:a9abd7a8f35bf3b0c211d8212675d09b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes various types of output data to files in a specified directory.  <a href="mptrac_8h.html#a9abd7a8f35bf3b0c211d8212675d09b1">More...</a><br /></td></tr>
<tr class="separator:a9abd7a8f35bf3b0c211d8212675d09b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55562b13a38a124b0abc09ce8511dde9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a55562b13a38a124b0abc09ce8511dde9">mptrac_update_device</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> **met0, <a class="el" href="structmet__t.html">met_t</a> **met1, const <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a55562b13a38a124b0abc09ce8511dde9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates device memory for specified data structures.  <a href="mptrac_8h.html#a55562b13a38a124b0abc09ce8511dde9">More...</a><br /></td></tr>
<tr class="separator:a55562b13a38a124b0abc09ce8511dde9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98dff5c679aa16aa2506b2f9aaea1f66"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a98dff5c679aa16aa2506b2f9aaea1f66">mptrac_update_host</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structcache__t.html">cache_t</a> *cache, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> **met0, <a class="el" href="structmet__t.html">met_t</a> **met1, const <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a98dff5c679aa16aa2506b2f9aaea1f66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates host memory for specified data structures.  <a href="mptrac_8h.html#a98dff5c679aa16aa2506b2f9aaea1f66">More...</a><br /></td></tr>
<tr class="separator:a98dff5c679aa16aa2506b2f9aaea1f66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a623b433e01381315e5d49fc4c2bc3548"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a623b433e01381315e5d49fc4c2bc3548">nat_temperature</a> (const double p, const double h2o, const double hno3)</td></tr>
<tr class="memdesc:a623b433e01381315e5d49fc4c2bc3548"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the nitric acid trihydrate (NAT) temperature.  <a href="mptrac_8h.html#a623b433e01381315e5d49fc4c2bc3548">More...</a><br /></td></tr>
<tr class="separator:a623b433e01381315e5d49fc4c2bc3548"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ce53cb5230060c17ee4766ca910e79"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae0ce53cb5230060c17ee4766ca910e79">pbl_weight</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const int ip, const double pbl, const double ps)</td></tr>
<tr class="memdesc:ae0ce53cb5230060c17ee4766ca910e79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a weighting factor based on planetary boundary layer pressure.  <a href="mptrac_8h.html#ae0ce53cb5230060c17ee4766ca910e79">More...</a><br /></td></tr>
<tr class="separator:ae0ce53cb5230060c17ee4766ca910e79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0092541e8eb2c51fc9a3fcd98043f3f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af0092541e8eb2c51fc9a3fcd98043f3f">read_atm_asc</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:af0092541e8eb2c51fc9a3fcd98043f3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads air parcel data from an ASCII file and populates the given atmospheric structure.  <a href="mptrac_8h.html#af0092541e8eb2c51fc9a3fcd98043f3f">More...</a><br /></td></tr>
<tr class="separator:af0092541e8eb2c51fc9a3fcd98043f3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac51355e97453a01a70446623d0c382e5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ac51355e97453a01a70446623d0c382e5">read_atm_bin</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ac51355e97453a01a70446623d0c382e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads air parcel data from a binary file and populates the given atmospheric structure.  <a href="mptrac_8h.html#ac51355e97453a01a70446623d0c382e5">More...</a><br /></td></tr>
<tr class="separator:ac51355e97453a01a70446623d0c382e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad55d18eefcfa90b7c40d4a37dbb8fbf0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ad55d18eefcfa90b7c40d4a37dbb8fbf0">read_atm_clams</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:ad55d18eefcfa90b7c40d4a37dbb8fbf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads atmospheric data from a CLAMS NetCDF file.  <a href="mptrac_8h.html#ad55d18eefcfa90b7c40d4a37dbb8fbf0">More...</a><br /></td></tr>
<tr class="separator:ad55d18eefcfa90b7c40d4a37dbb8fbf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2569c3ce3d8d46ce8aa186d42685494c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2569c3ce3d8d46ce8aa186d42685494c">read_atm_nc</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:a2569c3ce3d8d46ce8aa186d42685494c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads air parcel data from a generic netCDF file and populates the given atmospheric structure.  <a href="mptrac_8h.html#a2569c3ce3d8d46ce8aa186d42685494c">More...</a><br /></td></tr>
<tr class="separator:a2569c3ce3d8d46ce8aa186d42685494c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a501ec43c01f1d742a133a7a3289d59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1a501ec43c01f1d742a133a7a3289d59">read_clim_photo</a> (const char *filename, <a class="el" href="structclim__photo__t.html">clim_photo_t</a> *photo)</td></tr>
<tr class="memdesc:a1a501ec43c01f1d742a133a7a3289d59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads photolysis rates from a NetCDF file and populates the given photolysis structure.  <a href="mptrac_8h.html#a1a501ec43c01f1d742a133a7a3289d59">More...</a><br /></td></tr>
<tr class="separator:a1a501ec43c01f1d742a133a7a3289d59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4392a0ab24a984ac30ed1ef85a89257d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a4392a0ab24a984ac30ed1ef85a89257d">read_clim_photo_help</a> (const int ncid, const char *varname, const <a class="el" href="structclim__photo__t.html">clim_photo_t</a> *photo, double var[<a class="el" href="mptrac_8h.html#a6594e57d1fff186da0a254a3742dcff7">CP</a>][<a class="el" href="mptrac_8h.html#af7d97769fe58e5913e640ffed1d36fbf">CSZA</a>][<a class="el" href="mptrac_8h.html#ae27556d9109b33480031038071c8b4b0">CO3</a>])</td></tr>
<tr class="memdesc:a4392a0ab24a984ac30ed1ef85a89257d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a 3D climatological photochemistry variable from a NetCDF file.  <a href="mptrac_8h.html#a4392a0ab24a984ac30ed1ef85a89257d">More...</a><br /></td></tr>
<tr class="separator:a4392a0ab24a984ac30ed1ef85a89257d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3510fe56a6a6e589b5c2474495af03e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a3510fe56a6a6e589b5c2474495af03e2">read_clim_ts</a> (const char *filename, <a class="el" href="structclim__ts__t.html">clim_ts_t</a> *ts)</td></tr>
<tr class="memdesc:a3510fe56a6a6e589b5c2474495af03e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a climatological time series from a file and populates the given time series structure.  <a href="mptrac_8h.html#a3510fe56a6a6e589b5c2474495af03e2">More...</a><br /></td></tr>
<tr class="separator:a3510fe56a6a6e589b5c2474495af03e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6af2603c773b4d11bf7e187ccb123ba2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a6af2603c773b4d11bf7e187ccb123ba2">read_clim_zm</a> (const char *filename, const char *varname, <a class="el" href="structclim__zm__t.html">clim_zm_t</a> *zm)</td></tr>
<tr class="memdesc:a6af2603c773b4d11bf7e187ccb123ba2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads zonally averaged climatological data from a netCDF file and populates the given structure.  <a href="mptrac_8h.html#a6af2603c773b4d11bf7e187ccb123ba2">More...</a><br /></td></tr>
<tr class="separator:a6af2603c773b4d11bf7e187ccb123ba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a3277ab872141360b876c25b5643ba6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a7a3277ab872141360b876c25b5643ba6">read_kernel</a> (const char *filename, double kz[<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], double kw[<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], int *nk)</td></tr>
<tr class="memdesc:a7a3277ab872141360b876c25b5643ba6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads kernel function data from a file and populates the provided arrays.  <a href="mptrac_8h.html#a7a3277ab872141360b876c25b5643ba6">More...</a><br /></td></tr>
<tr class="separator:a7a3277ab872141360b876c25b5643ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc520c5d948ea75f0acb9b351a6b8b75"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#acc520c5d948ea75f0acb9b351a6b8b75">read_met_bin</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:acc520c5d948ea75f0acb9b351a6b8b75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads meteorological data from a binary file.  <a href="mptrac_8h.html#acc520c5d948ea75f0acb9b351a6b8b75">More...</a><br /></td></tr>
<tr class="separator:acc520c5d948ea75f0acb9b351a6b8b75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b9aea19f1f7b7461d49a90bef54d286"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a> (FILE *in, const <a class="el" href="structmet__t.html">met_t</a> *met, float var[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>], const char *varname)</td></tr>
<tr class="memdesc:a4b9aea19f1f7b7461d49a90bef54d286"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a 2-dimensional meteorological variable from a binary file and stores it in the provided array.  <a href="mptrac_8h.html#a4b9aea19f1f7b7461d49a90bef54d286">More...</a><br /></td></tr>
<tr class="separator:a4b9aea19f1f7b7461d49a90bef54d286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8acf2c312916a07fa0856aa6d4948558"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a> (FILE *in, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structmet__t.html">met_t</a> *met, float var[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const char *varname, const float bound_min, const float bound_max)</td></tr>
<tr class="memdesc:a8acf2c312916a07fa0856aa6d4948558"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads 3D meteorological data from a binary file, potentially using different compression methods.  <a href="mptrac_8h.html#a8acf2c312916a07fa0856aa6d4948558">More...</a><br /></td></tr>
<tr class="separator:a8acf2c312916a07fa0856aa6d4948558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af61accbe7a6587652bb15ea68d6aee03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af61accbe7a6587652bb15ea68d6aee03">read_met_cape</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:af61accbe7a6587652bb15ea68d6aee03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates Convective Available Potential Energy (CAPE) for each grid point.  <a href="mptrac_8h.html#af61accbe7a6587652bb15ea68d6aee03">More...</a><br /></td></tr>
<tr class="separator:af61accbe7a6587652bb15ea68d6aee03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b20694a5f995be231b64a5121eab7a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1b20694a5f995be231b64a5121eab7a9">read_met_cloud</a> (<a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a1b20694a5f995be231b64a5121eab7a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates cloud-related variables for each grid point.  <a href="mptrac_8h.html#a1b20694a5f995be231b64a5121eab7a9">More...</a><br /></td></tr>
<tr class="separator:a1b20694a5f995be231b64a5121eab7a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2776502fa762ba5034c0759d7645d1e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2776502fa762ba5034c0759d7645d1e1">read_met_detrend</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a2776502fa762ba5034c0759d7645d1e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detrends meteorological data.  <a href="mptrac_8h.html#a2776502fa762ba5034c0759d7645d1e1">More...</a><br /></td></tr>
<tr class="separator:a2776502fa762ba5034c0759d7645d1e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a089d9c0099e3fc6944c2a48667362ca0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a089d9c0099e3fc6944c2a48667362ca0">read_met_extrapolate</a> (<a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a089d9c0099e3fc6944c2a48667362ca0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates meteorological data.  <a href="mptrac_8h.html#a089d9c0099e3fc6944c2a48667362ca0">More...</a><br /></td></tr>
<tr class="separator:a089d9c0099e3fc6944c2a48667362ca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01594c9f21549808fcf2f2f8be781e79"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a01594c9f21549808fcf2f2f8be781e79">read_met_geopot</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a01594c9f21549808fcf2f2f8be781e79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates geopotential heights from meteorological data.  <a href="mptrac_8h.html#a01594c9f21549808fcf2f2f8be781e79">More...</a><br /></td></tr>
<tr class="separator:a01594c9f21549808fcf2f2f8be781e79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c358b6cc1f736e2f186c8aef4d6a79"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a82c358b6cc1f736e2f186c8aef4d6a79">read_met_grib</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a82c358b6cc1f736e2f186c8aef4d6a79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads meteorological data from a grib file and processes it.  <a href="mptrac_8h.html#a82c358b6cc1f736e2f186c8aef4d6a79">More...</a><br /></td></tr>
<tr class="separator:a82c358b6cc1f736e2f186c8aef4d6a79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae29b6f816c6177addaaae17589e3fc90"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae29b6f816c6177addaaae17589e3fc90">read_met_grib_grid</a> (<a class="el" href="mptrac_8h.html#a5aa74f0eae3fc2645b1fd1ec7efe0c8c">codes_handle</a> **handles, int count_handles, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:ae29b6f816c6177addaaae17589e3fc90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads global meteorological information from a grib file.  <a href="mptrac_8h.html#ae29b6f816c6177addaaae17589e3fc90">More...</a><br /></td></tr>
<tr class="separator:ae29b6f816c6177addaaae17589e3fc90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c4adfad6db9c544b2dd4399fb7ee531"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a9c4adfad6db9c544b2dd4399fb7ee531">read_met_grib_levels</a> (<a class="el" href="mptrac_8h.html#a5aa74f0eae3fc2645b1fd1ec7efe0c8c">codes_handle</a> **handles, const int num_messages, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a9c4adfad6db9c544b2dd4399fb7ee531"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads meteorological variables at different vertical levels from a grib file.  <a href="mptrac_8h.html#a9c4adfad6db9c544b2dd4399fb7ee531">More...</a><br /></td></tr>
<tr class="separator:a9c4adfad6db9c544b2dd4399fb7ee531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a083193a16b89fb11373c95354eaf54e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a083193a16b89fb11373c95354eaf54e5">read_met_grib_surface</a> (<a class="el" href="mptrac_8h.html#a5aa74f0eae3fc2645b1fd1ec7efe0c8c">codes_handle</a> **handles, const int num_messages, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a083193a16b89fb11373c95354eaf54e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads surface meteorological data from a grib file and stores it in the meteorological data structure.  <a href="mptrac_8h.html#a083193a16b89fb11373c95354eaf54e5">More...</a><br /></td></tr>
<tr class="separator:a083193a16b89fb11373c95354eaf54e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a449f642b01d0dc65cc32f86a850bcb7b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structmet__t.html">met_t</a> *met, float var[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const char *varname)</td></tr>
<tr class="memdesc:a449f642b01d0dc65cc32f86a850bcb7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates meteorological data to specified pressure levels.  <a href="mptrac_8h.html#a449f642b01d0dc65cc32f86a850bcb7b">More...</a><br /></td></tr>
<tr class="separator:a449f642b01d0dc65cc32f86a850bcb7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a305d8ee431236c52e0fd21d26f23a695"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a305d8ee431236c52e0fd21d26f23a695">read_met_monotonize</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a305d8ee431236c52e0fd21d26f23a695"><td class="mdescLeft">&#160;</td><td class="mdescRight">Makes zeta and pressure profiles monotone.  <a href="mptrac_8h.html#a305d8ee431236c52e0fd21d26f23a695">More...</a><br /></td></tr>
<tr class="separator:a305d8ee431236c52e0fd21d26f23a695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d5d9f14125739740b23f1ff88baf835"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a6d5d9f14125739740b23f1ff88baf835">read_met_nc</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met, <a class="el" href="structdd__t.html">dd_t</a> *dd)</td></tr>
<tr class="memdesc:a6d5d9f14125739740b23f1ff88baf835"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads meteorological data from a NetCDF file and processes it.  <a href="mptrac_8h.html#a6d5d9f14125739740b23f1ff88baf835">More...</a><br /></td></tr>
<tr class="separator:a6d5d9f14125739740b23f1ff88baf835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4562461a2883609e1768b1c3671eec4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae4562461a2883609e1768b1c3671eec4">read_met_nc_grid</a> (const char *filename, const int ncid, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met, <a class="el" href="structdd__t.html">dd_t</a> *dd)</td></tr>
<tr class="memdesc:ae4562461a2883609e1768b1c3671eec4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads meteorological grid data from NetCDF files with domain decomposition.  <a href="mptrac_8h.html#ae4562461a2883609e1768b1c3671eec4">More...</a><br /></td></tr>
<tr class="separator:ae4562461a2883609e1768b1c3671eec4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c6041039047d277d4836da1bb119e3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a6c6041039047d277d4836da1bb119e3d">read_met_nc_grid_dd_naive</a> (<a class="el" href="structdd__t.html">dd_t</a> *dd, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met, const int ncid)</td></tr>
<tr class="memdesc:a6c6041039047d277d4836da1bb119e3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read meteorological grid data from a NetCDF file and set up subdomain decomposition with halos.  <a href="mptrac_8h.html#a6c6041039047d277d4836da1bb119e3d">More...</a><br /></td></tr>
<tr class="separator:a6c6041039047d277d4836da1bb119e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ee3cac435af17ad5aaf885cc2dc3262"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2ee3cac435af17ad5aaf885cc2dc3262">read_met_nc_levels</a> (const int ncid, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met, <a class="el" href="structdd__t.html">dd_t</a> *dd)</td></tr>
<tr class="memdesc:a2ee3cac435af17ad5aaf885cc2dc3262"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and processes meteorological level data from NetCDF files with domain decomposition.  <a href="mptrac_8h.html#a2ee3cac435af17ad5aaf885cc2dc3262">More...</a><br /></td></tr>
<tr class="separator:a2ee3cac435af17ad5aaf885cc2dc3262"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa86499774fc9def653b04f95e56b4052"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aa86499774fc9def653b04f95e56b4052">read_met_nc_surface</a> (const int ncid, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met, <a class="el" href="structdd__t.html">dd_t</a> *dd)</td></tr>
<tr class="memdesc:aa86499774fc9def653b04f95e56b4052"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and processes surface meteorological data from NetCDF files with domain decomposition.  <a href="mptrac_8h.html#aa86499774fc9def653b04f95e56b4052">More...</a><br /></td></tr>
<tr class="separator:aa86499774fc9def653b04f95e56b4052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ab3c3e5e9881f1b688e6840723356ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a> (const int ncid, const char *varname, const char *varname2, const char *varname3, const char *varname4, const char *varname5, const char *varname6, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structmet__t.html">met_t</a> *met, <a class="el" href="structdd__t.html">dd_t</a> *dd, float dest[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>], const float scl, const int init)</td></tr>
<tr class="memdesc:a0ab3c3e5e9881f1b688e6840723356ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a 2-dimensional meteorological variable from a NetCDF file.  <a href="mptrac_8h.html#a0ab3c3e5e9881f1b688e6840723356ed">More...</a><br /></td></tr>
<tr class="separator:a0ab3c3e5e9881f1b688e6840723356ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff6a4eae1eba129266c5485c77aa6a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a> (const int ncid, const char *varname, const char *varname2, const char *varname3, const char *varname4, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structmet__t.html">met_t</a> *met, <a class="el" href="structdd__t.html">dd_t</a> *dd, float dest[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const float scl)</td></tr>
<tr class="memdesc:a1ff6a4eae1eba129266c5485c77aa6a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a 3-dimensional meteorological variable from a NetCDF file.  <a href="mptrac_8h.html#a1ff6a4eae1eba129266c5485c77aa6a3">More...</a><br /></td></tr>
<tr class="separator:a1ff6a4eae1eba129266c5485c77aa6a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2723705c94110a3ddfc84f2f0c8ddc71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a2723705c94110a3ddfc84f2f0c8ddc71">read_met_pbl</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a2723705c94110a3ddfc84f2f0c8ddc71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the planetary boundary layer (PBL) pressure based on meteorological data.  <a href="mptrac_8h.html#a2723705c94110a3ddfc84f2f0c8ddc71">More...</a><br /></td></tr>
<tr class="separator:a2723705c94110a3ddfc84f2f0c8ddc71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38f91765df8eb0a66fb3a6408dca0600"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a38f91765df8eb0a66fb3a6408dca0600">read_met_periodic</a> (<a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a38f91765df8eb0a66fb3a6408dca0600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies periodic boundary conditions to meteorological data along longitudinal axis.  <a href="mptrac_8h.html#a38f91765df8eb0a66fb3a6408dca0600">More...</a><br /></td></tr>
<tr class="separator:a38f91765df8eb0a66fb3a6408dca0600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea1a286e6ec2a763b560997203fd5b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#adea1a286e6ec2a763b560997203fd5b7">read_met_polar_winds</a> (<a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:adea1a286e6ec2a763b560997203fd5b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a fix for polar winds in meteorological data.  <a href="mptrac_8h.html#adea1a286e6ec2a763b560997203fd5b7">More...</a><br /></td></tr>
<tr class="separator:adea1a286e6ec2a763b560997203fd5b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2c90884cb02bf90f095ff36f41e020a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ac2c90884cb02bf90f095ff36f41e020a">read_met_pv</a> (<a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:ac2c90884cb02bf90f095ff36f41e020a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates potential vorticity (PV) from meteorological data.  <a href="mptrac_8h.html#ac2c90884cb02bf90f095ff36f41e020a">More...</a><br /></td></tr>
<tr class="separator:ac2c90884cb02bf90f095ff36f41e020a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ee63e8a6c82ac0dc569255455a50da2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a9ee63e8a6c82ac0dc569255455a50da2">read_met_ozone</a> (<a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a9ee63e8a6c82ac0dc569255455a50da2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the total column ozone from meteorological ozone data.  <a href="mptrac_8h.html#a9ee63e8a6c82ac0dc569255455a50da2">More...</a><br /></td></tr>
<tr class="separator:a9ee63e8a6c82ac0dc569255455a50da2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e6ef467d264f7b13436a460c753ed8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a0e6ef467d264f7b13436a460c753ed8a">read_met_sample</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a0e6ef467d264f7b13436a460c753ed8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Downsamples meteorological data based on specified parameters.  <a href="mptrac_8h.html#a0e6ef467d264f7b13436a460c753ed8a">More...</a><br /></td></tr>
<tr class="separator:a0e6ef467d264f7b13436a460c753ed8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29701c07d5dded042b2031e09e11d679"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a29701c07d5dded042b2031e09e11d679">read_met_tropo</a> (const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structclim__t.html">clim_t</a> *clim, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a29701c07d5dded042b2031e09e11d679"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the tropopause and related meteorological variables based on various methods and stores the results in the meteorological data structure.  <a href="mptrac_8h.html#a29701c07d5dded042b2031e09e11d679">More...</a><br /></td></tr>
<tr class="separator:a29701c07d5dded042b2031e09e11d679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1365b8fd93db0fc3fe4c467107710d03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1365b8fd93db0fc3fe4c467107710d03">read_obs</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, double *rt, double *rz, double *rlon, double *rlat, double *robs, int *nobs)</td></tr>
<tr class="memdesc:a1365b8fd93db0fc3fe4c467107710d03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads observation data from a file and stores it in arrays.  <a href="mptrac_8h.html#a1365b8fd93db0fc3fe4c467107710d03">More...</a><br /></td></tr>
<tr class="separator:a1365b8fd93db0fc3fe4c467107710d03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29da9a205ad3577ba3890f3e1e4350c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a29da9a205ad3577ba3890f3e1e4350c3">read_obs_asc</a> (const char *filename, double *rt, double *rz, double *rlon, double *rlat, double *robs, int *nobs)</td></tr>
<tr class="memdesc:a29da9a205ad3577ba3890f3e1e4350c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads observation data from an ASCII file.  <a href="mptrac_8h.html#a29da9a205ad3577ba3890f3e1e4350c3">More...</a><br /></td></tr>
<tr class="separator:a29da9a205ad3577ba3890f3e1e4350c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4536a82b3dc62081d26114c1250b1427"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a4536a82b3dc62081d26114c1250b1427">read_obs_nc</a> (const char *filename, double *rt, double *rz, double *rlon, double *rlat, double *robs, int *nobs)</td></tr>
<tr class="memdesc:a4536a82b3dc62081d26114c1250b1427"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads observation data from a NetCDF file.  <a href="mptrac_8h.html#a4536a82b3dc62081d26114c1250b1427">More...</a><br /></td></tr>
<tr class="separator:a4536a82b3dc62081d26114c1250b1427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d07c7baed461e240ff50585ddeed80a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a> (const char *filename, int argc, char *argv[], const char *varname, const int arridx, const char *defvalue, char *value)</td></tr>
<tr class="memdesc:a7d07c7baed461e240ff50585ddeed80a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scans a control file or command-line arguments for a specified variable.  <a href="mptrac_8h.html#a7d07c7baed461e240ff50585ddeed80a">More...</a><br /></td></tr>
<tr class="separator:a7d07c7baed461e240ff50585ddeed80a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b580107362b559d90f6766d340cc370"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a1b580107362b559d90f6766d340cc370">sedi</a> (const double p, const double T, const double rp, const double rhop)</td></tr>
<tr class="memdesc:a1b580107362b559d90f6766d340cc370"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the sedimentation velocity of a particle in air.  <a href="mptrac_8h.html#a1b580107362b559d90f6766d340cc370">More...</a><br /></td></tr>
<tr class="separator:a1b580107362b559d90f6766d340cc370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62786d005ed312f3c9ba2fac7cd544fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a62786d005ed312f3c9ba2fac7cd544fc">spline</a> (const double *x, const double *y, const int n, const double *x2, double *y2, const int n2, const int method)</td></tr>
<tr class="memdesc:a62786d005ed312f3c9ba2fac7cd544fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs spline interpolation or linear interpolation.  <a href="mptrac_8h.html#a62786d005ed312f3c9ba2fac7cd544fc">More...</a><br /></td></tr>
<tr class="separator:a62786d005ed312f3c9ba2fac7cd544fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87088b5ccf95f03d986f1bdd570b5b2f"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a87088b5ccf95f03d986f1bdd570b5b2f">stddev</a> (const float *data, const int n)</td></tr>
<tr class="memdesc:a87088b5ccf95f03d986f1bdd570b5b2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the standard deviation of a set of data.  <a href="mptrac_8h.html#a87088b5ccf95f03d986f1bdd570b5b2f">More...</a><br /></td></tr>
<tr class="separator:a87088b5ccf95f03d986f1bdd570b5b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a578e7ebaa62304182de8fe7ddf144b8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a578e7ebaa62304182de8fe7ddf144b8f">time2jsec</a> (const int year, const int mon, const int day, const int hour, const int min, const int sec, const double remain, double *jsec)</td></tr>
<tr class="memdesc:a578e7ebaa62304182de8fe7ddf144b8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts time components to seconds since January 1, 2000, 12:00:00 UTC.  <a href="mptrac_8h.html#a578e7ebaa62304182de8fe7ddf144b8f">More...</a><br /></td></tr>
<tr class="separator:a578e7ebaa62304182de8fe7ddf144b8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d6fa50cf378c33b8ba9575d17cffe9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a6d6fa50cf378c33b8ba9575d17cffe9c">timer</a> (const char *name, const char *group, const int output)</td></tr>
<tr class="memdesc:a6d6fa50cf378c33b8ba9575d17cffe9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measures and reports elapsed time for named and grouped timers.  <a href="mptrac_8h.html#a6d6fa50cf378c33b8ba9575d17cffe9c">More...</a><br /></td></tr>
<tr class="separator:a6d6fa50cf378c33b8ba9575d17cffe9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c5064804f7b46a4130b5411374a771d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8c5064804f7b46a4130b5411374a771d">time_from_filename</a> (const char *filename, const int offset)</td></tr>
<tr class="memdesc:a8c5064804f7b46a4130b5411374a771d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts and converts a timestamp from a filename to Julian seconds.  <a href="mptrac_8h.html#a8c5064804f7b46a4130b5411374a771d">More...</a><br /></td></tr>
<tr class="separator:a8c5064804f7b46a4130b5411374a771d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90bdbbffe8b8633d84a48d2ddd311180"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a90bdbbffe8b8633d84a48d2ddd311180">tropo_weight</a> (const <a class="el" href="structclim__t.html">clim_t</a> *clim, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const int ip)</td></tr>
<tr class="memdesc:a90bdbbffe8b8633d84a48d2ddd311180"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a weighting factor based on tropopause pressure.  <a href="mptrac_8h.html#a90bdbbffe8b8633d84a48d2ddd311180">More...</a><br /></td></tr>
<tr class="separator:a90bdbbffe8b8633d84a48d2ddd311180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70603265840ed0c76957a2df53dabc5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a70603265840ed0c76957a2df53dabc5a">write_atm_asc</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:a70603265840ed0c76957a2df53dabc5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes air parcel data to an ASCII file or gnuplot.  <a href="mptrac_8h.html#a70603265840ed0c76957a2df53dabc5a">More...</a><br /></td></tr>
<tr class="separator:a70603265840ed0c76957a2df53dabc5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af40f268fa1f23a997abbebc49d4c88d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af40f268fa1f23a997abbebc49d4c88d2">write_atm_bin</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:af40f268fa1f23a997abbebc49d4c88d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes air parcel data to a binary file.  <a href="mptrac_8h.html#af40f268fa1f23a997abbebc49d4c88d2">More...</a><br /></td></tr>
<tr class="separator:af40f268fa1f23a997abbebc49d4c88d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc1746c0cf47f3116b471f66f6a3e0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#acdc1746c0cf47f3116b471f66f6a3e0c">write_atm_clams</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:acdc1746c0cf47f3116b471f66f6a3e0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes air parcel data to a NetCDF file in the CLaMS format.  <a href="mptrac_8h.html#acdc1746c0cf47f3116b471f66f6a3e0c">More...</a><br /></td></tr>
<tr class="separator:acdc1746c0cf47f3116b471f66f6a3e0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a094daf77749905feec48a3e69fb779e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a094daf77749905feec48a3e69fb779e1">write_atm_clams_traj</a> (const char *dirname, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:a094daf77749905feec48a3e69fb779e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes CLaMS trajectory data to a NetCDF file.  <a href="mptrac_8h.html#a094daf77749905feec48a3e69fb779e1">More...</a><br /></td></tr>
<tr class="separator:a094daf77749905feec48a3e69fb779e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff66d76a0f9415997955f47edeff5b99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aff66d76a0f9415997955f47edeff5b99">write_atm_nc</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm)</td></tr>
<tr class="memdesc:aff66d76a0f9415997955f47edeff5b99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes air parcel data to a NetCDF file.  <a href="mptrac_8h.html#aff66d76a0f9415997955f47edeff5b99">More...</a><br /></td></tr>
<tr class="separator:aff66d76a0f9415997955f47edeff5b99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe2f86cb96a4de47d262cf7776164d46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#afe2f86cb96a4de47d262cf7776164d46">write_csi</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:afe2f86cb96a4de47d262cf7776164d46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes Critical Success Index (CSI) data to a file.  <a href="mptrac_8h.html#afe2f86cb96a4de47d262cf7776164d46">More...</a><br /></td></tr>
<tr class="separator:afe2f86cb96a4de47d262cf7776164d46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26de995e28ccaf098f62a6cc007ba312"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a26de995e28ccaf098f62a6cc007ba312">write_csi_ens</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:a26de995e28ccaf098f62a6cc007ba312"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes ensemble-based Critical Success Index (CSI) and other verification statistics to an output file.  <a href="mptrac_8h.html#a26de995e28ccaf098f62a6cc007ba312">More...</a><br /></td></tr>
<tr class="separator:a26de995e28ccaf098f62a6cc007ba312"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4036654b5bb8eaf257500214c2f0407d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a4036654b5bb8eaf257500214c2f0407d">write_ens</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:a4036654b5bb8eaf257500214c2f0407d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes ensemble data to a file.  <a href="mptrac_8h.html#a4036654b5bb8eaf257500214c2f0407d">More...</a><br /></td></tr>
<tr class="separator:a4036654b5bb8eaf257500214c2f0407d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af185d3a188bc2279135c58c8d5f24795"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af185d3a188bc2279135c58c8d5f24795">write_grid</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:af185d3a188bc2279135c58c8d5f24795"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes grid data to a file in ASCII or netCDF format.  <a href="mptrac_8h.html#af185d3a188bc2279135c58c8d5f24795">More...</a><br /></td></tr>
<tr class="separator:af185d3a188bc2279135c58c8d5f24795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a543c818eac1224703400c9554104d643"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a543c818eac1224703400c9554104d643">write_grid_asc</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const double *cd, double *mean[<a class="el" href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>], double *sigma[<a class="el" href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>], const double *vmr_impl, const double t, const double *z, const double *lon, const double *lat, const double *area, const double dz, const int *np)</td></tr>
<tr class="memdesc:a543c818eac1224703400c9554104d643"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes grid data to an ASCII file.  <a href="mptrac_8h.html#a543c818eac1224703400c9554104d643">More...</a><br /></td></tr>
<tr class="separator:a543c818eac1224703400c9554104d643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0a8f7561c1902f48e3ba8e9731eba9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae0a8f7561c1902f48e3ba8e9731eba9f">write_grid_nc</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const double *cd, double *mean[<a class="el" href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>], double *sigma[<a class="el" href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>], const double *vmr_impl, const double t, const double *z, const double *lon, const double *lat, const double *area, const double dz, const int *np)</td></tr>
<tr class="memdesc:ae0a8f7561c1902f48e3ba8e9731eba9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes grid data to a NetCDF file.  <a href="mptrac_8h.html#ae0a8f7561c1902f48e3ba8e9731eba9f">More...</a><br /></td></tr>
<tr class="separator:ae0a8f7561c1902f48e3ba8e9731eba9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af330c627ed04b0ae7098b89e2577e733"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af330c627ed04b0ae7098b89e2577e733">write_met_bin</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:af330c627ed04b0ae7098b89e2577e733"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes meteorological data in binary format to a specified file.  <a href="mptrac_8h.html#af330c627ed04b0ae7098b89e2577e733">More...</a><br /></td></tr>
<tr class="separator:af330c627ed04b0ae7098b89e2577e733"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac27e0e729035eecb9097b57538aa1669"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a> (FILE *out, <a class="el" href="structmet__t.html">met_t</a> *met, float var[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>], const char *varname)</td></tr>
<tr class="memdesc:ac27e0e729035eecb9097b57538aa1669"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a 2-dimensional meteorological variable to a binary file.  <a href="mptrac_8h.html#ac27e0e729035eecb9097b57538aa1669">More...</a><br /></td></tr>
<tr class="separator:ac27e0e729035eecb9097b57538aa1669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a135c74d7aa047461b2a8c72b312bd567"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a> (FILE *out, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met, float var[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const char *varname, const int precision, const double tolerance)</td></tr>
<tr class="memdesc:a135c74d7aa047461b2a8c72b312bd567"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a 3-dimensional meteorological variable to a binary file.  <a href="mptrac_8h.html#a135c74d7aa047461b2a8c72b312bd567">More...</a><br /></td></tr>
<tr class="separator:a135c74d7aa047461b2a8c72b312bd567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92ad405ee98c55d656f4b9fcb4957503"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a92ad405ee98c55d656f4b9fcb4957503">write_met_nc</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met)</td></tr>
<tr class="memdesc:a92ad405ee98c55d656f4b9fcb4957503"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes meteorological data to a NetCDF file.  <a href="mptrac_8h.html#a92ad405ee98c55d656f4b9fcb4957503">More...</a><br /></td></tr>
<tr class="separator:a92ad405ee98c55d656f4b9fcb4957503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bed36c022857a81c5d80e45e8be582a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a> (const int ncid, const char *varname, <a class="el" href="structmet__t.html">met_t</a> *met, float var[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>], const float scl)</td></tr>
<tr class="memdesc:a0bed36c022857a81c5d80e45e8be582a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a 2D meteorological variable to a NetCDF file.  <a href="mptrac_8h.html#a0bed36c022857a81c5d80e45e8be582a">More...</a><br /></td></tr>
<tr class="separator:a0bed36c022857a81c5d80e45e8be582a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae14d46547d2b1260b2ba857499b180d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a> (const int ncid, const char *varname, <a class="el" href="structmet__t.html">met_t</a> *met, float var[<a class="el" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>][<a class="el" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>][<a class="el" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], const float scl)</td></tr>
<tr class="memdesc:ae14d46547d2b1260b2ba857499b180d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a 3D meteorological variable to a NetCDF file.  <a href="mptrac_8h.html#ae14d46547d2b1260b2ba857499b180d7">More...</a><br /></td></tr>
<tr class="separator:ae14d46547d2b1260b2ba857499b180d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d5476c104eaa958ba0564597bee9c3b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#a8d5476c104eaa958ba0564597bee9c3b">write_prof</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:a8d5476c104eaa958ba0564597bee9c3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes profile data to a specified file.  <a href="mptrac_8h.html#a8d5476c104eaa958ba0564597bee9c3b">More...</a><br /></td></tr>
<tr class="separator:a8d5476c104eaa958ba0564597bee9c3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0cd0b75f7269ad20dc88ce4114ab5f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#af0cd0b75f7269ad20dc88ce4114ab5f1">write_sample</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structmet__t.html">met_t</a> *met0, <a class="el" href="structmet__t.html">met_t</a> *met1, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:af0cd0b75f7269ad20dc88ce4114ab5f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes sample data to a specified file.  <a href="mptrac_8h.html#af0cd0b75f7269ad20dc88ce4114ab5f1">More...</a><br /></td></tr>
<tr class="separator:af0cd0b75f7269ad20dc88ce4114ab5f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf952d2078d652006af74cc8ac4cd913"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#aaf952d2078d652006af74cc8ac4cd913">write_station</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:aaf952d2078d652006af74cc8ac4cd913"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes station data to a specified file.  <a href="mptrac_8h.html#aaf952d2078d652006af74cc8ac4cd913">More...</a><br /></td></tr>
<tr class="separator:aaf952d2078d652006af74cc8ac4cd913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9cf70f782a54ee8eb8fa87c80f936d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptrac_8h.html#ad9cf70f782a54ee8eb8fa87c80f936d2">write_vtk</a> (const char *filename, const <a class="el" href="structctl__t.html">ctl_t</a> *ctl, const <a class="el" href="structatm__t.html">atm_t</a> *atm, const double t)</td></tr>
<tr class="memdesc:ad9cf70f782a54ee8eb8fa87c80f936d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes VTK (Visualization Toolkit) data to a specified file.  <a href="mptrac_8h.html#ad9cf70f782a54ee8eb8fa87c80f936d2">More...</a><br /></td></tr>
<tr class="separator:ad9cf70f782a54ee8eb8fa87c80f936d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >MPTRAC library declarations. </p>

<p class="definition">Definition in file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ada6230d3c1696537923dc5a9446d7521" name="ada6230d3c1696537923dc5a9446d7521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada6230d3c1696537923dc5a9446d7521">&#9670;&nbsp;</a></span>MPI_Datatype</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MPI_Datatype&#160;&#160;&#160;void*</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Placeholder when MPI is not available. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00145">145</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a5aa74f0eae3fc2645b1fd1ec7efe0c8c" name="a5aa74f0eae3fc2645b1fd1ec7efe0c8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aa74f0eae3fc2645b1fd1ec7efe0c8c">&#9670;&nbsp;</a></span>codes_handle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define codes_handle&#160;&#160;&#160;void*</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Placeholder when ECCODES is not available. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00190">190</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a174754c04acfba9e1f66ba249e68643a" name="a174754c04acfba9e1f66ba249e68643a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a174754c04acfba9e1f66ba249e68643a">&#9670;&nbsp;</a></span>AVO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AVO&#160;&#160;&#160;6.02214076e23</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Avogadro constant [1/mol]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00199">199</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="af48c8f42b5451a04703d55d62ea50a3e" name="af48c8f42b5451a04703d55d62ea50a3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af48c8f42b5451a04703d55d62ea50a3e">&#9670;&nbsp;</a></span>CPD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPD&#160;&#160;&#160;1003.5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specific heat of dry air at constant pressure [J/(kg K)]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00204">204</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a6ebf6899d6c1c8b7b9d09be872c05aae" name="a6ebf6899d6c1c8b7b9d09be872c05aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ebf6899d6c1c8b7b9d09be872c05aae">&#9670;&nbsp;</a></span>EPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EPS&#160;&#160;&#160;(<a class="el" href="mptrac_8h.html#a1c4cf7d6c3605ff72cd8b9a63379d4ea">MH2O</a> / <a class="el" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ratio of the specific gas constant of dry air and water vapor [1]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00209">209</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a6440afc9207bc5eba00d9161ff744e16" name="a6440afc9207bc5eba00d9161ff744e16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6440afc9207bc5eba00d9161ff744e16">&#9670;&nbsp;</a></span>G0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define G0&#160;&#160;&#160;9.80665</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Standard gravity [m/s^2]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00214">214</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a2091e935ef46727f066804a98a0d039f" name="a2091e935ef46727f066804a98a0d039f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2091e935ef46727f066804a98a0d039f">&#9670;&nbsp;</a></span>H0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define H0&#160;&#160;&#160;7.0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scale height [km]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00219">219</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a60ac8f6cd3cf230202ce5aba9df2d6e1" name="a60ac8f6cd3cf230202ce5aba9df2d6e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60ac8f6cd3cf230202ce5aba9df2d6e1">&#9670;&nbsp;</a></span>LV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LV&#160;&#160;&#160;2501000.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Latent heat of vaporization of water [J/kg]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00224">224</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a3566596468c1f46bc90ad143b5c9e203" name="a3566596468c1f46bc90ad143b5c9e203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3566596468c1f46bc90ad143b5c9e203">&#9670;&nbsp;</a></span>KARMAN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KARMAN&#160;&#160;&#160;0.40</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Karman's constant. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00229">229</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a1841fd1a462d245d8c73dce55e2f45da" name="a1841fd1a462d245d8c73dce55e2f45da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1841fd1a462d245d8c73dce55e2f45da">&#9670;&nbsp;</a></span>KB</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KB&#160;&#160;&#160;1.3806504e-23</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Boltzmann constant [kg m^2/(K s^2)]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00234">234</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a11702dcb3f3ec928229185eb96686127" name="a11702dcb3f3ec928229185eb96686127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11702dcb3f3ec928229185eb96686127">&#9670;&nbsp;</a></span>MA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MA&#160;&#160;&#160;28.9644</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Molar mass of dry air [g/mol]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00239">239</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a1c4cf7d6c3605ff72cd8b9a63379d4ea" name="a1c4cf7d6c3605ff72cd8b9a63379d4ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c4cf7d6c3605ff72cd8b9a63379d4ea">&#9670;&nbsp;</a></span>MH2O</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MH2O&#160;&#160;&#160;18.01528</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Molar mass of water vapor [g/mol]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00244">244</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="aa5770de64e81ecf3f35d559357f67a76" name="aa5770de64e81ecf3f35d559357f67a76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5770de64e81ecf3f35d559357f67a76">&#9670;&nbsp;</a></span>MO3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MO3&#160;&#160;&#160;48.00</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Molar mass of ozone [g/mol]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00249">249</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a1583b00a62bc1138f99bbfcd8ef81a6a" name="a1583b00a62bc1138f99bbfcd8ef81a6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1583b00a62bc1138f99bbfcd8ef81a6a">&#9670;&nbsp;</a></span>P0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define P0&#160;&#160;&#160;1013.25</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Standard pressure [hPa]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00254">254</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a30a3f049b718d26a32f16ed72716d588" name="a30a3f049b718d26a32f16ed72716d588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30a3f049b718d26a32f16ed72716d588">&#9670;&nbsp;</a></span>RA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RA&#160;&#160;&#160;(1e3 * <a class="el" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> / <a class="el" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specific gas constant of dry air [J/(kg K)]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00259">259</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a0600e3f227b6e9a3ae26f4d6e2a0581e" name="a0600e3f227b6e9a3ae26f4d6e2a0581e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0600e3f227b6e9a3ae26f4d6e2a0581e">&#9670;&nbsp;</a></span>RE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RE&#160;&#160;&#160;6367.421</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mean radius of Earth [km]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00264">264</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a7e71def3baefc10ec36f1dd48da4050e" name="a7e71def3baefc10ec36f1dd48da4050e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e71def3baefc10ec36f1dd48da4050e">&#9670;&nbsp;</a></span>RI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RI&#160;&#160;&#160;8.3144598</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ideal gas constant [J/(mol K)]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00269">269</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ad41b89d4eb6d63a0def5e5fd2a5ab326" name="ad41b89d4eb6d63a0def5e5fd2a5ab326"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad41b89d4eb6d63a0def5e5fd2a5ab326">&#9670;&nbsp;</a></span>T0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T0&#160;&#160;&#160;273.15</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Standard temperature [K]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00274">274</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="adb5bf6fbe6405b09bad71e89e1da5850" name="adb5bf6fbe6405b09bad71e89e1da5850"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb5bf6fbe6405b09bad71e89e1da5850">&#9670;&nbsp;</a></span>EP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EP&#160;&#160;&#160;140</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of pressure levels for meteo data. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00283">283</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a6c2e35fdcd9091ccada629895fa1d034" name="a6c2e35fdcd9091ccada629895fa1d034"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c2e35fdcd9091ccada629895fa1d034">&#9670;&nbsp;</a></span>EX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EX&#160;&#160;&#160;1444</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of longitudes for meteo data. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00288">288</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a423a96c51fa2ea8a6406113803acbbc1" name="a423a96c51fa2ea8a6406113803acbbc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a423a96c51fa2ea8a6406113803acbbc1">&#9670;&nbsp;</a></span>EY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EY&#160;&#160;&#160;724</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of latitudes for meteo data. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00293">293</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a05b49c662c073f89e86804f7856622a0" name="a05b49c662c073f89e86804f7856622a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05b49c662c073f89e86804f7856622a0">&#9670;&nbsp;</a></span>LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LEN&#160;&#160;&#160;5000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum length of ASCII data lines. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00298">298</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a1d2af32106d1fe82729714d3aa28a1c4" name="a1d2af32106d1fe82729714d3aa28a1c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d2af32106d1fe82729714d3aa28a1c4">&#9670;&nbsp;</a></span>METVAR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define METVAR&#160;&#160;&#160;13</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of 3-D meteorological variables. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00303">303</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ab04c88bedc6b2be8ddfe7aa8d3e93f06" name="ab04c88bedc6b2be8ddfe7aa8d3e93f06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab04c88bedc6b2be8ddfe7aa8d3e93f06">&#9670;&nbsp;</a></span>NP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NP&#160;&#160;&#160;10000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of atmospheric data points. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00308">308</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a68c2775fc4d7385df9c7bb96d23b482b" name="a68c2775fc4d7385df9c7bb96d23b482b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68c2775fc4d7385df9c7bb96d23b482b">&#9670;&nbsp;</a></span>NQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NQ&#160;&#160;&#160;15</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of quantities per data point. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00313">313</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ad7d0bf1acdf6b0da23c3ccd8ce8f6caa" name="ad7d0bf1acdf6b0da23c3ccd8ce8f6caa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7d0bf1acdf6b0da23c3ccd8ce8f6caa">&#9670;&nbsp;</a></span>NCSI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NCSI&#160;&#160;&#160;1000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of data points for CSI calculation. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00318">318</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a1dd69f988ec51453efc614485237c23a" name="a1dd69f988ec51453efc614485237c23a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dd69f988ec51453efc614485237c23a">&#9670;&nbsp;</a></span>NENS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NENS&#160;&#160;&#160;2000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of data points for ensemble analysis. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00323">323</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a4e6d37e546b0cac9bffdd01ec84f53dd" name="a4e6d37e546b0cac9bffdd01ec84f53dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e6d37e546b0cac9bffdd01ec84f53dd">&#9670;&nbsp;</a></span>NOBS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NOBS&#160;&#160;&#160;10000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of observation data points. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00328">328</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a51ca9914034cd3e92903476fd4eebbd6" name="a51ca9914034cd3e92903476fd4eebbd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51ca9914034cd3e92903476fd4eebbd6">&#9670;&nbsp;</a></span>NTHREADS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NTHREADS&#160;&#160;&#160;512</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of OpenMP threads. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00333">333</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ac5bc792e372b15e7a1d3efe6daac9aec" name="ac5bc792e372b15e7a1d3efe6daac9aec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5bc792e372b15e7a1d3efe6daac9aec">&#9670;&nbsp;</a></span>CY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CY&#160;&#160;&#160;250</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of latitudes for climatological data. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00338">338</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ae27556d9109b33480031038071c8b4b0" name="ae27556d9109b33480031038071c8b4b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae27556d9109b33480031038071c8b4b0">&#9670;&nbsp;</a></span>CO3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CO3&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of total column ozone data for climatological data. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00343">343</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a6594e57d1fff186da0a254a3742dcff7" name="a6594e57d1fff186da0a254a3742dcff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6594e57d1fff186da0a254a3742dcff7">&#9670;&nbsp;</a></span>CP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CP&#160;&#160;&#160;70</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of pressure levels for climatological data. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00348">348</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="af7d97769fe58e5913e640ffed1d36fbf" name="af7d97769fe58e5913e640ffed1d36fbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7d97769fe58e5913e640ffed1d36fbf">&#9670;&nbsp;</a></span>CSZA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CSZA&#160;&#160;&#160;50</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of solar zenith angles for climatological data. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00353">353</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a7e463881fb9033a2fb65f3782d4e1c01" name="a7e463881fb9033a2fb65f3782d4e1c01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e463881fb9033a2fb65f3782d4e1c01">&#9670;&nbsp;</a></span>CT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CT&#160;&#160;&#160;12</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of time steps for climatological data. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00358">358</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a9d9ce8cebc572a42e7b4ab9e92c3a350" name="a9d9ce8cebc572a42e7b4ab9e92c3a350"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d9ce8cebc572a42e7b4ab9e92c3a350">&#9670;&nbsp;</a></span>CTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CTS&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of data points of climatological time series. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00363">363</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="adf22cd7d4f17a9d16554023c6c82b8b7" name="adf22cd7d4f17a9d16554023c6c82b8b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf22cd7d4f17a9d16554023c6c82b8b7">&#9670;&nbsp;</a></span>DD_NPART</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DD_NPART&#160;&#160;&#160;100000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of particles to send and recieve in domain decomposition. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00368">368</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="afe0e9afb861a649aaba5efb3b9ac7d57" name="afe0e9afb861a649aaba5efb3b9ac7d57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe0e9afb861a649aaba5efb3b9ac7d57">&#9670;&nbsp;</a></span>DD_NNMAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DD_NNMAX&#160;&#160;&#160;26</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of neighbours to communicate with in domain decomposition. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00373">373</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a07d4ce392f2c0e5bab856f6f354813a8" name="a07d4ce392f2c0e5bab856f6f354813a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07d4ce392f2c0e5bab856f6f354813a8">&#9670;&nbsp;</a></span>DD_NPOLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DD_NPOLE&#160;&#160;&#160;-2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constant indicating the North pole [-]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00378">378</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a2544a6f3c2d54d8e61493db6d56ec16c" name="a2544a6f3c2d54d8e61493db6d56ec16c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2544a6f3c2d54d8e61493db6d56ec16c">&#9670;&nbsp;</a></span>DD_SPOLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DD_SPOLE&#160;&#160;&#160;-3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constant indicating the South pole [-]. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00383">383</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a9aee3e5daf3b1051597d21ab093adbd0" name="a9aee3e5daf3b1051597d21ab093adbd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9aee3e5daf3b1051597d21ab093adbd0">&#9670;&nbsp;</a></span>ALLOC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ALLOC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">if</span>((ptr=calloc((<span class="keywordtype">size_t</span>)(n), <span class="keyword">sizeof</span>(type)))==NULL)      \</div>
<div class="line">    ERRMSG(<span class="stringliteral">&quot;Out of memory!&quot;</span>);</div>
</div><!-- fragment -->
<p>Allocate memory for a pointer with error handling. </p>
<p >This macro allocates memory for a pointer of a given type and size using the <code>calloc</code> function. It includes error handling to check if memory allocation was successful. If the code is being compiled with OpenACC support (_OPENACC macro defined), it additionally checks if the code is running on a GPU device, and if not, it raises an error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Pointer variable to be allocated. </td></tr>
    <tr><td class="paramname">type</td><td>Data type of the pointer. </td></tr>
    <tr><td class="paramname">n</td><td>Number of elements to allocate memory for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>If the code is compiled without OpenACC support, the conditional check for GPU device is skipped.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00416">416</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a56fa16148a574bac429287eb4612aa2e" name="a56fa16148a574bac429287eb4612aa2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56fa16148a574bac429287eb4612aa2e">&#9670;&nbsp;</a></span>ARRAY_2D</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARRAY_2D</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ix, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">iy, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ny&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  ((ix) * (ny) + (iy))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Macro for computing the linear index of a 2D array element. </p>
<p >The <code>ARRAY_2D</code> macro computes the linear index of a 2D array element based on the specified row index (<code>ix</code>), column index (<code>iy</code>), and number of columns (<code>ny</code>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ix</td><td>Integer representing the row index of the 2D array element. </td></tr>
    <tr><td class="paramname">iy</td><td>Integer representing the column index of the 2D array element. </td></tr>
    <tr><td class="paramname">ny</td><td>Integer representing the number of columns in the 2D array. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The computed linear index of the 2D array element.</dd></dl>
<p>The macro computes the linear index using the formula: <code>(ix) * (ny) + (iy)</code>. This formula assumes row-major storage, where elements of each row are stored sequentially in memory.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00439">439</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a0a81bdec7708d9599d0dcfa7a41caa26" name="a0a81bdec7708d9599d0dcfa7a41caa26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a81bdec7708d9599d0dcfa7a41caa26">&#9670;&nbsp;</a></span>ARRAY_3D</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARRAY_3D</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ix, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">iy, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ny, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">iz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nz&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (((ix)*(ny) + (iy)) * (nz) + (iz))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the linear index of a 3D array element. </p>
<p >This macro computes the linear index of a 3D array element based on the specified row index (<code>ix</code>), column index (<code>iy</code>), depth index (<code>iz</code>), number of columns (<code>ny</code>), and number of depths (<code>nz</code>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ix</td><td>Row index of the 3D array element. </td></tr>
    <tr><td class="paramname">iy</td><td>Column index of the 3D array element. </td></tr>
    <tr><td class="paramname">ny</td><td>Number of columns in the 3D array. </td></tr>
    <tr><td class="paramname">iz</td><td>Depth index of the 3D array element. </td></tr>
    <tr><td class="paramname">nz</td><td>Number of depths in the 3D array. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Linear index of the 3D array element.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00458">458</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ad6fd608dae29bc65e5c4ad1480f7b891" name="ad6fd608dae29bc65e5c4ad1480f7b891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6fd608dae29bc65e5c4ad1480f7b891">&#9670;&nbsp;</a></span>ARRHENIUS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARRHENIUS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  ((a) * exp( -(b) / (t)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the Arrhenius rate constant. </p>
<p >The Arrhenius equation is commonly used in chemical kinetics to describe the temperature dependence of reaction rates. This macro calculates the rate constant (k) based on the Arrhenius equation:</p>
<p class="formulaDsp">
\[ k = a \times \exp( -b / T ), \]
</p>
<p >where:</p><ul>
<li>k is the rate constant.</li>
<li>a is the pre-exponential factor or frequency factor.</li>
<li>b is the activation energy.</li>
<li>T is the temperature in Kelvin.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Pre-exponential factor or frequency factor. </td></tr>
    <tr><td class="paramname">b</td><td>Activation energy. </td></tr>
    <tr><td class="paramname">t</td><td>Temperature in Kelvin. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Calculated rate constant based on the Arrhenius equation.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00483">483</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a49fc908b537b2bfd13462453f83267c0" name="a49fc908b537b2bfd13462453f83267c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49fc908b537b2bfd13462453f83267c0">&#9670;&nbsp;</a></span>CLAMP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CLAMP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">v, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lo, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hi&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (((v) &lt; (lo)) ? (lo) : (((v) &gt; (hi)) ? (hi) : (v)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clamp a value to a specified range. </p>
<p >Ensures that <code>v</code> lies between <code>lo</code> and <code>hi</code>. If <code>v</code> &lt; <code>lo</code>, returns <code>lo</code>. If <code>v</code> &gt; <code>hi</code>, returns <code>hi</code>. Otherwise, returns <code>v</code> unchanged.</p>
<p >This macro works with any numeric type (e.g., int, float, double). All arguments are evaluated exactly once  avoid passing expressions with side effects (e.g., ++ operators or function calls).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Input value to clamp. </td></tr>
    <tr><td class="paramname">lo</td><td>Lower bound. </td></tr>
    <tr><td class="paramname">hi</td><td>Upper bound. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The clamped value between <code>lo</code> and <code>hi</code>.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00505">505</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="af32eb4cf0330afcdd3e0f3d195737a3c" name="af32eb4cf0330afcdd3e0f3d195737a3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af32eb4cf0330afcdd3e0f3d195737a3c">&#9670;&nbsp;</a></span>DEG2DX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEG2DX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dlon, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lat&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a> * <a class="el" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(dlon) * cos(<a class="el" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(lat)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a longitude difference to a distance in the x-direction (east-west) at a specific latitude. </p>
<p >This macro calculates the distance in the x-direction (east-west) corresponding to a given longitude difference at a specific latitude using the formula:</p>
<p class="formulaDsp">
\[ dx = dlon \times \pi \times RE / 180 times \cos(lat), \]
</p>
<p >where:</p><ul>
<li>dx is the distance in the x-direction (east-west).</li>
<li>dlon is the difference in longitudes in degrees.</li>
<li>RE is the Earth's radius.</li>
<li>lat is the latitude in degrees.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dlon</td><td>Difference in longitudes in degrees. </td></tr>
    <tr><td class="paramname">lat</td><td>Latitude in degrees. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Distance in the x-direction (east-west) corresponding to the given longitude difference at the specified latitude.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00529">529</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a6b3bf18cdd34775ace994db9a97474b1" name="a6b3bf18cdd34775ace994db9a97474b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b3bf18cdd34775ace994db9a97474b1">&#9670;&nbsp;</a></span>DEG2DY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEG2DY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dlat</td><td>)</td>
          <td>&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a> * <a class="el" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(dlat))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a latitude difference to a distance in the y-direction (north-south). </p>
<p >This macro calculates the distance in the y-direction (north-south) corresponding to a given latitude difference using the formula:</p>
<p class="formulaDsp">
\[ dy = dlat \times \pi \times RE / 180, \]
</p>
<p >where:</p><ul>
<li>dy is the distance in the y-direction (north-south).</li>
<li>dlat is the difference in latitudes in degrees.</li>
<li>RE is the Earth's radius.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dlat</td><td>Difference in latitudes in degrees. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Distance in the y-direction (north-south) corresponding to the given latitude difference.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00550">550</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="aa3616a5af1a14b0a5a1b2f542066ae45" name="aa3616a5af1a14b0a5a1b2f542066ae45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3616a5af1a14b0a5a1b2f542066ae45">&#9670;&nbsp;</a></span>DEG2RAD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEG2RAD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">deg</td><td>)</td>
          <td>&#160;&#160;&#160;  ((deg) * (M_PI / 180.0))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts degrees to radians. </p>
<p >This macro converts an angle from degrees to radians using the formula: radians = degrees * ( / 180)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">deg</td><td>The angle in degrees to be converted.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The angle in radians.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This macro uses the M_PI constant from &lt;math.h&gt; for the value of .</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00567">567</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a5d2bccab2674c0b9fee6d3107952fc8a" name="a5d2bccab2674c0b9fee6d3107952fc8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d2bccab2674c0b9fee6d3107952fc8a">&#9670;&nbsp;</a></span>DP2DZ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DP2DZ</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dp, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (- (dp) * <a class="el" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a> / (p))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a pressure difference to a height difference in the vertical direction. </p>
<p >This macro calculates the change in height (altitude) corresponding to a given pressure difference using the formula:</p>
<p class="formulaDsp">
\[ dz = - (dp) \times H_0 / p \]
</p>
<p >where:</p><ul>
<li>dz is the change in height (altitude) in meters.</li>
<li>dp is the pressure difference in hPa.</li>
<li>H0 is a reference scale height in km.</li>
<li>p is the reference pressure in hPa.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dp</td><td>Pressure difference in hPa. </td></tr>
    <tr><td class="paramname">p</td><td>Reference pressure in hPa. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Change in height (altitude) in kilometers corresponding to the given pressure difference.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Don't use this for large values of dp!</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00592">592</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a6b22b78dc1239748a44cbd2db4862ef4" name="a6b22b78dc1239748a44cbd2db4862ef4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b22b78dc1239748a44cbd2db4862ef4">&#9670;&nbsp;</a></span>DX2DEG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DX2DEG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dx, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lat&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  (((lat) &lt; -89.999 || (lat) &gt; 89.999) ? 0                      \</div>
<div class="line">   : (dx) * 180. / (M_PI * <a class="code hl_define" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a> * cos(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(lat))))</div>
<div class="ttc" id="amptrac_8h_html_a0600e3f227b6e9a3ae26f4d6e2a0581e"><div class="ttname"><a href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a></div><div class="ttdeci">#define RE</div><div class="ttdoc">Mean radius of Earth [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00264">mptrac.h:264</a></div></div>
<div class="ttc" id="amptrac_8h_html_aa3616a5af1a14b0a5a1b2f542066ae45"><div class="ttname"><a href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a></div><div class="ttdeci">#define DEG2RAD(deg)</div><div class="ttdoc">Converts degrees to radians.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00567">mptrac.h:567</a></div></div>
</div><!-- fragment -->
<p>Convert a distance in kilometers to degrees longitude at a given latitude. </p>
<p >This macro calculates the change in longitude in degrees corresponding to a given distance in kilometers at a specified latitude on the Earth's surface. It uses the formula:</p>
<p class="formulaDsp">
\[ dlon = \frac{dx \times 180}{\pi \times RE \times \cos(lat)} \]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dx</td><td>Distance in kilometers. </td></tr>
    <tr><td class="paramname">lat</td><td>Latitude in degrees. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Change in longitude in degrees.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The latitude must be in the range [-89.999, 89.999] degrees. Otherwise, the macro return value will be zero. This avoids issues with the singularities at the poles.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00614">614</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="af7f0e2b08c22c7da133b53aaad9861ff" name="af7f0e2b08c22c7da133b53aaad9861ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7f0e2b08c22c7da133b53aaad9861ff">&#9670;&nbsp;</a></span>DY2DEG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DY2DEG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dy</td><td>)</td>
          <td>&#160;&#160;&#160;  ((dy) * 180. / (M_PI * <a class="el" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a distance in kilometers to degrees latitude. </p>
<p >This macro calculates the change in latitude in degrees corresponding to a given distance in kilometers on the Earth's surface. It uses the formula:</p>
<p class="formulaDsp">
\[ dlat = \frac{dy \times 180}{\pi \times RE} \]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dy</td><td>Distance in kilometers. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Change in latitude in degrees.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00632">632</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a8d7cc5a9d3263cea4b432e83ab58c286" name="a8d7cc5a9d3263cea4b432e83ab58c286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d7cc5a9d3263cea4b432e83ab58c286">&#9670;&nbsp;</a></span>DZ2DP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DZ2DP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dz, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (-(dz) * (p) / <a class="el" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a change in altitude to a change in pressure. </p>
<p >This macro calculates the change in pressure corresponding to a given change in altitude. It uses the hydrostatic equation:</p>
<p class="formulaDsp">
\[ dp = -\left(dz \times \frac{p}{H_0}\right) \]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dz</td><td>Change in altitude in kilometers. </td></tr>
    <tr><td class="paramname">p</td><td>Current pressure in hPa. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Change in pressure in hPa.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Don't use this for large values of dz!</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00651">651</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ae733a5a3a9e9a85474da2105655a0dc4" name="ae733a5a3a9e9a85474da2105655a0dc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae733a5a3a9e9a85474da2105655a0dc4">&#9670;&nbsp;</a></span>DIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIST</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  sqrt(<a class="el" href="mptrac_8h.html#af003cf5f79f68880f39a9a95d69f19bb">DIST2</a>(a, b))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the distance between two points in Cartesian coordinates. </p>
<p >This macro calculates the Euclidean distance between two points in Cartesian coordinates. It uses the square root of the square of the distance obtained from the DIST2 macro.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Coordinates of the first point as an array of doubles. </td></tr>
    <tr><td class="paramname">b</td><td>Coordinates of the second point as an array of doubles. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The distance between the two points.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00667">667</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="af003cf5f79f68880f39a9a95d69f19bb" name="af003cf5f79f68880f39a9a95d69f19bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af003cf5f79f68880f39a9a95d69f19bb">&#9670;&nbsp;</a></span>DIST2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIST2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  ((a[0]-b[0])*(a[0]-b[0])+(a[1]-b[1])*(a[1]-b[1])+(a[2]-b[2])*(a[2]-b[2]))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the squared Euclidean distance between two points in Cartesian coordinates. </p>
<p >This macro calculates the squared Euclidean distance between two points in Cartesian coordinates. It computes the sum of the squares of the differences of corresponding coordinates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Coordinates of the first point as an array of doubles. </td></tr>
    <tr><td class="paramname">b</td><td>Coordinates of the second point as an array of doubles. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The squared distance between the two points.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00683">683</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a2f872a4cdfaa577c03b9dea8201028e8" name="a2f872a4cdfaa577c03b9dea8201028e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f872a4cdfaa577c03b9dea8201028e8">&#9670;&nbsp;</a></span>DOTP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DOTP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (a[0]*b[0]+a[1]*b[1]+a[2]*b[2])</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the dot product of two vectors. </p>
<p >This macro computes the dot product of two vectors represented as arrays of doubles. It multiplies corresponding components of the vectors and sums the results.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>The first vector as an array of doubles. </td></tr>
    <tr><td class="paramname">b</td><td>The second vector as an array of doubles. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The dot product of the two vectors.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00699">699</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="aeabba41ec64b3f196c1e6802e22f265d" name="aeabba41ec64b3f196c1e6802e22f265d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeabba41ec64b3f196c1e6802e22f265d">&#9670;&nbsp;</a></span>ECC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ECC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">cmd</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                                   \</div>
<div class="line">    int ecc_result=(cmd);                                               \</div>
<div class="line">    if(ecc_result!=0)                                                   \</div>
<div class="line">      ERRMSG(<span class="stringliteral">&quot;ECCODES error: %s&quot;</span>, codes_get_error_message(ecc_result)); \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Execute an ECCODES command and check for errors. </p>
<p >This macro executes an ECCODES command and checks the result. If the result indicates an error, it prints the error message using ERRMSG.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cmd</td><td>ECCODES command to execute.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Nils Nobre Wittwer </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00713">713</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a9ef36660c77a006dcb280b1cfd2e9945" name="a9ef36660c77a006dcb280b1cfd2e9945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ef36660c77a006dcb280b1cfd2e9945">&#9670;&nbsp;</a></span>ECC_READ_2D</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ECC_READ_2D</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">variable, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">target, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">scaling_factor, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">found_flag&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {   \</div>
<div class="line">    if(strcmp(short_name, variable) == 0) {                             \</div>
<div class="line">      for (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;nx; ix++)                              \</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;ny; iy++)                            \</div>
<div class="line">          target[ix][iy] = (<span class="keywordtype">float</span>)(values[iy * met-&gt;nx + ix] * scaling_factor); \</div>
<div class="line">      found_flag = 1;                                                   \</div>
<div class="line">    }                                                                   \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Writes 2-D data from a grib message into the meteo struct. </p>
<p >This macro writes 2-D data from a one-dimensional grib message into the corresponding 2-D variable in the meteo struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">variable</td><td>Name of the current meteorological variable </td></tr>
    <tr><td class="paramname">target</td><td>Pointer to the 2-D array in the meteo struct where the data will be stored. </td></tr>
    <tr><td class="paramname">scaling_factor</td><td>Scaling factor to apply to the data. </td></tr>
    <tr><td class="paramname">found_flag</td><td>Flag to store, that the variable was found in the grib message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Nils Nobre Wittwer </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00732">732</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a2d623ce25098e81e4de78bbb09b10f5b" name="a2d623ce25098e81e4de78bbb09b10f5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d623ce25098e81e4de78bbb09b10f5b">&#9670;&nbsp;</a></span>ECC_READ_3D</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ECC_READ_3D</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">variable, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">level, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">target, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">scaling_factor, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">found_flag&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    { \</div>
<div class="line">    if(strcmp(short_name, variable) == 0) {                             \</div>
<div class="line">      for (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;nx; ix++)                              \</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;ny; iy++)                            \</div>
<div class="line">          target[ix][iy][level] = (<span class="keywordtype">float</span>) (values[iy * met-&gt;nx + ix] * scaling_factor); \</div>
<div class="line">      found_flag += 1;                                                  \</div>
<div class="line">    }                                                                   \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Writes 3D data from a grib message into the meteo struct. </p>
<p >This macro writes 3D data from a one-dimensional grib message into the corresponding 3D variable in the meteo struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">variable</td><td>Name of the current meteorological variable. </td></tr>
    <tr><td class="paramname">level</td><td>Index of the vertical level in the 3D array where the data should be stored. </td></tr>
    <tr><td class="paramname">target</td><td>Pointer to the 3D array in the meteo struct where the data will be stored. </td></tr>
    <tr><td class="paramname">scaling_factor</td><td>Scaling factor to apply to the data. </td></tr>
    <tr><td class="paramname">found_flag</td><td>Counter to store, how many messages containing data for this variable have been read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Nils Nobre Wittwer </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00755">755</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="aff4e721b49a057c4e4a3a6f56cc06469" name="aff4e721b49a057c4e4a3a6f56cc06469"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff4e721b49a057c4e4a3a6f56cc06469">&#9670;&nbsp;</a></span>FMOD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FMOD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  ((x) - (int) ((x) / (y)) * (y))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the floating-point remainder of dividing x by y. </p>
<p >This macro computes the floating-point remainder of dividing x by y. It calculates this remainder as x minus the integer part of (x / y) times y.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The dividend. </td></tr>
    <tr><td class="paramname">y</td><td>The divisor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The floating-point remainder of x divided by y.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Macro has been added as a substitute when a GPU version of fmod() is missing.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00780">780</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a68e3272a6f873b919d4f6d8982042a50" name="a68e3272a6f873b919d4f6d8982042a50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68e3272a6f873b919d4f6d8982042a50">&#9670;&nbsp;</a></span>FREAD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FREAD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">size, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">in&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                   \</div>
<div class="line">    if(fread(ptr, <span class="keyword">sizeof</span>(type), size, in)!=size)                        \</div>
<div class="line">      ERRMSG(<span class="stringliteral">&quot;Error while reading!&quot;</span>);                                   \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Read data from a file stream and store it in memory. </p>
<p >This macro reads data of a specified type from the given input file stream and stores it in the specified memory location. It ensures that the correct amount of data is read from the file stream, and if not, it raises an error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Pointer to the memory location where the data will be stored. </td></tr>
    <tr><td class="paramname">type</td><td>Type of the data elements to be read. </td></tr>
    <tr><td class="paramname">size</td><td>Number of elements to read. </td></tr>
    <tr><td class="paramname">in</td><td>File stream from which to read the data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00798">798</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a1e67562ddd8fb52548a4ca02d3640bac" name="a1e67562ddd8fb52548a4ca02d3640bac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e67562ddd8fb52548a4ca02d3640bac">&#9670;&nbsp;</a></span>FWRITE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FWRITE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">size, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">out&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                   \</div>
<div class="line">    if(fwrite(ptr, <span class="keyword">sizeof</span>(type), size, out)!=size)                      \</div>
<div class="line">      ERRMSG(<span class="stringliteral">&quot;Error while writing!&quot;</span>);                                   \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Write data from memory to a file stream. </p>
<p >This macro writes data of a specified type from the specified memory location to the given output file stream. It ensures that the correct amount of data is written to the file stream, and if not, it raises an error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Pointer to the memory location containing the data to be written. </td></tr>
    <tr><td class="paramname">type</td><td>Type of the data elements to be written. </td></tr>
    <tr><td class="paramname">size</td><td>Number of elements to write. </td></tr>
    <tr><td class="paramname">out</td><td>File stream to which the data will be written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00818">818</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a3a1d95aec47889277a6bf1e25f366c24" name="a3a1d95aec47889277a6bf1e25f366c24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a1d95aec47889277a6bf1e25f366c24">&#9670;&nbsp;</a></span>INTPOL_INIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INTPOL_INIT&#160;&#160;&#160;  double cw[4] = {0.0, 0.0, 0.0, 0.0}; int ci[3] = {0, 0, 0};</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize arrays for interpolation. </p>
<p >This macro initializes arrays used for interpolation. It sets the weights <code>cw</code> and indices <code>ci</code> to zero. These arrays are used during interpolation to store the interpolation weights and indices.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00833">833</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ab4d615b798ce84f6ee2eb42df3c90998" name="ab4d615b798ce84f6ee2eb42df3c90998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4d615b798ce84f6ee2eb42df3c90998">&#9670;&nbsp;</a></span>INTPOL_2D</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INTPOL_2D</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">var, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">init&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <a class="code hl_function" href="mptrac_8h.html#ab88b081ba4352a0566066ec4156b94c6">intpol_met_time_2d</a>(met0, met0-&gt;var, met1, met1-&gt;var,                  \</div>
<div class="line">                     atm-&gt;time[ip], atm-&gt;lon[ip], atm-&gt;lat[ip],         \</div>
<div class="line">                     &amp;var, ci, cw, init);</div>
<div class="ttc" id="amptrac_8h_html_ab88b081ba4352a0566066ec4156b94c6"><div class="ttname"><a href="mptrac_8h.html#ab88b081ba4352a0566066ec4156b94c6">intpol_met_time_2d</a></div><div class="ttdeci">void intpol_met_time_2d(const met_t *met0, float array0[EX][EY], const met_t *met1, float array1[EX][EY], const double ts, const double lon, const double lat, double *var, int *ci, double *cw, const int init)</div><div class="ttdoc">Interpolates meteorological data in 2D space and time.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02458">mptrac.c:2458</a></div></div>
</div><!-- fragment -->
<p>Perform 2D interpolation for a meteorological variable. </p>
<p >This macro performs 2D interpolation for a given meteorological variable at a specific time and location.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">var</td><td>The variable to interpolate. </td></tr>
    <tr><td class="paramname">init</td><td>A flag indicating whether to initialize the interpolation arrays (<code>cw</code> and <code>ci</code>). Set to 1 for initialization, 0 otherwise. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The interpolated value of the variable <code>var</code>.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00847">847</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a48e10ecee070acb7be2df6a8ca3d9764" name="a48e10ecee070acb7be2df6a8ca3d9764"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48e10ecee070acb7be2df6a8ca3d9764">&#9670;&nbsp;</a></span>INTPOL_3D</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INTPOL_3D</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">var, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">init&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <a class="code hl_function" href="mptrac_8h.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;var, met1, met1-&gt;var,                  \</div>
<div class="line">                     atm-&gt;time[ip], atm-&gt;p[ip],                         \</div>
<div class="line">                     atm-&gt;lon[ip], atm-&gt;lat[ip],                        \</div>
<div class="line">                     &amp;var, ci, cw, init);</div>
<div class="ttc" id="amptrac_8h_html_a5819df4f969928e2f45144e44feb50a6"><div class="ttname"><a href="mptrac_8h.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a></div><div class="ttdeci">void intpol_met_time_3d(const met_t *met0, float array0[EX][EY][EP], const met_t *met1, float array1[EX][EY][EP], const double ts, const double p, const double lon, const double lat, double *var, int *ci, double *cw, const int init)</div><div class="ttdoc">Interpolates meteorological data in 3D space and time.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02429">mptrac.c:2429</a></div></div>
</div><!-- fragment -->
<p>Perform 3D interpolation for a meteorological variable. </p>
<p >This macro performs 3D interpolation for a given meteorological variable at a specific time, pressure level, and location.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">var</td><td>The variable to interpolate. </td></tr>
    <tr><td class="paramname">init</td><td>A flag indicating whether to initialize the interpolation arrays (<code>cw</code> and <code>ci</code>). Set to 1 for initialization, 0 otherwise. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The interpolated value of the variable <code>var</code>.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00864">864</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a2db66d3f79b89cb80d81f0ff4b8104be" name="a2db66d3f79b89cb80d81f0ff4b8104be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2db66d3f79b89cb80d81f0ff4b8104be">&#9670;&nbsp;</a></span>INTPOL_SPACE_ALL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INTPOL_SPACE_ALL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lon, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lat&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate multiple meteorological variables in space. </p>
<p >This macro performs spatial interpolation for multiple meteorological variables at a given pressure level, longitude, and latitude.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The pressure level at which to interpolate the variables. </td></tr>
    <tr><td class="paramname">lon</td><td>The longitude at which to interpolate the variables. </td></tr>
    <tr><td class="paramname">lat</td><td>The latitude at which to interpolate the variables.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hofmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00883">883</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a983e27f3f3845d3e6bc38716aab60cdd" name="a983e27f3f3845d3e6bc38716aab60cdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a983e27f3f3845d3e6bc38716aab60cdd">&#9670;&nbsp;</a></span>INTPOL_TIME_ALL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INTPOL_TIME_ALL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">time, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lon, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lat&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate multiple meteorological variables in time. </p>
<p >This macro performs temporal interpolation for multiple meteorological variables at a given time, pressure level, longitude, and latitude.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>The time at which to interpolate the variables. </td></tr>
    <tr><td class="paramname">p</td><td>The pressure level at which to interpolate the variables. </td></tr>
    <tr><td class="paramname">lon</td><td>The longitude at which to interpolate the variables. </td></tr>
    <tr><td class="paramname">lat</td><td>The latitude at which to interpolate the variables.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00937">937</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a25d1c99b30b81c5705cff2f3dd224a1d" name="a25d1c99b30b81c5705cff2f3dd224a1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25d1c99b30b81c5705cff2f3dd224a1d">&#9670;&nbsp;</a></span>LAPSE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LAPSE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t2&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  (1e3 * <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> / <a class="code hl_define" href="mptrac_8h.html#a30a3f049b718d26a32f16ed72716d588">RA</a> * ((t2) - (t1)) / ((t2) + (t1))                        \</div>
<div class="line">   * ((p2) + (p1)) / ((p2) - (p1)))</div>
<div class="ttc" id="amptrac_8h_html_a30a3f049b718d26a32f16ed72716d588"><div class="ttname"><a href="mptrac_8h.html#a30a3f049b718d26a32f16ed72716d588">RA</a></div><div class="ttdeci">#define RA</div><div class="ttdoc">Specific gas constant of dry air [J/(kg K)].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00259">mptrac.h:259</a></div></div>
<div class="ttc" id="amptrac_8h_html_a6440afc9207bc5eba00d9161ff744e16"><div class="ttname"><a href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a></div><div class="ttdeci">#define G0</div><div class="ttdoc">Standard gravity [m/s^2].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00214">mptrac.h:214</a></div></div>
</div><!-- fragment -->
<p>Calculate lapse rate. </p>
<p >This macro calculates the lapse rate between two pressure levels given their temperatures and pressures.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p1</td><td>Pressure at the first level (in hPa). </td></tr>
    <tr><td class="paramname">t1</td><td>Temperature at the first level (in K). </td></tr>
    <tr><td class="paramname">p2</td><td>Pressure at the second level (in hPa). </td></tr>
    <tr><td class="paramname">t2</td><td>Temperature at the second level (in K). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The lapse rate (in K/km).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l00991">991</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="aebaef4a0f8136be064bf1d29ce1ced83" name="aebaef4a0f8136be064bf1d29ce1ced83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebaef4a0f8136be064bf1d29ce1ced83">&#9670;&nbsp;</a></span>LIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  ((y0)+((y1)-(y0))/((x1)-(x0))*((x)-(x0)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Linear interpolation. </p>
<p >This macro performs linear interpolation to estimate the value of y at a given x based on two points (x0, y0) and (x1, y1).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x0</td><td>X-coordinate of the first point. </td></tr>
    <tr><td class="paramname">y0</td><td>Y-coordinate of the first point. </td></tr>
    <tr><td class="paramname">x1</td><td>X-coordinate of the second point. </td></tr>
    <tr><td class="paramname">y1</td><td>Y-coordinate of the second point. </td></tr>
    <tr><td class="paramname">x</td><td>The x-coordinate at which to estimate the y-value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The estimated y-value at the given x-coordinate.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01010">1010</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="afa99ec4acc4ecb2dc3c2d05da15d0e3f" name="afa99ec4acc4ecb2dc3c2d05da15d0e3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa99ec4acc4ecb2dc3c2d05da15d0e3f">&#9670;&nbsp;</a></span>MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (((a)&gt;(b))?(a):(b))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Macro to determine the maximum of two values. </p>
<p >This macro evaluates to the larger of its two arguments, <code>a</code> and <code>b</code>. It uses a ternary conditional operator to compare the values of <code>a</code> and <code>b</code> and returns <code>a</code> if <code>a</code> is greater than <code>b</code>; otherwise, it returns <code>b</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>The first value to compare. Can be of any type that supports comparison. </td></tr>
    <tr><td class="paramname">b</td><td>The second value to compare. Can be of any type that supports comparison.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The larger of the two values, <code>a</code> or <code>b</code>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Both <code>a</code> and <code>b</code> are evaluated twice. If <code>a</code> or <code>b</code> have side effects (e.g., increment operators, function calls), the side effects will occur more than once. This can lead to unexpected behavior.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The macro does not perform type checking, so <code>a</code> and <code>b</code> should be of compatible types to avoid potential issues with comparison and return value.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01037">1037</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a7efc33e26d9ab0d99a61ade0e7f15893" name="a7efc33e26d9ab0d99a61ade0e7f15893"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7efc33e26d9ab0d99a61ade0e7f15893">&#9670;&nbsp;</a></span>MET_HEADER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MET_HEADER</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write header for meteorological data file. </p>
<p >This macro writes a header to a meteorological data file, providing information about the variables stored in the file and their corresponding columns.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>Pointer to the file stream where the header will be written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01051">1051</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a3acffbd305ee72dcd4593c0d8af64a4f" name="a3acffbd305ee72dcd4593c0d8af64a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3acffbd305ee72dcd4593c0d8af64a4f">&#9670;&nbsp;</a></span>MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (((a)&lt;(b))?(a):(b))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Macro to determine the minimum of two values. </p>
<p >This macro evaluates to the smaller of its two arguments, <code>a</code> and <code>b</code>. It uses a ternary conditional operator to compare the values of <code>a</code> and <code>b</code> and returns <code>a</code> if <code>a</code> is less than <code>b</code>; otherwise, it returns <code>b</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>The first value to compare. Can be of any type that supports comparison. </td></tr>
    <tr><td class="paramname">b</td><td>The second value to compare. Can be of any type that supports comparison.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The smaller of the two values, <code>a</code> or <code>b</code>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Both <code>a</code> and <code>b</code> are evaluated twice. If <code>a</code> or <code>b</code> have side effects (e.g., increment operators, function calls), the side effects will occur more than once. This can lead to unexpected behavior.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The macro does not perform type checking, so <code>a</code> and <code>b</code> should be of compatible types to avoid potential issues with comparison and return value.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01138">1138</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a241767dd865cc665eeee896fb598eb9f" name="a241767dd865cc665eeee896fb598eb9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a241767dd865cc665eeee896fb598eb9f">&#9670;&nbsp;</a></span>MOLEC_DENS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOLEC_DENS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a174754c04acfba9e1f66ba249e68643a">AVO</a> * 1e-6 * ((p) * 100) / (<a class="el" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> * (t)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the density of a gas molecule. </p>
<p >This macro calculates the density of a gas molecule using the provided pressure and temperature values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Pressure of the gas in Pascals. </td></tr>
    <tr><td class="paramname">t</td><td>Temperature of the gas in Kelvin. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Density of the gas molecule in kg/m^3.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01153">1153</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a2678db26e1acda0cccd79553b9cc9b51" name="a2678db26e1acda0cccd79553b9cc9b51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2678db26e1acda0cccd79553b9cc9b51">&#9670;&nbsp;</a></span>NC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">cmd</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                \</div>
<div class="line">    int nc_result=(cmd);                             \</div>
<div class="line">    if(nc_result!=NC_NOERR)                          \</div>
<div class="line">      ERRMSG(<span class="stringliteral">&quot;%s&quot;</span>, nc_strerror(nc_result));          \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Execute a NetCDF command and check for errors. </p>
<p >This macro executes a NetCDF command and checks the result. If the result indicates an error, it prints the error message using ERRMSG.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cmd</td><td>NetCDF command to execute.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01167">1167</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="acca20163a6d11e1ee94426b2e44d5c17" name="acca20163a6d11e1ee94426b2e44d5c17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acca20163a6d11e1ee94426b2e44d5c17">&#9670;&nbsp;</a></span>NC_DEF_VAR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NC_DEF_VAR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">varname, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ndims, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dims, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">long_name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">units, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">level, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">quant&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    { \</div>
<div class="line">    NC(nc_def_var(ncid, varname, type, ndims, dims, &amp;varid));           \</div>
<div class="line">    NC(nc_put_att_text(ncid, varid, <span class="stringliteral">&quot;long_name&quot;</span>, strnlen(long_name, <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>), long_name)); \</div>
<div class="line">    NC(nc_put_att_text(ncid, varid, <span class="stringliteral">&quot;units&quot;</span>, strnlen(units, <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>), units)); \</div>
<div class="line">    if((quant) &gt; 0)                                                     \</div>
<div class="line">      NC(nc_def_var_quantize(ncid, varid, NC_QUANTIZE_GRANULARBR, quant)); \</div>
<div class="line">    if((level) != 0) {                                                  \</div>
<div class="line">      NC(nc_def_var_deflate(ncid, varid, 1, 1, level));                 \</div>
<div class="line">      <span class="comment">/* unsigned int ulevel = (unsigned int)level; */</span>                  \</div>
<div class="line">      <span class="comment">/* NC(nc_def_var_filter(ncid, varid, 32015, 1, (unsigned int[]){ulevel})); */</span> \</div>
<div class="line">    }                                                                   \</div>
<div class="line">  }</div>
<div class="ttc" id="amptrac_8h_html_a05b49c662c073f89e86804f7856622a0"><div class="ttname"><a href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a></div><div class="ttdeci">#define LEN</div><div class="ttdoc">Maximum length of ASCII data lines.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00298">mptrac.h:298</a></div></div>
</div><!-- fragment -->
<p>Define a NetCDF variable with attributes. </p>
<p >This macro defines a NetCDF variable with the specified name, data type, dimensions, long name, and units. It also sets the <code>long_name</code> and <code>units</code> attributes for the variable. It enables compression and quantizatio of the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varname</td><td>Name of the variable. </td></tr>
    <tr><td class="paramname">type</td><td>Data type of the variable. </td></tr>
    <tr><td class="paramname">ndims</td><td>Number of dimensions for the variable. </td></tr>
    <tr><td class="paramname">dims</td><td>Array of dimension IDs. </td></tr>
    <tr><td class="paramname">long_name</td><td>Long name of the variable. </td></tr>
    <tr><td class="paramname">units</td><td>Units of the variable. </td></tr>
    <tr><td class="paramname">level</td><td>zlib compression level (0 = off). </td></tr>
    <tr><td class="paramname">quant</td><td>Number of digits for quantization (0 = off).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>To enable ZSTD compression, replace <code>nc_def_var_deflate()</code> by <code>nc_def_var_filter()</code> below. Use dynamic linking, static linking does not work. Set environment variable <code>HDF5_PLUGIN_PATH</code> to <code>./libs/build/share/netcdf-plugins/</code>.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01196">1196</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ad7d3c9758dc177ab607539de4625d6ca" name="ad7d3c9758dc177ab607539de4625d6ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7d3c9758dc177ab607539de4625d6ca">&#9670;&nbsp;</a></span>NC_GET_DOUBLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NC_GET_DOUBLE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">varname, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">force&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                   \</div>
<div class="line">    if(force) {                                                 \</div>
<div class="line">      NC(nc_inq_varid(ncid, varname, &amp;varid));                  \</div>
<div class="line">      NC(nc_get_var_double(ncid, varid, ptr));                  \</div>
<div class="line">    } <span class="keywordflow">else</span> {                                                    \</div>
<div class="line">      if(nc_inq_varid(ncid, varname, &amp;varid) == NC_NOERR) {     \</div>
<div class="line">        NC(nc_get_var_double(ncid, varid, ptr));                \</div>
<div class="line">      } <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">else							\</a></div>
<div class="line"><a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">	WARN</a>(<span class="stringliteral">&quot;netCDF variable %s is missing!&quot;</span>, varname);       \</div>
<div class="line">    }                                                           \</div>
<div class="line">  }</div>
<div class="ttc" id="amptrac_8h_html_a8f75b971030a39ef811d3526a62b36b8"><div class="ttname"><a href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a></div><div class="ttdeci">#define WARN(...)</div><div class="ttdoc">Print a warning message with contextual information.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02010">mptrac.h:2010</a></div></div>
</div><!-- fragment -->
<p>Retrieve a double-precision variable from a NetCDF file. </p>
<p >This macro retrieves a double-precision variable from a NetCDF file. It first checks if the variable exists in the file and then reads its data into the specified pointer. If the <code>force</code> parameter is set to true, it forces the retrieval of the variable, raising an error if the variable does not exist. If <code>force</code> is false, it retrieves the variable if it exists and issues a warning if it does not.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varname</td><td>Name of the variable to retrieve. </td></tr>
    <tr><td class="paramname">ptr</td><td>Pointer to the memory location where the data will be stored. </td></tr>
    <tr><td class="paramname">force</td><td>Boolean flag indicating whether to force retrieval (true) or not (false).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01226">1226</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="af2af2081610570f29a5d50b3864b4f9c" name="af2af2081610570f29a5d50b3864b4f9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2af2081610570f29a5d50b3864b4f9c">&#9670;&nbsp;</a></span>NC_INQ_DIM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NC_INQ_DIM</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dimname, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">min, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">max, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">check&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {       \</div>
<div class="line">    int dimid; <span class="keywordtype">size_t</span> naux;                               \</div>
<div class="line">    NC(nc_inq_dimid(ncid, dimname, &amp;dimid));              \</div>
<div class="line">    NC(nc_inq_dimlen(ncid, dimid, &amp;naux));                \</div>
<div class="line">    *ptr = (int)naux;                                     \</div>
<div class="line">    if (check)                                            \</div>
<div class="line">      if ((*ptr) &lt; (min) || (*ptr) &gt; (max))               \</div>
<div class="line">        ERRMSG(<span class="stringliteral">&quot;Dimension %s is out of range!&quot;</span>, dimname); \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Inquire the length of a dimension in a NetCDF file. </p>
<p >This macro retrieves the length of a specified dimension from a NetCDF file. It checks if the length of the dimension is within a specified range and assigns the length to the provided pointer. If the length is outside the specified range, an error message is raised.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dimname</td><td>Name of the dimension to inquire. </td></tr>
    <tr><td class="paramname">ptr</td><td>Pointer to an integer where the dimension length will be stored. </td></tr>
    <tr><td class="paramname">min</td><td>Minimum acceptable length for the dimension. </td></tr>
    <tr><td class="paramname">max</td><td>Maximum acceptable length for the dimension. </td></tr>
    <tr><td class="paramname">check</td><td>Flag to check bounds. Set to 1 for bounds check.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01256">1256</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ae8b2166768c41952fc7e05faef7bb593" name="ae8b2166768c41952fc7e05faef7bb593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8b2166768c41952fc7e05faef7bb593">&#9670;&nbsp;</a></span>NC_PUT_DOUBLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NC_PUT_DOUBLE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">varname, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hyperslab&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {           \</div>
<div class="line">    NC(nc_inq_varid(ncid, varname, &amp;varid));                    \</div>
<div class="line">    if(hyperslab) {                                             \</div>
<div class="line">      NC(nc_put_vara_double(ncid, varid, start, count, ptr));   \</div>
<div class="line">    } <span class="keywordflow">else</span> {                                                    \</div>
<div class="line">      NC(nc_put_var_double(ncid, varid, ptr));                  \</div>
<div class="line">    }                                                           \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Write double precision data to a NetCDF variable. </p>
<p >This macro writes data to a specified NetCDF variable. It can handle both full variable writes and hyperslab writes depending on the <code>hyperslab</code> parameter. If <code>hyperslab</code> is true, the data is written as a hyperslab; otherwise, the entire variable is written.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varname</td><td>Name of the NetCDF variable to write to. </td></tr>
    <tr><td class="paramname">ptr</td><td>Pointer to the data to be written. </td></tr>
    <tr><td class="paramname">hyperslab</td><td>Boolean indicating whether to write the data as a hyperslab.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01280">1280</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ac0e202b5cb2a0adea56392860c4ffb86" name="ac0e202b5cb2a0adea56392860c4ffb86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0e202b5cb2a0adea56392860c4ffb86">&#9670;&nbsp;</a></span>NC_PUT_FLOAT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NC_PUT_FLOAT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">varname, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hyperslab&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                   \</div>
<div class="line">    NC(nc_inq_varid(ncid, varname, &amp;varid));                    \</div>
<div class="line">    if(hyperslab) {                                             \</div>
<div class="line">      NC(nc_put_vara_float(ncid, varid, start, count, ptr));    \</div>
<div class="line">    } <span class="keywordflow">else</span> {                                                    \</div>
<div class="line">      NC(nc_put_var_float(ncid, varid, ptr));                   \</div>
<div class="line">    }                                                           \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Write a float array to a NetCDF file. </p>
<p >This macro writes a float array to a specified variable in a NetCDF file. Depending on the value of the hyperslab parameter, the data can be written as a hyperslab or as a whole variable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varname</td><td>Name of the variable to which the float array will be written. </td></tr>
    <tr><td class="paramname">ptr</td><td>Pointer to the float array to be written. </td></tr>
    <tr><td class="paramname">hyperslab</td><td>Boolean flag indicating if the data should be written as a hyperslab.<ul>
<li>If true, the data will be written as a hyperslab using the start and count arrays.</li>
<li>If false, the data will be written to the entire variable.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01304">1304</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a3ed28cecbf584b977168813e9e2e0e32" name="a3ed28cecbf584b977168813e9e2e0e32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ed28cecbf584b977168813e9e2e0e32">&#9670;&nbsp;</a></span>NC_PUT_INT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NC_PUT_INT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">varname, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">hyperslab&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                   \</div>
<div class="line">    NC(nc_inq_varid(ncid, varname, &amp;varid));                    \</div>
<div class="line">    if(hyperslab) {                                             \</div>
<div class="line">      NC(nc_put_vara_int(ncid, varid, start, count, ptr));      \</div>
<div class="line">    } <span class="keywordflow">else</span> {                                                    \</div>
<div class="line">      NC(nc_put_var_int(ncid, varid, ptr));                     \</div>
<div class="line">    }                                                           \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Write integer data to a NetCDF variable. </p>
<p >This macro writes data to a specified NetCDF variable. It can handle both full variable writes and hyperslab writes depending on the <code>hyperslab</code> parameter. If <code>hyperslab</code> is true, the data is written as a hyperslab; otherwise, the entire variable is written.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varname</td><td>Name of the NetCDF variable to write to. </td></tr>
    <tr><td class="paramname">ptr</td><td>Pointer to the data to be written. </td></tr>
    <tr><td class="paramname">hyperslab</td><td>Boolean indicating whether to write the data as a hyperslab.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01327">1327</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a96e012265aff69f99407f69b8e1abb58" name="a96e012265aff69f99407f69b8e1abb58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96e012265aff69f99407f69b8e1abb58">&#9670;&nbsp;</a></span>NC_PUT_ATT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NC_PUT_ATT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">varname, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">attname, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">text&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                           \</div>
<div class="line">    NC(nc_inq_varid(ncid, varname, &amp;varid));                            \</div>
<div class="line">    NC(nc_put_att_text(ncid, varid, attname, strnlen(text, <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>), text)); \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Add a text attribute to a NetCDF variable. </p>
<p >This macro adds a text attribute to a specified NetCDF variable. It first retrieves the variable ID using its name, then it attaches the text attribute to the variable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varname</td><td>Name of the NetCDF variable to which the attribute will be added. </td></tr>
    <tr><td class="paramname">attname</td><td>Name of the attribute to be added. </td></tr>
    <tr><td class="paramname">text</td><td>Text of the attribute to be added.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01349">1349</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a218e2f27b530e30c0905d28be265e00f" name="a218e2f27b530e30c0905d28be265e00f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a218e2f27b530e30c0905d28be265e00f">&#9670;&nbsp;</a></span>NC_PUT_ATT_GLOBAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NC_PUT_ATT_GLOBAL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">attname, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">text&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  <a class="el" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_put_att_text(ncid, NC_GLOBAL, attname, strnlen(text, <a class="el" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>), text));</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a global text attribute to a NetCDF file. </p>
<p >This macro adds a text attribute to the global attributes of a NetCDF file. It directly attaches the attribute to the file, rather than to a specific variable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attname</td><td>Name of the global attribute to be added. </td></tr>
    <tr><td class="paramname">text</td><td>Text of the attribute to be added.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01366">1366</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a04481815cacab8fbbb9109b21b6f57ec" name="a04481815cacab8fbbb9109b21b6f57ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04481815cacab8fbbb9109b21b6f57ec">&#9670;&nbsp;</a></span>NN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (fabs((x) - (x0)) &lt;= fabs((x) - (x1)) ? (y0) : (y1))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform nearest-neighbor interpolation. </p>
<p >This macro returns the value of the nearest neighbor (y0 or y1) for a given x value. It compares the distances between x and x0, and between x and x1, and returns the y value corresponding to the closer x value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x0</td><td>The x-coordinate of the first point. </td></tr>
    <tr><td class="paramname">y0</td><td>The y-coordinate of the first point. </td></tr>
    <tr><td class="paramname">x1</td><td>The x-coordinate of the second point. </td></tr>
    <tr><td class="paramname">y1</td><td>The y-coordinate of the second point. </td></tr>
    <tr><td class="paramname">x</td><td>The x-coordinate for which the nearest neighbor is to be found. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The y-coordinate of the nearest neighbor (either y0 or y1).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01386">1386</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a11241b8a58cfbbe8cc92e1db4aff45ab" name="a11241b8a58cfbbe8cc92e1db4aff45ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11241b8a58cfbbe8cc92e1db4aff45ab">&#9670;&nbsp;</a></span>PARTICLE_LOOP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLE_LOOP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">check_dt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> ip0_const = ip0;                            \</div>
<div class="line">  const <span class="keywordtype">int</span> ip1_const = ip1;                            \</div>
<div class="line">  _Pragma(<span class="stringliteral">&quot;omp parallel for default(shared)&quot;</span>)           \</div>
<div class="line">  for (<span class="keywordtype">int</span> ip = ip0_const; ip &lt; ip1_const; ip++)        \</div>
<div class="line">    <span class="keywordflow">if</span> (!check_dt || cache-&gt;dt[ip] != 0)</div>
</div><!-- fragment -->
<p>Loop over particle indices with OpenACC acceleration. </p>
<p >This macro defines a loop over particle indices from <code>ip0</code> to <code>ip1</code> with optional checking of <code>dt</code>. If <code>_OPENACC</code> is defined, the loop is accelerated using OpenACC directives. Otherwise, OpenMP parallelization is used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip0</td><td>The starting index of the loop (inclusive). </td></tr>
    <tr><td class="paramname">ip1</td><td>The ending index of the loop (exclusive). </td></tr>
    <tr><td class="paramname">check_dt</td><td>Flag indicating whether to check the array <code>dt</code> for non-zero values. </td></tr>
    <tr><td class="paramname">...</td><td>Optional pragma directives to be applied.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01413">1413</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a5e1d0f42ad38aba63907665ccdd43b86" name="a5e1d0f42ad38aba63907665ccdd43b86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e1d0f42ad38aba63907665ccdd43b86">&#9670;&nbsp;</a></span>P</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define P</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">z</td><td>)</td>
          <td>&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">P0</a> * exp(-(z) / <a class="el" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute pressure at given altitude. </p>
<p >This macro calculates the pressure at a given altitude using the barometric formula.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">z</td><td>The altitude in kilometers. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The pressure in hPa at the given altitude.</dd></dl>
<p>The barometric formula used for this calculation is:</p>
<p class="formulaDsp">
\[ P(z) = P_0 \times e^{-(z / H_0)}, \]
</p>
<p >where:</p><ul>
<li>\( P(z) \) is the pressure at altitude \( z \),</li>
<li>\( P_0 \) is the standard pressure,</li>
<li>\( H_0 \) is the scale height.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The constants \( P_0 \) and \( H_0 \) must be defined before using this macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01443">1443</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="adc5ae7e10b1b021fb68397df5bad0a64" name="adc5ae7e10b1b021fb68397df5bad0a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc5ae7e10b1b021fb68397df5bad0a64">&#9670;&nbsp;</a></span>PSAT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSAT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t</td><td>)</td>
          <td>&#160;&#160;&#160;  (6.112 * exp(17.62 * ((t) - <a class="el" href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a>) / (243.12 + (t) - <a class="el" href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a>)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute saturation pressure over water. </p>
<p >This macro calculates the saturation pressure over water based on the WMO (2018) formula.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>The temperature in degrees Celsius. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The saturation pressure over water at the given temperature.</dd></dl>
<p>The saturation pressure over water is calculated using the formula:</p>
<p class="formulaDsp">
\[ P_{\textrm{sat}}(t) = 6.112 \times e^{17.62 \times \frac{(t - T_0)}{243.12 + (t - T_0)}}, \]
</p>
<p >where:</p><ul>
<li>\( P_{\textrm{sat}}(t) \) is the saturation pressure over water at temperature \( t \),</li>
<li>\( T_0 \) is the reference temperature (0C).</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The constants \( T_0 \) must be defined before using this macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01467">1467</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a70eb939aa0b84d808a49a4a18111ae9f" name="a70eb939aa0b84d808a49a4a18111ae9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70eb939aa0b84d808a49a4a18111ae9f">&#9670;&nbsp;</a></span>PSICE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSICE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t</td><td>)</td>
          <td>&#160;&#160;&#160;  (6.112 * exp(22.46 * ((t) - <a class="el" href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a>) / (272.62 + (t) - <a class="el" href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a>)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute saturation pressure over ice (WMO, 2018). </p>
<p >This macro calculates the saturation pressure over ice based on the WMO (2018) formula.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>The temperature in K. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The saturation pressure over ice at the given temperature.</dd></dl>
<p>The saturation pressure over ice is calculated using the formula:</p>
<p class="formulaDsp">
\[ P_{\textrm{ice}}(t) = 6.112 \times e^{22.46 \times \frac{(t - T_0)}{272.62 + (t - T_0)}}, \]
</p>
<p >where:</p><ul>
<li>\( P_{\textrm{ice}}(t) \) is the saturation pressure over ice at temperature \( t \),</li>
<li>\( T_0 \) is the reference temperature (0C).</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The constant \( T_0 \) must be defined before using this macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01491">1491</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a1f71059c62f3f9c3db1f6eb5f94dd7a8" name="a1f71059c62f3f9c3db1f6eb5f94dd7a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f71059c62f3f9c3db1f6eb5f94dd7a8">&#9670;&nbsp;</a></span>PW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PW</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h2o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  ((p) * <a class="el" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>((h2o), 0.1e-6) / (1. + (1. - <a class="el" href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a>) * <a class="el" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>((h2o), 0.1e-6)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate partial water vapor pressure. </p>
<p >This macro calculates the partial water vapor pressure using the given total pressure and water vapor mixing ratio.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The total pressure in hPa (hectopascals). </td></tr>
    <tr><td class="paramname">h2o</td><td>The water vapor mixing ratio in ppv (parts per volume). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The partial water vapor pressure.</dd></dl>
<p>The partial water vapor pressure is calculated using the formula:</p>
<p class="formulaDsp">
\[ P_{\textrm{w}}(p, h_2o) = \frac{p \times \max(h_2o, 0.1 \times 10^{-6})}{1 + (1 - \epsilon) \times \max(h_2o, 0.1 \times 10^{-6})}, \]
</p>
<p >where:</p><ul>
<li>\( P_{\textrm{w}}(p, h_2o) \) is the partial water vapor pressure,</li>
<li>\( p \) is the total pressure in hPa,</li>
<li>\( h_2o \) is the water vapor mixing ratio in ppv,</li>
<li>\( \epsilon \) is the factor to account for saturation vapor pressure over water.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The constant \( \epsilon \) must be defined before using this macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01518">1518</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="aacc958134b53425ec947541bb72ac8b1" name="aacc958134b53425ec947541bb72ac8b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc958134b53425ec947541bb72ac8b1">&#9670;&nbsp;</a></span>RAD2DEG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAD2DEG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">rad</td><td>)</td>
          <td>&#160;&#160;&#160;  ((rad) * (180.0 / M_PI))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts radians to degrees. </p>
<p >This macro converts an angle from radians to degrees using the formula: degrees = radians * (180 / )</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rad</td><td>The angle in radians to be converted.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The angle in degrees.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This macro uses the M_PI constant from &lt;math.h&gt; for the value of .</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01535">1535</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ab72fd70a37f29f2192b751999b6c7cc2" name="ab72fd70a37f29f2192b751999b6c7cc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab72fd70a37f29f2192b751999b6c7cc2">&#9670;&nbsp;</a></span>RH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RH</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h2o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">PW</a>(p, h2o) / <a class="el" href="mptrac_8h.html#adc5ae7e10b1b021fb68397df5bad0a64">PSAT</a>(t) * 100.)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute relative humidity over water. </p>
<p >This macro calculates the relative humidity over water using the given total pressure, temperature, and water vapor mixing ratio.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The total pressure in hPa. </td></tr>
    <tr><td class="paramname">t</td><td>The temperature in K. </td></tr>
    <tr><td class="paramname">h2o</td><td>The water vapor mixing ratio in ppv (parts per volume). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The relative humidity over water in percentage.</dd></dl>
<p>The relative humidity over water is calculated using the formula:</p>
<p class="formulaDsp">
\[ RH_{\textrm{w}}(p, t, h_2o) = \frac{P_{\textrm{w}}(p, h_2o)}{P_{\textrm{sat}}(t)} \times 100, \]
</p>
<p >where:</p><ul>
<li>\( RH_{\textrm{w}}(p, t, h_2o) \) is the relative humidity over water,</li>
<li>\( P_{\textrm{w}}(p, h_2o) \) is the partial water vapor pressure,</li>
<li>\( P_{\textrm{sat}}(t) \) is the saturation pressure over water at the given temperature,</li>
<li>\( p \) is the total pressure in hPa,</li>
<li>\( t \) is the temperature in Kelvin,</li>
<li>\( h_2o \) is the water vapor mixing ratio in ppv.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The macros <a class="el" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8" title="Calculate partial water vapor pressure.">PW()</a> and <a class="el" href="mptrac_8h.html#adc5ae7e10b1b021fb68397df5bad0a64" title="Compute saturation pressure over water.">PSAT()</a> must be defined before using this macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01565">1565</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a9431567784929c9e462e16f393e04088" name="a9431567784929c9e462e16f393e04088"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9431567784929c9e462e16f393e04088">&#9670;&nbsp;</a></span>RHICE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RHICE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h2o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">PW</a>(p, h2o) / <a class="el" href="mptrac_8h.html#a70eb939aa0b84d808a49a4a18111ae9f">PSICE</a>(t) * 100.)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute relative humidity over ice. </p>
<p >This macro calculates the relative humidity over ice using the given total pressure, temperature, and water vapor mixing ratio.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The total pressure in hPa. </td></tr>
    <tr><td class="paramname">t</td><td>The temperature in K. </td></tr>
    <tr><td class="paramname">h2o</td><td>The water vapor mixing ratio in ppv (parts per volume). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The relative humidity over ice in percentage.</dd></dl>
<p>The relative humidity over ice is calculated using the formula:</p>
<p class="formulaDsp">
\[ RH_{\textrm{ice}}(p, t, h_2o) = \frac{P_{\textrm{w}}(p, h_2o)}{P_{\textrm{ice}}(t)} \times 100, \]
</p>
<p >where:</p><ul>
<li>\( RH_{\textrm{ice}}(p, t, h_2o) \) is the relative humidity over ice,</li>
<li>\( P_{\textrm{w}}(p, h_2o) \) is the partial water vapor pressure,</li>
<li>\( P_{\textrm{ice}}(t) \) is the saturation pressure over ice at the given temperature,</li>
<li>\( p \) is the total pressure in hPa,</li>
<li>\( t \) is the temperature in Kelvin,</li>
<li>\( h_2o \) is the water vapor mixing ratio in ppv.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The macros <a class="el" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8" title="Calculate partial water vapor pressure.">PW()</a> and <a class="el" href="mptrac_8h.html#a70eb939aa0b84d808a49a4a18111ae9f" title="Compute saturation pressure over ice (WMO, 2018).">PSICE()</a> must be defined before using this macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01595">1595</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ae088e183d18a16fd6ab469d48ce3f06a" name="ae088e183d18a16fd6ab469d48ce3f06a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae088e183d18a16fd6ab469d48ce3f06a">&#9670;&nbsp;</a></span>RHO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RHO</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (100. * (p) / (<a class="el" href="mptrac_8h.html#a30a3f049b718d26a32f16ed72716d588">RA</a> * (t)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute density of air. </p>
<p >This macro calculates the density of air using the given total pressure and temperature.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The total pressure in hPa. </td></tr>
    <tr><td class="paramname">t</td><td>The temperature in K. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The density of air in kg/m^3.</dd></dl>
<p>The density of air is calculated using the formula:</p>
<p class="formulaDsp">
\[ \rho(p, t) = \frac{100 \times p}{R_a \times t}, \]
</p>
<p >where:</p><ul>
<li>\( \rho(p, t) \) is the density of air,</li>
<li>\( p \) is the total pressure in hPa,</li>
<li>\( t \) is the temperature in Kelvin,</li>
<li>\( R_a \) is the specific gas constant for dry air (287.05 J/(kgK)).</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01620">1620</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a9c741a27b379cebf498901dc7d271296" name="a9c741a27b379cebf498901dc7d271296"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c741a27b379cebf498901dc7d271296">&#9670;&nbsp;</a></span>SET_ATM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SET_ATM</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">qnt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">val&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">if</span> (ctl-&gt;qnt &gt;= 0)                            \</div>
<div class="line">    atm-&gt;q[ctl-&gt;qnt][ip] = val;</div>
</div><!-- fragment -->
<p>Set atmospheric quantity value. </p>
<p >This macro sets the value of a specific atmospheric quantity at a given index 'ip'. The macro first checks if the control index 'ctl-&gt;qnt' is non-negative before assigning the value, ensuring that the quantity index is valid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">qnt</td><td>The index representing the atmospheric quantity to set. </td></tr>
    <tr><td class="paramname">val</td><td>The value to set for the atmospheric quantity.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The macro assumes the existence of structures 'ctl' and 'atm' containing the control indices and atmospheric data, respectively, and an index 'ip' representing the data point.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01639">1639</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a83e28faf41ab5f04f2f81ea7008565ea" name="a83e28faf41ab5f04f2f81ea7008565ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83e28faf41ab5f04f2f81ea7008565ea">&#9670;&nbsp;</a></span>SET_QNT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SET_QNT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">qnt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">longname, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">unit&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;qnt_name[iq], name) == 0) {       \</div>
<div class="line">    ctl-&gt;qnt = iq;                                      \</div>
<div class="line">    sprintf(ctl-&gt;qnt_longname[iq], longname);           \</div>
<div class="line">    sprintf(ctl-&gt;qnt_unit[iq], unit);                   \</div>
<div class="line">  } <span class="keywordflow">else</span></div>
</div><!-- fragment -->
<p>Set atmospheric quantity index. </p>
<p >This macro sets the index, long name, and unit of a specific atmospheric quantity based on its name. It compares the name parameter with the name of the atmospheric quantity stored in 'ctl-&gt;qnt_name'. If a match is found, it assigns the index to 'ctl-&gt;qnt', updates the long name, and updates the unit.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">qnt</td><td>The index representing the atmospheric quantity. </td></tr>
    <tr><td class="paramname">name</td><td>The name of the atmospheric quantity. </td></tr>
    <tr><td class="paramname">longname</td><td>The long name of the atmospheric quantity. </td></tr>
    <tr><td class="paramname">unit</td><td>The unit of the atmospheric quantity.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The macro assumes the existence of structures 'ctl' containing control information. It also assumes the presence of 'iq', representing the index of the atmospheric quantity.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01662">1662</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a47b5bc0bd14e22c0329d967e3c6657bd" name="a47b5bc0bd14e22c0329d967e3c6657bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47b5bc0bd14e22c0329d967e3c6657bd">&#9670;&nbsp;</a></span>SH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SH</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h2o</td><td>)</td>
          <td>&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a> * <a class="el" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>((h2o), 0.1e-6))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute specific humidity from water vapor volume mixing ratio. </p>
<p >This macro calculates the specific humidity from the water vapor volume mixing ratio. Specific humidity represents the ratio of the mass of water vapor to the total mass of air and is dimensionless.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h2o</td><td>The water vapor volume mixing ratio. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The specific humidity.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The macro assumes that 'EPS' is defined and represents the ratio of the molecular weight of water vapor to the molecular weight of dry air.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01683">1683</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="aa7866fa5e4e0ee9b034e9dab6599a9cc" name="aa7866fa5e4e0ee9b034e9dab6599a9cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7866fa5e4e0ee9b034e9dab6599a9cc">&#9670;&nbsp;</a></span>SQR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SQR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;  ((x)*(x))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the square of a value. </p>
<p >This macro computes the square of the input value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The input value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The square of the input value.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01696">1696</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="addce2bf4f1107168ab1a7564756aa155" name="addce2bf4f1107168ab1a7564756aa155"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addce2bf4f1107168ab1a7564756aa155">&#9670;&nbsp;</a></span>SWAP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SWAP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">type&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  do {type tmp = x; x = y; y = tmp;} while(0);</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Swap two values. </p>
<p >This macro swaps the values of two variables of the specified type.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The first variable to be swapped. </td></tr>
    <tr><td class="paramname">y</td><td>The second variable to be swapped. </td></tr>
    <tr><td class="paramname">type</td><td>The type of the variables.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01710">1710</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="accf0b870a4ce9e19153c59f88898543a" name="accf0b870a4ce9e19153c59f88898543a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accf0b870a4ce9e19153c59f88898543a">&#9670;&nbsp;</a></span>TDEW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TDEW</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h2o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  (<a class="code hl_define" href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a> + 243.12 * log(<a class="code hl_define" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">PW</a>((p), (h2o)) / 6.112)    \</div>
<div class="line">   / (17.62 - log(<a class="code hl_define" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">PW</a>((p), (h2o)) / 6.112)))</div>
<div class="ttc" id="amptrac_8h_html_a1f71059c62f3f9c3db1f6eb5f94dd7a8"><div class="ttname"><a href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">PW</a></div><div class="ttdeci">#define PW(p, h2o)</div><div class="ttdoc">Calculate partial water vapor pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01518">mptrac.h:1518</a></div></div>
<div class="ttc" id="amptrac_8h_html_ad41b89d4eb6d63a0def5e5fd2a5ab326"><div class="ttname"><a href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a></div><div class="ttdeci">#define T0</div><div class="ttdoc">Standard temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00274">mptrac.h:274</a></div></div>
</div><!-- fragment -->
<p>Calculate dew point temperature. </p>
<p >This macro computes the dew point temperature using the formula provided by the World Meteorological Organization (WMO, 2018).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The atmospheric pressure in hPa. </td></tr>
    <tr><td class="paramname">h2o</td><td>The water vapor volume mixing ratio. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The dew point temperature in Kelvin.</dd></dl>
<p>Formula:</p>
<p class="formulaDsp">
\[ T_{\textrm{dew}} = T_0 + \frac{243.12 \times \ln\left(\frac{{P_W(p, h_{2}O)}}{6.112}\right)}{17.62 - \ln\left(\frac{{P_W(p, h_{2}O)}}{6.112}\right)} \]
</p>
<p >where:</p><ul>
<li>\( T_{\textrm{dew}} \) is the dew point temperature.</li>
<li>\( T_0 \) is the reference temperature in Kelvin (typically 273.15 K).</li>
<li>\( P_W(p, h_{2}O) \) is the partial water vapor pressure.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01734">1734</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a879f63fc7d15755d06ff79084410b6c9" name="a879f63fc7d15755d06ff79084410b6c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a879f63fc7d15755d06ff79084410b6c9">&#9670;&nbsp;</a></span>TICE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TICE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h2o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  (<a class="code hl_define" href="mptrac_8h.html#ad41b89d4eb6d63a0def5e5fd2a5ab326">T0</a> + 272.62 * log(<a class="code hl_define" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">PW</a>((p), (h2o)) / 6.112)    \</div>
<div class="line">   / (22.46 - log(<a class="code hl_define" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">PW</a>((p), (h2o)) / 6.112)))</div>
</div><!-- fragment -->
<p>Calculate frost point temperature (WMO, 2018). </p>
<p >This macro computes the frost point temperature using the formula provided by the World Meteorological Organization (WMO, 2018).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The atmospheric pressure in hPa. </td></tr>
    <tr><td class="paramname">h2o</td><td>The water vapor volume mixing ratio. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The frost point temperature in Kelvin.</dd></dl>
<p>Formula:</p>
<p class="formulaDsp">
\[ T_{\textrm{ice}} = T_0 + \frac{272.62 \times \ln\left(\frac{{P_W(p, h_{2}O)}}{6.112}\right)}{22.46 - \ln\left(\frac{{P_W(p, h_{2}O)}}{6.112}\right)} \]
</p>
<p >where:</p><ul>
<li>\( T_{\textrm{ice}} \) is the frost point temperature.</li>
<li>\( T_0 \) is the reference temperature in Kelvin (typically 273.15 K).</li>
<li>\( P_W(p, h_{2}O) \) is the partial water vapor pressure.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01759">1759</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a7d6c988afa363960f9cb5f3b589d2ae4" name="a7d6c988afa363960f9cb5f3b589d2ae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d6c988afa363960f9cb5f3b589d2ae4">&#9670;&nbsp;</a></span>THETA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THETA</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  ((t) * pow(1000. / (p), 0.286))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute potential temperature. </p>
<p >This macro calculates the potential temperature of the atmosphere.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The atmospheric pressure in hPa. </td></tr>
    <tr><td class="paramname">t</td><td>The temperature in Kelvin. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The potential temperature in Kelvin.</dd></dl>
<p>Formula:</p>
<p class="formulaDsp">
\[ \theta = T \left( \frac{1000}{P} \right)^{0.286} \]
</p>
<p >where:</p><ul>
<li>\( \theta \) is the potential temperature.</li>
<li>\( T \) is the temperature in Kelvin.</li>
<li>\( P \) is the atmospheric pressure in hPa.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01783">1783</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a8cbdab681e71d411200fb104480f4862" name="a8cbdab681e71d411200fb104480f4862"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cbdab681e71d411200fb104480f4862">&#9670;&nbsp;</a></span>THETAVIRT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THETAVIRT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h2o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(<a class="el" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>((p), (t)), <a class="el" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>((h2o), 0.1e-6)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute virtual potential temperature. </p>
<p >This macro calculates the virtual potential temperature of the atmosphere, which takes into account the effect of water vapor on the atmosphere's buoyancy.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The atmospheric pressure in hPa. </td></tr>
    <tr><td class="paramname">t</td><td>The temperature in Kelvin. </td></tr>
    <tr><td class="paramname">h2o</td><td>The water vapor volume mixing ratio (ppv). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The virtual potential temperature in Kelvin.</dd></dl>
<p>Formula:</p>
<p >The virtual potential temperature ( \( \theta_v \)) is computed as</p>
<p class="formulaDsp">
\[ \theta_v = \theta \left( 1 + \frac{0.61 \times q}{\epsilon} \right), \]
</p>
<p >where:</p><ul>
<li>\( \theta_v \) is the virtual potential temperature.</li>
<li>\( \theta \) is the potential temperature.</li>
<li>\( q \) is the specific humidity.</li>
<li>\( \epsilon \) is the ratio of the molecular weight of water vapor to dry air.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01812">1812</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a8b61d1304377b77925b2802459ddae98" name="a8b61d1304377b77925b2802459ddae98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b61d1304377b77925b2802459ddae98">&#9670;&nbsp;</a></span>TOK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">line, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tok, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">format, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">var&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                   \</div>
<div class="line">    if(((tok)=strtok((line), <span class="stringliteral">&quot; \t&quot;</span>))) {                                 \</div>
<div class="line">      if(sscanf(tok, format, &amp;(var))!=1) continue;                      \</div>
<div class="line">    } else <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(&quot;Error while reading!&quot;);                              \</div>
<div class="line">  }</div>
<div class="ttc" id="amptrac_8h_html_a3e0ae69dee4a8bb2e616526b5ebe6875"><div class="ttname"><a href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a></div><div class="ttdeci">#define ERRMSG(...)</div><div class="ttdoc">Print an error message with contextual information and terminate the program.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02043">mptrac.h:2043</a></div></div>
</div><!-- fragment -->
<p>Get string tokens. </p>
<p >This macro extracts tokens from a given string, typically used for parsing input lines.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">line</td><td>The input string containing tokens. </td></tr>
    <tr><td class="paramname">tok</td><td>A pointer to the token string. </td></tr>
    <tr><td class="paramname">format</td><td>The format string specifying the expected format of the token. </td></tr>
    <tr><td class="paramname">var</td><td>The variable to store the parsed token value.</td></tr>
  </table>
  </dd>
</dl>
<p>The macro tokenizes the input line using space and tab characters as delimiters. It then parses each token according to the specified format string and stores the parsed value in the provided variable.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01833">1833</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a068492d8c01b3b2d1aebf28ded97bb71" name="a068492d8c01b3b2d1aebf28ded97bb71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a068492d8c01b3b2d1aebf28ded97bb71">&#9670;&nbsp;</a></span>TVIRT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TVIRT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h2o&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  ((t) * (1. + (1. - <a class="el" href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a>) * <a class="el" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>((h2o), 0.1e-6)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute virtual temperature. </p>
<p >This macro calculates the virtual temperature of air given its temperature and water vapor volume mixing ratio.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>The temperature of the air in Kelvin. </td></tr>
    <tr><td class="paramname">h2o</td><td>The water vapor volume mixing ratio. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The virtual temperature of the air.</dd></dl>
<p>The virtual temperature (T_v) is computed as the temperature (t) multiplied by (1 + (1 - EPS) * max(h2o, 0.1e-6)), where EPS is the ratio of the molar mass of water vapor to the molar mass of dry air.</p>
<dl class="section note"><dt>Note</dt><dd>EPS is typically defined as 0.622.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01858">1858</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a58b4f1573922a1f73dd4bf014fd441bf" name="a58b4f1573922a1f73dd4bf014fd441bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58b4f1573922a1f73dd4bf014fd441bf">&#9670;&nbsp;</a></span>Z</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Z</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p</td><td>)</td>
          <td>&#160;&#160;&#160;  (<a class="el" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a> * log(<a class="el" href="mptrac_8h.html#a1583b00a62bc1138f99bbfcd8ef81a6a">P0</a> / (p)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert pressure to altitude. </p>
<p >This macro calculates the altitude from the given pressure using the barometric formula.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The pressure in hPa (hectopascal). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The altitude in kilometers (km).</dd></dl>
<p>Formula:</p>
<p >The altitude (z) is computed as H0 times the natural logarithm of the ratio of the reference pressure (P0) to the given pressure (p), where H0 is the scale height and P0 is the reference pressure at sea level.</p>
<dl class="section note"><dt>Note</dt><dd>H0 and P0 are typically defined as constants specific to the atmosphere.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01880">1880</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a8c73522db5d14433bd9ad2bd45d0de5f" name="a8c73522db5d14433bd9ad2bd45d0de5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c73522db5d14433bd9ad2bd45d0de5f">&#9670;&nbsp;</a></span>ZDIFF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZDIFF</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lnp0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h2o0, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lnp1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h2o1&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  (<a class="code hl_define" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> / <a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a> / <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> * 0.5 * (<a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>((t0), (h2o0)) + <a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>((t1), (h2o1)))     \</div>
<div class="line">   * ((lnp0) - (lnp1)))</div>
<div class="ttc" id="amptrac_8h_html_a068492d8c01b3b2d1aebf28ded97bb71"><div class="ttname"><a href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a></div><div class="ttdeci">#define TVIRT(t, h2o)</div><div class="ttdoc">Compute virtual temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01858">mptrac.h:1858</a></div></div>
<div class="ttc" id="amptrac_8h_html_a11702dcb3f3ec928229185eb96686127"><div class="ttname"><a href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a></div><div class="ttdeci">#define MA</div><div class="ttdoc">Molar mass of dry air [g/mol].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00239">mptrac.h:239</a></div></div>
<div class="ttc" id="amptrac_8h_html_a7e71def3baefc10ec36f1dd48da4050e"><div class="ttname"><a href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a></div><div class="ttdeci">#define RI</div><div class="ttdoc">Ideal gas constant [J/(mol K)].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00269">mptrac.h:269</a></div></div>
</div><!-- fragment -->
<p>Calculate geopotential height difference. </p>
<p >This macro calculates the geopotential height difference between two pressure levels using the hypsometric equation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lnp0</td><td>The natural logarithm of the pressure at the first level. </td></tr>
    <tr><td class="paramname">t0</td><td>The temperature at the first level in Kelvin (K). </td></tr>
    <tr><td class="paramname">h2o0</td><td>The water vapor volume mixing ratio at the first level. </td></tr>
    <tr><td class="paramname">lnp1</td><td>The natural logarithm of the pressure at the second level. </td></tr>
    <tr><td class="paramname">t1</td><td>The temperature at the second level in Kelvin (K). </td></tr>
    <tr><td class="paramname">h2o1</td><td>The water vapor volume mixing ratio at the second level. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The geopotential height difference in kilometers (km).</dd></dl>
<p>Formula: The geopotential height difference (dz) is computed as a function of the difference in natural logarithm of pressure (lnp) between the two levels, the average virtual temperature (ThetaVirt) of the two levels, the specific gas constant for dry air (RI), and the acceleration due to gravity at the surface of the Earth (G0).</p>
<dl class="section note"><dt>Note</dt><dd>The specific gas constant for dry air (RI), the molar mass of dry air (MA), and the acceleration due to gravity at the surface of the Earth (G0) are typically defined as constants specific to the atmosphere.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01911">1911</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a90ee947c906d48ce71affad259ac991d" name="a90ee947c906d48ce71affad259ac991d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90ee947c906d48ce71affad259ac991d">&#9670;&nbsp;</a></span>ZETA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZETA</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ps, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  (((p) / (ps) &lt;= 0.3 ? 1. :                                            \</div>
<div class="line">    sin(M_PI / 2. * (1. - (p) / (ps)) / (1. - 0.3)))                    \</div>
<div class="line">   * <a class="code hl_define" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>((p), (t)))</div>
<div class="ttc" id="amptrac_8h_html_a7d6c988afa363960f9cb5f3b589d2ae4"><div class="ttname"><a href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a></div><div class="ttdeci">#define THETA(p, t)</div><div class="ttdoc">Compute potential temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01783">mptrac.h:1783</a></div></div>
</div><!-- fragment -->
<p>Computes the value of the zeta vertical coordinate. </p>
<p >This macro calculates the zeta vertical coordinate based on the given surface pressure (<code>ps</code>), pressure (<code>p</code>), and temperature (<code>t</code>). The calculation depends on the ratio <code>p/ps</code>:</p><ul>
<li>If <code>p/ps &lt;= 0.3</code>, the function returns 1.0 multiplied by <code><a class="el" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4" title="Compute potential temperature.">THETA(p, t)</a></code>.</li>
<li>Otherwise, it computes a sine function transformation scaled by <code><a class="el" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4" title="Compute potential temperature.">THETA(p, t)</a></code>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ps</td><td>Surface pressure. </td></tr>
    <tr><td class="paramname">p</td><td>Pressure at the given level. </td></tr>
    <tr><td class="paramname">t</td><td>Temperature at the given level. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Computed zeta vertical coordinate value.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01930">1930</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="aa0c49f3ada06708693de9e60b449964c" name="aa0c49f3ada06708693de9e60b449964c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0c49f3ada06708693de9e60b449964c">&#9670;&nbsp;</a></span>LOGLEV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOGLEV&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Level of log messages (0=none, 1=basic, 2=detailed, 3=debug). </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01941">1941</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="acaa1c3fa56061380a29889d703236251" name="acaa1c3fa56061380a29889d703236251"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaa1c3fa56061380a29889d703236251">&#9670;&nbsp;</a></span>LOG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">level, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                           \</div>
<div class="line">    if(level &gt;= 2)                                                      \</div>
<div class="line">      printf(<span class="stringliteral">&quot;  &quot;</span>);                                                     \</div>
<div class="line">    if(level &lt;= <a class="code hl_define" href="mptrac_8h.html#aa0c49f3ada06708693de9e60b449964c">LOGLEV</a>) {                                               \</div>
<div class="line">      printf(__VA_ARGS__);                                              \</div>
<div class="line">      printf(<span class="stringliteral">&quot;\n&quot;</span>);                                                     \</div>
<div class="line">    }                                                                   \</div>
<div class="line">  }</div>
<div class="ttc" id="amptrac_8h_html_aa0c49f3ada06708693de9e60b449964c"><div class="ttname"><a href="mptrac_8h.html#aa0c49f3ada06708693de9e60b449964c">LOGLEV</a></div><div class="ttdeci">#define LOGLEV</div><div class="ttdoc">Level of log messages (0=none, 1=basic, 2=detailed, 3=debug).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01941">mptrac.h:1941</a></div></div>
</div><!-- fragment -->
<p>Print a log message with a specified logging level. </p>
<p >This macro prints a formatted log message to the standard output if the specified logging level meets certain conditions. The message will be indented if the logging level is greater than or equal to 2.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">level</td><td>The logging level of the message. This should be an integer value. </td></tr>
    <tr><td class="paramname">...</td><td>The formatted message string and its arguments, similar to printf.</td></tr>
  </table>
  </dd>
</dl>
<p>The <code>LOG</code> macro provides a simple way to log messages with different levels of importance. The message is only printed if the specified <code>level</code> is less than or equal to the pre-defined <code>LOGLEV</code> macro. If the <code>level</code> is greater than or equal to 2, the message is preceded by two spaces for indentation.</p>
<p >The macro expands to a block of code that:</p><ul>
<li>Checks if the <code>level</code> is greater than or equal to 2, and if so, prints two spaces.</li>
<li>Checks if the <code>level</code> is less than or equal to <code>LOGLEV</code>, and if so, prints the formatted message followed by a newline.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The <code>LOGLEV</code> macro must be defined with an appropriate logging level before using the <code>LOG</code> macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l01973">1973</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a8f75b971030a39ef811d3526a62b36b8" name="a8f75b971030a39ef811d3526a62b36b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f75b971030a39ef811d3526a62b36b8">&#9670;&nbsp;</a></span>WARN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WARN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                                   \</div>
<div class="line">    printf(<span class="stringliteral">&quot;\nWarning (%s, %s, l%d): &quot;</span>, __FILE__, __func__, __LINE__);  \</div>
<div class="line">    LOG(0, __VA_ARGS__);                                                \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Print a warning message with contextual information. </p>
<p >This macro prints a formatted warning message to the standard output, including the file name, function name, and line number where the warning occurred. The message is then passed to the <code>LOG</code> macro with a logging level of 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">...</td><td>The formatted warning message string and its arguments, similar to printf.</td></tr>
  </table>
  </dd>
</dl>
<p>The <code>WARN</code> macro is used to print warning messages with additional context about where the warning was triggered. The message includes the following contextual information:</p><ul>
<li>The name of the source file where the macro is called (<code>__FILE__</code>).</li>
<li>The name of the function where the macro is called (<code>__func__</code>).</li>
<li>The line number in the source file where the macro is called (<code>__LINE__</code>).</li>
</ul>
<p >After printing this contextual information, the macro uses the <code>LOG</code> macro with a logging level of 0 to print the actual warning message. This ensures that warning messages are always logged, regardless of the value of <code>LOGLEV</code>.</p>
<dl class="section note"><dt>Note</dt><dd>The <code>LOG</code> macro must be defined before using the <code>WARN</code> macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l02010">2010</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a3e0ae69dee4a8bb2e616526b5ebe6875" name="a3e0ae69dee4a8bb2e616526b5ebe6875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e0ae69dee4a8bb2e616526b5ebe6875">&#9670;&nbsp;</a></span>ERRMSG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ERRMSG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                                   \</div>
<div class="line">    printf(<span class="stringliteral">&quot;\nError (%s, %s, l%d): &quot;</span>, __FILE__, __func__, __LINE__);    \</div>
<div class="line">    LOG(0, __VA_ARGS__);                                                \</div>
<div class="line">    exit(EXIT_FAILURE);                                                 \</div>
<div class="line">  }</div>
</div><!-- fragment -->
<p>Print an error message with contextual information and terminate the program. </p>
<p >This macro prints a formatted error message to the standard output, including the file name, function name, and line number where the error occurred. After printing the message, the program is terminated with an exit status indicating failure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">...</td><td>The formatted error message string and its arguments, similar to printf.</td></tr>
  </table>
  </dd>
</dl>
<p>The <code>ERRMSG</code> macro is used to report critical errors that require the program to terminate immediately. The message includes the following contextual information:</p><ul>
<li>The name of the source file where the macro is called (<code>__FILE__</code>).</li>
<li>The name of the function where the macro is called (<code>__func__</code>).</li>
<li>The line number in the source file where the macro is called (<code>__LINE__</code>).</li>
</ul>
<p >After printing this contextual information, the macro uses the <code>LOG</code> macro with a logging level of 0 to print the actual error message. Finally, the program exits with a failure status (<code>EXIT_FAILURE</code>).</p>
<dl class="section note"><dt>Note</dt><dd>The <code>LOG</code> macro must be defined before using the <code>ERRMSG</code> macro.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l02043">2043</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a19e6b556dec9bcdb4e422d57633ce731" name="a19e6b556dec9bcdb4e422d57633ce731"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19e6b556dec9bcdb4e422d57633ce731">&#9670;&nbsp;</a></span>PRINT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">format, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">var&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  printf(<span class="stringliteral">&quot;Print (%s, %s, l%d): %s= &quot;</span>format<span class="stringliteral">&quot;\n&quot;</span>,                         \</div>
<div class="line">         __FILE__, __func__, __LINE__, #var, var);</div>
</div><!-- fragment -->
<p>Print the value of a variable with contextual information. </p>
<p >This macro prints the value of a variable to the standard output, including the file name, function name, and line number where the macro is called. The output also includes the variable's name and value in a formatted string.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">format</td><td>The format string used to print the variable's value, similar to printf. </td></tr>
    <tr><td class="paramname">var</td><td>The variable to be printed.</td></tr>
  </table>
  </dd>
</dl>
<p>The <code>PRINT</code> macro is used to output the value of a variable along with additional context about where the macro is called. The message includes:</p><ul>
<li>The name of the source file where the macro is called (<code>__FILE__</code>).</li>
<li>The name of the function where the macro is called (<code>__func__</code>).</li>
<li>The line number in the source file where the macro is called (<code>__LINE__</code>).</li>
<li>The name of the variable being printed (<code>#var</code>).</li>
<li>The value of the variable, formatted according to the provided format string (<code>format</code>).</li>
</ul>
<p >This macro is particularly useful for debugging purposes, providing a convenient way to trace variable values and their locations in the code.</p>
<dl class="section note"><dt>Note</dt><dd>The format string must be compatible with the type of the variable being printed.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l02078">2078</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ab14495ae1f9667df5d198613bcc8d092" name="ab14495ae1f9667df5d198613bcc8d092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab14495ae1f9667df5d198613bcc8d092">&#9670;&nbsp;</a></span>NTIMER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NTIMER&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of timers. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l02087">2087</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="ab84d08f557a59406c2b0969300937769" name="ab84d08f557a59406c2b0969300937769"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab84d08f557a59406c2b0969300937769">&#9670;&nbsp;</a></span>PRINT_TIMERS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_TIMERS&#160;&#160;&#160;  <a class="el" href="mptrac_8h.html#a6d6fa50cf378c33b8ba9575d17cffe9c">timer</a>(&quot;END&quot;, &quot;END&quot;, 1);</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the current state of all timers. </p>
<p >This macro calls the <code>timer</code> function with predefined arguments to signify the end of the timer logging process. It is used to print the results of all the timers that have been tracked.</p>
<dl class="section note"><dt>Note</dt><dd>The <code>timer</code> function must be defined elsewhere in the codebase for this macro to function correctly.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l02102">2102</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<a id="a2b61365bd73a3cf3c059940b7e008749" name="a2b61365bd73a3cf3c059940b7e008749"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b61365bd73a3cf3c059940b7e008749">&#9670;&nbsp;</a></span>SELECT_TIMER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SELECT_TIMER</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">id, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">group&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  <a class="el" href="mptrac_8h.html#a6d6fa50cf378c33b8ba9575d17cffe9c">timer</a>(id, group, 0);</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select and start a timer with specific attributes. </p>
<p >This macro stops the current timer (if any) and starts a new timer with the specified ID and group. It uses the <code>timer</code> function to log the timer start event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>The identifier for the timer. </td></tr>
    <tr><td class="paramname">group</td><td>The group name associated with the timer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8h_source.html#l02117">2117</a> of file <a class="el" href="mptrac_8h_source.html">mptrac.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa4b5f89a098befae2a864decab80f133" name="aa4b5f89a098befae2a864decab80f133"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4b5f89a098befae2a864decab80f133">&#9670;&nbsp;</a></span>broadcast_large_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void broadcast_large_data </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Broadcasts large data across all processes in an MPI communicator. </p>
<p >This function divides the data into manageable chunks and broadcasts each chunk sequentially. This approach is necessary because the data size may exceed the maximum allowable message size for a single MPI_Bcast operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Pointer to the data to be broadcasted. </td></tr>
    <tr><td class="paramname">N</td><td>Size of the data in bytes.</td></tr>
  </table>
  </dd>
</dl>
<p>The function first broadcasts the total size of the data to all processes. Then, it calculates the number of chunks needed to broadcast the entire data. Each chunk is broadcasted in sequence until the entire data has been sent.</p>
<p >The maximum chunk size is defined as CHUNK_SIZE (2147483647 bytes).</p>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the MPI environment has been initialized before calling this function and will be finalized afterward.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

</div>
</div>
<a id="aaf98f7230de0893b8dc4833d3c83c7a4" name="aaf98f7230de0893b8dc4833d3c83c7a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf98f7230de0893b8dc4833d3c83c7a4">&#9670;&nbsp;</a></span>cart2geo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cart2geo </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts Cartesian coordinates to geographic coordinates. </p>
<p >This function converts a point from Cartesian coordinates (x, y, z) to geographic coordinates (longitude, latitude, and altitude). It uses the spherical Earth approximation for the conversion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Pointer to an array containing the Cartesian coordinates (x, y, z) in kilometers. </td></tr>
    <tr><td class="paramname">z</td><td>Pointer to a double where the computed altitude (above the reference ellipsoid) will be stored, in kilometers. </td></tr>
    <tr><td class="paramname">lon</td><td>Pointer to a double where the computed longitude (in degrees) will be stored. </td></tr>
    <tr><td class="paramname">lat</td><td>Pointer to a double where the computed latitude (in degrees) will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann</dd></dl>
<p>Converts Cartesian coordinates to geographic coordinates. </p>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l00074">74</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   78</span>               {</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> radius = sqrt(<a class="code hl_define" href="mptrac_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">DOTP</a>(x, x));</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  *lat = <a class="code hl_define" href="mptrac_8h.html#aacc958134b53425ec947541bb72ac8b1">RAD2DEG</a>(asin(x[2] / radius));</div>
<div class="line"><span class="lineno">   83</span>  *lon = <a class="code hl_define" href="mptrac_8h.html#aacc958134b53425ec947541bb72ac8b1">RAD2DEG</a>(atan2(x[1], x[0]));</div>
<div class="line"><span class="lineno">   84</span>  *z = radius - <a class="code hl_define" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a>;</div>
<div class="line"><span class="lineno">   85</span>}</div>
<div class="ttc" id="amptrac_8h_html_a2f872a4cdfaa577c03b9dea8201028e8"><div class="ttname"><a href="mptrac_8h.html#a2f872a4cdfaa577c03b9dea8201028e8">DOTP</a></div><div class="ttdeci">#define DOTP(a, b)</div><div class="ttdoc">Calculate the dot product of two vectors.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00699">mptrac.h:699</a></div></div>
<div class="ttc" id="amptrac_8h_html_aacc958134b53425ec947541bb72ac8b1"><div class="ttname"><a href="mptrac_8h.html#aacc958134b53425ec947541bb72ac8b1">RAD2DEG</a></div><div class="ttdeci">#define RAD2DEG(rad)</div><div class="ttdoc">Converts radians to degrees.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01535">mptrac.h:1535</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ba00889eeb600010467d8b62de94a36" name="a9ba00889eeb600010467d8b62de94a36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ba00889eeb600010467d8b62de94a36">&#9670;&nbsp;</a></span>clim_oh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double clim_oh </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the hydroxyl radical (OH) concentration from climatology data, with an optional diurnal correction based on solar zenith angle. </p>
<p >This function retrieves OH data from a given climatology and applies a diurnal correction if the correction factor (oh_chem_beta) is greater than zero. The diurnal correction accounts for the variation in OH concentration due to changes in the solar zenith angle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing configuration parameters. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climatology structure containing OH data. </td></tr>
    <tr><td class="paramname">t</td><td>Time at which the OH concentration is to be calculated. </td></tr>
    <tr><td class="paramname">lon</td><td>Longitude at which the OH concentration is to be calculated. </td></tr>
    <tr><td class="paramname">lat</td><td>Latitude at which the OH concentration is to be calculated. </td></tr>
    <tr><td class="paramname">p</td><td>Pressure level at which the OH concentration is to be calculated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The OH concentration at the specified time, location, and pressure, possibly adjusted by a diurnal correction.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l00089">89</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   95</span>                  {</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>  <span class="comment">/* Set SZA threshold... */</span></div>
<div class="line"><span class="lineno">   98</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> sza_thresh = <a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(85.), csza_thresh = cos(sza_thresh);</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>  <span class="comment">/* Get OH data from climatology... */</span></div>
<div class="line"><span class="lineno">  101</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> oh = <a class="code hl_function" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#ac67a2bf753276e20cc577a0134b29252">oh</a>, t, lat, p);</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>  <span class="comment">/* Check beta... */</span></div>
<div class="line"><span class="lineno">  104</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a572e117f02cbfced576c216d366d1a89">oh_chem_beta</a> &lt;= 0)</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">return</span> oh;</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>  <span class="comment">/* Apply diurnal correction... */</span></div>
<div class="line"><span class="lineno">  108</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> csza = <a class="code hl_function" href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b">cos_sza</a>(t, lon, lat);</div>
<div class="line"><span class="lineno">  109</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> denom = (csza &gt;= csza_thresh) ? csza : csza_thresh;</div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordflow">return</span> oh * exp(-ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a572e117f02cbfced576c216d366d1a89">oh_chem_beta</a> / denom);</div>
<div class="line"><span class="lineno">  111</span>}</div>
<div class="ttc" id="amptrac_8c_html_a1c8c72b0bc66d214b4575c13a7a0eb6b"><div class="ttname"><a href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b">cos_sza</a></div><div class="ttdeci">double cos_sza(const double sec, const double lon, const double lat)</div><div class="ttdoc">Calculates the cosine of the solar zenith angle.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l01011">mptrac.c:1011</a></div></div>
<div class="ttc" id="amptrac_8c_html_a41f5ab8ff7acad400fe7332b6b53288a"><div class="ttname"><a href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a></div><div class="ttdeci">double clim_zm(const clim_zm_t *zm, const double t, const double lat, const double p)</div><div class="ttdoc">Interpolates monthly mean zonal mean climatological variables.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l00405">mptrac.c:405</a></div></div>
<div class="ttc" id="astructclim__t_html_ac67a2bf753276e20cc577a0134b29252"><div class="ttname"><a href="structclim__t.html#ac67a2bf753276e20cc577a0134b29252">clim_t::oh</a></div><div class="ttdeci">clim_zm_t oh</div><div class="ttdoc">OH zonal means.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03383">mptrac.h:3383</a></div></div>
<div class="ttc" id="astructctl__t_html_a572e117f02cbfced576c216d366d1a89"><div class="ttname"><a href="structctl__t.html#a572e117f02cbfced576c216d366d1a89">ctl_t::oh_chem_beta</a></div><div class="ttdeci">double oh_chem_beta</div><div class="ttdoc">Beta parameter for diurnal variablity of OH.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02850">mptrac.h:2850</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a9ba00889eeb600010467d8b62de94a36_cgraph.png" border="0" usemap="#amptrac_8h_a9ba00889eeb600010467d8b62de94a36_cgraph" alt=""/></div>
<map name="amptrac_8h_a9ba00889eeb600010467d8b62de94a36_cgraph" id="amptrac_8h_a9ba00889eeb600010467d8b62de94a36_cgraph">
<area shape="rect" title="Calculates the hydroxyl radical (OH) concentration from climatology data, with an optional diurnal co..." alt="" coords="5,56,72,83"/>
<area shape="rect" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a" title="Interpolates monthly mean zonal mean climatological variables." alt="" coords="120,31,191,57"/>
<area shape="rect" href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="120,81,191,108"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="243,5,317,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="239,56,321,83"/>
</map>
</div>

</div>
</div>
<a id="aba22251f4ea0fe56c2a59719998c650a" name="aba22251f4ea0fe56c2a59719998c650a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba22251f4ea0fe56c2a59719998c650a">&#9670;&nbsp;</a></span>clim_oh_diurnal_correction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clim_oh_diurnal_correction </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a diurnal correction to the hydroxyl radical (OH) concentration in climatology data. </p>
<p >This function iterates over the climatology data points for OH concentration and integrates the day/night correction factor over longitude. The correction factor is based on the solar zenith angle, and it adjusts the OH data to account for diurnal variations. The corrected OH data is scaled accordingly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing configuration parameters, including the correction factor (oh_chem_beta). </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climatology structure containing OH data that will be corrected.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l00115">115</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  117</span>                {</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>  <span class="comment">/* Set SZA threshold... */</span></div>
<div class="line"><span class="lineno">  120</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> sza_thresh = <a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(85.), csza_thresh = cos(sza_thresh);</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>  <span class="comment">/* Loop over climatology data points... */</span></div>
<div class="line"><span class="lineno">  123</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> it = 0; it &lt; clim-&gt;<a class="code hl_variable" href="structclim__t.html#ac67a2bf753276e20cc577a0134b29252">oh</a>.<a class="code hl_variable" href="structclim__zm__t.html#aa852df9602b1dfd0cbf453159dbf0e41">ntime</a>; it++)</div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; clim-&gt;<a class="code hl_variable" href="structclim__t.html#ac67a2bf753276e20cc577a0134b29252">oh</a>.<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a>; iz++)</div>
<div class="line"><span class="lineno">  125</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; clim-&gt;<a class="code hl_variable" href="structclim__t.html#ac67a2bf753276e20cc577a0134b29252">oh</a>.<a class="code hl_variable" href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">nlat</a>; iy++) {</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>        <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno">  128</span>        <span class="keywordtype">int</span> n = 0;</div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordtype">double</span> sum = 0;</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>        <span class="comment">/* Integrate day/night correction factor over longitude... */</span></div>
<div class="line"><span class="lineno">  132</span>        <span class="keywordflow">for</span> (<span class="keywordtype">double</span> lon = -180; lon &lt; 180; lon += 1.0) {</div>
<div class="line"><span class="lineno">  133</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> csza =</div>
<div class="line"><span class="lineno">  134</span>            <a class="code hl_function" href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b">cos_sza</a>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#ac67a2bf753276e20cc577a0134b29252">oh</a>.<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[it], lon, clim-&gt;<a class="code hl_variable" href="structclim__t.html#ac67a2bf753276e20cc577a0134b29252">oh</a>.<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[iy]);</div>
<div class="line"><span class="lineno">  135</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> denom = (csza &gt;= csza_thresh) ? csza : csza_thresh;</div>
<div class="line"><span class="lineno">  136</span>          sum += exp(-ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a572e117f02cbfced576c216d366d1a89">oh_chem_beta</a> / denom);</div>
<div class="line"><span class="lineno">  137</span>          n++;</div>
<div class="line"><span class="lineno">  138</span>        }</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>        <span class="comment">/* Apply scaling factor to OH data... */</span></div>
<div class="line"><span class="lineno">  141</span>        clim-&gt;<a class="code hl_variable" href="structclim__t.html#ac67a2bf753276e20cc577a0134b29252">oh</a>.<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[it][iz][iy] /= (sum / (double) n);</div>
<div class="line"><span class="lineno">  142</span>      }</div>
<div class="line"><span class="lineno">  143</span>}</div>
<div class="ttc" id="astructclim__zm__t_html_a06e634b21e38187593b011c715afa57a"><div class="ttname"><a href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">clim_zm_t::time</a></div><div class="ttdeci">double time[CT]</div><div class="ttdoc">Time [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03339">mptrac.h:3339</a></div></div>
<div class="ttc" id="astructclim__zm__t_html_a3c0b1227fc300563dc460fef7b4b249a"><div class="ttname"><a href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">clim_zm_t::np</a></div><div class="ttdeci">int np</div><div class="ttdoc">Number of pressure levels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03336">mptrac.h:3336</a></div></div>
<div class="ttc" id="astructclim__zm__t_html_a893d077ed8733dc568f87950ce40f5c6"><div class="ttname"><a href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">clim_zm_t::vmr</a></div><div class="ttdeci">double vmr[CT][CP][CY]</div><div class="ttdoc">Volume mixing ratio [ppv].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03348">mptrac.h:3348</a></div></div>
<div class="ttc" id="astructclim__zm__t_html_aa852df9602b1dfd0cbf453159dbf0e41"><div class="ttname"><a href="structclim__zm__t.html#aa852df9602b1dfd0cbf453159dbf0e41">clim_zm_t::ntime</a></div><div class="ttdeci">int ntime</div><div class="ttdoc">Number of timesteps.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03330">mptrac.h:3330</a></div></div>
<div class="ttc" id="astructclim__zm__t_html_ab3d452abf93ad1d5f39c2c20fc6403e9"><div class="ttname"><a href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">clim_zm_t::nlat</a></div><div class="ttdeci">int nlat</div><div class="ttdoc">Number of latitudes.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03333">mptrac.h:3333</a></div></div>
<div class="ttc" id="astructclim__zm__t_html_aff242585ab3f0df6832c7417d90d8f2f"><div class="ttname"><a href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">clim_zm_t::lat</a></div><div class="ttdeci">double lat[CY]</div><div class="ttdoc">Latitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03342">mptrac.h:3342</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_aba22251f4ea0fe56c2a59719998c650a_cgraph.png" border="0" usemap="#amptrac_8h_aba22251f4ea0fe56c2a59719998c650a_cgraph" alt=""/></div>
<map name="amptrac_8h_aba22251f4ea0fe56c2a59719998c650a_cgraph" id="amptrac_8h_aba22251f4ea0fe56c2a59719998c650a_cgraph">
<area shape="rect" title="Applies a diurnal correction to the hydroxyl radical (OH) concentration in climatology data." alt="" coords="5,5,181,32"/>
<area shape="rect" href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="229,5,300,32"/>
</map>
</div>

</div>
</div>
<a id="a69a55a5bcd0af800ddc35cbe3b16cd15" name="a69a55a5bcd0af800ddc35cbe3b16cd15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69a55a5bcd0af800ddc35cbe3b16cd15">&#9670;&nbsp;</a></span>clim_photo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double clim_photo </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>rate</em>[CP][CSZA][CO3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__photo__t.html">clim_photo_t</a> *&#160;</td>
          <td class="paramname"><em>photo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>sza</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>o3c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the photolysis rate for a given set of atmospheric conditions. </p>
<p >This function computes the photolysis rate based on provided climatology data and input parameters such as pressure, solar zenith angle (SZA), and ozone column. It ensures that the input parameters are within the valid range of the climatology data and interpolates the photolysis rate accordingly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rate</td><td>3D array containing the photolysis rates for different combinations of pressure, SZA, and ozone column. </td></tr>
    <tr><td class="paramname">photo</td><td>Pointer to the climatology data structure containing arrays of valid pressure levels, SZAs, and ozone columns. </td></tr>
    <tr><td class="paramname">p</td><td>Pressure at which the photolysis rate is to be calculated. </td></tr>
    <tr><td class="paramname">sza</td><td>Solar zenith angle at which the photolysis rate is to be calculated. </td></tr>
    <tr><td class="paramname">o3c</td><td>Ozone column at which the photolysis rate is to be calculated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The interpolated photolysis rate for the specified conditions. If the calculated rate is negative, it returns 0.0.</dd></dl>
<p>This function performs the following steps:</p><ol type="1">
<li>Checks and adjusts the input parameters (pressure, SZA, and ozone column) to ensure they are within the valid range.</li>
<li>Determines the appropriate indices in the climatology data for interpolation.</li>
<li>Performs trilinear interpolation to calculate the photolysis rate based on the input parameters.</li>
</ol>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l00147">147</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  152</span>                    {</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>  <span class="comment">/* Check pressure range... */</span></div>
<div class="line"><span class="lineno">  155</span>  <span class="keywordtype">double</span> p_help = p;</div>
<div class="line"><span class="lineno">  156</span>  <span class="keywordflow">if</span> (p &lt; photo-&gt;p[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1])</div>
<div class="line"><span class="lineno">  157</span>    p_help = photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1];</div>
<div class="line"><span class="lineno">  158</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p &gt; photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[0])</div>
<div class="line"><span class="lineno">  159</span>    p_help = photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[0];</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>  <span class="comment">/* Check sza range... */</span></div>
<div class="line"><span class="lineno">  162</span>  <span class="keywordtype">double</span> sza_help = sza;</div>
<div class="line"><span class="lineno">  163</span>  <span class="keywordflow">if</span> (sza &lt; photo-&gt;sza[0])</div>
<div class="line"><span class="lineno">  164</span>    sza_help = photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>[0];</div>
<div class="line"><span class="lineno">  165</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sza &gt; photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1])</div>
<div class="line"><span class="lineno">  166</span>    sza_help = photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1];</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>  <span class="comment">/* Check ozone column range... */</span></div>
<div class="line"><span class="lineno">  169</span>  <span class="keywordtype">double</span> o3c_help = o3c;</div>
<div class="line"><span class="lineno">  170</span>  <span class="keywordflow">if</span> (o3c &lt; photo-&gt;o3c[0])</div>
<div class="line"><span class="lineno">  171</span>    o3c_help = photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[0];</div>
<div class="line"><span class="lineno">  172</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o3c &gt; photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1])</div>
<div class="line"><span class="lineno">  173</span>    o3c_help = photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1];</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>  <span class="comment">/* Get indices... */</span></div>
<div class="line"><span class="lineno">  176</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ip = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a>, p_help);</div>
<div class="line"><span class="lineno">  177</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> isza = <a class="code hl_function" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a>, sza_help);</div>
<div class="line"><span class="lineno">  178</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> io3c = <a class="code hl_function" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a>, o3c_help);</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>  <span class="comment">/* Interpolate photolysis rate... */</span></div>
<div class="line"><span class="lineno">  181</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux00 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[ip], rate[ip][isza][io3c],</div>
<div class="line"><span class="lineno">  182</span>                           photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[ip + 1], rate[ip + 1][isza][io3c],</div>
<div class="line"><span class="lineno">  183</span>                           p_help);</div>
<div class="line"><span class="lineno">  184</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux01 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[ip], rate[ip][isza][io3c + 1],</div>
<div class="line"><span class="lineno">  185</span>                           photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[ip + 1], rate[ip + 1][isza][io3c + 1],</div>
<div class="line"><span class="lineno">  186</span>                           p_help);</div>
<div class="line"><span class="lineno">  187</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux10 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[ip], rate[ip][isza + 1][io3c],</div>
<div class="line"><span class="lineno">  188</span>                           photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[ip + 1], rate[ip + 1][isza + 1][io3c],</div>
<div class="line"><span class="lineno">  189</span>                           p_help);</div>
<div class="line"><span class="lineno">  190</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux11 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[ip], rate[ip][isza + 1][io3c + 1],</div>
<div class="line"><span class="lineno">  191</span>                           photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[ip + 1], rate[ip + 1][isza + 1][io3c + 1],</div>
<div class="line"><span class="lineno">  192</span>                           p_help);</div>
<div class="line"><span class="lineno">  193</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux0 =</div>
<div class="line"><span class="lineno">  194</span>    <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[io3c], aux00, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[io3c + 1], aux01, o3c_help);</div>
<div class="line"><span class="lineno">  195</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux1 =</div>
<div class="line"><span class="lineno">  196</span>    <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[io3c], aux10, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[io3c + 1], aux11, o3c_help);</div>
<div class="line"><span class="lineno">  197</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux =</div>
<div class="line"><span class="lineno">  198</span>    <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>[isza], aux0, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>[isza + 1], aux1, sza_help);</div>
<div class="line"><span class="lineno">  199</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(aux, 0.0);</div>
<div class="line"><span class="lineno">  200</span>}</div>
<div class="ttc" id="amptrac_8c_html_a2a3c8ab98f21179741b274439786726d"><div class="ttname"><a href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a></div><div class="ttdeci">int locate_reg(const double *xx, const int n, const double x)</div><div class="ttdoc">Locate the index of the interval containing a given value in a regular grid.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02933">mptrac.c:2933</a></div></div>
<div class="ttc" id="amptrac_8c_html_a4e1b87dc3c93a23c89f739adf10b60dc"><div class="ttname"><a href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a></div><div class="ttdeci">int locate_irr(const double *xx, const int n, const double x)</div><div class="ttdoc">Locate the index of the interval containing a given value in a sorted array.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02869">mptrac.c:2869</a></div></div>
<div class="ttc" id="amptrac_8h_html_aebaef4a0f8136be064bf1d29ce1ced83"><div class="ttname"><a href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a></div><div class="ttdeci">#define LIN(x0, y0, x1, y1, x)</div><div class="ttdoc">Linear interpolation.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01010">mptrac.h:1010</a></div></div>
<div class="ttc" id="amptrac_8h_html_afa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdoc">Macro to determine the maximum of two values.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01037">mptrac.h:1037</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_a0049cb269d4506812a7f4d3e83338f9a"><div class="ttname"><a href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">clim_photo_t::nsza</a></div><div class="ttdeci">int nsza</div><div class="ttdoc">Number of solar zenith angles.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03257">mptrac.h:3257</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_a0954705edbe1ca70559f1adeb231a685"><div class="ttname"><a href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">clim_photo_t::sza</a></div><div class="ttdeci">double sza[CSZA]</div><div class="ttdoc">Solar zenith angle [rad].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03266">mptrac.h:3266</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_a29e3ba531fc98c377540862e80cdbaab"><div class="ttname"><a href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">clim_photo_t::p</a></div><div class="ttdeci">double p[CP]</div><div class="ttdoc">Pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03263">mptrac.h:3263</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_ac0271c879928d27622665e275d535bc1"><div class="ttname"><a href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">clim_photo_t::o3c</a></div><div class="ttdeci">double o3c[CO3]</div><div class="ttdoc">Total column ozone [DU].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03269">mptrac.h:3269</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_ac8e36bf703a6431948567de9cb94c1e0"><div class="ttname"><a href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">clim_photo_t::np</a></div><div class="ttdeci">int np</div><div class="ttdoc">Number of pressure levels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03254">mptrac.h:3254</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_acce113364acbbf45c8d77ff60a743b3c"><div class="ttname"><a href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">clim_photo_t::no3c</a></div><div class="ttdeci">int no3c</div><div class="ttdoc">Number of total ozone columns.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03260">mptrac.h:3260</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a69a55a5bcd0af800ddc35cbe3b16cd15_cgraph.png" border="0" usemap="#amptrac_8h_a69a55a5bcd0af800ddc35cbe3b16cd15_cgraph" alt=""/></div>
<map name="amptrac_8h_a69a55a5bcd0af800ddc35cbe3b16cd15_cgraph" id="amptrac_8h_a69a55a5bcd0af800ddc35cbe3b16cd15_cgraph">
<area shape="rect" title="Calculates the photolysis rate for a given set of atmospheric conditions." alt="" coords="5,31,91,57"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="143,5,217,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="139,56,221,83"/>
</map>
</div>

</div>
</div>
<a id="a4531cb279e09061a6f34a73695c7b692" name="a4531cb279e09061a6f34a73695c7b692"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4531cb279e09061a6f34a73695c7b692">&#9670;&nbsp;</a></span>clim_tropo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double clim_tropo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the tropopause pressure based on climatological data. </p>
<p >This function computes the tropopause pressure using climatological data for different times and latitudes. It interpolates the tropopause pressure based on the input time and latitude parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clim</td><td>Pointer to the climatology structure containing tropopause pressure data. </td></tr>
    <tr><td class="paramname">t</td><td>Time for which the tropopause pressure is to be calculated, in seconds since the beginning of the year. </td></tr>
    <tr><td class="paramname">lat</td><td>Latitude at which the tropopause pressure is to be calculated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The interpolated tropopause pressure for the specified time and latitude.</dd></dl>
<p>This function performs the following steps:</p><ol type="1">
<li>Calculates the number of seconds since the beginning of the year.</li>
<li>Determines the appropriate indices in the climatology data for interpolation based on time and latitude.</li>
<li>Interpolates the tropopause pressure using linear interpolation based on latitude and time.</li>
</ol>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l00204">204</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  207</span>                    {</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>  <span class="comment">/* Get seconds since begin of year... */</span></div>
<div class="line"><span class="lineno">  210</span>  <span class="keywordtype">double</span> sec = <a class="code hl_define" href="mptrac_8h.html#aff4e721b49a057c4e4a3a6f56cc06469">FMOD</a>(t, 365.25 * 86400.);</div>
<div class="line"><span class="lineno">  211</span>  <span class="keywordflow">while</span> (sec &lt; 0)</div>
<div class="line"><span class="lineno">  212</span>    sec += 365.25 * 86400.;</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>  <span class="comment">/* Get indices... */</span></div>
<div class="line"><span class="lineno">  215</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> isec = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#ae2845f40329df2cf90838d1684617ada">tropo_time</a>, clim-&gt;<a class="code hl_variable" href="structclim__t.html#a71b9c5664f017ee5f36db4aae204328a">tropo_ntime</a>, sec);</div>
<div class="line"><span class="lineno">  216</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ilat = <a class="code hl_function" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#aaaee23fbfbb65c1eb77daad5a003defa">tropo_lat</a>, clim-&gt;<a class="code hl_variable" href="structclim__t.html#abe42300dd939b2409b3dbf37550e58f6">tropo_nlat</a>, lat);</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>  <span class="comment">/* Interpolate tropopause pressure... */</span></div>
<div class="line"><span class="lineno">  219</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> p0 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#aaaee23fbfbb65c1eb77daad5a003defa">tropo_lat</a>[ilat],</div>
<div class="line"><span class="lineno">  220</span>                        clim-&gt;<a class="code hl_variable" href="structclim__t.html#ad357829e5b267a357fce1a27518e271f">tropo</a>[isec][ilat],</div>
<div class="line"><span class="lineno">  221</span>                        clim-&gt;<a class="code hl_variable" href="structclim__t.html#aaaee23fbfbb65c1eb77daad5a003defa">tropo_lat</a>[ilat + 1],</div>
<div class="line"><span class="lineno">  222</span>                        clim-&gt;<a class="code hl_variable" href="structclim__t.html#ad357829e5b267a357fce1a27518e271f">tropo</a>[isec][ilat + 1], lat);</div>
<div class="line"><span class="lineno">  223</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> p1 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#aaaee23fbfbb65c1eb77daad5a003defa">tropo_lat</a>[ilat],</div>
<div class="line"><span class="lineno">  224</span>                        clim-&gt;<a class="code hl_variable" href="structclim__t.html#ad357829e5b267a357fce1a27518e271f">tropo</a>[isec + 1][ilat],</div>
<div class="line"><span class="lineno">  225</span>                        clim-&gt;<a class="code hl_variable" href="structclim__t.html#aaaee23fbfbb65c1eb77daad5a003defa">tropo_lat</a>[ilat + 1],</div>
<div class="line"><span class="lineno">  226</span>                        clim-&gt;<a class="code hl_variable" href="structclim__t.html#ad357829e5b267a357fce1a27518e271f">tropo</a>[isec + 1][ilat + 1], lat);</div>
<div class="line"><span class="lineno">  227</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#ae2845f40329df2cf90838d1684617ada">tropo_time</a>[isec], p0, clim-&gt;<a class="code hl_variable" href="structclim__t.html#ae2845f40329df2cf90838d1684617ada">tropo_time</a>[isec + 1], p1, sec);</div>
<div class="line"><span class="lineno">  228</span>}</div>
<div class="ttc" id="amptrac_8h_html_aff4e721b49a057c4e4a3a6f56cc06469"><div class="ttname"><a href="mptrac_8h.html#aff4e721b49a057c4e4a3a6f56cc06469">FMOD</a></div><div class="ttdeci">#define FMOD(x, y)</div><div class="ttdoc">Calculate the floating-point remainder of dividing x by y.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00780">mptrac.h:780</a></div></div>
<div class="ttc" id="astructclim__t_html_a71b9c5664f017ee5f36db4aae204328a"><div class="ttname"><a href="structclim__t.html#a71b9c5664f017ee5f36db4aae204328a">clim_t::tropo_ntime</a></div><div class="ttdeci">int tropo_ntime</div><div class="ttdoc">Number of tropopause timesteps.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03362">mptrac.h:3362</a></div></div>
<div class="ttc" id="astructclim__t_html_aaaee23fbfbb65c1eb77daad5a003defa"><div class="ttname"><a href="structclim__t.html#aaaee23fbfbb65c1eb77daad5a003defa">clim_t::tropo_lat</a></div><div class="ttdeci">double tropo_lat[73]</div><div class="ttdoc">Tropopause latitudes [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03371">mptrac.h:3371</a></div></div>
<div class="ttc" id="astructclim__t_html_abe42300dd939b2409b3dbf37550e58f6"><div class="ttname"><a href="structclim__t.html#abe42300dd939b2409b3dbf37550e58f6">clim_t::tropo_nlat</a></div><div class="ttdeci">int tropo_nlat</div><div class="ttdoc">Number of tropopause latitudes.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03365">mptrac.h:3365</a></div></div>
<div class="ttc" id="astructclim__t_html_ad357829e5b267a357fce1a27518e271f"><div class="ttname"><a href="structclim__t.html#ad357829e5b267a357fce1a27518e271f">clim_t::tropo</a></div><div class="ttdeci">double tropo[12][73]</div><div class="ttdoc">Tropopause pressure values [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03374">mptrac.h:3374</a></div></div>
<div class="ttc" id="astructclim__t_html_ae2845f40329df2cf90838d1684617ada"><div class="ttname"><a href="structclim__t.html#ae2845f40329df2cf90838d1684617ada">clim_t::tropo_time</a></div><div class="ttdeci">double tropo_time[12]</div><div class="ttdoc">Tropopause time steps [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03368">mptrac.h:3368</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a4531cb279e09061a6f34a73695c7b692_cgraph.png" border="0" usemap="#amptrac_8h_a4531cb279e09061a6f34a73695c7b692_cgraph" alt=""/></div>
<map name="amptrac_8h_a4531cb279e09061a6f34a73695c7b692_cgraph" id="amptrac_8h_a4531cb279e09061a6f34a73695c7b692_cgraph">
<area shape="rect" title="Calculates the tropopause pressure based on climatological data." alt="" coords="5,31,88,57"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="140,5,215,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="136,56,219,83"/>
</map>
</div>

</div>
</div>
<a id="aa9cf40c6960c5078d1ea9e12a2fb0872" name="aa9cf40c6960c5078d1ea9e12a2fb0872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9cf40c6960c5078d1ea9e12a2fb0872">&#9670;&nbsp;</a></span>clim_tropo_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clim_tropo_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the tropopause data in the climatology structure. </p>
<p >This function initializes the tropopause data in the climatology structure. It sets the time steps, latitudes, and tropopause pressure values based on predefined arrays.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clim</td><td>Pointer to the climatology structure to be initialized.</td></tr>
  </table>
  </dd>
</dl>
<p>This function performs the following steps:</p><ol type="1">
<li>Sets the number of time steps and initializes the time array.</li>
<li>Sets the number of latitudes and initializes the latitude array.</li>
<li>Initializes the tropopause pressure values based on predefined arrays.</li>
<li>Computes the range of tropopause pressure values.</li>
<li>Logs information about the initialization process.</li>
</ol>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l00232">232</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  233</span>                {</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno">  236</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Initialize tropopause data...&quot;</span>);</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>  <span class="comment">/* Set time [s]... */</span></div>
<div class="line"><span class="lineno">  239</span>  clim-&gt;<a class="code hl_variable" href="structclim__t.html#a71b9c5664f017ee5f36db4aae204328a">tropo_ntime</a> = 12;</div>
<div class="line"><span class="lineno">  240</span>  <span class="keywordtype">double</span> tropo_time[12] = {</div>
<div class="line"><span class="lineno">  241</span>    1209600.00, 3888000.00, 6393600.00,</div>
<div class="line"><span class="lineno">  242</span>    9072000.00, 11664000.00, 14342400.00,</div>
<div class="line"><span class="lineno">  243</span>    16934400.00, 19612800.00, 22291200.00,</div>
<div class="line"><span class="lineno">  244</span>    24883200.00, 27561600.00, 30153600.00</div>
<div class="line"><span class="lineno">  245</span>  };</div>
<div class="line"><span class="lineno">  246</span>  memcpy(clim-&gt;<a class="code hl_variable" href="structclim__t.html#ae2845f40329df2cf90838d1684617ada">tropo_time</a>, tropo_time, <span class="keyword">sizeof</span>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#ae2845f40329df2cf90838d1684617ada">tropo_time</a>));</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>  <span class="comment">/* Set latitudes [deg]... */</span></div>
<div class="line"><span class="lineno">  249</span>  clim-&gt;<a class="code hl_variable" href="structclim__t.html#abe42300dd939b2409b3dbf37550e58f6">tropo_nlat</a> = 73;</div>
<div class="line"><span class="lineno">  250</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> tropo_lat[73] = {</div>
<div class="line"><span class="lineno">  251</span>    -90, -87.5, -85, -82.5, -80, -77.5, -75, -72.5, -70, -67.5,</div>
<div class="line"><span class="lineno">  252</span>    -65, -62.5, -60, -57.5, -55, -52.5, -50, -47.5, -45, -42.5,</div>
<div class="line"><span class="lineno">  253</span>    -40, -37.5, -35, -32.5, -30, -27.5, -25, -22.5, -20, -17.5,</div>
<div class="line"><span class="lineno">  254</span>    -15, -12.5, -10, -7.5, -5, -2.5, 0, 2.5, 5, 7.5, 10, 12.5,</div>
<div class="line"><span class="lineno">  255</span>    15, 17.5, 20, 22.5, 25, 27.5, 30, 32.5, 35, 37.5, 40, 42.5,</div>
<div class="line"><span class="lineno">  256</span>    45, 47.5, 50, 52.5, 55, 57.5, 60, 62.5, 65, 67.5, 70, 72.5,</div>
<div class="line"><span class="lineno">  257</span>    75, 77.5, 80, 82.5, 85, 87.5, 90</div>
<div class="line"><span class="lineno">  258</span>  };</div>
<div class="line"><span class="lineno">  259</span>  memcpy(clim-&gt;<a class="code hl_variable" href="structclim__t.html#aaaee23fbfbb65c1eb77daad5a003defa">tropo_lat</a>, tropo_lat, <span class="keyword">sizeof</span>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#aaaee23fbfbb65c1eb77daad5a003defa">tropo_lat</a>));</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>  <span class="comment">/* Set tropopause pressure [hPa] (NCEP/NCAR Reanalysis 1)... */</span></div>
<div class="line"><span class="lineno">  262</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> tropo[12][73] = {</div>
<div class="line"><span class="lineno">  263</span>    {324.1, 325.6, 325, 324.3, 322.5, 319.7, 314, 307.2, 301.8, 299.6,</div>
<div class="line"><span class="lineno">  264</span>     297.1, 292.2, 285.6, 276.1, 264, 248.9, 231.9, 213.5, 194.4,</div>
<div class="line"><span class="lineno">  265</span>     175.3, 157, 140.4, 126.7, 116.3, 109.5, 105.4, 103, 101.4, 100.4,</div>
<div class="line"><span class="lineno">  266</span>     99.69, 99.19, 98.84, 98.56, 98.39, 98.39, 98.42, 98.44, 98.54,</div>
<div class="line"><span class="lineno">  267</span>     98.68, 98.81, 98.89, 98.96, 99.12, 99.65, 101.4, 105.4, 113.5, 128,</div>
<div class="line"><span class="lineno">  268</span>     152.1, 184.7, 214, 234.1, 247.3, 255.8, 262.6, 267.7, 271.7, 275,</div>
<div class="line"><span class="lineno">  269</span>     277.2, 279, 280.1, 280.4, 280.6, 280.1, 279.3, 278.3, 276.8, 275.8,</div>
<div class="line"><span class="lineno">  270</span>     275.3, 275.6, 275.4, 274.1, 273.5},</div>
<div class="line"><span class="lineno">  271</span>    {337.3, 338.7, 337.8, 336.4, 333, 328.8, 321.1, 312.6, 306.6, 303.7,</div>
<div class="line"><span class="lineno">  272</span>     300.2, 293.8, 285.4, 273.8, 259.6, 242.7, 224.4, 205.2, 186, 167.5,</div>
<div class="line"><span class="lineno">  273</span>     150.3, 135, 122.8, 113.9, 108.2, 104.7, 102.5, 101.1, 100.2, 99.42,</div>
<div class="line"><span class="lineno">  274</span>     98.88, 98.52, 98.25, 98.09, 98.07, 98.1, 98.12, 98.2, 98.25, 98.27,</div>
<div class="line"><span class="lineno">  275</span>     98.26, 98.27, 98.36, 98.79, 100.2, 104.2, 113.7, 131.2, 159.5, 193,</div>
<div class="line"><span class="lineno">  276</span>     220.4, 238.1, 250.2, 258.1, 264.7, 269.7, 273.7, 277.3, 280.2, 282.8,</div>
<div class="line"><span class="lineno">  277</span>     284.9, 286.5, 288.1, 288.8, 289, 288.5, 287.2, 286.3, 286.1, 287.2,</div>
<div class="line"><span class="lineno">  278</span>     287.5, 286.2, 285.8},</div>
<div class="line"><span class="lineno">  279</span>    {335, 336, 335.7, 335.1, 332.3, 328.1, 320.6, 311.8, 305.1, 301.9,</div>
<div class="line"><span class="lineno">  280</span>     297.6, 290, 280.4, 268.3, 254.6, 239.6, 223.9, 207.9, 192.2, 176.9,</div>
<div class="line"><span class="lineno">  281</span>     161.7, 146.4, 132.2, 120.6, 112.3, 107.2, 104.3, 102.4, 101.3,</div>
<div class="line"><span class="lineno">  282</span>     100.4, 99.86, 99.47, 99.16, 98.97, 98.94, 98.97, 99, 99.09, 99.2,</div>
<div class="line"><span class="lineno">  283</span>     99.31, 99.35, 99.41, 99.51, 99.86, 101.1, 104.9, 114.3, 131, 156.8,</div>
<div class="line"><span class="lineno">  284</span>     186.3, 209.3, 224.6, 236.8, 246.3, 254.9, 262.3, 268.8, 274.8,</div>
<div class="line"><span class="lineno">  285</span>     279.9, 284.6, 288.6, 291.6, 294.9, 297.5, 299.8, 301.8, 303.1,</div>
<div class="line"><span class="lineno">  286</span>     304.3, 304.9, 306, 306.6, 306.2, 306},</div>
<div class="line"><span class="lineno">  287</span>    {306.2, 306.7, 305.7, 307.1, 307.3, 306.4, 301.8, 296.2, 292.4,</div>
<div class="line"><span class="lineno">  288</span>     290.3, 287.1, 280.9, 273.4, 264.3, 254.1, 242.8, 231, 219, 207.2,</div>
<div class="line"><span class="lineno">  289</span>     195.5, 183.3, 169.7, 154.7, 138.7, 124.1, 113.6, 107.8, 104.7,</div>
<div class="line"><span class="lineno">  290</span>     102.8, 101.7, 100.9, 100.4, 100, 99.79, 99.7, 99.66, 99.68, 99.79,</div>
<div class="line"><span class="lineno">  291</span>     99.94, 100.2, 100.5, 100.9, 101.4, 102.1, 103.4, 107, 115.2, 129.1,</div>
<div class="line"><span class="lineno">  292</span>     148.7, 171, 190.8, 205.6, 218.4, 229.4, 239.6, 248.6, 256.5,</div>
<div class="line"><span class="lineno">  293</span>     263.7, 270.3, 276.6, 282.6, 288.1, 294.5, 300.4, 306.3, 311.4,</div>
<div class="line"><span class="lineno">  294</span>     315.1, 318.3, 320.3, 322.2, 322.8, 321.5, 321.1},</div>
<div class="line"><span class="lineno">  295</span>    {266.5, 264.9, 260.8, 261, 262, 263, 261.3, 259.7, 259.2, 259.8,</div>
<div class="line"><span class="lineno">  296</span>     260.1, 258.6, 256.7, 253.6, 249.5, 243.9, 237.4, 230, 222.1, 213.9,</div>
<div class="line"><span class="lineno">  297</span>     205, 194.4, 180.4, 161.8, 140.7, 122.9, 112.1, 106.7, 104.1, 102.7,</div>
<div class="line"><span class="lineno">  298</span>     101.8, 101.4, 101.1, 101, 101, 101, 101.1, 101.2, 101.5, 101.9,</div>
<div class="line"><span class="lineno">  299</span>     102.4, 103, 103.8, 104.9, 106.8, 110.1, 115.6, 124, 135.2, 148.9,</div>
<div class="line"><span class="lineno">  300</span>     165.2, 181.3, 198, 211.8, 223.5, 233.8, 242.9, 251.5, 259, 266.2,</div>
<div class="line"><span class="lineno">  301</span>     273.1, 279.2, 286.2, 292.8, 299.6, 306, 311.1, 315.5, 318.8, 322.6,</div>
<div class="line"><span class="lineno">  302</span>     325.3, 325.8, 325.8},</div>
<div class="line"><span class="lineno">  303</span>    {220.1, 218.1, 210.8, 207.2, 207.6, 210.5, 211.4, 213.5, 217.3,</div>
<div class="line"><span class="lineno">  304</span>     222.4, 227.9, 232.8, 237.4, 240.8, 242.8, 243, 241.5, 238.6, 234.2,</div>
<div class="line"><span class="lineno">  305</span>     228.5, 221, 210.7, 195.1, 172.9, 147.8, 127.6, 115.6, 109.9, 107.1,</div>
<div class="line"><span class="lineno">  306</span>     105.7, 105, 104.8, 104.8, 104.9, 105, 105.1, 105.3, 105.5, 105.8,</div>
<div class="line"><span class="lineno">  307</span>     106.4, 107, 107.6, 108.1, 108.8, 110, 111.8, 114.2, 117.4, 121.6,</div>
<div class="line"><span class="lineno">  308</span>     127.9, 137.3, 151.2, 169.5, 189, 205.8, 218.9, 229.1, 237.8, 245,</div>
<div class="line"><span class="lineno">  309</span>     251.5, 257.1, 262.3, 268.2, 274, 280.4, 286.7, 292.4, 297.9, 302.9,</div>
<div class="line"><span class="lineno">  310</span>     308.5, 312.2, 313.1, 313.3},</div>
<div class="line"><span class="lineno">  311</span>    {187.4, 184.5, 173.3, 166.1, 165.4, 167.8, 169.6, 173.6, 179.6,</div>
<div class="line"><span class="lineno">  312</span>     187.9, 198.9, 210, 220.5, 229.2, 235.7, 239.9, 241.8, 241.6, 239.6,</div>
<div class="line"><span class="lineno">  313</span>     235.8, 229.4, 218.6, 200.9, 175.9, 149.4, 129.4, 118.3, 113.1,</div>
<div class="line"><span class="lineno">  314</span>     110.8, 109.7, 109.3, 109.4, 109.7, 110, 110.2, 110.4, 110.5, 110.7,</div>
<div class="line"><span class="lineno">  315</span>     111, 111.4, 111.8, 112.1, 112.3, 112.7, 113.2, 113.9, 115, 116.4,</div>
<div class="line"><span class="lineno">  316</span>     117.9, 120.4, 124.1, 130.9, 142.2, 159.6, 179.6, 198.5, 212.9,</div>
<div class="line"><span class="lineno">  317</span>     224.2, 232.7, 239.1, 243.8, 247.7, 252.4, 257.3, 263.2, 269.5,</div>
<div class="line"><span class="lineno">  318</span>     275.4, 281.1, 286.3, 292, 296.3, 298.2, 298.8},</div>
<div class="line"><span class="lineno">  319</span>    {166, 166.4, 155.7, 148.3, 147.1, 149, 152.1, 157, 163.6, 172.4,</div>
<div class="line"><span class="lineno">  320</span>     185.3, 199.2, 212.6, 224, 233.2, 239.6, 243.3, 244.6, 243.6, 240.3,</div>
<div class="line"><span class="lineno">  321</span>     233.9, 222.6, 203.7, 177, 149.5, 129.7, 119, 114, 111.7, 110.7,</div>
<div class="line"><span class="lineno">  322</span>     110.3, 110.3, 110.6, 110.9, 111.1, 111.3, 111.5, 111.6, 111.9,</div>
<div class="line"><span class="lineno">  323</span>     112.2, 112.5, 112.6, 112.8, 113, 113.4, 114, 115.1, 116.5, 118.3,</div>
<div class="line"><span class="lineno">  324</span>     120.9, 124.4, 130.2, 139.4, 154.6, 173.8, 193.1, 208.1, 220.4,</div>
<div class="line"><span class="lineno">  325</span>     230.1, 238.2, 244.7, 249.5, 254.5, 259.3, 264.5, 269.4, 273.7,</div>
<div class="line"><span class="lineno">  326</span>     278.2, 282.6, 287.4, 290.9, 292.5, 293},</div>
<div class="line"><span class="lineno">  327</span>    {171.9, 172.8, 166.2, 162.3, 161.4, 162.5, 165.2, 169.6, 175.3,</div>
<div class="line"><span class="lineno">  328</span>     183.1, 193.8, 205.9, 218.3, 229.6, 238.5, 244.3, 246.9, 246.7,</div>
<div class="line"><span class="lineno">  329</span>     243.8, 238.4, 230.2, 217.9, 199.6, 174.9, 148.9, 129.8, 119.5,</div>
<div class="line"><span class="lineno">  330</span>     114.8, 112.3, 110.9, 110.3, 110.1, 110.2, 110.3, 110.4, 110.5,</div>
<div class="line"><span class="lineno">  331</span>     110.6, 110.8, 111, 111.4, 111.8, 112, 112.2, 112.4, 112.9, 113.6,</div>
<div class="line"><span class="lineno">  332</span>     114.7, 116.3, 118.4, 121.9, 127.1, 136.1, 149.8, 168.4, 186.9,</div>
<div class="line"><span class="lineno">  333</span>     203.3, 217, 229.1, 238.7, 247, 254, 259.3, 264.3, 268.3, 272.5,</div>
<div class="line"><span class="lineno">  334</span>     276.6, 280.4, 284.4, 288.4, 293.3, 297.2, 298.7, 299.1},</div>
<div class="line"><span class="lineno">  335</span>    {191.6, 192.2, 189, 188.1, 190.2, 193.7, 197.8, 202.9, 208.5,</div>
<div class="line"><span class="lineno">  336</span>     215.6, 224.2, 233.1, 241.2, 247.3, 250.8, 251.3, 248.9, 244.2,</div>
<div class="line"><span class="lineno">  337</span>     237.3, 228.4, 217.2, 202.9, 184.5, 162.5, 140.7, 124.8, 116.2,</div>
<div class="line"><span class="lineno">  338</span>     111.8, 109.4, 107.9, 107, 106.7, 106.6, 106.6, 106.7, 106.7,</div>
<div class="line"><span class="lineno">  339</span>     106.8, 107, 107.4, 108, 108.7, 109.3, 109.8, 110.4, 111.2,</div>
<div class="line"><span class="lineno">  340</span>     112.4, 114.2, 116.9, 121.1, 127.9, 139.3, 155.2, 173.6, 190.7,</div>
<div class="line"><span class="lineno">  341</span>     206.1, 220.1, 232.3, 243, 251.8, 259.2, 265.7, 270.6, 275.3,</div>
<div class="line"><span class="lineno">  342</span>     279.3, 283.3, 286.9, 289.7, 292.8, 296.1, 300.5, 303.9, 304.8,</div>
<div class="line"><span class="lineno">  343</span>     305.1},</div>
<div class="line"><span class="lineno">  344</span>    {241.5, 239.6, 236.8, 237.4, 239.4, 242.3, 244.2, 246.4, 249.2,</div>
<div class="line"><span class="lineno">  345</span>     253.6, 258.6, 262.7, 264.8, 264.2, 260.6, 254.1, 245.5, 235.3,</div>
<div class="line"><span class="lineno">  346</span>     223.9, 211.7, 198.3, 183.1, 165.6, 147.1, 130.5, 118.7, 111.9,</div>
<div class="line"><span class="lineno">  347</span>     108.1, 105.8, 104.3, 103.4, 102.8, 102.5, 102.4, 102.5, 102.5,</div>
<div class="line"><span class="lineno">  348</span>     102.5, 102.7, 103.1, 103.8, 104.6, 105.4, 106.1, 107, 108.2,</div>
<div class="line"><span class="lineno">  349</span>     109.9, 112.8, 117.5, 126, 140.4, 161, 181.9, 201.2, 216.8, 230.4,</div>
<div class="line"><span class="lineno">  350</span>     241.8, 251.4, 259.9, 266.9, 272.8, 277.4, 280.4, 282.9, 284.6,</div>
<div class="line"><span class="lineno">  351</span>     286.1, 287.4, 288.3, 289.5, 290.9, 294.2, 296.9, 297.5, 297.6},</div>
<div class="line"><span class="lineno">  352</span>    {301.2, 300.3, 296.6, 295.4, 295, 294.3, 291.2, 287.4, 284.9, 284.7,</div>
<div class="line"><span class="lineno">  353</span>     284.1, 281.5, 277.1, 270.4, 261.7, 250.6, 237.6, 223.1, 207.9, 192,</div>
<div class="line"><span class="lineno">  354</span>     175.8, 158.8, 142.1, 127.6, 116.8, 109.9, 106, 103.6, 102.1, 101.1,</div>
<div class="line"><span class="lineno">  355</span>     100.4, 99.96, 99.6, 99.37, 99.32, 99.32, 99.31, 99.46, 99.77, 100.2,</div>
<div class="line"><span class="lineno">  356</span>     100.7, 101.3, 101.8, 102.7, 104.1, 106.8, 111.9, 121, 136.7, 160,</div>
<div class="line"><span class="lineno">  357</span>     186.9, 209.9, 228.1, 241.2, 251.5, 259.5, 265.7, 270.9, 274.8, 278,</div>
<div class="line"><span class="lineno">  358</span>     280.3, 281.8, 283, 283.3, 283.7, 283.8, 283, 282.2, 281.2, 281.4,</div>
<div class="line"><span class="lineno">  359</span>     281.7, 281.1, 281.2}</div>
<div class="line"><span class="lineno">  360</span>  };</div>
<div class="line"><span class="lineno">  361</span>  memcpy(clim-&gt;<a class="code hl_variable" href="structclim__t.html#ad357829e5b267a357fce1a27518e271f">tropo</a>, tropo, <span class="keyword">sizeof</span>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#ad357829e5b267a357fce1a27518e271f">tropo</a>));</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>  <span class="comment">/* Get range... */</span></div>
<div class="line"><span class="lineno">  364</span>  <span class="keywordtype">double</span> tropomin = 1e99, tropomax = -1e99;</div>
<div class="line"><span class="lineno">  365</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> it = 0; it &lt; clim-&gt;<a class="code hl_variable" href="structclim__t.html#a71b9c5664f017ee5f36db4aae204328a">tropo_ntime</a>; it++)</div>
<div class="line"><span class="lineno">  366</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; clim-&gt;<a class="code hl_variable" href="structclim__t.html#abe42300dd939b2409b3dbf37550e58f6">tropo_nlat</a>; iy++) {</div>
<div class="line"><span class="lineno">  367</span>      tropomin = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(tropomin, clim-&gt;<a class="code hl_variable" href="structclim__t.html#ad357829e5b267a357fce1a27518e271f">tropo</a>[it][iy]);</div>
<div class="line"><span class="lineno">  368</span>      tropomax = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(tropomax, clim-&gt;<a class="code hl_variable" href="structclim__t.html#ad357829e5b267a357fce1a27518e271f">tropo</a>[it][iy]);</div>
<div class="line"><span class="lineno">  369</span>    }</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno">  372</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of time steps: %d&quot;</span>, clim-&gt;<a class="code hl_variable" href="structclim__t.html#a71b9c5664f017ee5f36db4aae204328a">tropo_ntime</a>);</div>
<div class="line"><span class="lineno">  373</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time steps: %.2f, %.2f ... %.2f s&quot;</span>,</div>
<div class="line"><span class="lineno">  374</span>      clim-&gt;<a class="code hl_variable" href="structclim__t.html#ae2845f40329df2cf90838d1684617ada">tropo_time</a>[0], clim-&gt;<a class="code hl_variable" href="structclim__t.html#ae2845f40329df2cf90838d1684617ada">tropo_time</a>[1],</div>
<div class="line"><span class="lineno">  375</span>      clim-&gt;<a class="code hl_variable" href="structclim__t.html#ae2845f40329df2cf90838d1684617ada">tropo_time</a>[clim-&gt;<a class="code hl_variable" href="structclim__t.html#a71b9c5664f017ee5f36db4aae204328a">tropo_ntime</a> - 1]);</div>
<div class="line"><span class="lineno">  376</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of latitudes: %d&quot;</span>, clim-&gt;<a class="code hl_variable" href="structclim__t.html#abe42300dd939b2409b3dbf37550e58f6">tropo_nlat</a>);</div>
<div class="line"><span class="lineno">  377</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Latitudes: %g, %g ... %g deg&quot;</span>,</div>
<div class="line"><span class="lineno">  378</span>      clim-&gt;<a class="code hl_variable" href="structclim__t.html#aaaee23fbfbb65c1eb77daad5a003defa">tropo_lat</a>[0], clim-&gt;<a class="code hl_variable" href="structclim__t.html#aaaee23fbfbb65c1eb77daad5a003defa">tropo_lat</a>[1],</div>
<div class="line"><span class="lineno">  379</span>      clim-&gt;<a class="code hl_variable" href="structclim__t.html#aaaee23fbfbb65c1eb77daad5a003defa">tropo_lat</a>[clim-&gt;<a class="code hl_variable" href="structclim__t.html#abe42300dd939b2409b3dbf37550e58f6">tropo_nlat</a> - 1]);</div>
<div class="line"><span class="lineno">  380</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Tropopause altitude range: %g ... %g hPa&quot;</span>, <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(tropomax),</div>
<div class="line"><span class="lineno">  381</span>      <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(tropomin));</div>
<div class="line"><span class="lineno">  382</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Tropopause pressure range: %g ... %g hPa&quot;</span>, tropomin, tropomax);</div>
<div class="line"><span class="lineno">  383</span>}</div>
<div class="ttc" id="amptrac_8h_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdoc">Macro to determine the minimum of two values.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01138">mptrac.h:1138</a></div></div>
<div class="ttc" id="amptrac_8h_html_a58b4f1573922a1f73dd4bf014fd441bf"><div class="ttname"><a href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a></div><div class="ttdeci">#define Z(p)</div><div class="ttdoc">Convert pressure to altitude.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01880">mptrac.h:1880</a></div></div>
<div class="ttc" id="amptrac_8h_html_acaa1c3fa56061380a29889d703236251"><div class="ttname"><a href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a></div><div class="ttdeci">#define LOG(level,...)</div><div class="ttdoc">Print a log message with a specified logging level.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01973">mptrac.h:1973</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbf877af94269d0aa1c94b7c50121df8" name="acbf877af94269d0aa1c94b7c50121df8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbf877af94269d0aa1c94b7c50121df8">&#9670;&nbsp;</a></span>clim_ts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double clim_ts </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structclim__ts__t.html">clim_ts_t</a> *&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolates a time series of climatological variables. </p>
<p >This function interpolates a time series of climatological variables based on the input time and the provided data points.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ts</td><td>Pointer to the time series structure containing data points. </td></tr>
    <tr><td class="paramname">t</td><td>Time at which to interpolate the climatological variable (in seconds). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Interpolated value of the climatological variable at the given time.</dd></dl>
<p>This function performs linear interpolation between the closest data points to the input time <code>t</code>. If <code>t</code> is outside the range of the provided time series, the value at the nearest boundary is returned.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l00387">387</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  389</span>                  {</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>  <span class="comment">/* Interpolate... */</span></div>
<div class="line"><span class="lineno">  392</span>  <span class="keywordflow">if</span> (t &lt;= ts-&gt;time[0])</div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordflow">return</span> ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a0a87d48606ea13114cea09194ea0ddd4">vmr</a>[0];</div>
<div class="line"><span class="lineno">  394</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t &gt;= ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>[ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a5933a10768e95f718d876cddcaad9c04">ntime</a> - 1])</div>
<div class="line"><span class="lineno">  395</span>    <span class="keywordflow">return</span> ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a0a87d48606ea13114cea09194ea0ddd4">vmr</a>[ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a5933a10768e95f718d876cddcaad9c04">ntime</a> - 1];</div>
<div class="line"><span class="lineno">  396</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  397</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>, ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a5933a10768e95f718d876cddcaad9c04">ntime</a>, t);</div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>[idx], ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a0a87d48606ea13114cea09194ea0ddd4">vmr</a>[idx],</div>
<div class="line"><span class="lineno">  399</span>               ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>[idx + 1], ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a0a87d48606ea13114cea09194ea0ddd4">vmr</a>[idx + 1], t);</div>
<div class="line"><span class="lineno">  400</span>  }</div>
<div class="line"><span class="lineno">  401</span>}</div>
<div class="ttc" id="astructclim__ts__t_html_a0a87d48606ea13114cea09194ea0ddd4"><div class="ttname"><a href="structclim__ts__t.html#a0a87d48606ea13114cea09194ea0ddd4">clim_ts_t::vmr</a></div><div class="ttdeci">double vmr[CTS]</div><div class="ttdoc">Volume mixing ratio [ppv].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03316">mptrac.h:3316</a></div></div>
<div class="ttc" id="astructclim__ts__t_html_a213272025e3c95dfe779d2e8abf0bcf2"><div class="ttname"><a href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">clim_ts_t::time</a></div><div class="ttdeci">double time[CTS]</div><div class="ttdoc">Time [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03313">mptrac.h:3313</a></div></div>
<div class="ttc" id="astructclim__ts__t_html_a5933a10768e95f718d876cddcaad9c04"><div class="ttname"><a href="structclim__ts__t.html#a5933a10768e95f718d876cddcaad9c04">clim_ts_t::ntime</a></div><div class="ttdeci">int ntime</div><div class="ttdoc">Number of timesteps.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03310">mptrac.h:3310</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_acbf877af94269d0aa1c94b7c50121df8_cgraph.png" border="0" usemap="#amptrac_8h_acbf877af94269d0aa1c94b7c50121df8_cgraph" alt=""/></div>
<map name="amptrac_8h_acbf877af94269d0aa1c94b7c50121df8_cgraph" id="amptrac_8h_acbf877af94269d0aa1c94b7c50121df8_cgraph">
<area shape="rect" title="Interpolates a time series of climatological variables." alt="" coords="5,5,69,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="117,5,192,32"/>
</map>
</div>

</div>
</div>
<a id="a41f5ab8ff7acad400fe7332b6b53288a" name="a41f5ab8ff7acad400fe7332b6b53288a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41f5ab8ff7acad400fe7332b6b53288a">&#9670;&nbsp;</a></span>clim_zm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double clim_zm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structclim__zm__t.html">clim_zm_t</a> *&#160;</td>
          <td class="paramname"><em>zm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolates monthly mean zonal mean climatological variables. </p>
<p >This function interpolates climatological variables based on pressure, latitude, and time. The climatological data is provided in the form of monthly mean zonal mean values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">zm</td><td>Pointer to the climatological zonal mean structure containing data points. </td></tr>
    <tr><td class="paramname">t</td><td>Time at which to interpolate the climatological variable (in seconds since the beginning of the year). </td></tr>
    <tr><td class="paramname">lat</td><td>Latitude at which to interpolate the climatological variable (in degrees). </td></tr>
    <tr><td class="paramname">p</td><td>Pressure at which to interpolate the climatological variable (in hPa). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Interpolated value of the climatological variable at the given pressure, latitude, and time.</dd></dl>
<p>This function performs trilinear interpolation between the nearest data points to the input time <code>t</code>, latitude <code>lat</code>, and pressure or altitude <code>p</code>. If the input values are outside the range of the provided data, the function extrapolates by using the nearest boundary values.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l00405">405</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  409</span>                  {</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>  <span class="comment">/* Get seconds since begin of year... */</span></div>
<div class="line"><span class="lineno">  412</span>  <span class="keywordtype">double</span> sec = <a class="code hl_define" href="mptrac_8h.html#aff4e721b49a057c4e4a3a6f56cc06469">FMOD</a>(t, 365.25 * 86400.);</div>
<div class="line"><span class="lineno">  413</span>  <span class="keywordflow">while</span> (sec &lt; 0)</div>
<div class="line"><span class="lineno">  414</span>    sec += 365.25 * 86400.;</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>  <span class="comment">/* Check pressure range... */</span></div>
<div class="line"><span class="lineno">  417</span>  <span class="keywordtype">double</span> p_help = p;</div>
<div class="line"><span class="lineno">  418</span>  <span class="keywordflow">if</span> (p &lt; zm-&gt;p[zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a> - 1])</div>
<div class="line"><span class="lineno">  419</span>    p_help = zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a> - 1];</div>
<div class="line"><span class="lineno">  420</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p &gt; zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[0])</div>
<div class="line"><span class="lineno">  421</span>    p_help = zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[0];</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>  <span class="comment">/* Check latitude range... */</span></div>
<div class="line"><span class="lineno">  424</span>  <span class="keywordtype">double</span> lat_help = lat;</div>
<div class="line"><span class="lineno">  425</span>  <span class="keywordflow">if</span> (lat &lt; zm-&gt;lat[0])</div>
<div class="line"><span class="lineno">  426</span>    lat_help = zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[0];</div>
<div class="line"><span class="lineno">  427</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lat &gt; zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">nlat</a> - 1])</div>
<div class="line"><span class="lineno">  428</span>    lat_help = zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">nlat</a> - 1];</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>  <span class="comment">/* Get indices... */</span></div>
<div class="line"><span class="lineno">  431</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> isec = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aa852df9602b1dfd0cbf453159dbf0e41">ntime</a>, sec);</div>
<div class="line"><span class="lineno">  432</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ilat = <a class="code hl_function" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">nlat</a>, lat_help);</div>
<div class="line"><span class="lineno">  433</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ip = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a>, p_help);</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>  <span class="comment">/* Interpolate climatology data... */</span></div>
<div class="line"><span class="lineno">  436</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux00 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[ip], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[isec][ip][ilat],</div>
<div class="line"><span class="lineno">  437</span>                           zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[ip + 1], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[isec][ip + 1][ilat],</div>
<div class="line"><span class="lineno">  438</span>                           p_help);</div>
<div class="line"><span class="lineno">  439</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux01 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[ip], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[isec][ip][ilat + 1],</div>
<div class="line"><span class="lineno">  440</span>                           zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[ip + 1], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[isec][ip + 1][ilat + 1],</div>
<div class="line"><span class="lineno">  441</span>                           p_help);</div>
<div class="line"><span class="lineno">  442</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux10 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[ip], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[isec + 1][ip][ilat],</div>
<div class="line"><span class="lineno">  443</span>                           zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[ip + 1], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[isec + 1][ip + 1][ilat],</div>
<div class="line"><span class="lineno">  444</span>                           p_help);</div>
<div class="line"><span class="lineno">  445</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux11 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[ip], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[isec + 1][ip][ilat + 1],</div>
<div class="line"><span class="lineno">  446</span>                           zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[ip + 1], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[isec + 1][ip + 1][ilat + 1],</div>
<div class="line"><span class="lineno">  447</span>                           p_help);</div>
<div class="line"><span class="lineno">  448</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux0 =</div>
<div class="line"><span class="lineno">  449</span>    <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[ilat], aux00, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[ilat + 1], aux01, lat_help);</div>
<div class="line"><span class="lineno">  450</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux1 =</div>
<div class="line"><span class="lineno">  451</span>    <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[ilat], aux10, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[ilat + 1], aux11, lat_help);</div>
<div class="line"><span class="lineno">  452</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[isec], aux0, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[isec + 1], aux1, sec);</div>
<div class="line"><span class="lineno">  453</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(aux, 0.0);</div>
<div class="line"><span class="lineno">  454</span>}</div>
<div class="ttc" id="astructclim__zm__t_html_a680339d53df354552c42829876d1271f"><div class="ttname"><a href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">clim_zm_t::p</a></div><div class="ttdeci">double p[CP]</div><div class="ttdoc">Pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03345">mptrac.h:3345</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a41f5ab8ff7acad400fe7332b6b53288a_cgraph.png" border="0" usemap="#amptrac_8h_a41f5ab8ff7acad400fe7332b6b53288a_cgraph" alt=""/></div>
<map name="amptrac_8h_a41f5ab8ff7acad400fe7332b6b53288a_cgraph" id="amptrac_8h_a41f5ab8ff7acad400fe7332b6b53288a_cgraph">
<area shape="rect" title="Interpolates monthly mean zonal mean climatological variables." alt="" coords="5,31,76,57"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="128,5,203,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="124,56,207,83"/>
</map>
</div>

</div>
</div>
<a id="a2e72346e130df723f0e0bec4eb739b14" name="a2e72346e130df723f0e0bec4eb739b14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e72346e130df723f0e0bec4eb739b14">&#9670;&nbsp;</a></span>compress_cms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compress_cms </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>plev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>decompress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>inout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compresses or decompresses a 3-D meteorological field using cmultiscale. </p>
<p >This routine operates on a longitude/latitude regular grid of size <code>nx</code>  <code>ny</code> and <code>np</code> vertical levels. The grid coordinates are generated internally:</p><ul>
<li>lon  [0, 360] (inclusive) with <code>nx</code> points</li>
<li>lat  [ 90,-90] (inclusive) with <code>ny</code> points</li>
</ul>
<p >If <code>decompress</code> is non-zero, the function reads <code>np</code> CMS solutions from <code>inout</code> (optionally using Zstd), evaluates them on the lon/lat grid, and fills <code>array</code> (3-D layout via ARRAY_3D macro).</p>
<p >If <code>decompress</code> is zero, the function processes the input <code>array</code> level-by-level:</p><ul>
<li>selects the CMS error threshold (eps) based on <code>varname</code> (e.g., "T","U","V",...)</li>
<li>builds CMS solutions from the level data (coarsening)</li>
<li>evaluates the reconstructed field and logs basic error metrics (bias, stddev, RMSE/NRMSE, correlation)</li>
<li>writes CMS solutions to <code>inout</code> (optionally using Zstd)</li>
</ul>
<p >The overall compression ratio reported in logs is the harmonic mean across levels.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Control/settings structure providing CMS parameters (Nd0, max level, eps per variable, batching, and whether to use Zstd for I/O). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">varname</td><td>Variable name used for selecting the CMS epsilon threshold (case-insensitive). Supported names include: "Z","T","U","V","W","PV","H2O","O3","LWC","RWC","IWC","SWC","CC". </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">array</td><td>Field data buffer.<ul>
<li>Decompress mode: output array filled with reconstructed values.</li>
<li>Compress mode: input array to be compressed. Expected indexing uses <a class="el" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26" title="Compute the linear index of a 3D array element.">ARRAY_3D(ix, iy, ny, ip, np)</a>. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>Number of longitude grid points (must be &gt;= 2). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Number of latitude grid points (must be &gt;= 2). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">np</td><td>Number of vertical levels (pressure levels). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plev</td><td>Pressure levels array of length <code>np</code> (used for logging). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">decompress</td><td>If non-zero, read CMS stream from <code>inout</code> and reconstruct <code>array</code>. If zero, build CMS solutions from <code>array</code> and write them to <code>inout</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">inout</td><td>Binary stream used for CMS I/O:<ul>
<li>Decompress mode: read from this stream.</li>
<li>Compress mode: write to this stream.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Uses OpenMP for parallel evaluation/coarsening, and GSL for statistics in compression mode. </dd>
<dd>
The function allocates temporary per-level buffers in compression mode and frees them internally. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><code>varname</code> must match one of the supported variable names; otherwise an error is raised.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

</div>
</div>
<a id="a61bbe35a4ff7b797fdb64f9797a3ffd1" name="a61bbe35a4ff7b797fdb64f9797a3ffd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61bbe35a4ff7b797fdb64f9797a3ffd1">&#9670;&nbsp;</a></span>compress_pck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compress_pck </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>nxy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>decompress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>inout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compresses or decompresses a 3D array of floats. </p>
<p >This function either compresses or decompresses a 3D array of floats based on the value of the <code>decompress</code> parameter. Compression reduces the storage size by converting float values (4 bytes) to unsigned short values (2 bytes) with scaling and offset. Decompression restores the original float values from the compressed unsigned short representation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varname</td><td>The name of the variable being processed. </td></tr>
    <tr><td class="paramname">array</td><td>Pointer to the 3D array of floats to be compressed or decompressed. </td></tr>
    <tr><td class="paramname">nxy</td><td>The number of elements in the first two dimensions of the array. </td></tr>
    <tr><td class="paramname">nz</td><td>The number of elements in the third dimension of the array. </td></tr>
    <tr><td class="paramname">decompress</td><td>If non-zero, the function will decompress the data; otherwise, it will compress the data. </td></tr>
    <tr><td class="paramname">inout</td><td>File pointer for input or output operations. It is used for reading compressed data during decompression and writing compressed data during compression.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>If decompressing:<ul>
<li>Reads scaling factors, offsets, and compressed data from the file.</li>
<li>Decompresses the data and stores it in the <code>array</code>.</li>
</ul>
</li>
<li>If compressing:<ul>
<li>Computes the minimum and maximum values for each slice in the third dimension.</li>
<li>Calculates scaling factors and offsets based on these values.</li>
<li>Compresses the data by converting floats to unsigned shorts using the scaling factors and offsets.</li>
<li>Writes the scaling factors, offsets, and compressed data to the file.</li>
</ul>
</li>
</ul>
<p >The function allocates memory for the compressed data array and frees it before returning.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l00680">680</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  686</span>               {</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span>  <span class="keywordtype">double</span> min[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], max[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], off[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], scl[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>];</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *sarray;</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">  693</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(sarray, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>,</div>
<div class="line"><span class="lineno">  694</span>        nxy * nz);</div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>  <span class="comment">/* Read compressed stream and decompress array... */</span></div>
<div class="line"><span class="lineno">  697</span>  <span class="keywordflow">if</span> (decompress) {</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno">  700</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read 3-D variable: %s (pck, RATIO= %g)&quot;</span>,</div>
<div class="line"><span class="lineno">  701</span>        varname, (<span class="keywordtype">double</span>) <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) / (<span class="keywordtype">double</span>) <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>));</div>
<div class="line"><span class="lineno">  702</span> </div>
<div class="line"><span class="lineno">  703</span>    <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno">  704</span>    <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;scl, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">  705</span>          nz,</div>
<div class="line"><span class="lineno">  706</span>          inout);</div>
<div class="line"><span class="lineno">  707</span>    <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;off, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">  708</span>          nz,</div>
<div class="line"><span class="lineno">  709</span>          inout);</div>
<div class="line"><span class="lineno">  710</span>    <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(sarray, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>,</div>
<div class="line"><span class="lineno">  711</span>          nxy * nz,</div>
<div class="line"><span class="lineno">  712</span>          inout);</div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span>    <span class="comment">/* Convert to float... */</span></div>
<div class="line"><span class="lineno">  715</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">  716</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ixy = 0; ixy &lt; nxy; ixy++)</div>
<div class="line"><span class="lineno">  717</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iz = 0; iz &lt; nz; iz++)</div>
<div class="line"><span class="lineno">  718</span>        array[ixy * nz + iz]</div>
<div class="line"><span class="lineno">  719</span>          = (<span class="keywordtype">float</span>) (sarray[ixy * nz + iz] * scl[iz] + off[iz]);</div>
<div class="line"><span class="lineno">  720</span>  }</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>  <span class="comment">/* Compress array and output compressed stream... */</span></div>
<div class="line"><span class="lineno">  723</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno">  726</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Write 3-D variable: %s (pck, RATIO= %g)&quot;</span>,</div>
<div class="line"><span class="lineno">  727</span>        varname, (<span class="keywordtype">double</span>) <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) / (<span class="keywordtype">double</span>) <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>));</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>    <span class="comment">/* Get range... */</span></div>
<div class="line"><span class="lineno">  730</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iz = 0; iz &lt; nz; iz++) {</div>
<div class="line"><span class="lineno">  731</span>      min[iz] = array[iz];</div>
<div class="line"><span class="lineno">  732</span>      max[iz] = array[iz];</div>
<div class="line"><span class="lineno">  733</span>    }</div>
<div class="line"><span class="lineno">  734</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ixy = 1; ixy &lt; nxy; ixy++)</div>
<div class="line"><span class="lineno">  735</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iz = 0; iz &lt; nz; iz++) {</div>
<div class="line"><span class="lineno">  736</span>        <span class="keywordflow">if</span> (array[ixy * nz + iz] &lt; min[iz])</div>
<div class="line"><span class="lineno">  737</span>          min[iz] = array[ixy * nz + iz];</div>
<div class="line"><span class="lineno">  738</span>        <span class="keywordflow">if</span> (array[ixy * nz + iz] &gt; max[iz])</div>
<div class="line"><span class="lineno">  739</span>          max[iz] = array[ixy * nz + iz];</div>
<div class="line"><span class="lineno">  740</span>      }</div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>    <span class="comment">/* Get offset and scaling factor... */</span></div>
<div class="line"><span class="lineno">  743</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iz = 0; iz &lt; nz; iz++) {</div>
<div class="line"><span class="lineno">  744</span>      scl[iz] = (max[iz] - min[iz]) / 65533.;</div>
<div class="line"><span class="lineno">  745</span>      off[iz] = min[iz];</div>
<div class="line"><span class="lineno">  746</span>    }</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>    <span class="comment">/* Convert to short... */</span></div>
<div class="line"><span class="lineno">  749</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">  750</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ixy = 0; ixy &lt; nxy; ixy++)</div>
<div class="line"><span class="lineno">  751</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iz = 0; iz &lt; nz; iz++)</div>
<div class="line"><span class="lineno">  752</span>        <span class="keywordflow">if</span> (scl[iz] != 0)</div>
<div class="line"><span class="lineno">  753</span>          sarray[ixy * nz + iz] = (<span class="keywordtype">unsigned</span> short)</div>
<div class="line"><span class="lineno">  754</span>            ((array[ixy * nz + iz] - off[iz]) / scl[iz] + .5);</div>
<div class="line"><span class="lineno">  755</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  756</span>          sarray[ixy * nz + iz] = 0;</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>    <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">  759</span>    <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;scl, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">  760</span>           nz,</div>
<div class="line"><span class="lineno">  761</span>           inout);</div>
<div class="line"><span class="lineno">  762</span>    <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;off, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">  763</span>           nz,</div>
<div class="line"><span class="lineno">  764</span>           inout);</div>
<div class="line"><span class="lineno">  765</span>    <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(sarray, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>,</div>
<div class="line"><span class="lineno">  766</span>           nxy * nz,</div>
<div class="line"><span class="lineno">  767</span>           inout);</div>
<div class="line"><span class="lineno">  768</span>  }</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">  771</span>  free(sarray);</div>
<div class="line"><span class="lineno">  772</span>}</div>
<div class="ttc" id="amptrac_8h_html_a1e67562ddd8fb52548a4ca02d3640bac"><div class="ttname"><a href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a></div><div class="ttdeci">#define FWRITE(ptr, type, size, out)</div><div class="ttdoc">Write data from memory to a file stream.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00818">mptrac.h:818</a></div></div>
<div class="ttc" id="amptrac_8h_html_a68e3272a6f873b919d4f6d8982042a50"><div class="ttname"><a href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a></div><div class="ttdeci">#define FREAD(ptr, type, size, in)</div><div class="ttdoc">Read data from a file stream and store it in memory.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00798">mptrac.h:798</a></div></div>
<div class="ttc" id="amptrac_8h_html_a9aee3e5daf3b1051597d21ab093adbd0"><div class="ttname"><a href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a></div><div class="ttdeci">#define ALLOC(ptr, type, n)</div><div class="ttdoc">Allocate memory for a pointer with error handling.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00416">mptrac.h:416</a></div></div>
<div class="ttc" id="amptrac_8h_html_adb5bf6fbe6405b09bad71e89e1da5850"><div class="ttname"><a href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a></div><div class="ttdeci">#define EP</div><div class="ttdoc">Maximum number of pressure levels for meteo data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00283">mptrac.h:283</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae686ad6d0ce087fddcd62a7b87c768f3" name="ae686ad6d0ce087fddcd62a7b87c768f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae686ad6d0ce087fddcd62a7b87c768f3">&#9670;&nbsp;</a></span>compress_sz3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compress_sz3 </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>precision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>decompress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>inout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compresses or decompresses a 3-D float array using the SZ3 library. </p>
<p >This function either compresses a 3-D floating-point array and writes it to a file stream, or reads compressed SZ3 data from a file stream and decompresses it into the provided array. The SZ3 error bound can be specified either by relative precision (bits) or absolute tolerance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varname</td><td>Name of the variable (used for logging). </td></tr>
    <tr><td class="paramname">array</td><td>Pointer to the 3-D float array (input for compression, output for decompression). </td></tr>
    <tr><td class="paramname">nx</td><td>Size of the first dimension. </td></tr>
    <tr><td class="paramname">ny</td><td>Size of the second dimension. </td></tr>
    <tr><td class="paramname">nz</td><td>Size of the third dimension. </td></tr>
    <tr><td class="paramname">precision</td><td>Relative precision in bits (used if &gt; 0; tolerance must be 0). </td></tr>
    <tr><td class="paramname">tolerance</td><td>Absolute error bound (used if &gt; 0; precision must be 0). </td></tr>
    <tr><td class="paramname">decompress</td><td>Non-zero to decompress data from <code>inout</code> into <code>array</code>; zero to compress <code>array</code> into <code>inout</code>. </td></tr>
    <tr><td class="paramname">inout</td><td>File stream for reading/writing compressed data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Exactly one of <code>precision</code> or <code>tolerance</code> must be set to a positive value. </dd>
<dd>
The SZ3 data type is fixed to <code>SZ_FLOAT</code> for this function.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">ERRMSG</td><td>if input parameters are invalid, memory allocation fails, compression/decompression fails, or file I/O errors occur.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>SZ_compress_args </dd>
<dd>
SZ_decompress</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

</div>
</div>
<a id="a412570d903373ea3f6ca36aa907f3d72" name="a412570d903373ea3f6ca36aa907f3d72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a412570d903373ea3f6ca36aa907f3d72">&#9670;&nbsp;</a></span>compress_zfp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compress_zfp </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>precision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>decompress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>inout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compresses or decompresses a 3D array of floats using the ZFP library. </p>
<p >This function either compresses or decompresses a 3D array of floats based on the value of the <code>decompress</code> parameter. Compression reduces the storage size using the ZFP compression algorithm, which supports fixed-precision or fixed-accuracy modes. Decompression restores the original float values from the compressed representation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varname</td><td>The name of the variable being processed. </td></tr>
    <tr><td class="paramname">array</td><td>Pointer to the 3D array of floats to be compressed or decompressed. </td></tr>
    <tr><td class="paramname">nx</td><td>The number of elements in the x-dimension of the array. </td></tr>
    <tr><td class="paramname">ny</td><td>The number of elements in the y-dimension of the array. </td></tr>
    <tr><td class="paramname">nz</td><td>The number of elements in the z-dimension of the array. </td></tr>
    <tr><td class="paramname">precision</td><td>The precision parameter for ZFP compression. If greater than 0, it sets the fixed precision mode. </td></tr>
    <tr><td class="paramname">tolerance</td><td>The tolerance parameter for ZFP compression. If greater than 0 and precision is 0, it sets the fixed accuracy mode. </td></tr>
    <tr><td class="paramname">decompress</td><td>If non-zero, the function will decompress the data; otherwise, it will compress the data. </td></tr>
    <tr><td class="paramname">inout</td><td>File pointer for input or output operations. It is used for reading compressed data during decompression and writing compressed data during compression.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Allocates metadata for the 3D array and the ZFP compressed stream.</li>
<li>Sets the compression mode based on the precision or tolerance parameters.</li>
<li>Allocates a buffer for the compressed data.</li>
<li>Associates a bit stream with the allocated buffer and sets up the ZFP stream.</li>
<li>If decompressing:<ul>
<li>Reads the size of the compressed data and the compressed data itself from the file.</li>
<li>Decompresses the data and stores it in the <code>array</code>.</li>
</ul>
</li>
<li>If compressing:<ul>
<li>Compresses the data and writes the compressed data size and the compressed data itself to the file.</li>
</ul>
</li>
</ul>
<p >The function logs the compression or decompression details and frees allocated resources before returning.</p>
<dl class="section note"><dt>Note</dt><dd>Ensure that either the precision or tolerance parameter is set to a value greater than 0.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

</div>
</div>
<a id="a057bb032e8b5df1b2a228b9b7931dd0c" name="a057bb032e8b5df1b2a228b9b7931dd0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a057bb032e8b5df1b2a228b9b7931dd0c">&#9670;&nbsp;</a></span>compress_zstd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compress_zstd </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>decompress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>inout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compresses or decompresses a float array using Zstandard (ZSTD). </p>
<p >This function either compresses a given float array and writes the result to a file, or reads compressed data from a file and decompresses it into the array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">varname</td><td>Name of the variable, used for logging. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">array</td><td>Pointer to the float array to compress or to fill with decompressed data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of float elements in the array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">decompress</td><td>If non-zero, perform decompression; otherwise, perform compression. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>Compression level (-5 to 22). Use 0 for the ZSTD default. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">inout</td><td>File pointer for input/output. Used for reading or writing compressed data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function uses ZSTD's simple one-shot compression API (ZSTD_compress), which does not support multithreaded compression.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The function allocates temporary memory for the compressed buffer and frees it internally. Ensure <code>array</code> has sufficient space for uncompressed data.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

</div>
</div>
<a id="a1c8c72b0bc66d214b4575c13a7a0eb6b" name="a1c8c72b0bc66d214b4575c13a7a0eb6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c8c72b0bc66d214b4575c13a7a0eb6b">&#9670;&nbsp;</a></span>cos_sza()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cos_sza </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the cosine of the solar zenith angle. </p>
<p >This function computes the cosine of the solar zenith angle (SZA), which describes the angle between the local zenith (straight up) and the line connecting the observer to the center of the Sun. The cosine of the SZA is often used directly in radiative transfer and photochemical calculations to avoid unnecessary use of trigonometric inverse functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sec</td><td>Seconds elapsed since 2000-01-01T12:00Z. </td></tr>
    <tr><td class="paramname">lon</td><td>Observer's longitude in degrees. </td></tr>
    <tr><td class="paramname">lat</td><td>Observer's latitude in degrees. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The cosine of the solar zenith angle (dimensionless, range [-1, 1]).</dd></dl>
<p>The cosine of the solar zenith angle is computed based on the observer's position (longitude and latitude) and the specified time in seconds elapsed since 2000-01-01T12:00Z.</p>
<dl class="section note"><dt>Note</dt><dd>The input longitude and latitude must be specified in degrees.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>acos()  can be used to convert the returned value to the solar zenith angle in radians if needed.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l01011">1011</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1014</span>                    {</div>
<div class="line"><span class="lineno"> 1015</span> </div>
<div class="line"><span class="lineno"> 1016</span>  <span class="comment">/* Number of days and fraction with respect to 2000-01-01T12:00Z... */</span></div>
<div class="line"><span class="lineno"> 1017</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> D = sec / 86400 - 0.5;</div>
<div class="line"><span class="lineno"> 1018</span> </div>
<div class="line"><span class="lineno"> 1019</span>  <span class="comment">/* Geocentric apparent ecliptic longitude [rad]... */</span></div>
<div class="line"><span class="lineno"> 1020</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> g = <a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(357.529 + 0.98560028 * D);</div>
<div class="line"><span class="lineno"> 1021</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> q = 280.459 + 0.98564736 * D;</div>
<div class="line"><span class="lineno"> 1022</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> L = <a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(q + 1.915 * sin(g) + 0.020 * sin(2 * g));</div>
<div class="line"><span class="lineno"> 1023</span> </div>
<div class="line"><span class="lineno"> 1024</span>  <span class="comment">/* Mean obliquity of the ecliptic [rad]... */</span></div>
<div class="line"><span class="lineno"> 1025</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> e = <a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(23.439 - 0.00000036 * D);</div>
<div class="line"><span class="lineno"> 1026</span> </div>
<div class="line"><span class="lineno"> 1027</span>  <span class="comment">/* Declination [rad]... */</span></div>
<div class="line"><span class="lineno"> 1028</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> sindec = sin(e) * sin(L);</div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span>  <span class="comment">/* Right ascension [rad]... */</span></div>
<div class="line"><span class="lineno"> 1031</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ra = atan2(cos(e) * sin(L), cos(L));</div>
<div class="line"><span class="lineno"> 1032</span> </div>
<div class="line"><span class="lineno"> 1033</span>  <span class="comment">/* Greenwich Mean Sidereal Time [h]... */</span></div>
<div class="line"><span class="lineno"> 1034</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> GMST = 18.697374558 + 24.06570982441908 * D;</div>
<div class="line"><span class="lineno"> 1035</span> </div>
<div class="line"><span class="lineno"> 1036</span>  <span class="comment">/* Local Sidereal Time [h]... */</span></div>
<div class="line"><span class="lineno"> 1037</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> LST = GMST + lon / 15;</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>  <span class="comment">/* Hour angle [rad]... */</span></div>
<div class="line"><span class="lineno"> 1040</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> h = LST / 12 * M_PI - ra;</div>
<div class="line"><span class="lineno"> 1041</span> </div>
<div class="line"><span class="lineno"> 1042</span>  <span class="comment">/* Convert latitude... */</span></div>
<div class="line"><span class="lineno"> 1043</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> lat_help = <a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(lat);</div>
<div class="line"><span class="lineno"> 1044</span> </div>
<div class="line"><span class="lineno"> 1045</span>  <span class="comment">/* Return cosine of solar zenith angle... */</span></div>
<div class="line"><span class="lineno"> 1046</span>  <span class="keywordflow">return</span> sin(lat_help) * sindec + cos(lat_help) * sqrt(1 -</div>
<div class="line"><span class="lineno"> 1047</span>                                                       <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(sindec)) * cos(h);</div>
<div class="line"><span class="lineno"> 1048</span>}</div>
<div class="ttc" id="amptrac_8h_html_aa7866fa5e4e0ee9b034e9dab6599a9cc"><div class="ttname"><a href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a></div><div class="ttdeci">#define SQR(x)</div><div class="ttdoc">Compute the square of a value.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01696">mptrac.h:1696</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0816a7fc51af1fbaf5146435baf29f82" name="a0816a7fc51af1fbaf5146435baf29f82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0816a7fc51af1fbaf5146435baf29f82">&#9670;&nbsp;</a></span>day2doy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void day2doy </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>doy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get day of year from date. </p>
<p >Converts a given date to the day of the year (DOY).</p>
<p >This function computes the day of the year (DOY) for a given date specified by the year, month, and day. It takes into account whether the given year is a leap year or not.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">year</td><td>The year of the date. </td></tr>
    <tr><td class="paramname">mon</td><td>The month of the date (1-12). </td></tr>
    <tr><td class="paramname">day</td><td>The day of the month (1-31). </td></tr>
    <tr><td class="paramname">doy</td><td>Pointer to an integer where the computed day of the year will be stored.</td></tr>
  </table>
  </dd>
</dl>
<p>The function uses two arrays, <code>d0</code> and <code>d0l</code>, which contain the cumulative number of days at the start of each month for non-leap years and leap years respectively. It checks if the year is a leap year and calculates the day of the year accordingly.</p>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the input date is valid.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l01052">1052</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1056</span>            {</div>
<div class="line"><span class="lineno"> 1057</span> </div>
<div class="line"><span class="lineno"> 1058</span>  <span class="keyword">const</span> <span class="keywordtype">int</span></div>
<div class="line"><span class="lineno"> 1059</span>    d0[12] = { 1, 32, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335 },</div>
<div class="line"><span class="lineno"> 1060</span>    d0l[12] = { 1, 32, 61, 92, 122, 153, 183, 214, 245, 275, 306, 336 };</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>  <span class="comment">/* Get day of year... */</span></div>
<div class="line"><span class="lineno"> 1063</span>  <span class="keywordflow">if</span> (year % 400 == 0 || (year % 100 != 0 &amp;&amp; year % 4 == 0))</div>
<div class="line"><span class="lineno"> 1064</span>    *doy = d0l[mon - 1] + day - 1;</div>
<div class="line"><span class="lineno"> 1065</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1066</span>    *doy = d0[mon - 1] + day - 1;</div>
<div class="line"><span class="lineno"> 1067</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad70990693ea72717320cca5278d230fc" name="ad70990693ea72717320cca5278d230fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad70990693ea72717320cca5278d230fc">&#9670;&nbsp;</a></span>dd_assign_rect_subdomains_atm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_assign_rect_subdomains_atm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assign atmospheric particles to rectangular subdomains. </p>
<p >This function classifies particles in an atmospheric model into subdomains defined by the domain decomposition (<code>dd</code>). Depending on whether this is the initial assignment (<code>init</code> != 0) or a subsequent reclassification, it either:</p><ul>
<li>Assigns each particle to the local subdomain based on longitude and latitude coordinates.</li>
<li>Updates particle destinations when they cross subdomain boundaries, using neighbor information.</li>
</ul>
<p >Longitude values are wrapped into the [0, 360) range to ensure consistency, and boundary conditions at the left and right edges of the domain are handled explicitly. Particles falling outside the subdomain bounds are marked with <code>-1</code> during initialization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atm</td><td>Pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing particle data:<ul>
<li><code>atm-&gt;lon</code>, <code>atm-&gt;lat</code> : particle coordinates</li>
<li><code>atm-&gt;q</code> : classification arrays, indexed by <code>ctl-&gt;qnt_subdomain</code> and <code>ctl-&gt;qnt_destination</code>. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters, including subdomain indices and query IDs (e.g., <code>ctl-&gt;qnt_subdomain</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dd</td><td>Pointer to a <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing decomposition information:<ul>
<li>rank, size</li>
<li>longitude/latitude subdomain bounds</li>
<li>neighbor ranks (<code>dd-&gt;neighbours</code>). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">init</td><td>Flag indicating whether this is the initial assignment (<code>init</code> != 0) or a reclassification (<code>init</code> == 0).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Parallelization is supported with OpenACC if compiled with <code>_OPENACC</code>.</li>
<li>Neighbor indices in <code>dd-&gt;neighbours</code> follow a directional convention (left, right, up, down, and diagonals).</li>
<li>Particles that do not belong to any subdomain are set to <code>-1</code> during initialization.</li>
<li>Optional logic for handling particles at the poles is provided but currently disabled.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

</div>
</div>
<a id="a8eac9efef5c2ad6768e59729a813f89e" name="a8eac9efef5c2ad6768e59729a813f89e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eac9efef5c2ad6768e59729a813f89e">&#9670;&nbsp;</a></span>dd_atm2particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_atm2particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparticle__t.html">particle_t</a> *&#160;</td>
          <td class="paramname"><em>particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nparticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extracts particles from an atmospheric state and prepares them for inter-domain transfer. </p>
<p >This routine scans the atmospheric arrays for particles that should be transferred to another MPI/OpenMP/OpenACC rank (i.e., particles whose destination subdomain differs from the current <code>rank</code>). For each such particle, the function copies its prognostic variables (time, position, pressure, tracers) into the <code>particles</code> buffer and marks the particle in the atmospheric fields as inactive by setting its subdomain flag to -1.</p>
<p >Additionally, the particle's timestep entry in <code>cache</code> is reset so that the receiving process can re-initialize it. <br  />
</p>
<p >If compiled with OpenACC, the function also manages the corresponding device data movement for <code>particles</code> and <code>nparticles</code>, and performs the selection loop on the accelerator.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atm</td><td>Pointer to the atmospheric state. Particle properties (time, lon, lat, pressure, tracer fields) are read from this structure. The particles subdomain field is overwritten and set to -1 for particles selected for transfer.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">particles</td><td>Output buffer where selected particles are copied. The array must be allocated to hold at least <code>*nparticles</code> entries. Indexing is relative to <code>atm-&gt;np</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Model control structure containing metadata such as the number of tracers (<code>ctl-&gt;nq</code>), and indices of relevant tracer fields (<code>ctl-&gt;qnt_destination</code>, <code>ctl-&gt;qnt_subdomain</code>).</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nparticles</td><td>On input, the number of particles to inspect (particles with indices <code>[atm-&gt;np, atm-&gt;np + *nparticles)</code>). <br  />
 On output, unchanged. Device copies may be created or updated when using OpenACC.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cache</td><td>Cache structure used to store per-particle timestep values. For each particle selected for transfer, <code>cache-&gt;dt[ip]</code> is set to 0.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rank</td><td>Rank of the current processing unit. Particles whose destination field does not match <code>rank</code> are selected for transfer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Particle selection criteria:<ul>
<li><code>atm-&gt;q[ctl-&gt;qnt_destination][ip] != rank</code></li>
<li>destination index &gt;= 0</li>
<li>subdomain index &gt;= 0</li>
</ul>
</dd>
<dd>
The function logs each particle prepared for transfer (verbosity level 3).</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This routine modifies the atmospheric arrays in place. Any subsequent operations should treat selected particles as removed/inactive until they are reconstructed or replaced by incoming particles.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

</div>
</div>
<a id="aa30aab901e2920353694e0e14d8823c8" name="aa30aab901e2920353694e0e14d8823c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa30aab901e2920353694e0e14d8823c8">&#9670;&nbsp;</a></span>dd_calc_subdomain_from_coords()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dd_calc_subdomain_from_coords </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mpi_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx_glob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny_glob</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the destination subdomain (MPI rank) for a particle based on its geographic coordinates. </p>
<p >This function determines which distributed-memory subdomain a particle belongs to, given its longitude and latitude. It performs several steps:</p>
<ul>
<li>Wraps longitude into the canonical range [0, 360).</li>
<li>Wraps latitudes that cross the poles (&gt;90 or &lt;90 degrees) by reflecting them across the poles and applying a 180 longitude shift.</li>
<li>Determines the global coordinate ranges from the provided meteorological grid (<code>met</code>).</li>
<li>Computes zonal and meridional subdomain indices based on uniform partitioning of the global grid into `ctl-&gt;dd_subdomains_zonal  ctl-&gt;dd_subdomains_meridional` tiles.</li>
<li>Clamps the resulting indices to valid ranges.</li>
<li>Converts the 2-D subdomain index (lon  lat) into a 1-D MPI rank index.</li>
</ul>
<p >The rank is finally clamped into the valid range <code>[0, mpi_size-1]</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lon</td><td>Input longitude in degrees. May lie outside [0, 360). Values are wrapped.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat</td><td>Input latitude in degrees. May lie outside the range [90, 90]. <br  />
 Values past the poles are wrapped and the longitude is flipped accordingly.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met</td><td>Pointer to meteorological grid information. Only the longitude and latitude arrays (<code>met-&gt;lon[]</code>, <code>met-&gt;lat[]</code>) are used to determine the global range of coordinates.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Model control structure. Provides the number of zonal and meridional subdomains (<code>ctl-&gt;dd_subdomains_zonal</code>, <code>ctl-&gt;dd_subdomains_meridional</code>) used for domain decomposition.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mpi_size</td><td>Number of MPI ranks participating in the simulation. The computed target rank is clamped to <code>[0, mpi_size - 1]</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx_glob</td><td>Number of global longitude points in <code>met-&gt;lon</code>. Used to compute the global longitude range.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny_glob</td><td>Number of global latitude points in <code>met-&gt;lat</code>. Used to compute the global latitude range.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The MPI rank (subdomain ID) corresponding to the provided coordinates. Guaranteed to be in the range <code>[0, mpi_size - 1]</code>.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function assumes a <em>uniform</em> partitioning of the global grid into rectangular longitude/latitude blocks.</dd>
<dd>
Diagnostic information (wrapped coordinates, computed ranges, indices) is printed to stdout for debugging.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

</div>
</div>
<a id="ab4daa4b5e882b8dbde9e8bc8fba443c5" name="ab4daa4b5e882b8dbde9e8bc8fba443c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4daa4b5e882b8dbde9e8bc8fba443c5">&#9670;&nbsp;</a></span>dd_communicate_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_communicate_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structparticle__t.html">particle_t</a> *&#160;</td>
          <td class="paramname"><em>particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nparticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mptrac_8h.html#ada6230d3c1696537923dc5a9446d7521">MPI_Datatype</a>&#160;</td>
          <td class="paramname"><em>MPI_Particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>neighbours</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nneighbours</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a>&#160;</td>
          <td class="paramname"><em>ctl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Communicates particles between MPI processes. </p>
<p >The <code>dd_communicate_particles</code> function manages the communication of particle data between neighbouring MPI processes. It sends and receives particles to and from neighbouring ranks, handling the allocation and deallocation of buffers, and ensuring proper synchronization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particles</td><td>An array of <code><a class="el" href="structparticle__t.html" title="Particle data.">particle_t</a></code> structures to be communicated. </td></tr>
    <tr><td class="paramname">nparticles</td><td>A pointer to an integer representing the number of particles. </td></tr>
    <tr><td class="paramname">MPI_Particle</td><td>An MPI_Datatype representing the structure of a particle. </td></tr>
    <tr><td class="paramname">neighbours</td><td>An array of integers representing the neighbouring ranks. </td></tr>
    <tr><td class="paramname">nneighbours</td><td>An integer representing the number of neighbours. </td></tr>
    <tr><td class="paramname">ctl</td><td>A control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) containing configuration parameters.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Initializes buffers for sending and receiving particles.</li>
<li>Retrieves the MPI rank of the current process.</li>
<li>Uses non-blocking MPI communication to send and receive the number of particles and particle data.</li>
<li>Waits for all communication operations to complete.</li>
<li>Copies received particles into the local particle array.</li>
<li>Updates the number of particles after receiving.</li>
<li>Frees allocated buffers after communication is complete.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the <code>particles</code> array and other parameters are properly initialized. It handles communication with neighbouring ranks, ignoring poles and empty signals. The function uses MPI non-blocking communication for efficiency.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

</div>
</div>
<a id="a8c01b33df34978b9434092c2a8bd6d2f" name="a8c01b33df34978b9434092c2a8bd6d2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c01b33df34978b9434092c2a8bd6d2f">&#9670;&nbsp;</a></span>dd_get_rect_neighbour()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_get_rect_neighbour </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a>&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines rectangular neighbouring ranks for MPI processes. </p>
<p >The <code>dd_get_rect_neighbour</code> function calculates and assigns the neighbouring ranks for an MPI process based on its current rank and the configuration of subdomains. This is typically used in parallel computing to manage data decomposition and communication between processes arranged in a rectangular grid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>A control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) containing configuration parameters for subdomains. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure where neighbour information will be stored.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Uses conditional logic to determine the neighbours based on the current rank and subdomain configuration.</li>
<li>Assigns neighbour ranks to the <code>neighbours</code> array in the <code>dd</code> structure.</li>
<li>Handles edge cases for processes at the boundaries of the grid, such as poles or edges.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the <code>ctl</code> and <code>dd</code> structures are properly initialized. The function considers different configurations for processes at the boundaries and handles them appropriately to ensure correct neighbour assignment.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

</div>
</div>
<a id="a055f8ecc85c15a10e63d36f2d06eb3a8" name="a055f8ecc85c15a10e63d36f2d06eb3a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a055f8ecc85c15a10e63d36f2d06eb3a8">&#9670;&nbsp;</a></span>dd_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dd_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes domain decomposition for parallel processing. </p>
<p >The <code>dd_init</code> function initializes the domain decomposition setup for parallel processing in a distributed computing environment. It ensures that the number of tasks matches the number of subdomains, registers a custom MPI datatype for particle structures, defines grid neighbours, and assigns particles to their respective subdomains.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Checks if the number of tasks matches the number of subdomains.</li>
<li>Registers a custom MPI datatype for particle structures using <code>dd_register_MPI_type_particle</code>.</li>
<li>Defines grid neighbours for each MPI task using <code>dd_get_rect_neighbour</code>.</li>
<li>Assigns particles to their respective subdomains using <code>dd_assign_rect_subdomains_atm</code>.</li>
<li>Sets the initialization flag to indicate successful initialization.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the <code>ctl</code>, <code>dd</code>, <code>atm</code>, and <code>met</code> structures are properly initialized. The function is typically called at the beginning of a parallel processing task to set up the environment.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

</div>
</div>
<a id="a81e8a5b50bf967bd3acc61f384549bc8" name="a81e8a5b50bf967bd3acc61f384549bc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81e8a5b50bf967bd3acc61f384549bc8">&#9670;&nbsp;</a></span>dd_is_periodic_longitude()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dd_is_periodic_longitude </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx_glob</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether the longitude grid is periodic (global coverage). </p>
<p >This function determines if the longitude array in <code>met</code> represents a global, periodic grid (covering 360). It does so by computing the longitude spacing and testing whether the total range of longitudes plus one spacing approximately equals 360 degrees.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">met</td><td>Pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure containing the longitude array (<code>met-&gt;lon</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx_glob</td><td>Number of global longitude grid points.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>The longitude grid is periodic (global). </td></tr>
    <tr><td class="paramname">0</td><td>The longitude grid is not periodic (regional).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>At least two longitude points are required; otherwise the function returns 0 (not periodic).</li>
<li>A tolerance of 0.01 is used to account for floating-point rounding.</li>
<li>The logic used here is consistent with <code><a class="el" href="mptrac_8h.html#a38f91765df8eb0a66fb3a6408dca0600" title="Applies periodic boundary conditions to meteorological data along longitudinal axis.">read_met_periodic()</a></code>.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

</div>
</div>
<a id="a461d579646e5fba38e62a33f780a1ca4" name="a461d579646e5fba38e62a33f780a1ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a461d579646e5fba38e62a33f780a1ca4">&#9670;&nbsp;</a></span>dd_particles2atm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_particles2atm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparticle__t.html">particle_t</a> *&#160;</td>
          <td class="paramname"><em>particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nparticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts particle data to atmospheric data. </p>
<p >The <code>dd_particles2atm</code> function converts data from an array of particle structures (<code><a class="el" href="structparticle__t.html" title="Particle data.">particle_t</a></code>) to an atmospheric data structure (<code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code>). It updates the atmospheric data with values from the particles and modifies the cache with control parameters (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data to be updated. </td></tr>
    <tr><td class="paramname">particles</td><td>An array of <code><a class="el" href="structparticle__t.html" title="Particle data.">particle_t</a></code> structures from which data will be taken. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">nparticles</td><td>A pointer to an integer representing the number of particles to process. </td></tr>
    <tr><td class="paramname">cache</td><td>A pointer to a <code><a class="el" href="structcache__t.html" title="Cache data structure.">cache_t</a></code> structure used for storing intermediate values.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Copies particle data (time, longitude, latitude, pressure, and quantities) into the atmospheric data structure.</li>
<li>Updates the cache with a time modification value from the control parameters.</li>
<li>Increases the particle count in the atmospheric data structure by the number of particles processed.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the <code>particles</code> array and <code>atm</code> structure are properly initialized. It also assumes that the <code>cache</code> is pre-allocated and accessible. The function uses OpenACC directives for parallel processing.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

</div>
</div>
<a id="ae88ba4917bcc5964b59c20aa6c4717d1" name="ae88ba4917bcc5964b59c20aa6c4717d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae88ba4917bcc5964b59c20aa6c4717d1">&#9670;&nbsp;</a></span>dd_register_MPI_type_particle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_register_MPI_type_particle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mptrac_8h.html#ada6230d3c1696537923dc5a9446d7521">MPI_Datatype</a> *&#160;</td>
          <td class="paramname"><em>MPI_Particle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a custom MPI datatype for particle structures. </p>
<p >The <code>dd_register_MPI_type_particle</code> function creates and commits a custom MPI datatype that represents the structure of a particle (<code><a class="el" href="structparticle__t.html" title="Particle data.">particle_t</a></code>). This datatype is used for efficient communication of particle data in MPI operations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">MPI_Particle</td><td>A pointer to an MPI_Datatype variable where the new datatype will be stored.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Defines an array of MPI datatypes corresponding to the types of the particle structure's fields.</li>
<li>Specifies the block lengths for each field in the particle structure.</li>
<li>Calculates the displacements of each field within the particle structure using the <code>offsetof</code> macro.</li>
<li>Creates a structured MPI datatype using <code>MPI_Type_create_struct</code>.</li>
<li>Commits the new MPI datatype using <code>MPI_Type_commit</code>.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the <code><a class="el" href="structparticle__t.html" title="Particle data.">particle_t</a></code> structure is defined and accessible. The <code>NQ</code> constant should be defined to represent the number of quantities in the particle structure.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

</div>
</div>
<a id="a24daf9849621181ba5b8dcec1c187778" name="a24daf9849621181ba5b8dcec1c187778"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24daf9849621181ba5b8dcec1c187778">&#9670;&nbsp;</a></span>dd_sort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_sort </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nparticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>rank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sort particles according to box index and target rank for neighbours. </p>
<p >The <code>dd_sort</code> function sorts particles within the atmospheric data structure (<code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code>) based on their geographical coordinates (longitude and latitude) and pressure level. It also considers the target rank to which a particle will be sent. The function allocates temporary arrays to store indices and auxiliary data for sorting, then performs the sorting operation. After sorting, it updates the order of particles in the atmospheric data structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters and settings. </td></tr>
    <tr><td class="paramname">met0</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure containing meteorological data at the current time step. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data with particle information. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information, including rank and neighbours. </td></tr>
    <tr><td class="paramname">nparticles</td><td>A pointer to an integer representing the number of particles to be sent. </td></tr>
    <tr><td class="paramname">rank</td><td>A pointer to an integer storing the current MPI rank.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Allocates temporary arrays for sorting indices and values.</li>
<li>Computes a unique index for each particle based on its geographical coordinates and pressure level.</li>
<li>Uses parallel processing directives (OpenACC or OpenMP) to calculate these indices.</li>
<li>Sorts the particles based on the computed indices using a sorting library (e.g., Thrust).</li>
<li>Rearranges the atmospheric data arrays according to the sorted indices.</li>
<li>Counts the number of particles that need to be sent to other ranks and updates the particle count.</li>
<li>Frees the allocated temporary arrays.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the <code>ctl</code>, <code>met0</code>, <code>atm</code>, <code>nparticles</code>, and <code>rank</code> parameters are properly initialized. </dd>
<dd>
The function utilizes the <code>locate_reg</code> and <code>locate_irr</code> functions to determine the appropriate index for sorting particles. </dd>
<dd>
Particle sorting is performed using either the Thrust library (if compiled with Thrust support) or a custom sorting algorithm. If compiled without Thrust support, an error message is displayed. </dd>
<dd>
After sorting, the function updates the order of particle-related data arrays in the atmosphere data structure to maintain consistency.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd>
<dd>
Lars Hoffmann </dd></dl>

</div>
</div>
<a id="ac97104a007f600d9912d8a6bd85abf4b" name="ac97104a007f600d9912d8a6bd85abf4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac97104a007f600d9912d8a6bd85abf4b">&#9670;&nbsp;</a></span>dd_sort_help()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_sort_help </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>np</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reorder an array according to a permutation vector. </p>
<p >This function reorders the contents of the array <code>a</code> using the permutation indices stored in <code>dd-&gt;p</code>. A temporary buffer (<code>dd-&gt;help</code>) is used to perform the reordering in two passes:</p><ul>
<li>First, elements from <code>a</code> are copied into <code>dd-&gt;help</code> in permuted order.</li>
<li>Then, <code>dd-&gt;help</code> is copied back into <code>a</code> in sequential order.</li>
</ul>
<p >Parallelization is supported with OpenACC or OpenMP, depending on compilation flags.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Pointer to the array of doubles to be reordered. On input, it contains the original data; on output, it contains the reordered data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dd</td><td>Pointer to a <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing:<ul>
<li><code>dd-&gt;p</code> : permutation indices (size <code>np</code>)</li>
<li><code>dd-&gt;help</code> : temporary buffer (size <code>np</code>) </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">np</td><td>Number of elements in the array and permutation vector.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The <code>dd-&gt;p</code> and <code>dd-&gt;help</code> arrays must be allocated with at least <code>np</code> elements.</li>
<li>Uses <code>#pragma acc</code> when compiled with OpenACC (<code>_OPENACC</code> defined), otherwise falls back to OpenMP.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

</div>
</div>
<a id="ab49cba44fc2caf4c419798b0ffc47f77" name="ab49cba44fc2caf4c419798b0ffc47f77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab49cba44fc2caf4c419798b0ffc47f77">&#9670;&nbsp;</a></span>doy2day()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void doy2day </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>doy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>mon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>day</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a given day of the year (DOY) to a date (month and day). </p>
<p >This function computes the month and day for a given day of the year (DOY) and year. It accounts for whether the given year is a leap year or not.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">year</td><td>The year corresponding to the DOY. </td></tr>
    <tr><td class="paramname">doy</td><td>The day of the year (1-365 or 1-366). </td></tr>
    <tr><td class="paramname">mon</td><td>Pointer to an integer where the computed month will be stored. </td></tr>
    <tr><td class="paramname">day</td><td>Pointer to an integer where the computed day of the month will be stored.</td></tr>
  </table>
  </dd>
</dl>
<p>The function uses two arrays, <code>d0</code> and <code>d0l</code>, which contain the cumulative number of days at the start of each month for non-leap years and leap years respectively. It checks if the year is a leap year and calculates the month and day of the month accordingly.</p>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the input DOY is valid for the given year.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l01893">1893</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1897</span>            {</div>
<div class="line"><span class="lineno"> 1898</span> </div>
<div class="line"><span class="lineno"> 1899</span>  <span class="keyword">const</span> <span class="keywordtype">int</span></div>
<div class="line"><span class="lineno"> 1900</span>    d0[12] = { 1, 32, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335 },</div>
<div class="line"><span class="lineno"> 1901</span>    d0l[12] = { 1, 32, 61, 92, 122, 153, 183, 214, 245, 275, 306, 336 };</div>
<div class="line"><span class="lineno"> 1902</span> </div>
<div class="line"><span class="lineno"> 1903</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 1904</span> </div>
<div class="line"><span class="lineno"> 1905</span>  <span class="comment">/* Get month and day... */</span></div>
<div class="line"><span class="lineno"> 1906</span>  <span class="keywordflow">if</span> (year % 400 == 0 || (year % 100 != 0 &amp;&amp; year % 4 == 0)) {</div>
<div class="line"><span class="lineno"> 1907</span>    <span class="keywordflow">for</span> (i = 11; i &gt; 0; i--)</div>
<div class="line"><span class="lineno"> 1908</span>      <span class="keywordflow">if</span> (d0l[i] &lt;= doy)</div>
<div class="line"><span class="lineno"> 1909</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1910</span>    *mon = i + 1;</div>
<div class="line"><span class="lineno"> 1911</span>    *day = doy - d0l[i] + 1;</div>
<div class="line"><span class="lineno"> 1912</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1913</span>    <span class="keywordflow">for</span> (i = 11; i &gt; 0; i--)</div>
<div class="line"><span class="lineno"> 1914</span>      <span class="keywordflow">if</span> (d0[i] &lt;= doy)</div>
<div class="line"><span class="lineno"> 1915</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1916</span>    *mon = i + 1;</div>
<div class="line"><span class="lineno"> 1917</span>    *day = doy - d0[i] + 1;</div>
<div class="line"><span class="lineno"> 1918</span>  }</div>
<div class="line"><span class="lineno"> 1919</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d4d1bda2a510a5a0818cf09f5abccd1" name="a5d4d1bda2a510a5a0818cf09f5abccd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d4d1bda2a510a5a0818cf09f5abccd1">&#9670;&nbsp;</a></span>fft_help()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fft_help </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fcReal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fcImag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the Fast Fourier Transform (FFT) of a complex sequence. </p>
<p >This function calculates the FFT of a complex sequence represented by separate arrays for the real and imaginary parts. The input arrays <code>fcReal</code> and <code>fcImag</code> are modified in place to contain the transformed data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fcReal</td><td>Pointer to an array of doubles representing the real part of the input sequence. The array should have at least <code>n</code> elements. </td></tr>
    <tr><td class="paramname">fcImag</td><td>Pointer to an array of doubles representing the imaginary part of the input sequence. The array should have at least <code>n</code> elements. </td></tr>
    <tr><td class="paramname">n</td><td>The number of complex data points in the input sequence. This value should not exceed PMAX.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>fcReal</code> and <code>fcImag</code> must point to arrays of at least <code>n</code> elements. </dd>
<dd>
<code>n</code> must be less than or equal to PMAX.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>The arrays <code>fcReal</code> and <code>fcImag</code> will contain the real and imaginary parts of the FFT result, respectively.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function uses the GNU Scientific Library (GSL) for computing the FFT. Ensure that GSL is properly installed and linked in your project.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>If <code>n</code> exceeds PMAX, the function will trigger an error message and terminate.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l01923">1923</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1926</span>               {</div>
<div class="line"><span class="lineno"> 1927</span> </div>
<div class="line"><span class="lineno"> 1928</span>  <span class="keywordtype">double</span> data[2 * <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>];</div>
<div class="line"><span class="lineno"> 1929</span> </div>
<div class="line"><span class="lineno"> 1930</span>  <span class="comment">/* Check size... */</span></div>
<div class="line"><span class="lineno"> 1931</span>  <span class="keywordflow">if</span> (n &gt; <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>)</div>
<div class="line"><span class="lineno"> 1932</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many data points!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1933</span> </div>
<div class="line"><span class="lineno"> 1934</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 1935</span>  gsl_fft_complex_wavetable *wavetable =</div>
<div class="line"><span class="lineno"> 1936</span>    gsl_fft_complex_wavetable_alloc((<span class="keywordtype">size_t</span>) n);</div>
<div class="line"><span class="lineno"> 1937</span>  gsl_fft_complex_workspace *workspace =</div>
<div class="line"><span class="lineno"> 1938</span>    gsl_fft_complex_workspace_alloc((<span class="keywordtype">size_t</span>) n);</div>
<div class="line"><span class="lineno"> 1939</span> </div>
<div class="line"><span class="lineno"> 1940</span>  <span class="comment">/* Set data (real, complex)... */</span></div>
<div class="line"><span class="lineno"> 1941</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++) {</div>
<div class="line"><span class="lineno"> 1942</span>    data[2 * i] = fcReal[i];</div>
<div class="line"><span class="lineno"> 1943</span>    data[2 * i + 1] = fcImag[i];</div>
<div class="line"><span class="lineno"> 1944</span>  }</div>
<div class="line"><span class="lineno"> 1945</span> </div>
<div class="line"><span class="lineno"> 1946</span>  <span class="comment">/* Calculate FFT... */</span></div>
<div class="line"><span class="lineno"> 1947</span>  gsl_fft_complex_forward(data, 1, (<span class="keywordtype">size_t</span>) n, wavetable, workspace);</div>
<div class="line"><span class="lineno"> 1948</span> </div>
<div class="line"><span class="lineno"> 1949</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno"> 1950</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++) {</div>
<div class="line"><span class="lineno"> 1951</span>    fcReal[i] = data[2 * i];</div>
<div class="line"><span class="lineno"> 1952</span>    fcImag[i] = data[2 * i + 1];</div>
<div class="line"><span class="lineno"> 1953</span>  }</div>
<div class="line"><span class="lineno"> 1954</span> </div>
<div class="line"><span class="lineno"> 1955</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 1956</span>  gsl_fft_complex_wavetable_free(wavetable);</div>
<div class="line"><span class="lineno"> 1957</span>  gsl_fft_complex_workspace_free(workspace);</div>
<div class="line"><span class="lineno"> 1958</span>}</div>
<div class="ttc" id="amptrac_8h_html_a6c2e35fdcd9091ccada629895fa1d034"><div class="ttname"><a href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a></div><div class="ttdeci">#define EX</div><div class="ttdoc">Maximum number of longitudes for meteo data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00288">mptrac.h:288</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae3aea782dfca9019f3f2d169f8cc0f6d" name="ae3aea782dfca9019f3f2d169f8cc0f6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3aea782dfca9019f3f2d169f8cc0f6d">&#9670;&nbsp;</a></span>geo2cart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void geo2cart </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates. </p>
<p >This function converts geographic coordinates specified by longitude, latitude, and altitude into Cartesian coordinates. The Earth is approximated as a sphere with radius defined by the constant <code>RE</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">z</td><td>The altitude above the Earth's surface in kilometers. </td></tr>
    <tr><td class="paramname">lon</td><td>The longitude in degrees. </td></tr>
    <tr><td class="paramname">lat</td><td>The latitude in degrees. </td></tr>
    <tr><td class="paramname">x</td><td>Pointer to an array of three doubles where the computed Cartesian coordinates (x, y, z) will be stored.</td></tr>
  </table>
  </dd>
</dl>
<p>The function computes the Cartesian coordinates using the given altitude, longitude, and latitude. It assumes the Earth is a perfect sphere and uses the following formulas:</p><ul>
<li>\( x = (\textrm{radius}) \cos(\textrm{lat in radians}) \cos(\textrm{lon in radians}) \)</li>
<li>\( y = (\textrm{radius}) \cos(\textrm{lat in radians}) \sin(\textrm{lon in radians}) \)</li>
<li>\( z = (\textrm{radius}) \sin(\textrm{lat in radians}) \)</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The constant <code>RE</code> is defined as the Earth's radius in kilometers. </dd>
<dd>
Longitude and latitude should be in degrees.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://en.wikipedia.org/wiki/Geographic_coordinate_conversion">https://en.wikipedia.org/wiki/Geographic_coordinate_conversion</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l01962">1962</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1966</span>             {</div>
<div class="line"><span class="lineno"> 1967</span> </div>
<div class="line"><span class="lineno"> 1968</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> radius = z + <a class="code hl_define" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a>;</div>
<div class="line"><span class="lineno"> 1969</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> latrad = <a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(lat);</div>
<div class="line"><span class="lineno"> 1970</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> lonrad = <a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(lon);</div>
<div class="line"><span class="lineno"> 1971</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> coslat = cos(latrad);</div>
<div class="line"><span class="lineno"> 1972</span> </div>
<div class="line"><span class="lineno"> 1973</span>  x[0] = radius * coslat * cos(lonrad);</div>
<div class="line"><span class="lineno"> 1974</span>  x[1] = radius * coslat * sin(lonrad);</div>
<div class="line"><span class="lineno"> 1975</span>  x[2] = radius * sin(latrad);</div>
<div class="line"><span class="lineno"> 1976</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aad0e01f51c815c87fccaae55195d8a35" name="aad0e01f51c815c87fccaae55195d8a35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad0e01f51c815c87fccaae55195d8a35">&#9670;&nbsp;</a></span>get_met_help()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_met_help </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>direct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>metbase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dt_met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a formatted filename for meteorological data files based on the input parameters. </p>
<p >This function determines a rounded time interval, decodes the time components (year, month, day, hour, minute, second), and constructs a filename string for meteorological data files in various formats. The filename is adjusted based on the input control settings.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the control structure containing configuration settings. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>The time value in seconds since a reference epoch. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">direct</td><td>Direction to round the time value. Use -1 for rounding down and 1 for rounding up. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metbase</td><td>Base string for the filename, representing the dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt_met</td><td>Time interval for rounding in seconds. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">filename</td><td>Output buffer to store the generated filename.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function modifies the provided filename buffer to include placeholders (e.g., YYYY, MM, DD, HH) replaced with the corresponding time values. The format of the filename depends on the values in the control structure (e.g., ctl-&gt;met_type).</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure that the filename buffer has sufficient size to accommodate the resulting string.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l01980">1980</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1986</span>                  {</div>
<div class="line"><span class="lineno"> 1987</span> </div>
<div class="line"><span class="lineno"> 1988</span>  <span class="keywordtype">char</span> repl[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 1989</span> </div>
<div class="line"><span class="lineno"> 1990</span>  <span class="keywordtype">double</span> t6, r;</div>
<div class="line"><span class="lineno"> 1991</span> </div>
<div class="line"><span class="lineno"> 1992</span>  <span class="keywordtype">int</span> year, mon, day, hour, min, sec;</div>
<div class="line"><span class="lineno"> 1993</span> </div>
<div class="line"><span class="lineno"> 1994</span>  <span class="comment">/* Round time to fixed intervals... */</span></div>
<div class="line"><span class="lineno"> 1995</span>  <span class="keywordflow">if</span> (direct == -1)</div>
<div class="line"><span class="lineno"> 1996</span>    t6 = floor(t / dt_met) * dt_met;</div>
<div class="line"><span class="lineno"> 1997</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1998</span>    t6 = ceil(t / dt_met) * dt_met;</div>
<div class="line"><span class="lineno"> 1999</span> </div>
<div class="line"><span class="lineno"> 2000</span>  <span class="comment">/* Decode time... */</span></div>
<div class="line"><span class="lineno"> 2001</span>  <a class="code hl_function" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a>(t6, &amp;year, &amp;mon, &amp;day, &amp;hour, &amp;min, &amp;sec, &amp;r);</div>
<div class="line"><span class="lineno"> 2002</span> </div>
<div class="line"><span class="lineno"> 2003</span>  <span class="comment">/* Set filename of MPTRAC meteo files... */</span></div>
<div class="line"><span class="lineno"> 2004</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6607c472936ade8396ee3095595f0475">met_clams</a> == 0) {</div>
<div class="line"><span class="lineno"> 2005</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 0)</div>
<div class="line"><span class="lineno"> 2006</span>      sprintf(filename, <span class="stringliteral">&quot;%s_YYYY_MM_DD_HH.nc&quot;</span>, metbase);</div>
<div class="line"><span class="lineno"> 2007</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 1)</div>
<div class="line"><span class="lineno"> 2008</span>      sprintf(filename, <span class="stringliteral">&quot;%s_YYYY_MM_DD_HH.bin&quot;</span>, metbase);</div>
<div class="line"><span class="lineno"> 2009</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 2)</div>
<div class="line"><span class="lineno"> 2010</span>      sprintf(filename, <span class="stringliteral">&quot;%s_YYYY_MM_DD_HH.pck&quot;</span>, metbase);</div>
<div class="line"><span class="lineno"> 2011</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 3)</div>
<div class="line"><span class="lineno"> 2012</span>      sprintf(filename, <span class="stringliteral">&quot;%s_YYYY_MM_DD_HH.zfp&quot;</span>, metbase);</div>
<div class="line"><span class="lineno"> 2013</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 4)</div>
<div class="line"><span class="lineno"> 2014</span>      sprintf(filename, <span class="stringliteral">&quot;%s_YYYY_MM_DD_HH.zstd&quot;</span>, metbase);</div>
<div class="line"><span class="lineno"> 2015</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 5)</div>
<div class="line"><span class="lineno"> 2016</span>      sprintf(filename, <span class="stringliteral">&quot;%s_YYYY_MM_DD_HH.cms&quot;</span>, metbase);</div>
<div class="line"><span class="lineno"> 2017</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 7)</div>
<div class="line"><span class="lineno"> 2018</span>      sprintf(filename, <span class="stringliteral">&quot;%s_YYYY_MM_DD_HH.sz3&quot;</span>, metbase);</div>
<div class="line"><span class="lineno"> 2019</span>    sprintf(repl, <span class="stringliteral">&quot;%d&quot;</span>, year);</div>
<div class="line"><span class="lineno"> 2020</span>    <a class="code hl_function" href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2">get_met_replace</a>(filename, <span class="stringliteral">&quot;YYYY&quot;</span>, repl);</div>
<div class="line"><span class="lineno"> 2021</span>    sprintf(repl, <span class="stringliteral">&quot;%02d&quot;</span>, mon);</div>
<div class="line"><span class="lineno"> 2022</span>    <a class="code hl_function" href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2">get_met_replace</a>(filename, <span class="stringliteral">&quot;MM&quot;</span>, repl);</div>
<div class="line"><span class="lineno"> 2023</span>    sprintf(repl, <span class="stringliteral">&quot;%02d&quot;</span>, day);</div>
<div class="line"><span class="lineno"> 2024</span>    <a class="code hl_function" href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2">get_met_replace</a>(filename, <span class="stringliteral">&quot;DD&quot;</span>, repl);</div>
<div class="line"><span class="lineno"> 2025</span>    sprintf(repl, <span class="stringliteral">&quot;%02d&quot;</span>, hour);</div>
<div class="line"><span class="lineno"> 2026</span>    <a class="code hl_function" href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2">get_met_replace</a>(filename, <span class="stringliteral">&quot;HH&quot;</span>, repl);</div>
<div class="line"><span class="lineno"> 2027</span>  }</div>
<div class="line"><span class="lineno"> 2028</span> </div>
<div class="line"><span class="lineno"> 2029</span>  <span class="comment">/* Set filename of CLaMS meteo files... */</span></div>
<div class="line"><span class="lineno"> 2030</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2031</span>    sprintf(filename, <span class="stringliteral">&quot;%s_YYMMDDHH.nc&quot;</span>, metbase);</div>
<div class="line"><span class="lineno"> 2032</span>    sprintf(repl, <span class="stringliteral">&quot;%d&quot;</span>, year);</div>
<div class="line"><span class="lineno"> 2033</span>    <a class="code hl_function" href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2">get_met_replace</a>(filename, <span class="stringliteral">&quot;YYYY&quot;</span>, repl);</div>
<div class="line"><span class="lineno"> 2034</span>    sprintf(repl, <span class="stringliteral">&quot;%02d&quot;</span>, year % 100);</div>
<div class="line"><span class="lineno"> 2035</span>    <a class="code hl_function" href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2">get_met_replace</a>(filename, <span class="stringliteral">&quot;YY&quot;</span>, repl);</div>
<div class="line"><span class="lineno"> 2036</span>    sprintf(repl, <span class="stringliteral">&quot;%02d&quot;</span>, mon);</div>
<div class="line"><span class="lineno"> 2037</span>    <a class="code hl_function" href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2">get_met_replace</a>(filename, <span class="stringliteral">&quot;MM&quot;</span>, repl);</div>
<div class="line"><span class="lineno"> 2038</span>    sprintf(repl, <span class="stringliteral">&quot;%02d&quot;</span>, day);</div>
<div class="line"><span class="lineno"> 2039</span>    <a class="code hl_function" href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2">get_met_replace</a>(filename, <span class="stringliteral">&quot;DD&quot;</span>, repl);</div>
<div class="line"><span class="lineno"> 2040</span>    sprintf(repl, <span class="stringliteral">&quot;%02d&quot;</span>, hour);</div>
<div class="line"><span class="lineno"> 2041</span>    <a class="code hl_function" href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2">get_met_replace</a>(filename, <span class="stringliteral">&quot;HH&quot;</span>, repl);</div>
<div class="line"><span class="lineno"> 2042</span>  }</div>
<div class="line"><span class="lineno"> 2043</span>}</div>
<div class="ttc" id="amptrac_8c_html_ac54a92b848d49b96ef6091df37b552f2"><div class="ttname"><a href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2">get_met_replace</a></div><div class="ttdeci">void get_met_replace(char *orig, char *search, char *repl)</div><div class="ttdoc">Replaces occurrences of a substring in a string with another substring.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02047">mptrac.c:2047</a></div></div>
<div class="ttc" id="amptrac_8c_html_acc0c1829ca7770d2dd6342f2cdf10bb9"><div class="ttname"><a href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a></div><div class="ttdeci">void jsec2time(const double jsec, int *year, int *mon, int *day, int *hour, int *min, int *sec, double *remain)</div><div class="ttdoc">Converts Julian seconds to calendar date and time components.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02582">mptrac.c:2582</a></div></div>
<div class="ttc" id="astructctl__t_html_a6607c472936ade8396ee3095595f0475"><div class="ttname"><a href="structctl__t.html#a6607c472936ade8396ee3095595f0475">ctl_t::met_clams</a></div><div class="ttdeci">int met_clams</div><div class="ttdoc">Read MPTRAC or CLaMS meteo data (0=MPTRAC, 1=CLaMS).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02474">mptrac.h:2474</a></div></div>
<div class="ttc" id="astructctl__t_html_afc013488cddf18deab78993e93068416"><div class="ttname"><a href="structctl__t.html#afc013488cddf18deab78993e93068416">ctl_t::met_type</a></div><div class="ttdeci">int met_type</div><div class="ttdoc">Type of meteo data files (0=netCDF, 1=binary, 2=pck, 3=ZFP, 4=ZSTD, 5=cms, 6=grib,...</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02471">mptrac.h:2471</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_aad0e01f51c815c87fccaae55195d8a35_cgraph.png" border="0" usemap="#amptrac_8h_aad0e01f51c815c87fccaae55195d8a35_cgraph" alt=""/></div>
<map name="amptrac_8h_aad0e01f51c815c87fccaae55195d8a35_cgraph" id="amptrac_8h_aad0e01f51c815c87fccaae55195d8a35_cgraph">
<area shape="rect" title="Generates a formatted filename for meteorological data files based on the input parameters." alt="" coords="5,31,105,57"/>
<area shape="rect" href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2" title="Replaces occurrences of a substring in a string with another substring." alt="" coords="153,5,272,32"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="173,56,252,83"/>
</map>
</div>

</div>
</div>
<a id="ac54a92b848d49b96ef6091df37b552f2" name="ac54a92b848d49b96ef6091df37b552f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac54a92b848d49b96ef6091df37b552f2">&#9670;&nbsp;</a></span>get_met_replace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_met_replace </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>orig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>search</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>repl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Replaces occurrences of a substring in a string with another substring. </p>
<p >This function replaces occurrences of the substring <code>search</code> in the string <code>orig</code> with the substring <code>repl</code>. The replacement is performed in-place.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">orig</td><td>The original string where replacements are to be made. </td></tr>
    <tr><td class="paramname">search</td><td>The substring to be replaced. </td></tr>
    <tr><td class="paramname">repl</td><td>The substring to replace occurrences of <code>search</code>.</td></tr>
  </table>
  </dd>
</dl>
<p>The function iterates over the original string <code>orig</code> and replaces each occurrence of the substring <code>search</code> with the substring <code>repl</code>. It performs the replacement operation up to three times to ensure multiple occurrences are replaced.</p>
<dl class="section note"><dt>Note</dt><dd>We use this function to repace the strings <code>YYYY</code>, <code>MM</code>, and <code>DD</code> by year, month, and day in filenames. </dd>
<dd>
Ensure that <code>orig</code>, <code>search</code>, and <code>repl</code> are properly initialized and have sufficient memory allocated before calling this function.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02047">2047</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2050</span>              {</div>
<div class="line"><span class="lineno"> 2051</span> </div>
<div class="line"><span class="lineno"> 2052</span>  <span class="keywordtype">char</span> buffer[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 2053</span> </div>
<div class="line"><span class="lineno"> 2054</span>  <span class="comment">/* Iterate... */</span></div>
<div class="line"><span class="lineno"> 2055</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><span class="lineno"> 2056</span> </div>
<div class="line"><span class="lineno"> 2057</span>    <span class="comment">/* Replace sub-string... */</span></div>
<div class="line"><span class="lineno"> 2058</span>    <span class="keywordtype">char</span> *ch;</div>
<div class="line"><span class="lineno"> 2059</span>    <span class="keywordflow">if</span> (!(ch = strstr(orig, search)))</div>
<div class="line"><span class="lineno"> 2060</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2061</span>    strncpy(buffer, orig, (<span class="keywordtype">size_t</span>) (ch - orig));</div>
<div class="line"><span class="lineno"> 2062</span>    buffer[ch - orig] = 0;</div>
<div class="line"><span class="lineno"> 2063</span>    sprintf(buffer + (ch - orig), <span class="stringliteral">&quot;%s%s&quot;</span>, repl, ch + strlen(search));</div>
<div class="line"><span class="lineno"> 2064</span>    orig[0] = 0;</div>
<div class="line"><span class="lineno"> 2065</span>    strcpy(orig, buffer);</div>
<div class="line"><span class="lineno"> 2066</span>  }</div>
<div class="line"><span class="lineno"> 2067</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c47d6d6469c5ab48cf0d0585b257593" name="a2c47d6d6469c5ab48cf0d0585b257593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c47d6d6469c5ab48cf0d0585b257593">&#9670;&nbsp;</a></span>get_tropo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_tropo </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>met_tropo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>lons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>lats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>zt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>qt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>o3t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>zs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate tropopause data. </p>
<p >This function reads and interpolates various meteorological parameters such as tropopause pressure, temperature, and ozone concentration at specified latitudes and longitudes. The interpolated data is stored in the provided arrays.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met_tropo</td><td>An integer specifying the type of meteorological data to use. </td></tr>
    <tr><td class="paramname">ctl</td><td>Pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure that controls the meteorological data processing. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to a <code><a class="el" href="structclim__t.html" title="Climatological data.">clim_t</a></code> structure containing climatological data. </td></tr>
    <tr><td class="paramname">met</td><td>Pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure containing meteorological data. </td></tr>
    <tr><td class="paramname">lons</td><td>Array of longitudes at which to interpolate data. The array should have <code>nx</code> elements. </td></tr>
    <tr><td class="paramname">nx</td><td>Number of longitude points. </td></tr>
    <tr><td class="paramname">lats</td><td>Array of latitudes at which to interpolate data. The array should have <code>ny</code> elements. </td></tr>
    <tr><td class="paramname">ny</td><td>Number of latitude points. </td></tr>
    <tr><td class="paramname">pt</td><td>Pointer to an array where the interpolated pressure values will be stored. The array should have <code>nx * ny</code> elements. </td></tr>
    <tr><td class="paramname">zt</td><td>Pointer to an array where the interpolated height values will be stored. The array should have <code>nx * ny</code> elements. </td></tr>
    <tr><td class="paramname">tt</td><td>Pointer to an array where the interpolated temperature values will be stored. The array should have <code>nx * ny</code> elements. </td></tr>
    <tr><td class="paramname">qt</td><td>Pointer to an array where the interpolated specific humidity values will be stored. The array should have <code>nx * ny</code> elements. </td></tr>
    <tr><td class="paramname">o3t</td><td>Pointer to an array where the interpolated ozone concentration values will be stored. The array should have <code>nx * ny</code> elements. </td></tr>
    <tr><td class="paramname">ps</td><td>Pointer to an array where the interpolated surface pressure values will be stored. The array should have <code>nx * ny</code> elements. </td></tr>
    <tr><td class="paramname">zs</td><td>Pointer to an array where the interpolated surface height values will be stored. The array should have <code>nx * ny</code> elements.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>lons</code> must have at least <code>nx</code> elements. </dd>
<dd>
<code>lats</code> must have at least <code>ny</code> elements. </dd>
<dd>
<code>pt</code>, <code>zt</code>, <code>tt</code>, <code>qt</code>, <code>o3t</code>, <code>ps</code>, and <code>zs</code> must have at least <code>nx * ny</code> elements.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>The arrays <code>pt</code>, <code>zt</code>, <code>tt</code>, <code>qt</code>, <code>o3t</code>, <code>ps</code>, and <code>zs</code> will contain the interpolated meteorological data.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function utilizes OpenMP for parallel processing of the interpolation tasks.</dd>
<dd>
The function uses the auxiliary functions <code>read_met_tropo</code>, <code>intpol_met_space_2d</code>, and <code>intpol_met_space_3d</code> for reading and interpolating the tropopause data.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02071">2071</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2086</span>              {</div>
<div class="line"><span class="lineno"> 2087</span> </div>
<div class="line"><span class="lineno"> 2088</span>  <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 2089</span> </div>
<div class="line"><span class="lineno"> 2090</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">met_tropo</a> = met_tropo;</div>
<div class="line"><span class="lineno"> 2091</span>  <a class="code hl_function" href="mptrac_8c.html#a29701c07d5dded042b2031e09e11d679">read_met_tropo</a>(ctl, clim, met);</div>
<div class="line"><span class="lineno"> 2092</span><span class="preprocessor">#pragma omp parallel for default(shared) private(ci,cw)</span></div>
<div class="line"><span class="lineno"> 2093</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; nx; ix++)</div>
<div class="line"><span class="lineno"> 2094</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ny; iy++) {</div>
<div class="line"><span class="lineno"> 2095</span>      <a class="code hl_function" href="mptrac_8c.html#a1d832e4cf4224c4166d2f083a7a02514">intpol_met_space_2d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>, lons[ix], lats[iy],</div>
<div class="line"><span class="lineno"> 2096</span>                          &amp;pt[iy * nx + ix], ci, cw, 1);</div>
<div class="line"><span class="lineno"> 2097</span>      <a class="code hl_function" href="mptrac_8c.html#a1d832e4cf4224c4166d2f083a7a02514">intpol_met_space_2d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>, lons[ix], lats[iy],</div>
<div class="line"><span class="lineno"> 2098</span>                          &amp;ps[iy * nx + ix], ci, cw, 0);</div>
<div class="line"><span class="lineno"> 2099</span>      <a class="code hl_function" href="mptrac_8c.html#a1d832e4cf4224c4166d2f083a7a02514">intpol_met_space_2d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>, lons[ix], lats[iy],</div>
<div class="line"><span class="lineno"> 2100</span>                          &amp;zs[iy * nx + ix], ci, cw, 0);</div>
<div class="line"><span class="lineno"> 2101</span>      <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>, pt[iy * nx + ix], lons[ix],</div>
<div class="line"><span class="lineno"> 2102</span>                          lats[iy], &amp;zt[iy * nx + ix], ci, cw, 1);</div>
<div class="line"><span class="lineno"> 2103</span>      <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, pt[iy * nx + ix], lons[ix],</div>
<div class="line"><span class="lineno"> 2104</span>                          lats[iy], &amp;tt[iy * nx + ix], ci, cw, 0);</div>
<div class="line"><span class="lineno"> 2105</span>      <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>, pt[iy * nx + ix], lons[ix],</div>
<div class="line"><span class="lineno"> 2106</span>                          lats[iy], &amp;qt[iy * nx + ix], ci, cw, 0);</div>
<div class="line"><span class="lineno"> 2107</span>      <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>, pt[iy * nx + ix], lons[ix],</div>
<div class="line"><span class="lineno"> 2108</span>                          lats[iy], &amp;o3t[iy * nx + ix], ci, cw, 0);</div>
<div class="line"><span class="lineno"> 2109</span>    }</div>
<div class="line"><span class="lineno"> 2110</span>}</div>
<div class="ttc" id="amptrac_8c_html_a1d832e4cf4224c4166d2f083a7a02514"><div class="ttname"><a href="mptrac_8c.html#a1d832e4cf4224c4166d2f083a7a02514">intpol_met_space_2d</a></div><div class="ttdeci">void intpol_met_space_2d(const met_t *met, float array[EX][EY], const double lon, const double lat, double *var, int *ci, double *cw, const int init)</div><div class="ttdoc">Interpolates meteorological variables in 2D space.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02371">mptrac.c:2371</a></div></div>
<div class="ttc" id="amptrac_8c_html_a29701c07d5dded042b2031e09e11d679"><div class="ttname"><a href="mptrac_8c.html#a29701c07d5dded042b2031e09e11d679">read_met_tropo</a></div><div class="ttdeci">void read_met_tropo(const ctl_t *ctl, const clim_t *clim, met_t *met)</div><div class="ttdoc">Calculates the tropopause and related meteorological variables based on various methods and stores th...</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l10678">mptrac.c:10678</a></div></div>
<div class="ttc" id="amptrac_8c_html_a72b3417d6665335c02591c365f88cad1"><div class="ttname"><a href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a></div><div class="ttdeci">void intpol_met_space_3d(const met_t *met, float array[EX][EY][EP], const double p, const double lon, const double lat, double *var, int *ci, double *cw, const int init)</div><div class="ttdoc">Interpolates meteorological variables in 3D space.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02313">mptrac.c:2313</a></div></div>
<div class="ttc" id="amptrac_8h_html_a3a1d95aec47889277a6bf1e25f366c24"><div class="ttname"><a href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a></div><div class="ttdeci">#define INTPOL_INIT</div><div class="ttdoc">Initialize arrays for interpolation.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00833">mptrac.h:833</a></div></div>
<div class="ttc" id="astructctl__t_html_a5303a68a713ead5d3e144ec4183a9a86"><div class="ttname"><a href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">ctl_t::met_tropo</a></div><div class="ttdeci">int met_tropo</div><div class="ttdoc">Tropopause definition (0=none, 1=clim, 2=cold point, 3=WMO_1st, 4=WMO_2nd, 5=dynamical).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02610">mptrac.h:2610</a></div></div>
<div class="ttc" id="astructmet__t_html_a135f6e1c898c2d206d9a032de0e7b579"><div class="ttname"><a href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">met_t::h2o</a></div><div class="ttdeci">float h2o[EX][EY][EP]</div><div class="ttdoc">Water vapor volume mixing ratio [1].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03547">mptrac.h:3547</a></div></div>
<div class="ttc" id="astructmet__t_html_a3ea571f00b50e6ba8191ec620bc1d15e"><div class="ttname"><a href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">met_t::ps</a></div><div class="ttdeci">float ps[EX][EY]</div><div class="ttdoc">Surface pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03457">mptrac.h:3457</a></div></div>
<div class="ttc" id="astructmet__t_html_a52f25b39ae97c30393755cefc303ccd0"><div class="ttname"><a href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">met_t::zs</a></div><div class="ttdeci">float zs[EX][EY]</div><div class="ttdoc">Surface geopotential height [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03463">mptrac.h:3463</a></div></div>
<div class="ttc" id="astructmet__t_html_a5ce0fb589ddc187ab1191a9fd081a376"><div class="ttname"><a href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">met_t::o3</a></div><div class="ttdeci">float o3[EX][EY][EP]</div><div class="ttdoc">Ozone volume mixing ratio [1].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03550">mptrac.h:3550</a></div></div>
<div class="ttc" id="astructmet__t_html_a60fe66c30f0f0b5abdb46f220e3137cf"><div class="ttname"><a href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">met_t::t</a></div><div class="ttdeci">float t[EX][EY][EP]</div><div class="ttdoc">Temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03532">mptrac.h:3532</a></div></div>
<div class="ttc" id="astructmet__t_html_a86578dd751b3d5bcb696265f4a1ac47d"><div class="ttname"><a href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">met_t::pt</a></div><div class="ttdeci">float pt[EX][EY]</div><div class="ttdoc">Tropopause pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03490">mptrac.h:3490</a></div></div>
<div class="ttc" id="astructmet__t_html_aaaa04cf36044fcc02d518fe667d63bb3"><div class="ttname"><a href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">met_t::z</a></div><div class="ttdeci">float z[EX][EY][EP]</div><div class="ttdoc">Geopotential height [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03529">mptrac.h:3529</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a2c47d6d6469c5ab48cf0d0585b257593_cgraph.png" border="0" usemap="#amptrac_8h_a2c47d6d6469c5ab48cf0d0585b257593_cgraph" alt=""/></div>
<map name="amptrac_8h_a2c47d6d6469c5ab48cf0d0585b257593_cgraph" id="amptrac_8h_a2c47d6d6469c5ab48cf0d0585b257593_cgraph">
<area shape="rect" title="Calculate tropopause data." alt="" coords="5,56,81,83"/>
<area shape="rect" href="mptrac_8c.html#a1d832e4cf4224c4166d2f083a7a02514" title="Interpolates meteorological variables in 2D space." alt="" coords="289,5,435,32"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="289,56,435,83"/>
<area shape="rect" href="mptrac_8c.html#a29701c07d5dded042b2031e09e11d679" title="Calculates the tropopause and related meteorological variables based on various methods and stores th..." alt="" coords="129,107,241,133"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="483,5,623,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="515,107,590,133"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="511,56,594,83"/>
<area shape="rect" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692" title="Calculates the tropopause pressure based on climatological data." alt="" coords="321,107,403,133"/>
<area shape="rect" href="mptrac_8c.html#a62786d005ed312f3c9ba2fac7cd544fc" title="Performs spline interpolation or linear interpolation." alt="" coords="334,157,390,184"/>
</map>
</div>

</div>
</div>
<a id="af0880745f22b8f99b19eeecf984df11d" name="af0880745f22b8f99b19eeecf984df11d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0880745f22b8f99b19eeecf984df11d">&#9670;&nbsp;</a></span>intpol_check_lon_lat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void intpol_check_lon_lat </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>lons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>lats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lon2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lat2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjusts longitude and latitude to ensure they fall within valid bounds. </p>
<p >This function checks and modifies the given longitude and latitude values to fit within the specified longitude and latitude arrays. The longitude is wrapped within a 360-degree range, and the latitude is clamped within the valid range defined by the latitude array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lons</td><td>Pointer to an array of valid longitude values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nlon</td><td>Number of elements in the longitude array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lats</td><td>Pointer to an array of valid latitude values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nlat</td><td>Number of elements in the latitude array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon</td><td>Input longitude to be checked and adjusted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat</td><td>Input latitude to be checked and adjusted. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lon2</td><td>Pointer to the adjusted longitude. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lat2</td><td>Pointer to the adjusted latitude.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02114">2114</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2122</span>                {</div>
<div class="line"><span class="lineno"> 2123</span> </div>
<div class="line"><span class="lineno"> 2124</span>  <span class="comment">/* Check longitude... */</span></div>
<div class="line"><span class="lineno"> 2125</span>  *lon2 = <a class="code hl_define" href="mptrac_8h.html#aff4e721b49a057c4e4a3a6f56cc06469">FMOD</a>(lon, 360.);</div>
<div class="line"><span class="lineno"> 2126</span>  <span class="keywordflow">if</span> (*lon2 &lt; lons[0])</div>
<div class="line"><span class="lineno"> 2127</span>    *lon2 += 360;</div>
<div class="line"><span class="lineno"> 2128</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*lon2 &gt; lons[nlon - 1])</div>
<div class="line"><span class="lineno"> 2129</span>    *lon2 -= 360;</div>
<div class="line"><span class="lineno"> 2130</span> </div>
<div class="line"><span class="lineno"> 2131</span>  <span class="comment">/* Check latitude... */</span></div>
<div class="line"><span class="lineno"> 2132</span>  *lat2 = lat;</div>
<div class="line"><span class="lineno"> 2133</span>  <span class="keywordflow">if</span> (lats[0] &lt; lats[nlat - 1])</div>
<div class="line"><span class="lineno"> 2134</span>    *lat2 = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(*lat2, lats[0]), lats[nlat - 1]);</div>
<div class="line"><span class="lineno"> 2135</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2136</span>    *lat2 = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(*lat2, lats[nlat - 1]), lats[0]);</div>
<div class="line"><span class="lineno"> 2137</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a52ad82091c3f977ba43c5983aa048667" name="a52ad82091c3f977ba43c5983aa048667"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52ad82091c3f977ba43c5983aa048667">&#9670;&nbsp;</a></span>intpol_met_4d_zeta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void intpol_met_4d_zeta </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>height0</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>array0</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>height1</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>array1</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ci</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolates meteorological variables to a given position and time. </p>
<p >This function interpolates meteorological variables to a specified position and time. It calculates the interpolated value based on the values provided at two time steps and performs interpolation in time, longitude, latitude, and altitude dimensions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data at the first time step. </td></tr>
    <tr><td class="paramname">height0</td><td>Array containing heights at the first time step. </td></tr>
    <tr><td class="paramname">array0</td><td>Array containing meteorological variable values at the first time step. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the meteorological data at the second time step. </td></tr>
    <tr><td class="paramname">height1</td><td>Array containing heights at the second time step. </td></tr>
    <tr><td class="paramname">array1</td><td>Array containing meteorological variable values at the second time step. </td></tr>
    <tr><td class="paramname">ts</td><td>Interpolation time (fractional time between met0 and met1). </td></tr>
    <tr><td class="paramname">height</td><td>Altitude at which to interpolate. </td></tr>
    <tr><td class="paramname">lon</td><td>Longitude at which to interpolate. </td></tr>
    <tr><td class="paramname">lat</td><td>Latitude at which to interpolate. </td></tr>
    <tr><td class="paramname">var</td><td>Pointer to store the interpolated variable value. </td></tr>
    <tr><td class="paramname">ci</td><td>Array to store the calculated indices. </td></tr>
    <tr><td class="paramname">cw</td><td>Array to store the weighting factors. </td></tr>
    <tr><td class="paramname">init</td><td>Flag indicating if it's the first call (1) or not (0).</td></tr>
  </table>
  </dd>
</dl>
<p>The function first restricts the longitude within the range [0, 360) degrees. It then calculates the horizontal indices (<code>ci[0]</code> and <code>ci[1]</code>) based on the provided longitude and latitude. Next, it locates the vertical indices for each edge of the column based on the provided height.</p>
<p >The function then calculates the weighting factors for time, longitude, latitude, and altitude. It iterates over the interpolation process to determine the altitude weighting factor. After initializing the interpolation parameters, it calculates the interpolated variable value and stores it in the memory location pointed to by <code>var</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Ensure that all arrays (<code>height0</code>, <code>array0</code>, <code>height1</code>, <code>array1</code>, <code>ci</code>, <code>cw</code>) have sufficient memory allocated before calling this function.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02141">2141</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2155</span>                  {</div>
<div class="line"><span class="lineno"> 2156</span> </div>
<div class="line"><span class="lineno"> 2157</span>  <span class="keywordflow">if</span> (init) {</div>
<div class="line"><span class="lineno"> 2158</span> </div>
<div class="line"><span class="lineno"> 2159</span>    <span class="comment">/* Check longitude and latitude... */</span></div>
<div class="line"><span class="lineno"> 2160</span>    <span class="keywordtype">double</span> lon2, lat2;</div>
<div class="line"><span class="lineno"> 2161</span>    <a class="code hl_function" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d">intpol_check_lon_lat</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, lon, lat,</div>
<div class="line"><span class="lineno"> 2162</span>                         &amp;lon2, &amp;lat2);</div>
<div class="line"><span class="lineno"> 2163</span> </div>
<div class="line"><span class="lineno"> 2164</span>    <span class="comment">/* Get horizontal indizes... */</span></div>
<div class="line"><span class="lineno"> 2165</span>    ci[0] = <a class="code hl_function" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, lon2);</div>
<div class="line"><span class="lineno"> 2166</span>    ci[1] = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, lat2);</div>
<div class="line"><span class="lineno"> 2167</span> </div>
<div class="line"><span class="lineno"> 2168</span>    <span class="comment">/* Locate the vertical indizes for each edge of the column... */</span></div>
<div class="line"><span class="lineno"> 2169</span>    <span class="keywordtype">int</span> ind[2][4];</div>
<div class="line"><span class="lineno"> 2170</span>    <a class="code hl_function" href="mptrac_8c.html#abd6bde703e5eec60bf68820afcdd5edc">locate_vert</a>(heights0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#abe8b336b71924b14d2badd0d6c0f7c27">npl</a>, ci[0], ci[1], height, ind[0]);</div>
<div class="line"><span class="lineno"> 2171</span>    <a class="code hl_function" href="mptrac_8c.html#abd6bde703e5eec60bf68820afcdd5edc">locate_vert</a>(heights1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#abe8b336b71924b14d2badd0d6c0f7c27">npl</a>, ci[0], ci[1], height, ind[1]);</div>
<div class="line"><span class="lineno"> 2172</span> </div>
<div class="line"><span class="lineno"> 2173</span>    <span class="comment">/* Find minimum and maximum indizes... */</span></div>
<div class="line"><span class="lineno"> 2174</span>    ci[2] = ind[0][0];</div>
<div class="line"><span class="lineno"> 2175</span>    <span class="keywordtype">int</span> k_max = ind[0][0];</div>
<div class="line"><span class="lineno"> 2176</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno"> 2177</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++) {</div>
<div class="line"><span class="lineno"> 2178</span>        <span class="keywordflow">if</span> (ci[2] &gt; ind[i][j])</div>
<div class="line"><span class="lineno"> 2179</span>          ci[2] = ind[i][j];</div>
<div class="line"><span class="lineno"> 2180</span>        <span class="keywordflow">if</span> (k_max &lt; ind[i][j])</div>
<div class="line"><span class="lineno"> 2181</span>          k_max = ind[i][j];</div>
<div class="line"><span class="lineno"> 2182</span>      }</div>
<div class="line"><span class="lineno"> 2183</span> </div>
<div class="line"><span class="lineno"> 2184</span>    <span class="comment">/* Get weighting factors for time, longitude and latitude... */</span></div>
<div class="line"><span class="lineno"> 2185</span>    cw[3] = (ts - met0-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>) / (met1-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a> - met0-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>);</div>
<div class="line"><span class="lineno"> 2186</span>    cw[0] = (lon2 - met0-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ci[0]]) /</div>
<div class="line"><span class="lineno"> 2187</span>      (met0-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ci[0] + 1] - met0-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ci[0]]);</div>
<div class="line"><span class="lineno"> 2188</span>    cw[1] = (lat2 - met0-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[ci[1]]) /</div>
<div class="line"><span class="lineno"> 2189</span>      (met0-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[ci[1] + 1] - met0-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[ci[1]]);</div>
<div class="line"><span class="lineno"> 2190</span> </div>
<div class="line"><span class="lineno"> 2191</span>    <span class="comment">/* Interpolate in time at the lowest level... */</span></div>
<div class="line"><span class="lineno"> 2192</span>    <span class="keywordtype">double</span> height00 = cw[3] * (heights1[ci[0]][ci[1]][ci[2]]</div>
<div class="line"><span class="lineno"> 2193</span>                               - heights0[ci[0]][ci[1]][ci[2]])</div>
<div class="line"><span class="lineno"> 2194</span>      + heights0[ci[0]][ci[1]][ci[2]];</div>
<div class="line"><span class="lineno"> 2195</span>    <span class="keywordtype">double</span> height01 = cw[3] * (heights1[ci[0]][ci[1] + 1][ci[2]]</div>
<div class="line"><span class="lineno"> 2196</span>                               - heights0[ci[0]][ci[1] + 1][ci[2]])</div>
<div class="line"><span class="lineno"> 2197</span>      + heights0[ci[0]][ci[1] + 1][ci[2]];</div>
<div class="line"><span class="lineno"> 2198</span>    <span class="keywordtype">double</span> height10 = cw[3] * (heights1[ci[0] + 1][ci[1]][ci[2]]</div>
<div class="line"><span class="lineno"> 2199</span>                               - heights0[ci[0] + 1][ci[1]][ci[2]])</div>
<div class="line"><span class="lineno"> 2200</span>      + heights0[ci[0] + 1][ci[1]][ci[2]];</div>
<div class="line"><span class="lineno"> 2201</span>    <span class="keywordtype">double</span> height11 = cw[3] * (heights1[ci[0] + 1][ci[1] + 1][ci[2]]</div>
<div class="line"><span class="lineno"> 2202</span>                               - heights0[ci[0] + 1][ci[1] + 1][ci[2]])</div>
<div class="line"><span class="lineno"> 2203</span>      + heights0[ci[0] + 1][ci[1] + 1][ci[2]];</div>
<div class="line"><span class="lineno"> 2204</span> </div>
<div class="line"><span class="lineno"> 2205</span>    <span class="comment">/* Interpolate in latitude direction... */</span></div>
<div class="line"><span class="lineno"> 2206</span>    <span class="keywordtype">double</span> height0 = cw[1] * (height01 - height00) + height00;</div>
<div class="line"><span class="lineno"> 2207</span>    <span class="keywordtype">double</span> height1 = cw[1] * (height11 - height10) + height10;</div>
<div class="line"><span class="lineno"> 2208</span> </div>
<div class="line"><span class="lineno"> 2209</span>    <span class="comment">/* Interpolate in longitude direction... */</span></div>
<div class="line"><span class="lineno"> 2210</span>    <span class="keywordtype">double</span> height_bot = cw[0] * (height1 - height0) + height0;</div>
<div class="line"><span class="lineno"> 2211</span> </div>
<div class="line"><span class="lineno"> 2212</span>    <span class="comment">/* Interpolate in time at the upper level... */</span></div>
<div class="line"><span class="lineno"> 2213</span>    height00 = cw[3] * (heights1[ci[0]][ci[1]][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2214</span>                        - heights0[ci[0]][ci[1]][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2215</span>      + heights0[ci[0]][ci[1]][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2216</span>    height01 = cw[3] * (heights1[ci[0]][ci[1] + 1][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2217</span>                        - heights0[ci[0]][ci[1] + 1][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2218</span>      + heights0[ci[0]][ci[1] + 1][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2219</span>    height10 = cw[3] * (heights1[ci[0] + 1][ci[1]][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2220</span>                        - heights0[ci[0] + 1][ci[1]][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2221</span>      + heights0[ci[0] + 1][ci[1]][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2222</span>    height11 = cw[3] * (heights1[ci[0] + 1][ci[1] + 1][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2223</span>                        - heights0[ci[0] + 1][ci[1] + 1][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2224</span>      + heights0[ci[0] + 1][ci[1] + 1][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2225</span> </div>
<div class="line"><span class="lineno"> 2226</span>    <span class="comment">/* Interpolate in latitude direction... */</span></div>
<div class="line"><span class="lineno"> 2227</span>    height0 = cw[1] * (height01 - height00) + height00;</div>
<div class="line"><span class="lineno"> 2228</span>    height1 = cw[1] * (height11 - height10) + height10;</div>
<div class="line"><span class="lineno"> 2229</span> </div>
<div class="line"><span class="lineno"> 2230</span>    <span class="comment">/* Interpolate in longitude direction... */</span></div>
<div class="line"><span class="lineno"> 2231</span>    <span class="keywordtype">double</span> height_top = cw[0] * (height1 - height0) + height0;</div>
<div class="line"><span class="lineno"> 2232</span> </div>
<div class="line"><span class="lineno"> 2233</span>    <span class="comment">/* Search at higher levels if height is not in box... */</span></div>
<div class="line"><span class="lineno"> 2234</span>    <span class="keywordflow">while</span> (((heights0[0][0][0] &gt; heights0[0][0][1]) &amp;&amp;</div>
<div class="line"><span class="lineno"> 2235</span>            ((height_bot &lt;= height) || (height_top &gt; height))</div>
<div class="line"><span class="lineno"> 2236</span>            &amp;&amp; (height_bot &gt;= height) &amp;&amp; (ci[2] &lt; k_max))</div>
<div class="line"><span class="lineno"> 2237</span>           ||</div>
<div class="line"><span class="lineno"> 2238</span>           ((heights0[0][0][0] &lt; heights0[0][0][1]) &amp;&amp;</div>
<div class="line"><span class="lineno"> 2239</span>            ((height_bot &gt;= height) || (height_top &lt; height))</div>
<div class="line"><span class="lineno"> 2240</span>            &amp;&amp; (height_bot &lt;= height) &amp;&amp; (ci[2] &lt; k_max))</div>
<div class="line"><span class="lineno"> 2241</span>      ) {</div>
<div class="line"><span class="lineno"> 2242</span> </div>
<div class="line"><span class="lineno"> 2243</span>      ci[2]++;</div>
<div class="line"><span class="lineno"> 2244</span>      height_bot = height_top;</div>
<div class="line"><span class="lineno"> 2245</span> </div>
<div class="line"><span class="lineno"> 2246</span>      <span class="comment">/* Interpolate in time at the next level... */</span></div>
<div class="line"><span class="lineno"> 2247</span>      height00 = cw[3] * (heights1[ci[0]][ci[1]][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2248</span>                          - heights0[ci[0]][ci[1]][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2249</span>        + heights0[ci[0]][ci[1]][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2250</span>      height01 = cw[3] * (heights1[ci[0]][ci[1] + 1][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2251</span>                          - heights0[ci[0]][ci[1] + 1][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2252</span>        + heights0[ci[0]][ci[1] + 1][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2253</span>      height10 = cw[3] * (heights1[ci[0] + 1][ci[1]][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2254</span>                          - heights0[ci[0] + 1][ci[1]][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2255</span>        + heights0[ci[0] + 1][ci[1]][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2256</span>      height11 = cw[3] * (heights1[ci[0] + 1][ci[1] + 1][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2257</span>                          - heights0[ci[0] + 1][ci[1] + 1][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2258</span>        + heights0[ci[0] + 1][ci[1] + 1][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2259</span> </div>
<div class="line"><span class="lineno"> 2260</span>      <span class="comment">/* Interpolate in latitude direction... */</span></div>
<div class="line"><span class="lineno"> 2261</span>      height0 = cw[1] * (height01 - height00) + height00;</div>
<div class="line"><span class="lineno"> 2262</span>      height1 = cw[1] * (height11 - height10) + height10;</div>
<div class="line"><span class="lineno"> 2263</span> </div>
<div class="line"><span class="lineno"> 2264</span>      <span class="comment">/* Interpolate in longitude direction... */</span></div>
<div class="line"><span class="lineno"> 2265</span>      height_top = cw[0] * (height1 - height0) + height0;</div>
<div class="line"><span class="lineno"> 2266</span>    }</div>
<div class="line"><span class="lineno"> 2267</span> </div>
<div class="line"><span class="lineno"> 2268</span>    <span class="comment">/* Get vertical weighting factors... */</span></div>
<div class="line"><span class="lineno"> 2269</span>    cw[2] = (height - height_bot)</div>
<div class="line"><span class="lineno"> 2270</span>      / (height_top - height_bot);</div>
<div class="line"><span class="lineno"> 2271</span>  }</div>
<div class="line"><span class="lineno"> 2272</span> </div>
<div class="line"><span class="lineno"> 2273</span>  <span class="comment">/* Calculate the needed array values... */</span></div>
<div class="line"><span class="lineno"> 2274</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array000 = cw[3] * (array1[ci[0]][ci[1]][ci[2]]</div>
<div class="line"><span class="lineno"> 2275</span>                                   - array0[ci[0]][ci[1]][ci[2]])</div>
<div class="line"><span class="lineno"> 2276</span>    + array0[ci[0]][ci[1]][ci[2]];</div>
<div class="line"><span class="lineno"> 2277</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array100 = cw[3] * (array1[ci[0] + 1][ci[1]][ci[2]]</div>
<div class="line"><span class="lineno"> 2278</span>                                   - array0[ci[0] + 1][ci[1]][ci[2]])</div>
<div class="line"><span class="lineno"> 2279</span>    + array0[ci[0] + 1][ci[1]][ci[2]];</div>
<div class="line"><span class="lineno"> 2280</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array010 = cw[3] * (array1[ci[0]][ci[1] + 1][ci[2]]</div>
<div class="line"><span class="lineno"> 2281</span>                                   - array0[ci[0]][ci[1] + 1][ci[2]])</div>
<div class="line"><span class="lineno"> 2282</span>    + array0[ci[0]][ci[1] + 1][ci[2]];</div>
<div class="line"><span class="lineno"> 2283</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array110 = cw[3] * (array1[ci[0] + 1][ci[1] + 1][ci[2]]</div>
<div class="line"><span class="lineno"> 2284</span>                                   - array0[ci[0] + 1][ci[1] + 1][ci[2]])</div>
<div class="line"><span class="lineno"> 2285</span>    + array0[ci[0] + 1][ci[1] + 1][ci[2]];</div>
<div class="line"><span class="lineno"> 2286</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array001 = cw[3] * (array1[ci[0]][ci[1]][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2287</span>                                   - array0[ci[0]][ci[1]][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2288</span>    + array0[ci[0]][ci[1]][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2289</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array101 = cw[3] * (array1[ci[0] + 1][ci[1]][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2290</span>                                   - array0[ci[0] + 1][ci[1]][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2291</span>    + array0[ci[0] + 1][ci[1]][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2292</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array011 = cw[3] * (array1[ci[0]][ci[1] + 1][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2293</span>                                   - array0[ci[0]][ci[1] + 1][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2294</span>    + array0[ci[0]][ci[1] + 1][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2295</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array111 = cw[3] * (array1[ci[0] + 1][ci[1] + 1][ci[2] + 1]</div>
<div class="line"><span class="lineno"> 2296</span>                                   - array0[ci[0] + 1][ci[1] + 1][ci[2] + 1])</div>
<div class="line"><span class="lineno"> 2297</span>    + array0[ci[0] + 1][ci[1] + 1][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2298</span> </div>
<div class="line"><span class="lineno"> 2299</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array00 = cw[0] * (array100 - array000) + array000;</div>
<div class="line"><span class="lineno"> 2300</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array10 = cw[0] * (array110 - array010) + array010;</div>
<div class="line"><span class="lineno"> 2301</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array01 = cw[0] * (array101 - array001) + array001;</div>
<div class="line"><span class="lineno"> 2302</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> array11 = cw[0] * (array111 - array011) + array011;</div>
<div class="line"><span class="lineno"> 2303</span> </div>
<div class="line"><span class="lineno"> 2304</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux0 = cw[1] * (array10 - array00) + array00;</div>
<div class="line"><span class="lineno"> 2305</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux1 = cw[1] * (array11 - array01) + array01;</div>
<div class="line"><span class="lineno"> 2306</span> </div>
<div class="line"><span class="lineno"> 2307</span>  <span class="comment">/* Interpolate vertically... */</span></div>
<div class="line"><span class="lineno"> 2308</span>  *var = cw[2] * (aux1 - aux0) + aux0;</div>
<div class="line"><span class="lineno"> 2309</span>}</div>
<div class="ttc" id="amptrac_8c_html_abd6bde703e5eec60bf68820afcdd5edc"><div class="ttname"><a href="mptrac_8c.html#abd6bde703e5eec60bf68820afcdd5edc">locate_vert</a></div><div class="ttdeci">void locate_vert(float profiles[EX][EY][EP], const int np, const int lon_ap_ind, const int lat_ap_ind, const double height_ap, int *ind)</div><div class="ttdoc">Locate the four vertical indizes of a box for a given height value.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02952">mptrac.c:2952</a></div></div>
<div class="ttc" id="amptrac_8c_html_af0880745f22b8f99b19eeecf984df11d"><div class="ttname"><a href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d">intpol_check_lon_lat</a></div><div class="ttdeci">void intpol_check_lon_lat(const double *lons, const int nlon, const double *lats, const int nlat, const double lon, const double lat, double *lon2, double *lat2)</div><div class="ttdoc">Adjusts longitude and latitude to ensure they fall within valid bounds.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02114">mptrac.c:2114</a></div></div>
<div class="ttc" id="astructmet__t_html_a2bbd96a0a7184bc730c14323a067a760"><div class="ttname"><a href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">met_t::nx</a></div><div class="ttdeci">int nx</div><div class="ttdoc">Number of longitudes.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03424">mptrac.h:3424</a></div></div>
<div class="ttc" id="astructmet__t_html_a3a066580dfee9253cfe22b1e4ebf73b9"><div class="ttname"><a href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">met_t::ny</a></div><div class="ttdeci">int ny</div><div class="ttdoc">Number of latitudes.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03427">mptrac.h:3427</a></div></div>
<div class="ttc" id="astructmet__t_html_a85df96bff71dfa55576a995234a87b8f"><div class="ttname"><a href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">met_t::lon</a></div><div class="ttdeci">double lon[EX]</div><div class="ttdoc">Longitudes [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03436">mptrac.h:3436</a></div></div>
<div class="ttc" id="astructmet__t_html_abe8b336b71924b14d2badd0d6c0f7c27"><div class="ttname"><a href="structmet__t.html#abe8b336b71924b14d2badd0d6c0f7c27">met_t::npl</a></div><div class="ttdeci">int npl</div><div class="ttdoc">Number of model levels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03433">mptrac.h:3433</a></div></div>
<div class="ttc" id="astructmet__t_html_acf9d509f67dbc7ad8119d40a2757285f"><div class="ttname"><a href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">met_t::time</a></div><div class="ttdeci">double time</div><div class="ttdoc">Time [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03421">mptrac.h:3421</a></div></div>
<div class="ttc" id="astructmet__t_html_af7b2d03415a8164a3e0a29da55a9f371"><div class="ttname"><a href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">met_t::lat</a></div><div class="ttdeci">double lat[EY]</div><div class="ttdoc">Latitudes [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03439">mptrac.h:3439</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a52ad82091c3f977ba43c5983aa048667_cgraph.png" border="0" usemap="#amptrac_8h_a52ad82091c3f977ba43c5983aa048667_cgraph" alt=""/></div>
<map name="amptrac_8h_a52ad82091c3f977ba43c5983aa048667_cgraph" id="amptrac_8h_a52ad82091c3f977ba43c5983aa048667_cgraph">
<area shape="rect" title="Interpolates meteorological variables to a given position and time." alt="" coords="5,81,140,108"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="188,5,328,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="221,56,295,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="217,107,299,133"/>
<area shape="rect" href="mptrac_8c.html#abd6bde703e5eec60bf68820afcdd5edc" title="Locate the four vertical indizes of a box for a given height value." alt="" coords="215,157,301,184"/>
<area shape="rect" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861" title="Locate the index of the interval containing a given value in an irregularly spaced array." alt="" coords="376,157,483,184"/>
</map>
</div>

</div>
</div>
<a id="a72b3417d6665335c02591c365f88cad1" name="a72b3417d6665335c02591c365f88cad1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72b3417d6665335c02591c365f88cad1">&#9670;&nbsp;</a></span>intpol_met_space_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void intpol_met_space_3d </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>array</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ci</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolates meteorological variables in 3D space. </p>
<p >This function interpolates meteorological variables at a specified pressure level and geographic position. It calculates the interpolated value based on the values provided at neighboring grid points and performs interpolation in pressure, longitude, and latitude dimensions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met</td><td>Pointer to the meteorological data. </td></tr>
    <tr><td class="paramname">array</td><td>Array containing meteorological variable values. </td></tr>
    <tr><td class="paramname">p</td><td>Pressure level at which to interpolate. </td></tr>
    <tr><td class="paramname">lon</td><td>Longitude at which to interpolate. </td></tr>
    <tr><td class="paramname">lat</td><td>Latitude at which to interpolate. </td></tr>
    <tr><td class="paramname">var</td><td>Pointer to store the interpolated variable value. </td></tr>
    <tr><td class="paramname">ci</td><td>Array to store the calculated indices. </td></tr>
    <tr><td class="paramname">cw</td><td>Array to store the weighting factors. </td></tr>
    <tr><td class="paramname">init</td><td>Flag indicating if it's the first call (1) or not (0).</td></tr>
  </table>
  </dd>
</dl>
<p>The function first checks the longitude and adjusts it if necessary to ensure it falls within the valid range. It then calculates the interpolation indices based on the provided pressure level, longitude, and latitude. Next, it computes the interpolation weights for pressure, longitude, and latitude.</p>
<p >The function interpolates vertically first and then horizontally. The interpolated value is stored in the memory location pointed to by <code>var</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Ensure that the <code>array</code>, <code>ci</code>, and <code>cw</code> arrays have sufficient memory allocated before calling this function.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02313">2313</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2322</span>                  {</div>
<div class="line"><span class="lineno"> 2323</span> </div>
<div class="line"><span class="lineno"> 2324</span>  <span class="comment">/* Initialize interpolation... */</span></div>
<div class="line"><span class="lineno"> 2325</span>  <span class="keywordflow">if</span> (init) {</div>
<div class="line"><span class="lineno"> 2326</span> </div>
<div class="line"><span class="lineno"> 2327</span>    <span class="comment">/* Check longitude and latitude... */</span></div>
<div class="line"><span class="lineno"> 2328</span>    <span class="keywordtype">double</span> lon2, lat2;</div>
<div class="line"><span class="lineno"> 2329</span>    <a class="code hl_function" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d">intpol_check_lon_lat</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, lon, lat,</div>
<div class="line"><span class="lineno"> 2330</span>                         &amp;lon2, &amp;lat2);</div>
<div class="line"><span class="lineno"> 2331</span> </div>
<div class="line"><span class="lineno"> 2332</span>    <span class="comment">/* Get interpolation indices... */</span></div>
<div class="line"><span class="lineno"> 2333</span>    ci[0] = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, p);</div>
<div class="line"><span class="lineno"> 2334</span>    ci[1] = <a class="code hl_function" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, lon2);</div>
<div class="line"><span class="lineno"> 2335</span>    ci[2] = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, lat2);</div>
<div class="line"><span class="lineno"> 2336</span> </div>
<div class="line"><span class="lineno"> 2337</span>    <span class="comment">/* Get interpolation weights... */</span></div>
<div class="line"><span class="lineno"> 2338</span>    cw[0] = (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ci[0] + 1] - p)</div>
<div class="line"><span class="lineno"> 2339</span>      / (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ci[0] + 1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ci[0]]);</div>
<div class="line"><span class="lineno"> 2340</span>    cw[1] = (met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ci[1] + 1] - lon2)</div>
<div class="line"><span class="lineno"> 2341</span>      / (met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ci[1] + 1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ci[1]]);</div>
<div class="line"><span class="lineno"> 2342</span>    cw[2] = (met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[ci[2] + 1] - lat2)</div>
<div class="line"><span class="lineno"> 2343</span>      / (met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[ci[2] + 1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[ci[2]]);</div>
<div class="line"><span class="lineno"> 2344</span>  }</div>
<div class="line"><span class="lineno"> 2345</span> </div>
<div class="line"><span class="lineno"> 2346</span>  <span class="comment">/* Interpolate vertically... */</span></div>
<div class="line"><span class="lineno"> 2347</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux00 =</div>
<div class="line"><span class="lineno"> 2348</span>    cw[0] * (array[ci[1]][ci[2]][ci[0]] - array[ci[1]][ci[2]][ci[0] + 1])</div>
<div class="line"><span class="lineno"> 2349</span>    + array[ci[1]][ci[2]][ci[0] + 1];</div>
<div class="line"><span class="lineno"> 2350</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux01 =</div>
<div class="line"><span class="lineno"> 2351</span>    cw[0] * (array[ci[1]][ci[2] + 1][ci[0]] -</div>
<div class="line"><span class="lineno"> 2352</span>             array[ci[1]][ci[2] + 1][ci[0] + 1])</div>
<div class="line"><span class="lineno"> 2353</span>    + array[ci[1]][ci[2] + 1][ci[0] + 1];</div>
<div class="line"><span class="lineno"> 2354</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux10 =</div>
<div class="line"><span class="lineno"> 2355</span>    cw[0] * (array[ci[1] + 1][ci[2]][ci[0]] -</div>
<div class="line"><span class="lineno"> 2356</span>             array[ci[1] + 1][ci[2]][ci[0] + 1])</div>
<div class="line"><span class="lineno"> 2357</span>    + array[ci[1] + 1][ci[2]][ci[0] + 1];</div>
<div class="line"><span class="lineno"> 2358</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux11 =</div>
<div class="line"><span class="lineno"> 2359</span>    cw[0] * (array[ci[1] + 1][ci[2] + 1][ci[0]] -</div>
<div class="line"><span class="lineno"> 2360</span>             array[ci[1] + 1][ci[2] + 1][ci[0] + 1])</div>
<div class="line"><span class="lineno"> 2361</span>    + array[ci[1] + 1][ci[2] + 1][ci[0] + 1];</div>
<div class="line"><span class="lineno"> 2362</span> </div>
<div class="line"><span class="lineno"> 2363</span>  <span class="comment">/* Interpolate horizontally... */</span></div>
<div class="line"><span class="lineno"> 2364</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux0 = cw[2] * (aux00 - aux01) + aux01;</div>
<div class="line"><span class="lineno"> 2365</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux1 = cw[2] * (aux10 - aux11) + aux11;</div>
<div class="line"><span class="lineno"> 2366</span>  *var = cw[1] * (aux0 - aux1) + aux1;</div>
<div class="line"><span class="lineno"> 2367</span>}</div>
<div class="ttc" id="astructmet__t_html_a5d4eb4cd28aa5db1ec672368921c0b8f"><div class="ttname"><a href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">met_t::np</a></div><div class="ttdeci">int np</div><div class="ttdoc">Number of pressure levels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03430">mptrac.h:3430</a></div></div>
<div class="ttc" id="astructmet__t_html_affbacae5925ff68007396b525622ee34"><div class="ttname"><a href="structmet__t.html#affbacae5925ff68007396b525622ee34">met_t::p</a></div><div class="ttdeci">double p[EP]</div><div class="ttdoc">Pressure levels [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03442">mptrac.h:3442</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a72b3417d6665335c02591c365f88cad1_cgraph.png" border="0" usemap="#amptrac_8h_a72b3417d6665335c02591c365f88cad1_cgraph" alt=""/></div>
<map name="amptrac_8h_a72b3417d6665335c02591c365f88cad1_cgraph" id="amptrac_8h_a72b3417d6665335c02591c365f88cad1_cgraph">
<area shape="rect" title="Interpolates meteorological variables in 3D space." alt="" coords="5,56,151,83"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="199,5,339,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="231,56,306,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="227,107,310,133"/>
</map>
</div>

</div>
</div>
<a id="a1d832e4cf4224c4166d2f083a7a02514" name="a1d832e4cf4224c4166d2f083a7a02514"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d832e4cf4224c4166d2f083a7a02514">&#9670;&nbsp;</a></span>intpol_met_space_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void intpol_met_space_2d </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>array</em>[EX][EY], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ci</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolates meteorological variables in 2D space. </p>
<p >This function interpolates meteorological variables at a specified geographic position. It calculates the interpolated value based on the values provided at neighboring grid points and performs interpolation in longitude and latitude dimensions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met</td><td>Pointer to the meteorological data. </td></tr>
    <tr><td class="paramname">array</td><td>Array containing meteorological variable values. </td></tr>
    <tr><td class="paramname">lon</td><td>Longitude at which to interpolate. </td></tr>
    <tr><td class="paramname">lat</td><td>Latitude at which to interpolate. </td></tr>
    <tr><td class="paramname">var</td><td>Pointer to store the interpolated variable value. </td></tr>
    <tr><td class="paramname">ci</td><td>Array to store the calculated indices. </td></tr>
    <tr><td class="paramname">cw</td><td>Array to store the weighting factors. </td></tr>
    <tr><td class="paramname">init</td><td>Flag indicating if it's the first call (1) or not (0).</td></tr>
  </table>
  </dd>
</dl>
<p>The function first checks the longitude and adjusts it if necessary to ensure it falls within the valid range. It then calculates the interpolation indices based on the provided longitude and latitude. Next, it computes the interpolation weights for longitude and latitude.</p>
<p >The function interpolates horizontally and stores the interpolated value in the memory location pointed to by <code>var</code>. If any of the data values used in interpolation are not finite, the function handles this situation by choosing a valid value or performing a simple interpolation.</p>
<dl class="section note"><dt>Note</dt><dd>Ensure that the <code>array</code>, <code>ci</code>, and <code>cw</code> arrays have sufficient memory allocated before calling this function.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02371">2371</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2379</span>                  {</div>
<div class="line"><span class="lineno"> 2380</span> </div>
<div class="line"><span class="lineno"> 2381</span>  <span class="comment">/* Initialize interpolation... */</span></div>
<div class="line"><span class="lineno"> 2382</span>  <span class="keywordflow">if</span> (init) {</div>
<div class="line"><span class="lineno"> 2383</span> </div>
<div class="line"><span class="lineno"> 2384</span>    <span class="comment">/* Check longitude and latitude... */</span></div>
<div class="line"><span class="lineno"> 2385</span>    <span class="keywordtype">double</span> lon2, lat2;</div>
<div class="line"><span class="lineno"> 2386</span>    <a class="code hl_function" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d">intpol_check_lon_lat</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, lon, lat,</div>
<div class="line"><span class="lineno"> 2387</span>                         &amp;lon2, &amp;lat2);</div>
<div class="line"><span class="lineno"> 2388</span> </div>
<div class="line"><span class="lineno"> 2389</span>    <span class="comment">/* Get interpolation indices... */</span></div>
<div class="line"><span class="lineno"> 2390</span>    ci[1] = <a class="code hl_function" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, lon2);</div>
<div class="line"><span class="lineno"> 2391</span>    ci[2] = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, lat2);</div>
<div class="line"><span class="lineno"> 2392</span> </div>
<div class="line"><span class="lineno"> 2393</span>    <span class="comment">/* Get interpolation weights... */</span></div>
<div class="line"><span class="lineno"> 2394</span>    cw[1] = (met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ci[1] + 1] - lon2)</div>
<div class="line"><span class="lineno"> 2395</span>      / (met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ci[1] + 1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ci[1]]);</div>
<div class="line"><span class="lineno"> 2396</span>    cw[2] = (met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[ci[2] + 1] - lat2)</div>
<div class="line"><span class="lineno"> 2397</span>      / (met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[ci[2] + 1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[ci[2]]);</div>
<div class="line"><span class="lineno"> 2398</span>  }</div>
<div class="line"><span class="lineno"> 2399</span> </div>
<div class="line"><span class="lineno"> 2400</span>  <span class="comment">/* Set variables... */</span></div>
<div class="line"><span class="lineno"> 2401</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux00 = array[ci[1]][ci[2]];</div>
<div class="line"><span class="lineno"> 2402</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux01 = array[ci[1]][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2403</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux10 = array[ci[1] + 1][ci[2]];</div>
<div class="line"><span class="lineno"> 2404</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> aux11 = array[ci[1] + 1][ci[2] + 1];</div>
<div class="line"><span class="lineno"> 2405</span> </div>
<div class="line"><span class="lineno"> 2406</span>  <span class="comment">/* Interpolate horizontally... */</span></div>
<div class="line"><span class="lineno"> 2407</span>  <span class="keywordflow">if</span> (isfinite(aux00) &amp;&amp; isfinite(aux01)</div>
<div class="line"><span class="lineno"> 2408</span>      &amp;&amp; isfinite(aux10) &amp;&amp; isfinite(aux11)) {</div>
<div class="line"><span class="lineno"> 2409</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux0 = cw[2] * (aux00 - aux01) + aux01;</div>
<div class="line"><span class="lineno"> 2410</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux1 = cw[2] * (aux10 - aux11) + aux11;</div>
<div class="line"><span class="lineno"> 2411</span>    *var = cw[1] * (aux0 - aux1) + aux1;</div>
<div class="line"><span class="lineno"> 2412</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2413</span>    <span class="keywordflow">if</span> (cw[2] &lt; 0.5) {</div>
<div class="line"><span class="lineno"> 2414</span>      <span class="keywordflow">if</span> (cw[1] &lt; 0.5)</div>
<div class="line"><span class="lineno"> 2415</span>        *var = aux11;</div>
<div class="line"><span class="lineno"> 2416</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2417</span>        *var = aux01;</div>
<div class="line"><span class="lineno"> 2418</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2419</span>      <span class="keywordflow">if</span> (cw[1] &lt; 0.5)</div>
<div class="line"><span class="lineno"> 2420</span>        *var = aux10;</div>
<div class="line"><span class="lineno"> 2421</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2422</span>        *var = aux00;</div>
<div class="line"><span class="lineno"> 2423</span>    }</div>
<div class="line"><span class="lineno"> 2424</span>  }</div>
<div class="line"><span class="lineno"> 2425</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a1d832e4cf4224c4166d2f083a7a02514_cgraph.png" border="0" usemap="#amptrac_8h_a1d832e4cf4224c4166d2f083a7a02514_cgraph" alt=""/></div>
<map name="amptrac_8h_a1d832e4cf4224c4166d2f083a7a02514_cgraph" id="amptrac_8h_a1d832e4cf4224c4166d2f083a7a02514_cgraph">
<area shape="rect" title="Interpolates meteorological variables in 2D space." alt="" coords="5,56,151,83"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="199,5,339,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="231,56,306,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="227,107,310,133"/>
</map>
</div>

</div>
</div>
<a id="a5819df4f969928e2f45144e44feb50a6" name="a5819df4f969928e2f45144e44feb50a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5819df4f969928e2f45144e44feb50a6">&#9670;&nbsp;</a></span>intpol_met_time_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void intpol_met_time_3d </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>array0</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>array1</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ci</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolates meteorological data in 3D space and time. </p>
<p >This function interpolates meteorological data in three dimensions (longitude, latitude, and pressure) and time. It calculates the interpolated value based on the values provided at neighboring grid points and performs interpolation both spatially and temporally.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data at time t0. </td></tr>
    <tr><td class="paramname">array0</td><td>3D array of meteorological data at time t0. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the meteorological data at time t1. </td></tr>
    <tr><td class="paramname">array1</td><td>3D array of meteorological data at time t1. </td></tr>
    <tr><td class="paramname">ts</td><td>Time stamp at which to interpolate. </td></tr>
    <tr><td class="paramname">p</td><td>Pressure level at which to interpolate. </td></tr>
    <tr><td class="paramname">lon</td><td>Longitude at which to interpolate. </td></tr>
    <tr><td class="paramname">lat</td><td>Latitude at which to interpolate. </td></tr>
    <tr><td class="paramname">var</td><td>Pointer to store the interpolated value. </td></tr>
    <tr><td class="paramname">ci</td><td>Array to store the calculated indices. </td></tr>
    <tr><td class="paramname">cw</td><td>Array to store the weighting factors. </td></tr>
    <tr><td class="paramname">init</td><td>Flag indicating if it's the first call (1) or not (0).</td></tr>
  </table>
  </dd>
</dl>
<p>The function first performs spatial interpolation for both time instances (t0 and t1) using the <code>intpol_met_space_3d</code> function. It then calculates the weighting factor <code>wt</code> based on the time stamp <code>ts</code>. Finally, it performs temporal interpolation using the interpolated values at t0 and t1 along with the weighting factor to compute the final interpolated value stored in <code>var</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Ensure that the <code>ci</code> and <code>cw</code> arrays have sufficient memory allocated before calling this function.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02429">2429</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2441</span>                  {</div>
<div class="line"><span class="lineno"> 2442</span> </div>
<div class="line"><span class="lineno"> 2443</span>  <span class="keywordtype">double</span> var0, var1;</div>
<div class="line"><span class="lineno"> 2444</span> </div>
<div class="line"><span class="lineno"> 2445</span>  <span class="comment">/* Spatial interpolation... */</span></div>
<div class="line"><span class="lineno"> 2446</span>  <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met0, array0, p, lon, lat, &amp;var0, ci, cw, init);</div>
<div class="line"><span class="lineno"> 2447</span>  <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met1, array1, p, lon, lat, &amp;var1, ci, cw, 0);</div>
<div class="line"><span class="lineno"> 2448</span> </div>
<div class="line"><span class="lineno"> 2449</span>  <span class="comment">/* Get weighting factor... */</span></div>
<div class="line"><span class="lineno"> 2450</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> wt = (met1-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a> - ts) / (met1-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a> - met0-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>);</div>
<div class="line"><span class="lineno"> 2451</span> </div>
<div class="line"><span class="lineno"> 2452</span>  <span class="comment">/* Interpolate... */</span></div>
<div class="line"><span class="lineno"> 2453</span>  *var = wt * (var0 - var1) + var1;</div>
<div class="line"><span class="lineno"> 2454</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a5819df4f969928e2f45144e44feb50a6_cgraph.png" border="0" usemap="#amptrac_8h_a5819df4f969928e2f45144e44feb50a6_cgraph" alt=""/></div>
<map name="amptrac_8h_a5819df4f969928e2f45144e44feb50a6_cgraph" id="amptrac_8h_a5819df4f969928e2f45144e44feb50a6_cgraph">
<area shape="rect" title="Interpolates meteorological data in 3D space and time." alt="" coords="5,56,140,83"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="188,56,333,83"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="381,5,521,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="414,56,489,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="410,107,493,133"/>
</map>
</div>

</div>
</div>
<a id="ab88b081ba4352a0566066ec4156b94c6" name="ab88b081ba4352a0566066ec4156b94c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab88b081ba4352a0566066ec4156b94c6">&#9670;&nbsp;</a></span>intpol_met_time_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void intpol_met_time_2d </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>array0</em>[EX][EY], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>array1</em>[EX][EY], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ci</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolates meteorological data in 2D space and time. </p>
<p >This function interpolates meteorological data in two dimensions (longitude and latitude) and time. It calculates the interpolated value based on the values provided at neighboring grid points and performs interpolation both spatially and temporally.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data at time t0. </td></tr>
    <tr><td class="paramname">array0</td><td>2D array of meteorological data at time t0. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the meteorological data at time t1. </td></tr>
    <tr><td class="paramname">array1</td><td>2D array of meteorological data at time t1. </td></tr>
    <tr><td class="paramname">ts</td><td>Time stamp at which to interpolate. </td></tr>
    <tr><td class="paramname">lon</td><td>Longitude at which to interpolate. </td></tr>
    <tr><td class="paramname">lat</td><td>Latitude at which to interpolate. </td></tr>
    <tr><td class="paramname">var</td><td>Pointer to store the interpolated value. </td></tr>
    <tr><td class="paramname">ci</td><td>Array to store the calculated indices. </td></tr>
    <tr><td class="paramname">cw</td><td>Array to store the weighting factors. </td></tr>
    <tr><td class="paramname">init</td><td>Flag indicating if it's the first call (1) or not (0).</td></tr>
  </table>
  </dd>
</dl>
<p>The function first performs spatial interpolation for both time instances (t0 and t1) using the <code>intpol_met_space_2d</code> function. It then calculates the weighting factor <code>wt</code> based on the time stamp <code>ts</code>. Finally, it performs temporal interpolation using the interpolated values at t0 and t1 along with the weighting factor to compute the final interpolated value stored in <code>var</code>. If one of the interpolated values is not finite, it selects the valid value based on the weighting factor <code>wt</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Ensure that the <code>ci</code> and <code>cw</code> arrays have sufficient memory allocated before calling this function.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02458">2458</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2469</span>                  {</div>
<div class="line"><span class="lineno"> 2470</span> </div>
<div class="line"><span class="lineno"> 2471</span>  <span class="keywordtype">double</span> var0, var1;</div>
<div class="line"><span class="lineno"> 2472</span> </div>
<div class="line"><span class="lineno"> 2473</span>  <span class="comment">/* Spatial interpolation... */</span></div>
<div class="line"><span class="lineno"> 2474</span>  <a class="code hl_function" href="mptrac_8c.html#a1d832e4cf4224c4166d2f083a7a02514">intpol_met_space_2d</a>(met0, array0, lon, lat, &amp;var0, ci, cw, init);</div>
<div class="line"><span class="lineno"> 2475</span>  <a class="code hl_function" href="mptrac_8c.html#a1d832e4cf4224c4166d2f083a7a02514">intpol_met_space_2d</a>(met1, array1, lon, lat, &amp;var1, ci, cw, 0);</div>
<div class="line"><span class="lineno"> 2476</span> </div>
<div class="line"><span class="lineno"> 2477</span>  <span class="comment">/* Get weighting factor... */</span></div>
<div class="line"><span class="lineno"> 2478</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> wt = (met1-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a> - ts) / (met1-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a> - met0-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>);</div>
<div class="line"><span class="lineno"> 2479</span> </div>
<div class="line"><span class="lineno"> 2480</span>  <span class="comment">/* Interpolate... */</span></div>
<div class="line"><span class="lineno"> 2481</span>  <span class="keywordflow">if</span> (isfinite(var0) &amp;&amp; isfinite(var1))</div>
<div class="line"><span class="lineno"> 2482</span>    *var = wt * (var0 - var1) + var1;</div>
<div class="line"><span class="lineno"> 2483</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wt &lt; 0.5)</div>
<div class="line"><span class="lineno"> 2484</span>    *var = var1;</div>
<div class="line"><span class="lineno"> 2485</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2486</span>    *var = var0;</div>
<div class="line"><span class="lineno"> 2487</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_ab88b081ba4352a0566066ec4156b94c6_cgraph.png" border="0" usemap="#amptrac_8h_ab88b081ba4352a0566066ec4156b94c6_cgraph" alt=""/></div>
<map name="amptrac_8h_ab88b081ba4352a0566066ec4156b94c6_cgraph" id="amptrac_8h_ab88b081ba4352a0566066ec4156b94c6_cgraph">
<area shape="rect" title="Interpolates meteorological data in 2D space and time." alt="" coords="5,56,140,83"/>
<area shape="rect" href="mptrac_8c.html#a1d832e4cf4224c4166d2f083a7a02514" title="Interpolates meteorological variables in 2D space." alt="" coords="188,56,333,83"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="381,5,521,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="414,56,489,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="410,107,493,133"/>
</map>
</div>

</div>
</div>
<a id="a89361130320488e87e4eb614a138d6cb" name="a89361130320488e87e4eb614a138d6cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89361130320488e87e4eb614a138d6cb">&#9670;&nbsp;</a></span>intpol_tropo_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void intpol_tropo_3d </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>array0</em>[EX][EY], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>array1</em>[EX][EY], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lons</em>[EX], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lats</em>[EY], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolates tropopause data in 3D (latitude, longitude, and time). </p>
<p >This function performs interpolation of tropopause data at a given latitude, longitude, and time. The interpolation can be performed using either linear interpolation or nearest neighbor interpolation. The standard deviation of the data points used in the interpolation is also computed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time0</td><td>Time corresponding to the first data array <code>array0</code>. </td></tr>
    <tr><td class="paramname">array0</td><td>A 2D array of tropopause data at <code>time0</code>. The dimensions are <code>EX</code> by <code>EY</code>. </td></tr>
    <tr><td class="paramname">time1</td><td>Time corresponding to the second data array <code>array1</code>. </td></tr>
    <tr><td class="paramname">array1</td><td>A 2D array of tropopause data at <code>time1</code>. The dimensions are <code>EX</code> by <code>EY</code>. </td></tr>
    <tr><td class="paramname">lons</td><td>Array of longitudes with <code>EX</code> elements. </td></tr>
    <tr><td class="paramname">lats</td><td>Array of latitudes with <code>EY</code> elements. </td></tr>
    <tr><td class="paramname">nlon</td><td>Number of longitudes. </td></tr>
    <tr><td class="paramname">nlat</td><td>Number of latitudes. </td></tr>
    <tr><td class="paramname">time</td><td>The specific time at which to interpolate the data. </td></tr>
    <tr><td class="paramname">lon</td><td>The specific longitude at which to interpolate the data. </td></tr>
    <tr><td class="paramname">lat</td><td>The specific latitude at which to interpolate the data. </td></tr>
    <tr><td class="paramname">method</td><td>Interpolation method: <code>1</code> for linear interpolation, otherwise nearest neighbor interpolation is used. </td></tr>
    <tr><td class="paramname">var</td><td>Pointer to the variable where the interpolated value will be stored. </td></tr>
    <tr><td class="paramname">sigma</td><td>Pointer to the variable where the standard deviation of the data points will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>array0</code> and <code>array1</code> must be 2D arrays of size <code>EX</code> by <code>EY</code>. </dd>
<dd>
<code>lons</code> must have at least <code>nlon</code> elements and <code>lats</code> must have at least <code>nlat</code> elements.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd><code>var</code> will contain the interpolated value. </dd>
<dd>
<code>sigma</code> will contain the standard deviation of the data points used in the interpolation.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function adjusts the longitude to ensure it is within the range defined by <code>lons</code>. </dd>
<dd>
This function uses the auxiliary functions <code>locate_reg</code>, <code>LIN</code>, and <code>NN</code> for locating indices and performing interpolation.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure that <code>EX</code> and <code>EY</code> are defined appropriately to match the dimensions of <code>array0</code> and <code>array1</code>.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02491">2491</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2505</span>                 {</div>
<div class="line"><span class="lineno"> 2506</span> </div>
<div class="line"><span class="lineno"> 2507</span>  <span class="keywordtype">double</span> mean = 0;</div>
<div class="line"><span class="lineno"> 2508</span> </div>
<div class="line"><span class="lineno"> 2509</span>  <span class="keywordtype">int</span> n = 0;</div>
<div class="line"><span class="lineno"> 2510</span> </div>
<div class="line"><span class="lineno"> 2511</span>  <span class="comment">/* Check longitude and latitude... */</span></div>
<div class="line"><span class="lineno"> 2512</span>  <span class="keywordtype">double</span> lon2, lat2;</div>
<div class="line"><span class="lineno"> 2513</span>  <a class="code hl_function" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d">intpol_check_lon_lat</a>(lons, nlon, lats, nlat, lon, lat, &amp;lon2, &amp;lat2);</div>
<div class="line"><span class="lineno"> 2514</span> </div>
<div class="line"><span class="lineno"> 2515</span>  <span class="comment">/* Get indices... */</span></div>
<div class="line"><span class="lineno"> 2516</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ix = <a class="code hl_function" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(lons, (<span class="keywordtype">int</span>) nlon, lon2);</div>
<div class="line"><span class="lineno"> 2517</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> iy = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(lats, (<span class="keywordtype">int</span>) nlat, lat2);</div>
<div class="line"><span class="lineno"> 2518</span> </div>
<div class="line"><span class="lineno"> 2519</span>  <span class="comment">/* Calculate standard deviation... */</span></div>
<div class="line"><span class="lineno"> 2520</span>  *sigma = 0;</div>
<div class="line"><span class="lineno"> 2521</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dx = 0; dx &lt; 2; dx++)</div>
<div class="line"><span class="lineno"> 2522</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dy = 0; dy &lt; 2; dy++) {</div>
<div class="line"><span class="lineno"> 2523</span>      <span class="keywordflow">if</span> (isfinite(array0[ix + dx][iy + dy])) {</div>
<div class="line"><span class="lineno"> 2524</span>        mean += array0[ix + dx][iy + dy];</div>
<div class="line"><span class="lineno"> 2525</span>        *sigma += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(array0[ix + dx][iy + dy]);</div>
<div class="line"><span class="lineno"> 2526</span>        n++;</div>
<div class="line"><span class="lineno"> 2527</span>      }</div>
<div class="line"><span class="lineno"> 2528</span>      <span class="keywordflow">if</span> (isfinite(array1[ix + dx][iy + dy])) {</div>
<div class="line"><span class="lineno"> 2529</span>        mean += array1[ix + dx][iy + dy];</div>
<div class="line"><span class="lineno"> 2530</span>        *sigma += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(array1[ix + dx][iy + dy]);</div>
<div class="line"><span class="lineno"> 2531</span>        n++;</div>
<div class="line"><span class="lineno"> 2532</span>      }</div>
<div class="line"><span class="lineno"> 2533</span>    }</div>
<div class="line"><span class="lineno"> 2534</span>  <span class="keywordflow">if</span> (n &gt; 0)</div>
<div class="line"><span class="lineno"> 2535</span>    *sigma = sqrt(<a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(*sigma / n - <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(mean / n), 0.0));</div>
<div class="line"><span class="lineno"> 2536</span> </div>
<div class="line"><span class="lineno"> 2537</span>  <span class="comment">/* Linear interpolation... */</span></div>
<div class="line"><span class="lineno"> 2538</span>  <span class="keywordflow">if</span> (method == 1 &amp;&amp; isfinite(array0[ix][iy])</div>
<div class="line"><span class="lineno"> 2539</span>      &amp;&amp; isfinite(array0[ix][iy + 1])</div>
<div class="line"><span class="lineno"> 2540</span>      &amp;&amp; isfinite(array0[ix + 1][iy])</div>
<div class="line"><span class="lineno"> 2541</span>      &amp;&amp; isfinite(array0[ix + 1][iy + 1])</div>
<div class="line"><span class="lineno"> 2542</span>      &amp;&amp; isfinite(array1[ix][iy])</div>
<div class="line"><span class="lineno"> 2543</span>      &amp;&amp; isfinite(array1[ix][iy + 1])</div>
<div class="line"><span class="lineno"> 2544</span>      &amp;&amp; isfinite(array1[ix + 1][iy])</div>
<div class="line"><span class="lineno"> 2545</span>      &amp;&amp; isfinite(array1[ix + 1][iy + 1])) {</div>
<div class="line"><span class="lineno"> 2546</span> </div>
<div class="line"><span class="lineno"> 2547</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux00 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(lons[ix], array0[ix][iy],</div>
<div class="line"><span class="lineno"> 2548</span>                             lons[ix + 1], array0[ix + 1][iy], lon2);</div>
<div class="line"><span class="lineno"> 2549</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux01 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(lons[ix], array0[ix][iy + 1],</div>
<div class="line"><span class="lineno"> 2550</span>                             lons[ix + 1], array0[ix + 1][iy + 1], lon2);</div>
<div class="line"><span class="lineno"> 2551</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux0 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(lats[iy], aux00, lats[iy + 1], aux01, lat2);</div>
<div class="line"><span class="lineno"> 2552</span> </div>
<div class="line"><span class="lineno"> 2553</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux10 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(lons[ix], array1[ix][iy],</div>
<div class="line"><span class="lineno"> 2554</span>                             lons[ix + 1], array1[ix + 1][iy], lon2);</div>
<div class="line"><span class="lineno"> 2555</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux11 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(lons[ix], array1[ix][iy + 1],</div>
<div class="line"><span class="lineno"> 2556</span>                             lons[ix + 1], array1[ix + 1][iy + 1], lon2);</div>
<div class="line"><span class="lineno"> 2557</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux1 = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(lats[iy], aux10, lats[iy + 1], aux11, lat2);</div>
<div class="line"><span class="lineno"> 2558</span> </div>
<div class="line"><span class="lineno"> 2559</span>    *var = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(time0, aux0, time1, aux1, time);</div>
<div class="line"><span class="lineno"> 2560</span>  }</div>
<div class="line"><span class="lineno"> 2561</span> </div>
<div class="line"><span class="lineno"> 2562</span>  <span class="comment">/* Nearest neighbor interpolation... */</span></div>
<div class="line"><span class="lineno"> 2563</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2564</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux00 = <a class="code hl_define" href="mptrac_8h.html#a04481815cacab8fbbb9109b21b6f57ec">NN</a>(lons[ix], array0[ix][iy],</div>
<div class="line"><span class="lineno"> 2565</span>                            lons[ix + 1], array0[ix + 1][iy], lon2);</div>
<div class="line"><span class="lineno"> 2566</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux01 = <a class="code hl_define" href="mptrac_8h.html#a04481815cacab8fbbb9109b21b6f57ec">NN</a>(lons[ix], array0[ix][iy + 1],</div>
<div class="line"><span class="lineno"> 2567</span>                            lons[ix + 1], array0[ix + 1][iy + 1], lon2);</div>
<div class="line"><span class="lineno"> 2568</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux0 = <a class="code hl_define" href="mptrac_8h.html#a04481815cacab8fbbb9109b21b6f57ec">NN</a>(lats[iy], aux00, lats[iy + 1], aux01, lat2);</div>
<div class="line"><span class="lineno"> 2569</span> </div>
<div class="line"><span class="lineno"> 2570</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux10 = <a class="code hl_define" href="mptrac_8h.html#a04481815cacab8fbbb9109b21b6f57ec">NN</a>(lons[ix], array1[ix][iy],</div>
<div class="line"><span class="lineno"> 2571</span>                            lons[ix + 1], array1[ix + 1][iy], lon2);</div>
<div class="line"><span class="lineno"> 2572</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux11 = <a class="code hl_define" href="mptrac_8h.html#a04481815cacab8fbbb9109b21b6f57ec">NN</a>(lons[ix], array1[ix][iy + 1],</div>
<div class="line"><span class="lineno"> 2573</span>                            lons[ix + 1], array1[ix + 1][iy + 1], lon2);</div>
<div class="line"><span class="lineno"> 2574</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux1 = <a class="code hl_define" href="mptrac_8h.html#a04481815cacab8fbbb9109b21b6f57ec">NN</a>(lats[iy], aux10, lats[iy + 1], aux11, lat2);</div>
<div class="line"><span class="lineno"> 2575</span> </div>
<div class="line"><span class="lineno"> 2576</span>    *var = <a class="code hl_define" href="mptrac_8h.html#a04481815cacab8fbbb9109b21b6f57ec">NN</a>(time0, aux0, time1, aux1, time);</div>
<div class="line"><span class="lineno"> 2577</span>  }</div>
<div class="line"><span class="lineno"> 2578</span>}</div>
<div class="ttc" id="amptrac_8h_html_a04481815cacab8fbbb9109b21b6f57ec"><div class="ttname"><a href="mptrac_8h.html#a04481815cacab8fbbb9109b21b6f57ec">NN</a></div><div class="ttdeci">#define NN(x0, y0, x1, y1, x)</div><div class="ttdoc">Perform nearest-neighbor interpolation.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01386">mptrac.h:1386</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a89361130320488e87e4eb614a138d6cb_cgraph.png" border="0" usemap="#amptrac_8h_a89361130320488e87e4eb614a138d6cb_cgraph" alt=""/></div>
<map name="amptrac_8h_a89361130320488e87e4eb614a138d6cb_cgraph" id="amptrac_8h_a89361130320488e87e4eb614a138d6cb_cgraph">
<area shape="rect" title="Interpolates tropopause data in 3D (latitude, longitude, and time)." alt="" coords="5,56,116,83"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="164,5,304,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="197,56,271,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="193,107,275,133"/>
</map>
</div>

</div>
</div>
<a id="acc0c1829ca7770d2dd6342f2cdf10bb9" name="acc0c1829ca7770d2dd6342f2cdf10bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc0c1829ca7770d2dd6342f2cdf10bb9">&#9670;&nbsp;</a></span>jsec2time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void jsec2time </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>jsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>mon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>hour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>remain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts Julian seconds to calendar date and time components. </p>
<p >This function converts Julian seconds to calendar date and time components, including year, month, day, hour, minute, and second. It also calculates the fractional part of the seconds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jsec</td><td>Julian seconds to convert. </td></tr>
    <tr><td class="paramname">year</td><td>Pointer to store the year. </td></tr>
    <tr><td class="paramname">mon</td><td>Pointer to store the month. </td></tr>
    <tr><td class="paramname">day</td><td>Pointer to store the day. </td></tr>
    <tr><td class="paramname">hour</td><td>Pointer to store the hour. </td></tr>
    <tr><td class="paramname">min</td><td>Pointer to store the minute. </td></tr>
    <tr><td class="paramname">sec</td><td>Pointer to store the second. </td></tr>
    <tr><td class="paramname">remain</td><td>Pointer to store the fractional part of seconds.</td></tr>
  </table>
  </dd>
</dl>
<p>The function initializes a time structure <code>t0</code> with a fixed starting date and time. It then converts the Julian seconds to a time_t type by adding the seconds to the epoch time. Next, it converts the time_t value to a UTC time structure <code>t1</code>. Finally, it extracts the year, month, day, hour, minute, and second components from <code>t1</code> and calculates the fractional part of seconds, which is stored in <code>remain</code>.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02582">2582</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2590</span>                  {</div>
<div class="line"><span class="lineno"> 2591</span> </div>
<div class="line"><span class="lineno"> 2592</span>  <span class="keyword">struct </span>tm t0, *t1;</div>
<div class="line"><span class="lineno"> 2593</span> </div>
<div class="line"><span class="lineno"> 2594</span>  t0.tm_year = 100;</div>
<div class="line"><span class="lineno"> 2595</span>  t0.tm_mon = 0;</div>
<div class="line"><span class="lineno"> 2596</span>  t0.tm_mday = 1;</div>
<div class="line"><span class="lineno"> 2597</span>  t0.tm_hour = 0;</div>
<div class="line"><span class="lineno"> 2598</span>  t0.tm_min = 0;</div>
<div class="line"><span class="lineno"> 2599</span>  t0.tm_sec = 0;</div>
<div class="line"><span class="lineno"> 2600</span> </div>
<div class="line"><span class="lineno"> 2601</span>  <span class="keyword">const</span> time_t jsec0 = (time_t) jsec + timegm(&amp;t0);</div>
<div class="line"><span class="lineno"> 2602</span>  t1 = gmtime(&amp;jsec0);</div>
<div class="line"><span class="lineno"> 2603</span> </div>
<div class="line"><span class="lineno"> 2604</span>  *year = t1-&gt;tm_year + 1900;</div>
<div class="line"><span class="lineno"> 2605</span>  *mon = t1-&gt;tm_mon + 1;</div>
<div class="line"><span class="lineno"> 2606</span>  *day = t1-&gt;tm_mday;</div>
<div class="line"><span class="lineno"> 2607</span>  *hour = t1-&gt;tm_hour;</div>
<div class="line"><span class="lineno"> 2608</span>  *min = t1-&gt;tm_min;</div>
<div class="line"><span class="lineno"> 2609</span>  *sec = t1-&gt;tm_sec;</div>
<div class="line"><span class="lineno"> 2610</span>  *remain = jsec - floor(jsec);</div>
<div class="line"><span class="lineno"> 2611</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae61cf973263fcc45574daa27d0dec8cd" name="ae61cf973263fcc45574daa27d0dec8cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae61cf973263fcc45574daa27d0dec8cd">&#9670;&nbsp;</a></span>kernel_weight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double kernel_weight </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>kz</em>[EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>kw</em>[EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the kernel weight based on altitude and given kernel data. </p>
<p >This function calculates the kernel weight based on altitude and given kernel data. It takes arrays of altitudes (<code>kz</code>) and corresponding weights (<code>kw</code>), the number of data points (<code>nk</code>), and the current altitude (<code>p</code>) as input.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kz</td><td>Array of altitudes. </td></tr>
    <tr><td class="paramname">kw</td><td>Array of corresponding weights. </td></tr>
    <tr><td class="paramname">nk</td><td>Number of data points. </td></tr>
    <tr><td class="paramname">p</td><td>Current altitude. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The calculated kernel weight.</dd></dl>
<p>If the number of data points is less than 2 (<code>nk &lt; 2</code>), the function returns a default weight of 1.0.</p>
<p >The function first computes the altitude <code>z</code> based on the current altitude <code>p</code>. Then it checks whether <code>z</code> is outside the range of altitudes in the kernel data. If so, it returns the corresponding weight at the nearest altitude boundary. Otherwise, it interpolates linearly between the two closest altitudes in the kernel data to determine the weight at altitude <code>z</code>.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02615">2615</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2619</span>                  {</div>
<div class="line"><span class="lineno"> 2620</span> </div>
<div class="line"><span class="lineno"> 2621</span>  <span class="comment">/* Check number of data points... */</span></div>
<div class="line"><span class="lineno"> 2622</span>  <span class="keywordflow">if</span> (nk &lt; 2)</div>
<div class="line"><span class="lineno"> 2623</span>    <span class="keywordflow">return</span> 1.0;</div>
<div class="line"><span class="lineno"> 2624</span> </div>
<div class="line"><span class="lineno"> 2625</span>  <span class="comment">/* Get altitude... */</span></div>
<div class="line"><span class="lineno"> 2626</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> z = <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(p);</div>
<div class="line"><span class="lineno"> 2627</span> </div>
<div class="line"><span class="lineno"> 2628</span>  <span class="comment">/* Get weighting factor... */</span></div>
<div class="line"><span class="lineno"> 2629</span>  <span class="keywordflow">if</span> (z &lt; kz[0])</div>
<div class="line"><span class="lineno"> 2630</span>    <span class="keywordflow">return</span> kw[0];</div>
<div class="line"><span class="lineno"> 2631</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (z &gt; kz[nk - 1])</div>
<div class="line"><span class="lineno"> 2632</span>    <span class="keywordflow">return</span> kw[nk - 1];</div>
<div class="line"><span class="lineno"> 2633</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2634</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(kz, nk, z);</div>
<div class="line"><span class="lineno"> 2635</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(kz[idx], kw[idx], kz[idx + 1], kw[idx + 1], z);</div>
<div class="line"><span class="lineno"> 2636</span>  }</div>
<div class="line"><span class="lineno"> 2637</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_ae61cf973263fcc45574daa27d0dec8cd_cgraph.png" border="0" usemap="#amptrac_8h_ae61cf973263fcc45574daa27d0dec8cd_cgraph" alt=""/></div>
<map name="amptrac_8h_ae61cf973263fcc45574daa27d0dec8cd_cgraph" id="amptrac_8h_ae61cf973263fcc45574daa27d0dec8cd_cgraph">
<area shape="rect" title="Calculates the kernel weight based on altitude and given kernel data." alt="" coords="5,5,108,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="156,5,231,32"/>
</map>
</div>

</div>
</div>
<a id="afa485eb277a5ced6dac0ed77665c976c" name="afa485eb277a5ced6dac0ed77665c976c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa485eb277a5ced6dac0ed77665c976c">&#9670;&nbsp;</a></span>lapse_rate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double lapse_rate </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>h2o</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the moist adiabatic lapse rate in Kelvin per kilometer. </p>
<p >This function calculates the moist adiabatic lapse rate in Kelvin per kilometer from the given temperature (<code>t</code>) in Kelvin and water vapor volume mixing ratio (<code>h2o</code>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>Temperature in Kelvin. </td></tr>
    <tr><td class="paramname">h2o</td><td>Water vapor volume mixing ratio. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The moist adiabatic lapse rate in Kelvin per kilometer.</dd></dl>
<p>The moist adiabatic lapse rate is calculated using the formula:</p>
<p class="formulaDsp">
\[ \Gamma = \frac{{1000 \times g \times \left(a + L_v \times r \times T\right)}} {{C_{pd} \times a + L_v^2 \times r \times \epsilon}} \]
</p>
<p >where:</p><ul>
<li>\( \Gamma \) is the lapse rate in Kelvin per kilometer.</li>
<li>\( g \) is the acceleration due to gravity (constant).</li>
<li>\( a = R_a \times T^2 \) is a term based on the gas constant for dry air and temperature squared.</li>
<li>\( R_a \) is the gas constant for dry air.</li>
<li>\( T \) is the temperature in Kelvin.</li>
<li>\( L_v \) is the latent heat of vaporization.</li>
<li>\( r = \frac{{S_h(h_2o)}}{{1 - S_h(h_2o)}} \) is a term based on the water vapor mixing ratio.</li>
<li>\( S_h(h_2o) \) is the saturation vapor pressure relative to the pressure at saturation.</li>
<li>\( C_{pd} \) is the specific heat of dry air at constant pressure.</li>
<li>\( \epsilon \) is the ratio of the gas constants for dry air and water vapor.</li>
</ul>
<p >The constants used in the calculation are defined externally:</p><ul>
<li>\( g \): Acceleration due to gravity (constant).</li>
<li>\( R_a \): Gas constant for dry air.</li>
<li>\( L_v \): Latent heat of vaporization.</li>
<li>\( C_{pd} \): Specific heat of dry air at constant pressure.</li>
<li>\( \epsilon \): Ratio of the gas constants for dry air and water vapor.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a href="https://en.wikipedia.org/wiki/Lapse_rate">Wikipedia - Lapse rate</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02641">2641</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2643</span>                    {</div>
<div class="line"><span class="lineno"> 2644</span> </div>
<div class="line"><span class="lineno"> 2645</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2646</span><span class="comment">     Calculate moist adiabatic lapse rate [K/km] from temperature [K]</span></div>
<div class="line"><span class="lineno"> 2647</span><span class="comment">     and water vapor volume mixing ratio [1].</span></div>
<div class="line"><span class="lineno"> 2648</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2649</span><span class="comment">     Reference: https://en.wikipedia.org/wiki/Lapse_rate</span></div>
<div class="line"><span class="lineno"> 2650</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno"> 2651</span> </div>
<div class="line"><span class="lineno"> 2652</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> a = <a class="code hl_define" href="mptrac_8h.html#a30a3f049b718d26a32f16ed72716d588">RA</a> * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(t), r = <a class="code hl_define" href="mptrac_8h.html#a47b5bc0bd14e22c0329d967e3c6657bd">SH</a>(h2o) / (1. - <a class="code hl_define" href="mptrac_8h.html#a47b5bc0bd14e22c0329d967e3c6657bd">SH</a>(h2o));</div>
<div class="line"><span class="lineno"> 2653</span> </div>
<div class="line"><span class="lineno"> 2654</span>  <span class="keywordflow">return</span> 1e3 * <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> * (a + <a class="code hl_define" href="mptrac_8h.html#a60ac8f6cd3cf230202ce5aba9df2d6e1">LV</a> * r * t) / (<a class="code hl_define" href="mptrac_8h.html#af48c8f42b5451a04703d55d62ea50a3e">CPD</a> * a + <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(<a class="code hl_define" href="mptrac_8h.html#a60ac8f6cd3cf230202ce5aba9df2d6e1">LV</a>) * r * <a class="code hl_define" href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a>);</div>
<div class="line"><span class="lineno"> 2655</span>}</div>
<div class="ttc" id="amptrac_8h_html_a47b5bc0bd14e22c0329d967e3c6657bd"><div class="ttname"><a href="mptrac_8h.html#a47b5bc0bd14e22c0329d967e3c6657bd">SH</a></div><div class="ttdeci">#define SH(h2o)</div><div class="ttdoc">Compute specific humidity from water vapor volume mixing ratio.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01683">mptrac.h:1683</a></div></div>
<div class="ttc" id="amptrac_8h_html_a60ac8f6cd3cf230202ce5aba9df2d6e1"><div class="ttname"><a href="mptrac_8h.html#a60ac8f6cd3cf230202ce5aba9df2d6e1">LV</a></div><div class="ttdeci">#define LV</div><div class="ttdoc">Latent heat of vaporization of water [J/kg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00224">mptrac.h:224</a></div></div>
<div class="ttc" id="amptrac_8h_html_a6ebf6899d6c1c8b7b9d09be872c05aae"><div class="ttname"><a href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a></div><div class="ttdeci">#define EPS</div><div class="ttdoc">Ratio of the specific gas constant of dry air and water vapor [1].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00209">mptrac.h:209</a></div></div>
<div class="ttc" id="amptrac_8h_html_af48c8f42b5451a04703d55d62ea50a3e"><div class="ttname"><a href="mptrac_8h.html#af48c8f42b5451a04703d55d62ea50a3e">CPD</a></div><div class="ttdeci">#define CPD</div><div class="ttdoc">Specific heat of dry air at constant pressure [J/(kg K)].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00204">mptrac.h:204</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a51f61e053cfec3bdd62fa3a8110e046e" name="a51f61e053cfec3bdd62fa3a8110e046e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51f61e053cfec3bdd62fa3a8110e046e">&#9670;&nbsp;</a></span>level_definitions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void level_definitions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines pressure levels for meteorological data. </p>
<p >This function defines pressure levels for meteorological data based on the given control structure (<code>ctl</code>). Pressure levels are defined differently based on the value of <code>press_level_def</code> in <code>ctl</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Control structure containing information about pressure level definitions.</td></tr>
  </table>
  </dd>
</dl>
<p>The function determines the number of pressure levels (<code>met_np</code>) and the corresponding pressure values (<code>met_p</code>) based on the value of <code>press_level_def</code> in the control structure <code>ctl</code>. It initializes the <code>met_np</code> and <code>met_p</code> fields accordingly.</p>
<dl class="section note"><dt>Note</dt><dd>Valid values for <code>press_level_def</code> are:<ul>
<li>0: Define 138 pressure levels.</li>
<li>1: Define 92 pressure levels.</li>
<li>2: Define 60 pressure levels.</li>
<li>3: Define 147 pressure levels.</li>
<li>4: Define 101 pressure levels.</li>
<li>5: Define 62 pressure levels.</li>
<li>6: Define 137 pressure levels.</li>
<li>7: Define 59 pressure levels. Any other value for <code>press_level_def</code> will result in an error message.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02659">2659</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2660</span>              {</div>
<div class="line"><span class="lineno"> 2661</span> </div>
<div class="line"><span class="lineno"> 2662</span>  <span class="keywordflow">if</span> (0 == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f9887a656e745a4c26dbd7d0730d0fc">met_press_level_def</a>) {</div>
<div class="line"><span class="lineno"> 2663</span> </div>
<div class="line"><span class="lineno"> 2664</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> = 138;</div>
<div class="line"><span class="lineno"> 2665</span> </div>
<div class="line"><span class="lineno"> 2666</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> press[138] = {</div>
<div class="line"><span class="lineno"> 2667</span>      0.0200, 0.0310, 0.0467, 0.0683, 0.0975, 0.1361, 0.1861, 0.2499,</div>
<div class="line"><span class="lineno"> 2668</span>      0.3299, 0.4288, 0.5496, 0.6952, 0.8690, 1.0742, 1.3143, 1.5928, 1.9134,</div>
<div class="line"><span class="lineno"> 2669</span>      2.2797, 2.6954, 3.1642, 3.6898, 4.2759, 4.9262, 5.6441, 6.4334, 7.2974,</div>
<div class="line"><span class="lineno"> 2670</span>      8.2397, 9.2634, 10.3720, 11.5685, 12.8561, 14.2377, 15.7162, 17.2945,</div>
<div class="line"><span class="lineno"> 2671</span>      18.9752, 20.7610, 22.6543, 24.6577, 26.7735, 29.0039, 31.3512, 33.8174,</div>
<div class="line"><span class="lineno"> 2672</span>      36.4047, 39.1149, 41.9493, 44.9082, 47.9915, 51.1990, 54.5299, 57.9834,</div>
<div class="line"><span class="lineno"> 2673</span>      61.5607, 65.2695, 69.1187, 73.1187, 77.2810, 81.6182, 86.1450, 90.8774,</div>
<div class="line"><span class="lineno"> 2674</span>      95.8280, 101.0047, 106.4153, 112.0681, 117.9714, 124.1337, 130.5637,</div>
<div class="line"><span class="lineno"> 2675</span>      137.2703, 144.2624, 151.5493, 159.1403, 167.0450, 175.2731, 183.8344,</div>
<div class="line"><span class="lineno"> 2676</span>      192.7389, 201.9969, 211.6186, 221.6146, 231.9954, 242.7719, 253.9549,</div>
<div class="line"><span class="lineno"> 2677</span>      265.5556, 277.5852, 290.0548, 302.9762, 316.3607, 330.2202, 344.5663,</div>
<div class="line"><span class="lineno"> 2678</span>      359.4111, 374.7666, 390.6450, 407.0583, 424.0190, 441.5395, 459.6321,</div>
<div class="line"><span class="lineno"> 2679</span>      478.3096, 497.5845, 517.4198, 537.7195, 558.3430, 579.1926, 600.1668,</div>
<div class="line"><span class="lineno"> 2680</span>      621.1624, 642.0764, 662.8084, 683.2620, 703.3467, 722.9795, 742.0855,</div>
<div class="line"><span class="lineno"> 2681</span>      760.5996, 778.4661, 795.6396, 812.0847, 827.7756, 842.6959, 856.8376,</div>
<div class="line"><span class="lineno"> 2682</span>      870.2004, 882.7910, 894.6222, 905.7116, 916.0815, 925.7571, 934.7666,</div>
<div class="line"><span class="lineno"> 2683</span>      943.1399, 950.9082, 958.1037, 964.7584, 970.9046, 976.5737, 981.7968,</div>
<div class="line"><span class="lineno"> 2684</span>      986.6036, 991.0230, 995.0824, 998.8081, 1002.2250, 1005.3562, 1008.2239,</div>
<div class="line"><span class="lineno"> 2685</span>      1010.8487, 1013.2500, 1044.45</div>
<div class="line"><span class="lineno"> 2686</span>    };</div>
<div class="line"><span class="lineno"> 2687</span> </div>
<div class="line"><span class="lineno"> 2688</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>; ip++)</div>
<div class="line"><span class="lineno"> 2689</span>      ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> - ip - 1] = press[ip];</div>
<div class="line"><span class="lineno"> 2690</span> </div>
<div class="line"><span class="lineno"> 2691</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f9887a656e745a4c26dbd7d0730d0fc">met_press_level_def</a>) {</div>
<div class="line"><span class="lineno"> 2692</span> </div>
<div class="line"><span class="lineno"> 2693</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> = 92;</div>
<div class="line"><span class="lineno"> 2694</span> </div>
<div class="line"><span class="lineno"> 2695</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> press[92] = {</div>
<div class="line"><span class="lineno"> 2696</span>      0.0200, 0.0398, 0.0739, 0.1291, 0.2141, 0.3395, 0.5175, 0.7617,</div>
<div class="line"><span class="lineno"> 2697</span>      1.0872, 1.5099, 2.0464, 2.7136, 3.5282, 4.5069, 5.6652, 7.0181,</div>
<div class="line"><span class="lineno"> 2698</span>      8.5795, 10.3617, 12.3759, 14.6316, 17.1371, 19.8987, 22.9216, 26.2090,</div>
<div class="line"><span class="lineno"> 2699</span>      29.7630, 33.5843, 37.6720, 42.0242, 46.6378, 51.5086, 56.6316, 61.9984,</div>
<div class="line"><span class="lineno"> 2700</span>      67.5973, 73.4150, 79.4434, 85.7016, 92.2162, 99.0182, 106.1445,</div>
<div class="line"><span class="lineno"> 2701</span>      113.6382,</div>
<div class="line"><span class="lineno"> 2702</span>      121.5502, 129.9403, 138.8558, 148.3260, 158.3816, 169.0545, 180.3786,</div>
<div class="line"><span class="lineno"> 2703</span>      192.3889, 205.1222, 218.6172, 232.9140, 248.0547, 264.0833, 281.0456,</div>
<div class="line"><span class="lineno"> 2704</span>      298.9895, 317.9651, 338.0245, 359.2221, 381.6144, 405.2606, 430.2069,</div>
<div class="line"><span class="lineno"> 2705</span>      456.4813, 483.8505, 512.0662, 540.8577, 569.9401, 599.0310, 627.9668,</div>
<div class="line"><span class="lineno"> 2706</span>      656.6129, 684.8491, 712.5573, 739.5739, 765.7697, 791.0376, 815.2774,</div>
<div class="line"><span class="lineno"> 2707</span>      838.3507, 860.1516, 880.6080, 899.6602, 917.2205, 933.2247, 947.6584,</div>
<div class="line"><span class="lineno"> 2708</span>      960.5245, 971.8169, 981.5301, 989.7322, 996.8732, 1002.8013,</div>
<div class="line"><span class="lineno"> 2709</span>      1007.4431, 1010.8487, 1013.2500, 1044.45</div>
<div class="line"><span class="lineno"> 2710</span>    };</div>
<div class="line"><span class="lineno"> 2711</span> </div>
<div class="line"><span class="lineno"> 2712</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>; ip++)</div>
<div class="line"><span class="lineno"> 2713</span>      ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> - ip - 1] = press[ip];</div>
<div class="line"><span class="lineno"> 2714</span> </div>
<div class="line"><span class="lineno"> 2715</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (2 == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f9887a656e745a4c26dbd7d0730d0fc">met_press_level_def</a>) {</div>
<div class="line"><span class="lineno"> 2716</span> </div>
<div class="line"><span class="lineno"> 2717</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> = 60;</div>
<div class="line"><span class="lineno"> 2718</span> </div>
<div class="line"><span class="lineno"> 2719</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> press[60] = {</div>
<div class="line"><span class="lineno"> 2720</span>      0.01, 0.1361, 0.2499, 0.4288, 0.6952, 1.0742,</div>
<div class="line"><span class="lineno"> 2721</span>      2.2797, 3.1642, 4.2759, 7.2974, 9.2634, 11.5685, 14.2377, 20.761,</div>
<div class="line"><span class="lineno"> 2722</span>      24.6577, 33.8174, 39.1149, 51.199, 57.9834, 73.1187, 81.6182,</div>
<div class="line"><span class="lineno"> 2723</span>      90.8774, 101.005, 112.068, 124.134, 137.27, 151.549, 167.045, 183.834,</div>
<div class="line"><span class="lineno"> 2724</span>      201.997, 221.615, 242.772, 265.556, 290.055, 316.361, 344.566, 374.767,</div>
<div class="line"><span class="lineno"> 2725</span>      407.058, 441.539, 478.31, 517.42, 558.343, 600.167, 683.262, 722.979,</div>
<div class="line"><span class="lineno"> 2726</span>      760.6, 795.64, 827.776, 856.838, 882.791, 905.712, 925.757, 943.14,</div>
<div class="line"><span class="lineno"> 2727</span>      958.104, 972.495, 986.886, 1001.28, 1015.67, 1030.06, 1044.45</div>
<div class="line"><span class="lineno"> 2728</span>    };</div>
<div class="line"><span class="lineno"> 2729</span> </div>
<div class="line"><span class="lineno"> 2730</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>; ip++)</div>
<div class="line"><span class="lineno"> 2731</span>      ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> - ip - 1] = press[ip];</div>
<div class="line"><span class="lineno"> 2732</span> </div>
<div class="line"><span class="lineno"> 2733</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (3 == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f9887a656e745a4c26dbd7d0730d0fc">met_press_level_def</a>) {</div>
<div class="line"><span class="lineno"> 2734</span> </div>
<div class="line"><span class="lineno"> 2735</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> = 147;</div>
<div class="line"><span class="lineno"> 2736</span> </div>
<div class="line"><span class="lineno"> 2737</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> press[147] = {</div>
<div class="line"><span class="lineno"> 2738</span>      0.0200, 0.0310, 0.0467, 0.0683, 0.0975, 0.1361, 0.1861, 0.2499,</div>
<div class="line"><span class="lineno"> 2739</span>      0.3299, 0.4288, 0.5496, 0.6952, 0.8690, 1.0742, 1.3143, 1.5928, 1.9134,</div>
<div class="line"><span class="lineno"> 2740</span>      2.2797, 2.6954, 3.1642, 3.6898, 4.2759, 4.9262, 5.6441, 6.4334, 7.2974,</div>
<div class="line"><span class="lineno"> 2741</span>      8.2397, 9.2634, 10.3720, 11.5685, 12.8561, 14.2377, 15.7162, 17.2945,</div>
<div class="line"><span class="lineno"> 2742</span>      18.9752, 20.7610, 22.6543, 24.6577, 26.7735, 29.0039, 31.3512, 33.8174,</div>
<div class="line"><span class="lineno"> 2743</span>      36.4047, 39.1149, 41.9493, 44.9082, 47.9915, 51.1990, 54.5299, 57.9834,</div>
<div class="line"><span class="lineno"> 2744</span>      61.5607, 65.2695, 69.1187, 73.1187, 77.2810, 81.6182, 86.1450, 90.8774,</div>
<div class="line"><span class="lineno"> 2745</span>      95.8280, 101.0047, 106.4153, 112.0681, 117.9714, 124.1337, 130.5637,</div>
<div class="line"><span class="lineno"> 2746</span>      137.2703, 144.2624, 151.5493, 159.1403, 167.0450, 175.2731, 183.8344,</div>
<div class="line"><span class="lineno"> 2747</span>      192.7389, 201.9969, 211.6186, 221.6146, 231.9954, 242.7719, 253.9549,</div>
<div class="line"><span class="lineno"> 2748</span>      265.5556, 277.5852, 290.0548, 302.9762, 316.3607, 330.2202, 344.5663,</div>
<div class="line"><span class="lineno"> 2749</span>      359.4111, 374.7666, 390.6450, 407.0583, 424.0190, 441.5395, 459.6321,</div>
<div class="line"><span class="lineno"> 2750</span>      478.3096, 497.5845, 517.4198, 537.7195, 558.3430, 579.1926, 600.1668,</div>
<div class="line"><span class="lineno"> 2751</span>      621.1624, 642.0764, 662.8084, 683.2620, 703.3467, 722.9795, 742.0855,</div>
<div class="line"><span class="lineno"> 2752</span>      760.5996, 778.4661, 795.6396, 812.0847, 827.7756, 842.6959, 856.8376,</div>
<div class="line"><span class="lineno"> 2753</span>      870.2004, 882.7910, 894.6222, 905.7116, 916.0815, 925.7571, 934.7666,</div>
<div class="line"><span class="lineno"> 2754</span>      943.1399, 950.9082, 958.1037, 964.7584, 970.9046, 976.5737, 981.7968,</div>
<div class="line"><span class="lineno"> 2755</span>      986.6036, 991.0230, 995.0824, 998.8081, 1002.2250, 1005.3562, 1008.2239,</div>
<div class="line"><span class="lineno"> 2756</span>      1010.8487, 1013.25, 1016.37, 1019.49, 1022.61, 1025.73, 1028.85,</div>
<div class="line"><span class="lineno"> 2757</span>      1031.97,</div>
<div class="line"><span class="lineno"> 2758</span>      1035.09, 1038.21, 1041.33, 1044.45</div>
<div class="line"><span class="lineno"> 2759</span>    };</div>
<div class="line"><span class="lineno"> 2760</span> </div>
<div class="line"><span class="lineno"> 2761</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>; ip++)</div>
<div class="line"><span class="lineno"> 2762</span>      ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> - ip - 1] = press[ip];</div>
<div class="line"><span class="lineno"> 2763</span> </div>
<div class="line"><span class="lineno"> 2764</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (4 == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f9887a656e745a4c26dbd7d0730d0fc">met_press_level_def</a>) {</div>
<div class="line"><span class="lineno"> 2765</span> </div>
<div class="line"><span class="lineno"> 2766</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> = 101;</div>
<div class="line"><span class="lineno"> 2767</span> </div>
<div class="line"><span class="lineno"> 2768</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> press[101] = {</div>
<div class="line"><span class="lineno"> 2769</span>      0.0200, 0.0398, 0.0739, 0.1291, 0.2141, 0.3395, 0.5175, 0.7617,</div>
<div class="line"><span class="lineno"> 2770</span>      1.0872, 1.5099, 2.0464, 2.7136, 3.5282, 4.5069, 5.6652, 7.0181,</div>
<div class="line"><span class="lineno"> 2771</span>      8.5795, 10.3617, 12.3759, 14.6316, 17.1371, 19.8987, 22.9216, 26.2090,</div>
<div class="line"><span class="lineno"> 2772</span>      29.7630, 33.5843, 37.6720, 42.0242, 46.6378, 51.5086, 56.6316, 61.9984,</div>
<div class="line"><span class="lineno"> 2773</span>      67.5973, 73.4150, 79.4434, 85.7016, 92.2162, 99.0182, 106.1445,</div>
<div class="line"><span class="lineno"> 2774</span>      113.6382,</div>
<div class="line"><span class="lineno"> 2775</span>      121.5502, 129.9403, 138.8558, 148.3260, 158.3816, 169.0545, 180.3786,</div>
<div class="line"><span class="lineno"> 2776</span>      192.3889, 205.1222, 218.6172, 232.9140, 248.0547, 264.0833, 281.0456,</div>
<div class="line"><span class="lineno"> 2777</span>      298.9895, 317.9651, 338.0245, 359.2221, 381.6144, 405.2606, 430.2069,</div>
<div class="line"><span class="lineno"> 2778</span>      456.4813, 483.8505, 512.0662, 540.8577, 569.9401, 599.0310, 627.9668,</div>
<div class="line"><span class="lineno"> 2779</span>      656.6129, 684.8491, 712.5573, 739.5739, 765.7697, 791.0376, 815.2774,</div>
<div class="line"><span class="lineno"> 2780</span>      838.3507, 860.1516, 880.6080, 899.6602, 917.2205, 933.2247, 947.6584,</div>
<div class="line"><span class="lineno"> 2781</span>      960.5245, 971.8169, 981.5301, 989.7322, 996.8732, 1002.8013,</div>
<div class="line"><span class="lineno"> 2782</span>      1007.4431, 1010.8487, 1013.25, 1016.37, 1019.49, 1022.61, 1025.73,</div>
<div class="line"><span class="lineno"> 2783</span>      1028.85, 1031.97,</div>
<div class="line"><span class="lineno"> 2784</span>      1035.09, 1038.21, 1041.33, 1044.45</div>
<div class="line"><span class="lineno"> 2785</span>    };</div>
<div class="line"><span class="lineno"> 2786</span> </div>
<div class="line"><span class="lineno"> 2787</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>; ip++)</div>
<div class="line"><span class="lineno"> 2788</span>      ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> - ip - 1] = press[ip];</div>
<div class="line"><span class="lineno"> 2789</span> </div>
<div class="line"><span class="lineno"> 2790</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (5 == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f9887a656e745a4c26dbd7d0730d0fc">met_press_level_def</a>) {</div>
<div class="line"><span class="lineno"> 2791</span> </div>
<div class="line"><span class="lineno"> 2792</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> = 62;</div>
<div class="line"><span class="lineno"> 2793</span> </div>
<div class="line"><span class="lineno"> 2794</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> press[62] = {</div>
<div class="line"><span class="lineno"> 2795</span>      0.01, 0.1361, 0.2499, 0.4288, 0.6952, 1.0742,</div>
<div class="line"><span class="lineno"> 2796</span>      2.2797, 3.1642, 4.2759, 7.2974, 9.2634, 11.5685, 14.2377, 20.761,</div>
<div class="line"><span class="lineno"> 2797</span>      24.6577, 33.8174, 39.1149, 51.199, 57.9834, 73.1187, 81.6182,</div>
<div class="line"><span class="lineno"> 2798</span>      90.8774, 101.005, 112.068, 124.134, 137.27, 151.549, 167.045, 183.834,</div>
<div class="line"><span class="lineno"> 2799</span>      201.997, 221.615, 242.772, 265.556, 290.055, 316.361, 344.566, 374.767,</div>
<div class="line"><span class="lineno"> 2800</span>      407.058, 441.539, 478.31, 517.42, 558.343, 600.167, 683.262, 722.979,</div>
<div class="line"><span class="lineno"> 2801</span>      760.6, 795.64, 827.776, 856.838, 882.791, 905.712, 925.757, 943.14,</div>
<div class="line"><span class="lineno"> 2802</span>      958.104, 972.495, 986.886, 1001.28, 1015.67, 1030.06, 1034.86, 1039.65,</div>
<div class="line"><span class="lineno"> 2803</span>      1044.45</div>
<div class="line"><span class="lineno"> 2804</span>    };</div>
<div class="line"><span class="lineno"> 2805</span> </div>
<div class="line"><span class="lineno"> 2806</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>; ip++)</div>
<div class="line"><span class="lineno"> 2807</span>      ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> - ip - 1] = press[ip];</div>
<div class="line"><span class="lineno"> 2808</span> </div>
<div class="line"><span class="lineno"> 2809</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (6 == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f9887a656e745a4c26dbd7d0730d0fc">met_press_level_def</a>) {</div>
<div class="line"><span class="lineno"> 2810</span> </div>
<div class="line"><span class="lineno"> 2811</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> = 137;</div>
<div class="line"><span class="lineno"> 2812</span> </div>
<div class="line"><span class="lineno"> 2813</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> press[137] = {</div>
<div class="line"><span class="lineno"> 2814</span>      0.01, 0.02, 0.031, 0.0467, 0.0683, 0.0975, 0.1361, 0.1861,</div>
<div class="line"><span class="lineno"> 2815</span>      0.2499, 0.3299, 0.4288, 0.5496, 0.6952, 0.869, 1.0742,</div>
<div class="line"><span class="lineno"> 2816</span>      1.3143, 1.5928, 1.9134, 2.2797, 2.6954, 3.1642, 3.6898,</div>
<div class="line"><span class="lineno"> 2817</span>      4.2759, 4.9262, 5.6441, 6.4334, 7.2974, 8.2397, 9.2634,</div>
<div class="line"><span class="lineno"> 2818</span>      10.372, 11.5685, 12.8561, 14.2377, 15.7162, 17.2945, 18.9752,</div>
<div class="line"><span class="lineno"> 2819</span>      20.761, 22.6543, 24.6577, 26.7735, 29.0039, 31.3512, 33.8174,</div>
<div class="line"><span class="lineno"> 2820</span>      36.4047, 39.1149, 41.9493, 44.9082, 47.9915, 51.199, 54.5299,</div>
<div class="line"><span class="lineno"> 2821</span>      57.9834, 61.5607, 65.2695, 69.1187, 73.1187, 77.281, 81.6182,</div>
<div class="line"><span class="lineno"> 2822</span>      86.145, 90.8774, 95.828, 101.005, 106.415, 112.068, 117.971,</div>
<div class="line"><span class="lineno"> 2823</span>      124.134, 130.564, 137.27, 144.262, 151.549, 159.14, 167.045,</div>
<div class="line"><span class="lineno"> 2824</span>      175.273, 183.834, 192.739, 201.997, 211.619, 221.615, 231.995,</div>
<div class="line"><span class="lineno"> 2825</span>      242.772, 253.955, 265.556, 277.585, 290.055, 302.976, 316.361,</div>
<div class="line"><span class="lineno"> 2826</span>      330.22, 344.566, 359.411, 374.767, 390.645, 407.058, 424.019,</div>
<div class="line"><span class="lineno"> 2827</span>      441.539, 459.632, 478.31, 497.584, 517.42, 537.72, 558.343,</div>
<div class="line"><span class="lineno"> 2828</span>      579.193, 600.167, 621.162, 642.076, 662.808, 683.262, 703.347,</div>
<div class="line"><span class="lineno"> 2829</span>      722.979, 742.086, 760.6, 778.466, 795.64, 812.085, 827.776,</div>
<div class="line"><span class="lineno"> 2830</span>      842.696, 856.838, 870.2, 882.791, 894.622, 905.712, 916.081,</div>
<div class="line"><span class="lineno"> 2831</span>      925.757, 934.767, 943.14, 950.908, 958.104, 965.299, 972.495,</div>
<div class="line"><span class="lineno"> 2832</span>      979.69, 986.886, 994.081, 1001.28, 1008.47, 1015.67, 1022.86,</div>
<div class="line"><span class="lineno"> 2833</span>      1030.06, 1037.25, 1044.45</div>
<div class="line"><span class="lineno"> 2834</span>    };</div>
<div class="line"><span class="lineno"> 2835</span> </div>
<div class="line"><span class="lineno"> 2836</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>; ip++)</div>
<div class="line"><span class="lineno"> 2837</span>      ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> - ip - 1] = press[ip];</div>
<div class="line"><span class="lineno"> 2838</span> </div>
<div class="line"><span class="lineno"> 2839</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (7 == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f9887a656e745a4c26dbd7d0730d0fc">met_press_level_def</a>) {</div>
<div class="line"><span class="lineno"> 2840</span> </div>
<div class="line"><span class="lineno"> 2841</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> = 59;</div>
<div class="line"><span class="lineno"> 2842</span> </div>
<div class="line"><span class="lineno"> 2843</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> press[59] = {</div>
<div class="line"><span class="lineno"> 2844</span>      0.1, 0.2, 0.3843, 0.6365, 0.9564, 1.3448, 1.8058, 2.3478,</div>
<div class="line"><span class="lineno"> 2845</span>      2.985, 3.7397, 4.6462, 5.7565, 7.1322, 8.8366, 10.9483,</div>
<div class="line"><span class="lineno"> 2846</span>      13.5647, 16.8064, 20.8227, 25.7989, 31.9642, 39.6029, 49.0671,</div>
<div class="line"><span class="lineno"> 2847</span>      60.1802, 73.0663, 87.7274, 104.229, 122.614, 142.902, 165.089,</div>
<div class="line"><span class="lineno"> 2848</span>      189.147, 215.025, 242.652, 272.059, 303.217, 336.044, 370.407,</div>
<div class="line"><span class="lineno"> 2849</span>      406.133, 443.009, 480.791, 519.209, 557.973, 596.777, 635.306,</div>
<div class="line"><span class="lineno"> 2850</span>      673.24, 710.263, 746.063, 780.346, 812.83, 843.263, 871.42,</div>
<div class="line"><span class="lineno"> 2851</span>      897.112, 920.189, 940.551, 958.148, 975.744, 993.341, 1010.94,</div>
<div class="line"><span class="lineno"> 2852</span>      1028.53, 1046.13</div>
<div class="line"><span class="lineno"> 2853</span>    };</div>
<div class="line"><span class="lineno"> 2854</span> </div>
<div class="line"><span class="lineno"> 2855</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>; ip++)</div>
<div class="line"><span class="lineno"> 2856</span>      ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> - ip - 1] = press[ip];</div>
<div class="line"><span class="lineno"> 2857</span> </div>
<div class="line"><span class="lineno"> 2858</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2859</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Use 0 for l137, 1 for l91, 2 for l60 or values between 3 and 7.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2860</span>  }</div>
<div class="line"><span class="lineno"> 2861</span> </div>
<div class="line"><span class="lineno"> 2862</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> &gt; <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>) {</div>
<div class="line"><span class="lineno"> 2863</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Recompile with larger EP to use this pressure level definition.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2864</span>  }</div>
<div class="line"><span class="lineno"> 2865</span>}</div>
<div class="ttc" id="astructctl__t_html_a7f9887a656e745a4c26dbd7d0730d0fc"><div class="ttname"><a href="structctl__t.html#a7f9887a656e745a4c26dbd7d0730d0fc">ctl_t::met_press_level_def</a></div><div class="ttdeci">int met_press_level_def</div><div class="ttdoc">Use predefined pressure levels or not.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02576">mptrac.h:2576</a></div></div>
<div class="ttc" id="astructctl__t_html_acd95a4753595490c2723383bd09ca035"><div class="ttname"><a href="structctl__t.html#acd95a4753595490c2723383bd09ca035">ctl_t::met_np</a></div><div class="ttdeci">int met_np</div><div class="ttdoc">Number of target pressure levels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02570">mptrac.h:2570</a></div></div>
<div class="ttc" id="astructctl__t_html_aeffc15a483bdb95fea0f1b44982e7281"><div class="ttname"><a href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">ctl_t::met_p</a></div><div class="ttdeci">double met_p[EP]</div><div class="ttdoc">Target pressure levels [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02573">mptrac.h:2573</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e1b87dc3c93a23c89f739adf10b60dc" name="a4e1b87dc3c93a23c89f739adf10b60dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e1b87dc3c93a23c89f739adf10b60dc">&#9670;&nbsp;</a></span>locate_irr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int locate_irr </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locate the index of the interval containing a given value in a sorted array. </p>
<p >This function locates the index of the interval containing a given value in a sorted array. It uses a binary search algorithm to efficiently find the interval.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xx</td><td>Pointer to the sorted array. </td></tr>
    <tr><td class="paramname">n</td><td>Size of the array. </td></tr>
    <tr><td class="paramname">x</td><td>Value to be located. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index of the interval containing the value <code>x</code>.</dd></dl>
<p>The function assumes that the array <code>xx</code> is sorted in ascending order. It returns the index of the interval where the value <code>x</code> is located. If the value <code>x</code> is outside the range of the array, the function returns the index of the closest interval.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02869">2869</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2872</span>                  {</div>
<div class="line"><span class="lineno"> 2873</span> </div>
<div class="line"><span class="lineno"> 2874</span>  <span class="keywordtype">int</span> ilo = 0;</div>
<div class="line"><span class="lineno"> 2875</span>  <span class="keywordtype">int</span> ihi = n - 1;</div>
<div class="line"><span class="lineno"> 2876</span>  <span class="keywordtype">int</span> i = (ihi + ilo) &gt;&gt; 1;</div>
<div class="line"><span class="lineno"> 2877</span> </div>
<div class="line"><span class="lineno"> 2878</span>  <span class="keywordflow">if</span> (xx[i] &lt; xx[i + 1])</div>
<div class="line"><span class="lineno"> 2879</span>    <span class="keywordflow">while</span> (ihi &gt; ilo + 1) {</div>
<div class="line"><span class="lineno"> 2880</span>      i = (ihi + ilo) &gt;&gt; 1;</div>
<div class="line"><span class="lineno"> 2881</span>      <span class="keywordflow">if</span> (xx[i] &gt; x)</div>
<div class="line"><span class="lineno"> 2882</span>        ihi = i;</div>
<div class="line"><span class="lineno"> 2883</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2884</span>        ilo = i;</div>
<div class="line"><span class="lineno"> 2885</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2886</span>    <span class="keywordflow">while</span> (ihi &gt; ilo + 1) {</div>
<div class="line"><span class="lineno"> 2887</span>      i = (ihi + ilo) &gt;&gt; 1;</div>
<div class="line"><span class="lineno"> 2888</span>      <span class="keywordflow">if</span> (xx[i] &lt;= x)</div>
<div class="line"><span class="lineno"> 2889</span>        ihi = i;</div>
<div class="line"><span class="lineno"> 2890</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2891</span>        ilo = i;</div>
<div class="line"><span class="lineno"> 2892</span>    }</div>
<div class="line"><span class="lineno"> 2893</span> </div>
<div class="line"><span class="lineno"> 2894</span>  <span class="keywordflow">return</span> ilo;</div>
<div class="line"><span class="lineno"> 2895</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b9ae6cda41f85d46c6333d039ee0861" name="a8b9ae6cda41f85d46c6333d039ee0861"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b9ae6cda41f85d46c6333d039ee0861">&#9670;&nbsp;</a></span>locate_irr_float()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int locate_irr_float </td>
          <td>(</td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locate the index of the interval containing a given value in an irregularly spaced array. </p>
<p >This function performs a binary search to locate the interval in the array <code>xx</code> such that <code>xx[ig] &lt;= x &lt; xx[ig + 1]</code>. If the value <code>x</code> lies within the interval specified by the initial guess index <code>ig</code>, the function returns <code>ig</code>. Otherwise, it searches the array to find the correct interval.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xx</td><td>Pointer to the array of floats representing the irregularly spaced intervals. The array must be of size <code>n</code>. </td></tr>
    <tr><td class="paramname">n</td><td>The number of elements in the array <code>xx</code>. </td></tr>
    <tr><td class="paramname">x</td><td>The value to locate within the intervals of the array <code>xx</code>. </td></tr>
    <tr><td class="paramname">ig</td><td>The initial guess index. If the interval <code>[xx[ig], xx[ig+1])</code> contains <code>x</code>, the function returns <code>ig</code> directly.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The index <code>i</code> such that <code>xx[i] &lt;= x &lt; xx[i + 1]</code>. If <code>x</code> is out of bounds, it returns the index of the closest interval.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the array <code>xx</code> contains at least two elements. </dd>
<dd>
The function can handle both increasing and decreasing sequences in the array <code>xx</code>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The behavior is undefined if the array <code>xx</code> is not sorted in either increasing or decreasing order, or if it contains less than two elements.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02899">2899</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2903</span>                {</div>
<div class="line"><span class="lineno"> 2904</span> </div>
<div class="line"><span class="lineno"> 2905</span>  <span class="keywordtype">int</span> ilo = 0;</div>
<div class="line"><span class="lineno"> 2906</span>  <span class="keywordtype">int</span> ihi = n - 1;</div>
<div class="line"><span class="lineno"> 2907</span>  <span class="keywordtype">int</span> i = (ihi + ilo) &gt;&gt; 1;</div>
<div class="line"><span class="lineno"> 2908</span> </div>
<div class="line"><span class="lineno"> 2909</span>  <span class="keywordflow">if</span> ((xx[ig] &lt;= x &amp;&amp; x &lt; xx[ig + 1]) || (xx[ig] &gt;= x &amp;&amp; x &gt; xx[ig + 1]))</div>
<div class="line"><span class="lineno"> 2910</span>    <span class="keywordflow">return</span> ig;</div>
<div class="line"><span class="lineno"> 2911</span> </div>
<div class="line"><span class="lineno"> 2912</span>  <span class="keywordflow">if</span> (xx[i] &lt; xx[i + 1])</div>
<div class="line"><span class="lineno"> 2913</span>    <span class="keywordflow">while</span> (ihi &gt; ilo + 1) {</div>
<div class="line"><span class="lineno"> 2914</span>      i = (ihi + ilo) &gt;&gt; 1;</div>
<div class="line"><span class="lineno"> 2915</span>      <span class="keywordflow">if</span> (xx[i] &gt; x)</div>
<div class="line"><span class="lineno"> 2916</span>        ihi = i;</div>
<div class="line"><span class="lineno"> 2917</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2918</span>        ilo = i;</div>
<div class="line"><span class="lineno"> 2919</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2920</span>    <span class="keywordflow">while</span> (ihi &gt; ilo + 1) {</div>
<div class="line"><span class="lineno"> 2921</span>      i = (ihi + ilo) &gt;&gt; 1;</div>
<div class="line"><span class="lineno"> 2922</span>      <span class="keywordflow">if</span> (xx[i] &lt;= x)</div>
<div class="line"><span class="lineno"> 2923</span>        ihi = i;</div>
<div class="line"><span class="lineno"> 2924</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2925</span>        ilo = i;</div>
<div class="line"><span class="lineno"> 2926</span>    }</div>
<div class="line"><span class="lineno"> 2927</span> </div>
<div class="line"><span class="lineno"> 2928</span>  <span class="keywordflow">return</span> ilo;</div>
<div class="line"><span class="lineno"> 2929</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a3c8ab98f21179741b274439786726d" name="a2a3c8ab98f21179741b274439786726d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a3c8ab98f21179741b274439786726d">&#9670;&nbsp;</a></span>locate_reg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int locate_reg </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locate the index of the interval containing a given value in a regular grid. </p>
<p >This function locates the index of the interval containing a given value in a regular grid. It calculates the index based on the spacing between grid points and the value to be located.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xx</td><td>Pointer to the array representing the regular grid. </td></tr>
    <tr><td class="paramname">n</td><td>Size of the grid (number of grid points). </td></tr>
    <tr><td class="paramname">x</td><td>Value to be located. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index of the interval containing the value <code>x</code>.</dd></dl>
<p>The function assumes that the array <code>xx</code> represents a regular grid with equally spaced points. It calculates the index of the interval where the value <code>x</code> is located based on the spacing between grid points. If the value <code>x</code> is outside the range of the grid, the function returns the index of the closest interval.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02933">2933</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2936</span>                  {</div>
<div class="line"><span class="lineno"> 2937</span> </div>
<div class="line"><span class="lineno"> 2938</span>  <span class="comment">/* Calculate index... */</span></div>
<div class="line"><span class="lineno"> 2939</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> i = (int) ((x - xx[0]) / (xx[1] - xx[0]));</div>
<div class="line"><span class="lineno"> 2940</span> </div>
<div class="line"><span class="lineno"> 2941</span>  <span class="comment">/* Check range... */</span></div>
<div class="line"><span class="lineno"> 2942</span>  <span class="keywordflow">if</span> (i &lt; 0)</div>
<div class="line"><span class="lineno"> 2943</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2944</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt; n - 2)</div>
<div class="line"><span class="lineno"> 2945</span>    <span class="keywordflow">return</span> n - 2;</div>
<div class="line"><span class="lineno"> 2946</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2947</span>    <span class="keywordflow">return</span> i;</div>
<div class="line"><span class="lineno"> 2948</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c56a2456275955981415456e631243f" name="a2c56a2456275955981415456e631243f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c56a2456275955981415456e631243f">&#9670;&nbsp;</a></span>locate_vert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void locate_vert </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>profiles</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>lon_ap_ind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>lat_ap_ind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>alt_ap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ind</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locate the four vertical indizes of a box for a given height value. </p>
<p >This function locates the vertical indices corresponding to a given height in a 3D irregular grid. It calculates the indices based on the specified longitude and latitude indices of the grid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">profiles</td><td>3D array representing the irregular grid. </td></tr>
    <tr><td class="paramname">np</td><td>Size of the profile (number of data points). </td></tr>
    <tr><td class="paramname">lon_ap_ind</td><td>Index of the longitude. </td></tr>
    <tr><td class="paramname">lat_ap_ind</td><td>Index of the latitude. </td></tr>
    <tr><td class="paramname">alt_ap</td><td>Height value. </td></tr>
    <tr><td class="paramname">ind</td><td>Pointer to an array to store the resulting indices.</td></tr>
  </table>
  </dd>
</dl>
<p>The function calculates the indices corresponding to the specified height in the 3D irregular grid. It stores the resulting indices in the array pointed to by <code>ind</code>. The indices are calculated based on the specified longitude and latitude indices of the grid.</p>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02952">2952</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2958</span>            {</div>
<div class="line"><span class="lineno"> 2959</span> </div>
<div class="line"><span class="lineno"> 2960</span>  ind[0] = <a class="code hl_function" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861">locate_irr_float</a>(profiles[lon_ap_ind][lat_ap_ind],</div>
<div class="line"><span class="lineno"> 2961</span>                            np, height_ap, 0);</div>
<div class="line"><span class="lineno"> 2962</span>  ind[1] = <a class="code hl_function" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861">locate_irr_float</a>(profiles[lon_ap_ind + 1][lat_ap_ind],</div>
<div class="line"><span class="lineno"> 2963</span>                            np, height_ap, ind[0]);</div>
<div class="line"><span class="lineno"> 2964</span>  ind[2] = <a class="code hl_function" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861">locate_irr_float</a>(profiles[lon_ap_ind][lat_ap_ind + 1],</div>
<div class="line"><span class="lineno"> 2965</span>                            np, height_ap, ind[1]);</div>
<div class="line"><span class="lineno"> 2966</span>  ind[3] = <a class="code hl_function" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861">locate_irr_float</a>(profiles[lon_ap_ind + 1][lat_ap_ind + 1],</div>
<div class="line"><span class="lineno"> 2967</span>                            np, height_ap, ind[2]);</div>
<div class="line"><span class="lineno"> 2968</span>}</div>
<div class="ttc" id="amptrac_8c_html_a8b9ae6cda41f85d46c6333d039ee0861"><div class="ttname"><a href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861">locate_irr_float</a></div><div class="ttdeci">int locate_irr_float(const float *xx, const int n, const double x, const int ig)</div><div class="ttdoc">Locate the index of the interval containing a given value in an irregularly spaced array.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02899">mptrac.c:2899</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a2c56a2456275955981415456e631243f_cgraph.png" border="0" usemap="#amptrac_8h_a2c56a2456275955981415456e631243f_cgraph" alt=""/></div>
<map name="amptrac_8h_a2c56a2456275955981415456e631243f_cgraph" id="amptrac_8h_a2c56a2456275955981415456e631243f_cgraph">
<area shape="rect" title="Locate the four vertical indizes of a box for a given height value." alt="" coords="5,5,92,32"/>
<area shape="rect" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861" title="Locate the index of the interval containing a given value in an irregularly spaced array." alt="" coords="140,5,247,32"/>
</map>
</div>

</div>
</div>
<a id="a16101092a4f867b18cf1d4feb3189d1d" name="a16101092a4f867b18cf1d4feb3189d1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16101092a4f867b18cf1d4feb3189d1d">&#9670;&nbsp;</a></span>module_advect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_advect </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Advances particle positions using different advection schemes. </p>
<p >This function updates the positions of atmospheric particles using different advection schemes based on vertical velocity formulations (omega or zetadot). The advection is performed over a number of integration nodes, using meteorological data interpolated in time and space.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the control structure containing configuration settings. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cache</td><td>Pointer to the cache structure storing precomputed time step values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met0</td><td>Pointer to the meteorological data structure at the initial time. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met1</td><td>Pointer to the meteorological data structure at the next time step. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle states.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>If <code>ctl-&gt;advect_vert_coord</code> is 0 or 2, the function uses omega vertical velocity.</li>
<li>If <code>ctl-&gt;advect_vert_coord</code> is 1, the function uses zetadot vertical velocity.</li>
<li>The function interpolates meteorological data either on pressure levels or model levels.</li>
<li>The advection scheme supports different integration methods (e.g., two-stage, four-stage).</li>
<li>The function updates longitude, latitude, and pressure (or zeta) for each particle.</li>
<li>Special handling is applied to ensure <code>zeta</code> values remain non-negative.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l02972">2972</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2977</span>              {</div>
<div class="line"><span class="lineno"> 2978</span> </div>
<div class="line"><span class="lineno"> 2979</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 2980</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_ADVECT&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 2981</span> </div>
<div class="line"><span class="lineno"> 2982</span>  <span class="comment">/* Use omega vertical velocity... */</span></div>
<div class="line"><span class="lineno"> 2983</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 2) {</div>
<div class="line"><span class="lineno"> 2984</span> </div>
<div class="line"><span class="lineno"> 2985</span>    <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 2986</span>    <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(ctl,cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 2987</span> </div>
<div class="line"><span class="lineno"> 2988</span>      <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 2989</span>      <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 2990</span>      <span class="keywordtype">double</span> dts, u[4], um = 0, v[4], vm = 0, w[4], wm = 0,</div>
<div class="line"><span class="lineno"> 2991</span>        x[3] = { 0, 0, 0 };</div>
<div class="line"><span class="lineno"> 2992</span> </div>
<div class="line"><span class="lineno"> 2993</span>      <span class="comment">/* Loop over integration nodes... */</span></div>
<div class="line"><span class="lineno"> 2994</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a>; i++) {</div>
<div class="line"><span class="lineno"> 2995</span> </div>
<div class="line"><span class="lineno"> 2996</span>        <span class="comment">/* Set position... */</span></div>
<div class="line"><span class="lineno"> 2997</span>        <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><span class="lineno"> 2998</span>          dts = 0.0;</div>
<div class="line"><span class="lineno"> 2999</span>          x[0] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip];</div>
<div class="line"><span class="lineno"> 3000</span>          x[1] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip];</div>
<div class="line"><span class="lineno"> 3001</span>          x[2] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip];</div>
<div class="line"><span class="lineno"> 3002</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3003</span>          dts = (i == 3 ? 1.0 : 0.5) * cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip];</div>
<div class="line"><span class="lineno"> 3004</span>          x[0] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] + <a class="code hl_define" href="mptrac_8h.html#a6b22b78dc1239748a44cbd2db4862ef4">DX2DEG</a>(dts * u[i - 1] / 1000., atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]);</div>
<div class="line"><span class="lineno"> 3005</span>          x[1] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] + <a class="code hl_define" href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">DY2DEG</a>(dts * v[i - 1] / 1000.);</div>
<div class="line"><span class="lineno"> 3006</span>          x[2] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] + dts * w[i - 1];</div>
<div class="line"><span class="lineno"> 3007</span>        }</div>
<div class="line"><span class="lineno"> 3008</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> tm = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] + dts;</div>
<div class="line"><span class="lineno"> 3009</span> </div>
<div class="line"><span class="lineno"> 3010</span>        <span class="comment">/* Interpolate meteo data on pressure levels... */</span></div>
<div class="line"><span class="lineno"> 3011</span>        <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 0) {</div>
<div class="line"><span class="lineno"> 3012</span>          <a class="code hl_function" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>,</div>
<div class="line"><span class="lineno"> 3013</span>                             tm, x[2], x[0], x[1], &amp;u[i], ci, cw, 1);</div>
<div class="line"><span class="lineno"> 3014</span>          <a class="code hl_function" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>,</div>
<div class="line"><span class="lineno"> 3015</span>                             tm, x[2], x[0], x[1], &amp;v[i], ci, cw, 0);</div>
<div class="line"><span class="lineno"> 3016</span>          <a class="code hl_function" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>,</div>
<div class="line"><span class="lineno"> 3017</span>                             tm, x[2], x[0], x[1], &amp;w[i], ci, cw, 0);</div>
<div class="line"><span class="lineno"> 3018</span>        }</div>
<div class="line"><span class="lineno"> 3019</span> </div>
<div class="line"><span class="lineno"> 3020</span>        <span class="comment">/* Interpolate meteo data on model levels... */</span></div>
<div class="line"><span class="lineno"> 3021</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3022</span>          <a class="code hl_function" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190">intpol_met_4d_zeta</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a760447bb9eca0826b3705f30a9b8f165">ul</a>,</div>
<div class="line"><span class="lineno"> 3023</span>                             met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a760447bb9eca0826b3705f30a9b8f165">ul</a>,</div>
<div class="line"><span class="lineno"> 3024</span>                             tm, x[2], x[0], x[1], &amp;u[i], ci, cw, 1);</div>
<div class="line"><span class="lineno"> 3025</span>          <a class="code hl_function" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190">intpol_met_4d_zeta</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a4b4aaeb8f39dea0fb511744f84535303">vl</a>,</div>
<div class="line"><span class="lineno"> 3026</span>                             met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a4b4aaeb8f39dea0fb511744f84535303">vl</a>,</div>
<div class="line"><span class="lineno"> 3027</span>                             tm, x[2], x[0], x[1], &amp;v[i], ci, cw, 0);</div>
<div class="line"><span class="lineno"> 3028</span>          <a class="code hl_function" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190">intpol_met_4d_zeta</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a4618b608901900608688f4f649dfbfc4">wl</a>,</div>
<div class="line"><span class="lineno"> 3029</span>                             met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a4618b608901900608688f4f649dfbfc4">wl</a>,</div>
<div class="line"><span class="lineno"> 3030</span>                             tm, x[2], x[0], x[1], &amp;w[i], ci, cw, 0);</div>
<div class="line"><span class="lineno"> 3031</span>        }</div>
<div class="line"><span class="lineno"> 3032</span> </div>
<div class="line"><span class="lineno"> 3033</span>        <span class="comment">/* Get mean wind... */</span></div>
<div class="line"><span class="lineno"> 3034</span>        <span class="keywordtype">double</span> k = 1.0;</div>
<div class="line"><span class="lineno"> 3035</span>        <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> == 2)</div>
<div class="line"><span class="lineno"> 3036</span>          k = (i == 0 ? 0.0 : 1.0);</div>
<div class="line"><span class="lineno"> 3037</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> == 4)</div>
<div class="line"><span class="lineno"> 3038</span>          k = (i == 0 || i == 3 ? 1.0 / 6.0 : 2.0 / 6.0);</div>
<div class="line"><span class="lineno"> 3039</span>        um += k * u[i];</div>
<div class="line"><span class="lineno"> 3040</span>        vm += k * v[i];</div>
<div class="line"><span class="lineno"> 3041</span>        wm += k * w[i];</div>
<div class="line"><span class="lineno"> 3042</span>      }</div>
<div class="line"><span class="lineno"> 3043</span> </div>
<div class="line"><span class="lineno"> 3044</span>      <span class="comment">/* Set new position... */</span></div>
<div class="line"><span class="lineno"> 3045</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] += cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip];</div>
<div class="line"><span class="lineno"> 3046</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] += <a class="code hl_define" href="mptrac_8h.html#a6b22b78dc1239748a44cbd2db4862ef4">DX2DEG</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * um / 1000.,</div>
<div class="line"><span class="lineno"> 3047</span>                             (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> == 2 ? x[1] : atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]));</div>
<div class="line"><span class="lineno"> 3048</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] += <a class="code hl_define" href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">DY2DEG</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * vm / 1000.);</div>
<div class="line"><span class="lineno"> 3049</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] += cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * wm;</div>
<div class="line"><span class="lineno"> 3050</span>    }</div>
<div class="line"><span class="lineno"> 3051</span>  }</div>
<div class="line"><span class="lineno"> 3052</span> </div>
<div class="line"><span class="lineno"> 3053</span>  <span class="comment">/* Use zeta or eta vertical velocity... */</span></div>
<div class="line"><span class="lineno"> 3054</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 1 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 3) {</div>
<div class="line"><span class="lineno"> 3055</span> </div>
<div class="line"><span class="lineno"> 3056</span>    <span class="comment">/* Select quantity index depending on coordinate... */</span></div>
<div class="line"><span class="lineno"> 3057</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> qnt = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 1</div>
<div class="line"><span class="lineno"> 3058</span>                     ? ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9382d9e9b29e10eeee582e1e10ff365a">qnt_zeta</a> : ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a59254cd97a92694d95b7fb6b384c4d3f">qnt_eta</a>);</div>
<div class="line"><span class="lineno"> 3059</span> </div>
<div class="line"><span class="lineno"> 3060</span>    <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 3061</span>    <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(ctl,cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 3062</span> </div>
<div class="line"><span class="lineno"> 3063</span>      <span class="comment">/* Convert pressure to vertical coordinate (zeta or eta)... */</span></div>
<div class="line"><span class="lineno"> 3064</span>      <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 3065</span>      <a class="code hl_function" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190">intpol_met_4d_zeta</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>,</div>
<div class="line"><span class="lineno"> 3066</span>                         met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, met1-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>,</div>
<div class="line"><span class="lineno"> 3067</span>                         atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip],</div>
<div class="line"><span class="lineno"> 3068</span>                         atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip],</div>
<div class="line"><span class="lineno"> 3069</span>                         &amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[qnt][ip], ci, cw, 1);</div>
<div class="line"><span class="lineno"> 3070</span> </div>
<div class="line"><span class="lineno"> 3071</span>      <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 3072</span>      <span class="keywordtype">double</span> dts, u[4], um = 0, v[4], vm = 0, wdot[4],</div>
<div class="line"><span class="lineno"> 3073</span>        wdotm = 0, x[3] = { 0, 0, 0 };</div>
<div class="line"><span class="lineno"> 3074</span> </div>
<div class="line"><span class="lineno"> 3075</span>      <span class="comment">/* Loop over integration nodes (RungeKutta steps)... */</span></div>
<div class="line"><span class="lineno"> 3076</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a>; i++) {</div>
<div class="line"><span class="lineno"> 3077</span> </div>
<div class="line"><span class="lineno"> 3078</span>        <span class="comment">/* Set position... */</span></div>
<div class="line"><span class="lineno"> 3079</span>        <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><span class="lineno"> 3080</span>          dts = 0.0;</div>
<div class="line"><span class="lineno"> 3081</span>          x[0] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip];</div>
<div class="line"><span class="lineno"> 3082</span>          x[1] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip];</div>
<div class="line"><span class="lineno"> 3083</span>          x[2] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[qnt][ip];</div>
<div class="line"><span class="lineno"> 3084</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3085</span>          dts = (i == 3 ? 1.0 : 0.5) * cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip];</div>
<div class="line"><span class="lineno"> 3086</span>          x[0] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] + <a class="code hl_define" href="mptrac_8h.html#a6b22b78dc1239748a44cbd2db4862ef4">DX2DEG</a>(dts * u[i - 1] / 1000., atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]);</div>
<div class="line"><span class="lineno"> 3087</span>          x[1] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] + <a class="code hl_define" href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">DY2DEG</a>(dts * v[i - 1] / 1000.);</div>
<div class="line"><span class="lineno"> 3088</span>          x[2] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[qnt][ip] + dts * wdot[i - 1];</div>
<div class="line"><span class="lineno"> 3089</span>        }</div>
<div class="line"><span class="lineno"> 3090</span> </div>
<div class="line"><span class="lineno"> 3091</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> tm = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] + dts;</div>
<div class="line"><span class="lineno"> 3092</span> </div>
<div class="line"><span class="lineno"> 3093</span>        <span class="comment">/* Interpolate meteo data... */</span></div>
<div class="line"><span class="lineno"> 3094</span>        <a class="code hl_function" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190">intpol_met_4d_zeta</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a760447bb9eca0826b3705f30a9b8f165">ul</a>,</div>
<div class="line"><span class="lineno"> 3095</span>                           met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a760447bb9eca0826b3705f30a9b8f165">ul</a>,</div>
<div class="line"><span class="lineno"> 3096</span>                           tm, x[2], x[0], x[1], &amp;u[i], ci, cw, 1);</div>
<div class="line"><span class="lineno"> 3097</span>        <a class="code hl_function" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190">intpol_met_4d_zeta</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a4b4aaeb8f39dea0fb511744f84535303">vl</a>,</div>
<div class="line"><span class="lineno"> 3098</span>                           met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a4b4aaeb8f39dea0fb511744f84535303">vl</a>,</div>
<div class="line"><span class="lineno"> 3099</span>                           tm, x[2], x[0], x[1], &amp;v[i], ci, cw, 0);</div>
<div class="line"><span class="lineno"> 3100</span>        <a class="code hl_function" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190">intpol_met_4d_zeta</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a1153b31e69a6542d2ee83d60c38f7bb1">zeta_dotl</a>,</div>
<div class="line"><span class="lineno"> 3101</span>                           met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a1153b31e69a6542d2ee83d60c38f7bb1">zeta_dotl</a>,</div>
<div class="line"><span class="lineno"> 3102</span>                           tm, x[2], x[0], x[1], &amp;wdot[i], ci, cw, 0);</div>
<div class="line"><span class="lineno"> 3103</span> </div>
<div class="line"><span class="lineno"> 3104</span>        <span class="comment">/* Compute RungeKutta weights... */</span></div>
<div class="line"><span class="lineno"> 3105</span>        <span class="keywordtype">double</span> k = 1.0;</div>
<div class="line"><span class="lineno"> 3106</span>        <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> == 2)</div>
<div class="line"><span class="lineno"> 3107</span>          k = (i == 0 ? 0.0 : 1.0);</div>
<div class="line"><span class="lineno"> 3108</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> == 4)</div>
<div class="line"><span class="lineno"> 3109</span>          k = (i == 0 || i == 3 ? 1.0 / 6.0 : 2.0 / 6.0);</div>
<div class="line"><span class="lineno"> 3110</span> </div>
<div class="line"><span class="lineno"> 3111</span>        um += k * u[i];</div>
<div class="line"><span class="lineno"> 3112</span>        vm += k * v[i];</div>
<div class="line"><span class="lineno"> 3113</span>        wdotm += k * wdot[i];</div>
<div class="line"><span class="lineno"> 3114</span>      }</div>
<div class="line"><span class="lineno"> 3115</span> </div>
<div class="line"><span class="lineno"> 3116</span>      <span class="comment">/* Update particle position... */</span></div>
<div class="line"><span class="lineno"> 3117</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] += cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip];</div>
<div class="line"><span class="lineno"> 3118</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] += <a class="code hl_define" href="mptrac_8h.html#a6b22b78dc1239748a44cbd2db4862ef4">DX2DEG</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * um / 1000.,</div>
<div class="line"><span class="lineno"> 3119</span>                             (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> == 2 ? x[1] : atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]));</div>
<div class="line"><span class="lineno"> 3120</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] += <a class="code hl_define" href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">DY2DEG</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * vm / 1000.);</div>
<div class="line"><span class="lineno"> 3121</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[qnt][ip] += cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * wdotm;</div>
<div class="line"><span class="lineno"> 3122</span> </div>
<div class="line"><span class="lineno"> 3123</span>      <span class="comment">/* Convert vertical coordinate (zeta or eta) back to pressure... */</span></div>
<div class="line"><span class="lineno"> 3124</span>      <a class="code hl_function" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190">intpol_met_4d_zeta</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>,</div>
<div class="line"><span class="lineno"> 3125</span>                         met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>, met1-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>,</div>
<div class="line"><span class="lineno"> 3126</span>                         atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip],</div>
<div class="line"><span class="lineno"> 3127</span>                         atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[qnt][ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip],</div>
<div class="line"><span class="lineno"> 3128</span>                         &amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], ci, cw, 1);</div>
<div class="line"><span class="lineno"> 3129</span>    }</div>
<div class="line"><span class="lineno"> 3130</span>  }</div>
<div class="line"><span class="lineno"> 3131</span>}</div>
<div class="ttc" id="amptrac_8c_html_a5819df4f969928e2f45144e44feb50a6"><div class="ttname"><a href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a></div><div class="ttdeci">void intpol_met_time_3d(const met_t *met0, float array0[EX][EY][EP], const met_t *met1, float array1[EX][EY][EP], const double ts, const double p, const double lon, const double lat, double *var, int *ci, double *cw, const int init)</div><div class="ttdoc">Interpolates meteorological data in 3D space and time.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02429">mptrac.c:2429</a></div></div>
<div class="ttc" id="amptrac_8c_html_ab5b4d31bdb9e487738d576ced596d190"><div class="ttname"><a href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190">intpol_met_4d_zeta</a></div><div class="ttdeci">void intpol_met_4d_zeta(const met_t *met0, float heights0[EX][EY][EP], float array0[EX][EY][EP], const met_t *met1, float heights1[EX][EY][EP], float array1[EX][EY][EP], const double ts, const double height, const double lon, const double lat, double *var, int *ci, double *cw, const int init)</div><div class="ttdoc">Interpolates meteorological variables to a given position and time.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02141">mptrac.c:2141</a></div></div>
<div class="ttc" id="amptrac_8h_html_a11241b8a58cfbbe8cc92e1db4aff45ab"><div class="ttname"><a href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a></div><div class="ttdeci">#define PARTICLE_LOOP(ip0, ip1, check_dt,...)</div><div class="ttdoc">Loop over particle indices with OpenACC acceleration.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01413">mptrac.h:1413</a></div></div>
<div class="ttc" id="amptrac_8h_html_a2b61365bd73a3cf3c059940b7e008749"><div class="ttname"><a href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a></div><div class="ttdeci">#define SELECT_TIMER(id, group)</div><div class="ttdoc">Select and start a timer with specific attributes.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02117">mptrac.h:2117</a></div></div>
<div class="ttc" id="amptrac_8h_html_a6b22b78dc1239748a44cbd2db4862ef4"><div class="ttname"><a href="mptrac_8h.html#a6b22b78dc1239748a44cbd2db4862ef4">DX2DEG</a></div><div class="ttdeci">#define DX2DEG(dx, lat)</div><div class="ttdoc">Convert a distance in kilometers to degrees longitude at a given latitude.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00614">mptrac.h:614</a></div></div>
<div class="ttc" id="amptrac_8h_html_af7f0e2b08c22c7da133b53aaad9861ff"><div class="ttname"><a href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">DY2DEG</a></div><div class="ttdeci">#define DY2DEG(dy)</div><div class="ttdoc">Convert a distance in kilometers to degrees latitude.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00632">mptrac.h:632</a></div></div>
<div class="ttc" id="astructatm__t_html_a05da6b99657d420d7bf4b37a392b048c"><div class="ttname"><a href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">atm_t::time</a></div><div class="ttdeci">double time[NP]</div><div class="ttdoc">Time [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03170">mptrac.h:3170</a></div></div>
<div class="ttc" id="astructatm__t_html_a25ef7d304d5cfa54c5af30192620373b"><div class="ttname"><a href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">atm_t::lat</a></div><div class="ttdeci">double lat[NP]</div><div class="ttdoc">Latitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03179">mptrac.h:3179</a></div></div>
<div class="ttc" id="astructatm__t_html_a2c8ffb598109120ed6d1f8e79aeb3ff8"><div class="ttname"><a href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">atm_t::lon</a></div><div class="ttdeci">double lon[NP]</div><div class="ttdoc">Longitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03176">mptrac.h:3176</a></div></div>
<div class="ttc" id="astructatm__t_html_a473366004c7195d5c455373296ee1833"><div class="ttname"><a href="structatm__t.html#a473366004c7195d5c455373296ee1833">atm_t::np</a></div><div class="ttdeci">int np</div><div class="ttdoc">Number of air parcels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03167">mptrac.h:3167</a></div></div>
<div class="ttc" id="astructatm__t_html_aa1c8de5772120f4a283c9cedcbe43fb7"><div class="ttname"><a href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">atm_t::q</a></div><div class="ttdeci">double q[NQ][NP]</div><div class="ttdoc">Quantity data (for various, user-defined attributes).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03182">mptrac.h:3182</a></div></div>
<div class="ttc" id="astructatm__t_html_ae769ef14e4824d35f47ad9dec75a4087"><div class="ttname"><a href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">atm_t::p</a></div><div class="ttdeci">double p[NP]</div><div class="ttdoc">Pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03173">mptrac.h:3173</a></div></div>
<div class="ttc" id="astructcache__t_html_a2ea05d5c51e9149cac55020d5c1b8c92"><div class="ttname"><a href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">cache_t::dt</a></div><div class="ttdeci">double dt[NP]</div><div class="ttdoc">Timesteps [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03240">mptrac.h:3240</a></div></div>
<div class="ttc" id="astructctl__t_html_a59254cd97a92694d95b7fb6b384c4d3f"><div class="ttname"><a href="structctl__t.html#a59254cd97a92694d95b7fb6b384c4d3f">ctl_t::qnt_eta</a></div><div class="ttdeci">int qnt_eta</div><div class="ttdoc">Quantity array index for eta vertical coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02354">mptrac.h:2354</a></div></div>
<div class="ttc" id="astructctl__t_html_a8eb0ca94791f79405c3b49da924f386d"><div class="ttname"><a href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">ctl_t::advect</a></div><div class="ttdeci">int advect</div><div class="ttdoc">Advection scheme (0=off, 1=Euler, 2=midpoint, 4=Runge-Kutta).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02645">mptrac.h:2645</a></div></div>
<div class="ttc" id="astructctl__t_html_a9382d9e9b29e10eeee582e1e10ff365a"><div class="ttname"><a href="structctl__t.html#a9382d9e9b29e10eeee582e1e10ff365a">ctl_t::qnt_zeta</a></div><div class="ttdeci">int qnt_zeta</div><div class="ttdoc">Quantity array index for zeta vertical coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02345">mptrac.h:2345</a></div></div>
<div class="ttc" id="astructctl__t_html_ad9524b57f1aaace70190a78966fc5076"><div class="ttname"><a href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">ctl_t::advect_vert_coord</a></div><div class="ttdeci">int advect_vert_coord</div><div class="ttdoc">Vertical velocity of air parcels (0=omega_on_plev, 1=zetadot_on_mlev, 2=omega_on_mlev,...</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02649">mptrac.h:2649</a></div></div>
<div class="ttc" id="astructmet__t_html_a1153b31e69a6542d2ee83d60c38f7bb1"><div class="ttname"><a href="structmet__t.html#a1153b31e69a6542d2ee83d60c38f7bb1">met_t::zeta_dotl</a></div><div class="ttdeci">float zeta_dotl[EX][EY][EP]</div><div class="ttdoc">Vertical velocity on model levels [K/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03583">mptrac.h:3583</a></div></div>
<div class="ttc" id="astructmet__t_html_a210cc808698557c4824a4a8d7908fe73"><div class="ttname"><a href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">met_t::w</a></div><div class="ttdeci">float w[EX][EY][EP]</div><div class="ttdoc">Vertical velocity [hPa/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03541">mptrac.h:3541</a></div></div>
<div class="ttc" id="astructmet__t_html_a4618b608901900608688f4f649dfbfc4"><div class="ttname"><a href="structmet__t.html#a4618b608901900608688f4f649dfbfc4">met_t::wl</a></div><div class="ttdeci">float wl[EX][EY][EP]</div><div class="ttdoc">Vertical velocity on model levels [hPa/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03577">mptrac.h:3577</a></div></div>
<div class="ttc" id="astructmet__t_html_a4b4aaeb8f39dea0fb511744f84535303"><div class="ttname"><a href="structmet__t.html#a4b4aaeb8f39dea0fb511744f84535303">met_t::vl</a></div><div class="ttdeci">float vl[EX][EY][EP]</div><div class="ttdoc">Meridional wind on model levels [m/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03574">mptrac.h:3574</a></div></div>
<div class="ttc" id="astructmet__t_html_a68b715eb9e5fa3a9c8f400e0c5667cc9"><div class="ttname"><a href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">met_t::u</a></div><div class="ttdeci">float u[EX][EY][EP]</div><div class="ttdoc">Zonal wind [m/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03535">mptrac.h:3535</a></div></div>
<div class="ttc" id="astructmet__t_html_a760447bb9eca0826b3705f30a9b8f165"><div class="ttname"><a href="structmet__t.html#a760447bb9eca0826b3705f30a9b8f165">met_t::ul</a></div><div class="ttdeci">float ul[EX][EY][EP]</div><div class="ttdoc">Zonal wind on model levels [m/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03571">mptrac.h:3571</a></div></div>
<div class="ttc" id="astructmet__t_html_abc29d5fbea8f527b849837efacd76eaa"><div class="ttname"><a href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">met_t::v</a></div><div class="ttdeci">float v[EX][EY][EP]</div><div class="ttdoc">Meridional wind [m/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03538">mptrac.h:3538</a></div></div>
<div class="ttc" id="astructmet__t_html_af1a12a97613433a41a2714a2634a83de"><div class="ttname"><a href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">met_t::pl</a></div><div class="ttdeci">float pl[EX][EY][EP]</div><div class="ttdoc">Pressure on model levels [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03568">mptrac.h:3568</a></div></div>
<div class="ttc" id="astructmet__t_html_afdf65f900ff556c3d4faef4443e3f40f"><div class="ttname"><a href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">met_t::zetal</a></div><div class="ttdeci">float zetal[EX][EY][EP]</div><div class="ttdoc">Zeta on model levels [K].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03580">mptrac.h:3580</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a16101092a4f867b18cf1d4feb3189d1d_cgraph.png" border="0" usemap="#amptrac_8h_a16101092a4f867b18cf1d4feb3189d1d_cgraph" alt=""/></div>
<map name="amptrac_8h_a16101092a4f867b18cf1d4feb3189d1d_cgraph" id="amptrac_8h_a16101092a4f867b18cf1d4feb3189d1d_cgraph">
<area shape="rect" title="Advances particle positions using different advection schemes." alt="" coords="5,81,116,108"/>
<area shape="rect" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190" title="Interpolates meteorological variables to a given position and time." alt="" coords="352,107,487,133"/>
<area shape="rect" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6" title="Interpolates meteorological data in 3D space and time." alt="" coords="164,56,299,83"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="540,5,680,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="573,56,647,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="569,107,651,133"/>
<area shape="rect" href="mptrac_8c.html#abd6bde703e5eec60bf68820afcdd5edc" title="Locate the four vertical indizes of a box for a given height value." alt="" coords="567,157,653,184"/>
<area shape="rect" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861" title="Locate the index of the interval containing a given value in an irregularly spaced array." alt="" coords="728,157,835,184"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="347,56,492,83"/>
</map>
</div>

</div>
</div>
<a id="a7f61eec2b48a2250ca25ff4657fa858d" name="a7f61eec2b48a2250ca25ff4657fa858d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f61eec2b48a2250ca25ff4657fa858d">&#9670;&nbsp;</a></span>module_advect_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_advect_init </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the advection module by setting up pressure fields. </p>
<p >This function initializes the advection module, setting up the air parcel pressure to be consistent with the given zeta vertical coordinate. It utilizes meteorological data from two time steps and interpolates the pressure values accordingly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing configuration flags. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the initial meteorological data structure. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the final meteorological data structure. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the air parcel data structure.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following operations:</p><ul>
<li>Sets up a timer labeled "MODULE_ADVECT_INIT" within the "PHYSICS" category.</li>
<li>If the zeta vertical coordinate system is specified (ctl-&gt;vert_coord_ap == 1), it initializes the pressure fields to be consistent with the zeta coordinate using 4D interpolation.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l03135">3135</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3140</span>              {</div>
<div class="line"><span class="lineno"> 3141</span> </div>
<div class="line"><span class="lineno"> 3142</span>  <span class="comment">/* Check parameters... */</span></div>
<div class="line"><span class="lineno"> 3143</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> != 1)</div>
<div class="line"><span class="lineno"> 3144</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3145</span> </div>
<div class="line"><span class="lineno"> 3146</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 3147</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_ADVECT_INIT&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3148</span> </div>
<div class="line"><span class="lineno"> 3149</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 3150</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 0, <span class="stringliteral">&quot;acc data present(ctl,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 3151</span> </div>
<div class="line"><span class="lineno"> 3152</span>    <span class="comment">/* Initialize pressure consistent with zeta... */</span></div>
<div class="line"><span class="lineno"> 3153</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 3154</span>    <a class="code hl_function" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190">intpol_met_4d_zeta</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>,</div>
<div class="line"><span class="lineno"> 3155</span>                       met1-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9382d9e9b29e10eeee582e1e10ff365a">qnt_zeta</a>][ip],</div>
<div class="line"><span class="lineno"> 3156</span>                       atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], &amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], ci, cw, 1);</div>
<div class="line"><span class="lineno"> 3157</span>  }</div>
<div class="line"><span class="lineno"> 3158</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a7f61eec2b48a2250ca25ff4657fa858d_cgraph.png" border="0" usemap="#amptrac_8h_a7f61eec2b48a2250ca25ff4657fa858d_cgraph" alt=""/></div>
<map name="amptrac_8h_a7f61eec2b48a2250ca25ff4657fa858d_cgraph" id="amptrac_8h_a7f61eec2b48a2250ca25ff4657fa858d_cgraph">
<area shape="rect" title="Initializes the advection module by setting up pressure fields." alt="" coords="5,81,140,108"/>
<area shape="rect" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190" title="Interpolates meteorological variables to a given position and time." alt="" coords="188,81,323,108"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="371,5,511,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="403,56,478,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="399,107,482,133"/>
<area shape="rect" href="mptrac_8c.html#abd6bde703e5eec60bf68820afcdd5edc" title="Locate the four vertical indizes of a box for a given height value." alt="" coords="397,157,484,184"/>
<area shape="rect" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861" title="Locate the index of the interval containing a given value in an irregularly spaced array." alt="" coords="559,157,665,184"/>
</map>
</div>

</div>
</div>
<a id="a7c775417ba44bae7a915616cc9df4615" name="a7c775417ba44bae7a915616cc9df4615"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c775417ba44bae7a915616cc9df4615">&#9670;&nbsp;</a></span>module_bound_cond()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_bound_cond </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply boundary conditions to particles based on meteorological and climatological data. </p>
<p >This function applies boundary conditions to particles based on specified criteria, including latitude, pressure, surface layer parameters, and climatological data. It loops over each particle and checks whether it satisfies the specified boundary conditions. If a particle satisfies the conditions, its properties such as mass, volume mixing ratio, and age of air are updated accordingly.</p>
<p >It checks for quantity flags to determine which properties need to be updated. If the latitude or pressure of a particle falls outside the specified ranges, it skips the particle. It also considers surface layer parameters such as surface pressure, height, zeta range, and planetary boundary layer. If a particle is within the specified surface layer boundaries, its properties are updated accordingly.</p>
<p >The function updates properties such as mass and volume mixing ratio if the corresponding flags are set. It retrieves volume mixing ratio values for various trace gases (e.g., CFC-10, CFC-11, N2O, SF6) from climatological time series data and updates the particle properties accordingly. Additionally, it updates the age of air for each particle based on the current simulation time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climatological data structure containing time series data. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data structure at the initial time step. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the meteorological data structure at the next time step. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l03162">3162</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3168</span>              {</div>
<div class="line"><span class="lineno"> 3169</span> </div>
<div class="line"><span class="lineno"> 3170</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 3171</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_BOUND_COND&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3172</span> </div>
<div class="line"><span class="lineno"> 3173</span>  <span class="comment">/* Check quantity flags... */</span></div>
<div class="line"><span class="lineno"> 3174</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &lt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &lt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1ba53bf2909cfe859cdd8d3e6db31e9a">qnt_Cccl4</a></div>
<div class="line"><span class="lineno"> 3175</span>      &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a43ba4811191565b719506351b40515">qnt_Cccl3f</a> &lt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a066b3cab4ae3633d7f5a4cc178f8d655">qnt_Cccl2f2</a> &lt; 0</div>
<div class="line"><span class="lineno"> 3176</span>      &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a3a8cc8108f6dce4fcf6b82ceb97d22">qnt_Cn2o</a> &lt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ad1be4d2d7d089ba9311f6c6b17baa2">qnt_Csf6</a> &lt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a08aa70d2f116af5dfe779b6ecec4dd19">qnt_aoa</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 3177</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3178</span> </div>
<div class="line"><span class="lineno"> 3179</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 3180</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1,</div>
<div class="line"><span class="lineno"> 3181</span>                <span class="stringliteral">&quot;acc data present(ctl,cache,clim,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 3182</span> </div>
<div class="line"><span class="lineno"> 3183</span>    <span class="comment">/* Check latitude and pressure range... */</span></div>
<div class="line"><span class="lineno"> 3184</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a686563c65fdd2d03d15cfdddf294584c">bound_lat0</a> || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] &gt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3488ff97025f12fbe161d85b09ddc33e">bound_lat1</a></div>
<div class="line"><span class="lineno"> 3185</span>        || atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &gt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa1419e1cd3c485e89a5166c7e1f19caf">bound_p0</a> || atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a44cbf78eb4bbb11036922bc40faa2b4b">bound_p1</a>)</div>
<div class="line"><span class="lineno"> 3186</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3187</span> </div>
<div class="line"><span class="lineno"> 3188</span>    <span class="comment">/* Check surface layer... */</span></div>
<div class="line"><span class="lineno"> 3189</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9e31767a1a873f2829a00cb15c0ae421">bound_dps</a> &gt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0c09fef6dfe4daa19ad717cd1e1b77ec">bound_dzs</a> &gt; 0</div>
<div class="line"><span class="lineno"> 3190</span>        || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae7b26fcc7af034afe6144631986213ea">bound_zetas</a> &gt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3e924116d2599fb79a734a74da11e8a2">bound_pbl</a>) {</div>
<div class="line"><span class="lineno"> 3191</span> </div>
<div class="line"><span class="lineno"> 3192</span>      <span class="comment">/* Get surface pressure... */</span></div>
<div class="line"><span class="lineno"> 3193</span>      <span class="keywordtype">double</span> ps;</div>
<div class="line"><span class="lineno"> 3194</span>      <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 3195</span>      <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(ps, 1);</div>
<div class="line"><span class="lineno"> 3196</span> </div>
<div class="line"><span class="lineno"> 3197</span>      <span class="comment">/* Check pressure... */</span></div>
<div class="line"><span class="lineno"> 3198</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9e31767a1a873f2829a00cb15c0ae421">bound_dps</a> &gt; 0 &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &lt; ps - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9e31767a1a873f2829a00cb15c0ae421">bound_dps</a>)</div>
<div class="line"><span class="lineno"> 3199</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3200</span> </div>
<div class="line"><span class="lineno"> 3201</span>      <span class="comment">/* Check height... */</span></div>
<div class="line"><span class="lineno"> 3202</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0c09fef6dfe4daa19ad717cd1e1b77ec">bound_dzs</a> &gt; 0 &amp;&amp; <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]) &gt; <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(ps) + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0c09fef6dfe4daa19ad717cd1e1b77ec">bound_dzs</a>)</div>
<div class="line"><span class="lineno"> 3203</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3204</span> </div>
<div class="line"><span class="lineno"> 3205</span>      <span class="comment">/* Check zeta range... */</span></div>
<div class="line"><span class="lineno"> 3206</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae7b26fcc7af034afe6144631986213ea">bound_zetas</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 3207</span>        <span class="keywordtype">double</span> t;</div>
<div class="line"><span class="lineno"> 3208</span>        <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 1);</div>
<div class="line"><span class="lineno"> 3209</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="mptrac_8h.html#a90ee947c906d48ce71affad259ac991d">ZETA</a>(ps, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t) &gt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae7b26fcc7af034afe6144631986213ea">bound_zetas</a>)</div>
<div class="line"><span class="lineno"> 3210</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3211</span>      }</div>
<div class="line"><span class="lineno"> 3212</span> </div>
<div class="line"><span class="lineno"> 3213</span>      <span class="comment">/* Check planetary boundary layer... */</span></div>
<div class="line"><span class="lineno"> 3214</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3e924116d2599fb79a734a74da11e8a2">bound_pbl</a>) {</div>
<div class="line"><span class="lineno"> 3215</span>        <span class="keywordtype">double</span> pbl;</div>
<div class="line"><span class="lineno"> 3216</span>        <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(pbl, 0);</div>
<div class="line"><span class="lineno"> 3217</span>        <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &lt; pbl)</div>
<div class="line"><span class="lineno"> 3218</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3219</span>      }</div>
<div class="line"><span class="lineno"> 3220</span>    }</div>
<div class="line"><span class="lineno"> 3221</span> </div>
<div class="line"><span class="lineno"> 3222</span>    <span class="comment">/* Set mass and volume mixing ratio... */</span></div>
<div class="line"><span class="lineno"> 3223</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &gt;= 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a25a01ebb0fcff6040d0003b88b13cdec">bound_mass</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3224</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip] =</div>
<div class="line"><span class="lineno"> 3225</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a25a01ebb0fcff6040d0003b88b13cdec">bound_mass</a> + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9feaa00a9e7de02f8bd661d735b8b280">bound_mass_trend</a> * atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip];</div>
<div class="line"><span class="lineno"> 3226</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &gt;= 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4f7014dad580e4e745c910187468807c">bound_vmr</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3227</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a>][ip] =</div>
<div class="line"><span class="lineno"> 3228</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4f7014dad580e4e745c910187468807c">bound_vmr</a> + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7a4b2ae4a45234a74df45b5adbe513cd">bound_vmr_trend</a> * atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip];</div>
<div class="line"><span class="lineno"> 3229</span> </div>
<div class="line"><span class="lineno"> 3230</span>    <span class="comment">/* Set CFC-10 volume mixing ratio... */</span></div>
<div class="line"><span class="lineno"> 3231</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1ba53bf2909cfe859cdd8d3e6db31e9a">qnt_Cccl4</a> &gt;= 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa17140ad321005a763259a2ae7dcd858">clim_ccl4_timeseries</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 3232</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1ba53bf2909cfe859cdd8d3e6db31e9a">qnt_Cccl4</a>][ip] = <a class="code hl_function" href="mptrac_8c.html#acbf877af94269d0aa1c94b7c50121df8">clim_ts</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a7c4cf5c511a125b4e3bc3731157037f3">ccl4</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip]);</div>
<div class="line"><span class="lineno"> 3233</span> </div>
<div class="line"><span class="lineno"> 3234</span>    <span class="comment">/* Set CFC-11 volume mixing ratio... */</span></div>
<div class="line"><span class="lineno"> 3235</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a43ba4811191565b719506351b40515">qnt_Cccl3f</a> &gt;= 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac6e501659bef71188874bf710d510635">clim_ccl3f_timeseries</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 3236</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a43ba4811191565b719506351b40515">qnt_Cccl3f</a>][ip] = <a class="code hl_function" href="mptrac_8c.html#acbf877af94269d0aa1c94b7c50121df8">clim_ts</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a84f795c6c4934f9e215b74dffa177685">ccl3f</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip]);</div>
<div class="line"><span class="lineno"> 3237</span> </div>
<div class="line"><span class="lineno"> 3238</span>    <span class="comment">/* Set CFC-12 volume mixing ratio... */</span></div>
<div class="line"><span class="lineno"> 3239</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a066b3cab4ae3633d7f5a4cc178f8d655">qnt_Cccl2f2</a> &gt;= 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad262595cbb226c73adcde30a4b7d3bf9">clim_ccl2f2_timeseries</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 3240</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a066b3cab4ae3633d7f5a4cc178f8d655">qnt_Cccl2f2</a>][ip] = <a class="code hl_function" href="mptrac_8c.html#acbf877af94269d0aa1c94b7c50121df8">clim_ts</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a0d489a65c8c1cee839f3467a1c51c401">ccl2f2</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip]);</div>
<div class="line"><span class="lineno"> 3241</span> </div>
<div class="line"><span class="lineno"> 3242</span>    <span class="comment">/* Set N2O volume mixing ratio... */</span></div>
<div class="line"><span class="lineno"> 3243</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a3a8cc8108f6dce4fcf6b82ceb97d22">qnt_Cn2o</a> &gt;= 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0bdff7541fde7bd508072c44279519fd">clim_n2o_timeseries</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 3244</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a3a8cc8108f6dce4fcf6b82ceb97d22">qnt_Cn2o</a>][ip] = <a class="code hl_function" href="mptrac_8c.html#acbf877af94269d0aa1c94b7c50121df8">clim_ts</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#af11604629b6390f0fdbb734b0dce2554">n2o</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip]);</div>
<div class="line"><span class="lineno"> 3245</span> </div>
<div class="line"><span class="lineno"> 3246</span>    <span class="comment">/* Set SF6 volume mixing ratio... */</span></div>
<div class="line"><span class="lineno"> 3247</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ad1be4d2d7d089ba9311f6c6b17baa2">qnt_Csf6</a> &gt;= 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab08651e92983408ef0bebfe875c59851">clim_sf6_timeseries</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 3248</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ad1be4d2d7d089ba9311f6c6b17baa2">qnt_Csf6</a>][ip] = <a class="code hl_function" href="mptrac_8c.html#acbf877af94269d0aa1c94b7c50121df8">clim_ts</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a787e837b08fea0fce0c6fe04140fb393">sf6</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip]);</div>
<div class="line"><span class="lineno"> 3249</span> </div>
<div class="line"><span class="lineno"> 3250</span>    <span class="comment">/* Set age of air... */</span></div>
<div class="line"><span class="lineno"> 3251</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a08aa70d2f116af5dfe779b6ecec4dd19">qnt_aoa</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3252</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a08aa70d2f116af5dfe779b6ecec4dd19">qnt_aoa</a>][ip] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip];</div>
<div class="line"><span class="lineno"> 3253</span>  }</div>
<div class="line"><span class="lineno"> 3254</span>}</div>
<div class="ttc" id="amptrac_8c_html_acbf877af94269d0aa1c94b7c50121df8"><div class="ttname"><a href="mptrac_8c.html#acbf877af94269d0aa1c94b7c50121df8">clim_ts</a></div><div class="ttdeci">double clim_ts(const clim_ts_t *ts, const double t)</div><div class="ttdoc">Interpolates a time series of climatological variables.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l00387">mptrac.c:387</a></div></div>
<div class="ttc" id="amptrac_8h_html_a48e10ecee070acb7be2df6a8ca3d9764"><div class="ttname"><a href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a></div><div class="ttdeci">#define INTPOL_3D(var, init)</div><div class="ttdoc">Perform 3D interpolation for a meteorological variable.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00864">mptrac.h:864</a></div></div>
<div class="ttc" id="amptrac_8h_html_a90ee947c906d48ce71affad259ac991d"><div class="ttname"><a href="mptrac_8h.html#a90ee947c906d48ce71affad259ac991d">ZETA</a></div><div class="ttdeci">#define ZETA(ps, p, t)</div><div class="ttdoc">Computes the value of the zeta vertical coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01930">mptrac.h:1930</a></div></div>
<div class="ttc" id="amptrac_8h_html_ab4d615b798ce84f6ee2eb42df3c90998"><div class="ttname"><a href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a></div><div class="ttdeci">#define INTPOL_2D(var, init)</div><div class="ttdoc">Perform 2D interpolation for a meteorological variable.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00847">mptrac.h:847</a></div></div>
<div class="ttc" id="astructclim__t_html_a0d489a65c8c1cee839f3467a1c51c401"><div class="ttname"><a href="structclim__t.html#a0d489a65c8c1cee839f3467a1c51c401">clim_t::ccl2f2</a></div><div class="ttdeci">clim_ts_t ccl2f2</div><div class="ttdoc">CFC-12 time series.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03401">mptrac.h:3401</a></div></div>
<div class="ttc" id="astructclim__t_html_a787e837b08fea0fce0c6fe04140fb393"><div class="ttname"><a href="structclim__t.html#a787e837b08fea0fce0c6fe04140fb393">clim_t::sf6</a></div><div class="ttdeci">clim_ts_t sf6</div><div class="ttdoc">SF6 time series.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03407">mptrac.h:3407</a></div></div>
<div class="ttc" id="astructclim__t_html_a7c4cf5c511a125b4e3bc3731157037f3"><div class="ttname"><a href="structclim__t.html#a7c4cf5c511a125b4e3bc3731157037f3">clim_t::ccl4</a></div><div class="ttdeci">clim_ts_t ccl4</div><div class="ttdoc">CFC-10 time series.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03395">mptrac.h:3395</a></div></div>
<div class="ttc" id="astructclim__t_html_a84f795c6c4934f9e215b74dffa177685"><div class="ttname"><a href="structclim__t.html#a84f795c6c4934f9e215b74dffa177685">clim_t::ccl3f</a></div><div class="ttdeci">clim_ts_t ccl3f</div><div class="ttdoc">CFC-11 time series.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03398">mptrac.h:3398</a></div></div>
<div class="ttc" id="astructclim__t_html_af11604629b6390f0fdbb734b0dce2554"><div class="ttname"><a href="structclim__t.html#af11604629b6390f0fdbb734b0dce2554">clim_t::n2o</a></div><div class="ttdeci">clim_ts_t n2o</div><div class="ttdoc">N2O time series.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03404">mptrac.h:3404</a></div></div>
<div class="ttc" id="astructctl__t_html_a066b3cab4ae3633d7f5a4cc178f8d655"><div class="ttname"><a href="structctl__t.html#a066b3cab4ae3633d7f5a4cc178f8d655">ctl_t::qnt_Cccl2f2</a></div><div class="ttdeci">int qnt_Cccl2f2</div><div class="ttdoc">Quantity array index for CFC-12 volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02423">mptrac.h:2423</a></div></div>
<div class="ttc" id="astructctl__t_html_a084c47554ce3d8b615dfabc9abbb26d1"><div class="ttname"><a href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">ctl_t::qnt_m</a></div><div class="ttdeci">int qnt_m</div><div class="ttdoc">Quantity array index for mass.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02162">mptrac.h:2162</a></div></div>
<div class="ttc" id="astructctl__t_html_a08aa70d2f116af5dfe779b6ecec4dd19"><div class="ttname"><a href="structctl__t.html#a08aa70d2f116af5dfe779b6ecec4dd19">ctl_t::qnt_aoa</a></div><div class="ttdeci">int qnt_aoa</div><div class="ttdoc">Quantity array index for age of air.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02432">mptrac.h:2432</a></div></div>
<div class="ttc" id="astructctl__t_html_a0bdff7541fde7bd508072c44279519fd"><div class="ttname"><a href="structctl__t.html#a0bdff7541fde7bd508072c44279519fd">ctl_t::clim_n2o_timeseries</a></div><div class="ttdeci">char clim_n2o_timeseries[LEN]</div><div class="ttdoc">Filename of N2O time series.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02775">mptrac.h:2775</a></div></div>
<div class="ttc" id="astructctl__t_html_a0c09fef6dfe4daa19ad717cd1e1b77ec"><div class="ttname"><a href="structctl__t.html#a0c09fef6dfe4daa19ad717cd1e1b77ec">ctl_t::bound_dzs</a></div><div class="ttdeci">double bound_dzs</div><div class="ttdoc">Boundary conditions surface layer depth [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02724">mptrac.h:2724</a></div></div>
<div class="ttc" id="astructctl__t_html_a1ba53bf2909cfe859cdd8d3e6db31e9a"><div class="ttname"><a href="structctl__t.html#a1ba53bf2909cfe859cdd8d3e6db31e9a">ctl_t::qnt_Cccl4</a></div><div class="ttdeci">int qnt_Cccl4</div><div class="ttdoc">Quantity array index for CFC-10 volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02417">mptrac.h:2417</a></div></div>
<div class="ttc" id="astructctl__t_html_a25a01ebb0fcff6040d0003b88b13cdec"><div class="ttname"><a href="structctl__t.html#a25a01ebb0fcff6040d0003b88b13cdec">ctl_t::bound_mass</a></div><div class="ttdeci">double bound_mass</div><div class="ttdoc">Boundary conditions mass per particle [kg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02697">mptrac.h:2697</a></div></div>
<div class="ttc" id="astructctl__t_html_a323dd04f9b74b6bef349e3a91b649568"><div class="ttname"><a href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">ctl_t::qnt_vmr</a></div><div class="ttdeci">int qnt_vmr</div><div class="ttdoc">Quantity array index for volume mixing ratio.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02165">mptrac.h:2165</a></div></div>
<div class="ttc" id="astructctl__t_html_a3488ff97025f12fbe161d85b09ddc33e"><div class="ttname"><a href="structctl__t.html#a3488ff97025f12fbe161d85b09ddc33e">ctl_t::bound_lat1</a></div><div class="ttdeci">double bound_lat1</div><div class="ttdoc">Boundary conditions maximum longitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02712">mptrac.h:2712</a></div></div>
<div class="ttc" id="astructctl__t_html_a3e924116d2599fb79a734a74da11e8a2"><div class="ttname"><a href="structctl__t.html#a3e924116d2599fb79a734a74da11e8a2">ctl_t::bound_pbl</a></div><div class="ttdeci">int bound_pbl</div><div class="ttdoc">Boundary conditions planetary boundary layer (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02730">mptrac.h:2730</a></div></div>
<div class="ttc" id="astructctl__t_html_a44cbf78eb4bbb11036922bc40faa2b4b"><div class="ttname"><a href="structctl__t.html#a44cbf78eb4bbb11036922bc40faa2b4b">ctl_t::bound_p1</a></div><div class="ttdeci">double bound_p1</div><div class="ttdoc">Boundary conditions top pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02718">mptrac.h:2718</a></div></div>
<div class="ttc" id="astructctl__t_html_a4f7014dad580e4e745c910187468807c"><div class="ttname"><a href="structctl__t.html#a4f7014dad580e4e745c910187468807c">ctl_t::bound_vmr</a></div><div class="ttdeci">double bound_vmr</div><div class="ttdoc">Boundary conditions volume mixing ratio [ppv].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02703">mptrac.h:2703</a></div></div>
<div class="ttc" id="astructctl__t_html_a686563c65fdd2d03d15cfdddf294584c"><div class="ttname"><a href="structctl__t.html#a686563c65fdd2d03d15cfdddf294584c">ctl_t::bound_lat0</a></div><div class="ttdeci">double bound_lat0</div><div class="ttdoc">Boundary conditions minimum longitude [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02709">mptrac.h:2709</a></div></div>
<div class="ttc" id="astructctl__t_html_a7a4b2ae4a45234a74df45b5adbe513cd"><div class="ttname"><a href="structctl__t.html#a7a4b2ae4a45234a74df45b5adbe513cd">ctl_t::bound_vmr_trend</a></div><div class="ttdeci">double bound_vmr_trend</div><div class="ttdoc">Boundary conditions volume mixing ratio trend [ppv/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02706">mptrac.h:2706</a></div></div>
<div class="ttc" id="astructctl__t_html_a8a3a8cc8108f6dce4fcf6b82ceb97d22"><div class="ttname"><a href="structctl__t.html#a8a3a8cc8108f6dce4fcf6b82ceb97d22">ctl_t::qnt_Cn2o</a></div><div class="ttdeci">int qnt_Cn2o</div><div class="ttdoc">Quantity array index for N2O volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02426">mptrac.h:2426</a></div></div>
<div class="ttc" id="astructctl__t_html_a8a43ba4811191565b719506351b40515"><div class="ttname"><a href="structctl__t.html#a8a43ba4811191565b719506351b40515">ctl_t::qnt_Cccl3f</a></div><div class="ttdeci">int qnt_Cccl3f</div><div class="ttdoc">Quantity array index for CFC-11 volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02420">mptrac.h:2420</a></div></div>
<div class="ttc" id="astructctl__t_html_a9ad1be4d2d7d089ba9311f6c6b17baa2"><div class="ttname"><a href="structctl__t.html#a9ad1be4d2d7d089ba9311f6c6b17baa2">ctl_t::qnt_Csf6</a></div><div class="ttdeci">int qnt_Csf6</div><div class="ttdoc">Quantity array index for SF6 volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02429">mptrac.h:2429</a></div></div>
<div class="ttc" id="astructctl__t_html_a9e31767a1a873f2829a00cb15c0ae421"><div class="ttname"><a href="structctl__t.html#a9e31767a1a873f2829a00cb15c0ae421">ctl_t::bound_dps</a></div><div class="ttdeci">double bound_dps</div><div class="ttdoc">Boundary conditions surface layer depth [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02721">mptrac.h:2721</a></div></div>
<div class="ttc" id="astructctl__t_html_a9feaa00a9e7de02f8bd661d735b8b280"><div class="ttname"><a href="structctl__t.html#a9feaa00a9e7de02f8bd661d735b8b280">ctl_t::bound_mass_trend</a></div><div class="ttdeci">double bound_mass_trend</div><div class="ttdoc">Boundary conditions mass per particle trend [kg/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02700">mptrac.h:2700</a></div></div>
<div class="ttc" id="astructctl__t_html_aa1419e1cd3c485e89a5166c7e1f19caf"><div class="ttname"><a href="structctl__t.html#aa1419e1cd3c485e89a5166c7e1f19caf">ctl_t::bound_p0</a></div><div class="ttdeci">double bound_p0</div><div class="ttdoc">Boundary conditions bottom pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02715">mptrac.h:2715</a></div></div>
<div class="ttc" id="astructctl__t_html_aa17140ad321005a763259a2ae7dcd858"><div class="ttname"><a href="structctl__t.html#aa17140ad321005a763259a2ae7dcd858">ctl_t::clim_ccl4_timeseries</a></div><div class="ttdeci">char clim_ccl4_timeseries[LEN]</div><div class="ttdoc">Filename of CFC-10 time series.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02766">mptrac.h:2766</a></div></div>
<div class="ttc" id="astructctl__t_html_ab08651e92983408ef0bebfe875c59851"><div class="ttname"><a href="structctl__t.html#ab08651e92983408ef0bebfe875c59851">ctl_t::clim_sf6_timeseries</a></div><div class="ttdeci">char clim_sf6_timeseries[LEN]</div><div class="ttdoc">Filename of SF6 time series.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02778">mptrac.h:2778</a></div></div>
<div class="ttc" id="astructctl__t_html_ac6e501659bef71188874bf710d510635"><div class="ttname"><a href="structctl__t.html#ac6e501659bef71188874bf710d510635">ctl_t::clim_ccl3f_timeseries</a></div><div class="ttdeci">char clim_ccl3f_timeseries[LEN]</div><div class="ttdoc">Filename of CFC-11 time series.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02769">mptrac.h:2769</a></div></div>
<div class="ttc" id="astructctl__t_html_ad262595cbb226c73adcde30a4b7d3bf9"><div class="ttname"><a href="structctl__t.html#ad262595cbb226c73adcde30a4b7d3bf9">ctl_t::clim_ccl2f2_timeseries</a></div><div class="ttdeci">char clim_ccl2f2_timeseries[LEN]</div><div class="ttdoc">Filename of CFC-12 time series.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02772">mptrac.h:2772</a></div></div>
<div class="ttc" id="astructctl__t_html_ae7b26fcc7af034afe6144631986213ea"><div class="ttname"><a href="structctl__t.html#ae7b26fcc7af034afe6144631986213ea">ctl_t::bound_zetas</a></div><div class="ttdeci">double bound_zetas</div><div class="ttdoc">Boundary conditions surface layer zeta [K].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02727">mptrac.h:2727</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a7c775417ba44bae7a915616cc9df4615_cgraph.png" border="0" usemap="#amptrac_8h_a7c775417ba44bae7a915616cc9df4615_cgraph" alt=""/></div>
<map name="amptrac_8h_a7c775417ba44bae7a915616cc9df4615_cgraph" id="amptrac_8h_a7c775417ba44bae7a915616cc9df4615_cgraph">
<area shape="rect" title="Apply boundary conditions to particles based on meteorological and climatological data." alt="" coords="5,5,147,32"/>
<area shape="rect" href="mptrac_8c.html#acbf877af94269d0aa1c94b7c50121df8" title="Interpolates a time series of climatological variables." alt="" coords="195,5,259,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="307,5,381,32"/>
</map>
</div>

</div>
</div>
<a id="a904c7f663617b319b69d5ff6fe04507a" name="a904c7f663617b319b69d5ff6fe04507a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a904c7f663617b319b69d5ff6fe04507a">&#9670;&nbsp;</a></span>module_chem_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_chem_grid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes gridded chemical tracer concentrations (volume mixing ratio) from individual air parcel mass data and assigns them back to the parcels. </p>
<p >This function aggregates the mass of tracer particles onto a 3D chemical grid (longitude  latitude  altitude), accounting for either single or ensemble simulations depending on <code>ctl-&gt;nens</code>. It then interpolates meteorological temperature fields and computes volume mixing ratios, storing them in the specified tracer quantity (e.g., <code>ctl-&gt;qnt_Cx</code>).</p>
<p >If the molar mass is undefined or required quantity indices are missing, the function exits early.</p>
<p >Parallelization is supported via OpenMP or OpenACC.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the control structure containing configuration parameters, including grid dimensions, tracer indices, and simulation mode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met0</td><td>Pointer to the meteorological data at the beginning of the interpolation interval. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met1</td><td>Pointer to the meteorological data at the end of the interpolation interval. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atm</td><td>Pointer to the atmospheric state, including parcel coordinates, time, mass, and output tracer fields. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Central time step used for output and interpolation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Requires <code>ctl-&gt;molmass &gt; 0</code>, and <code>ctl-&gt;qnt_m</code> and <code>ctl-&gt;qnt_Cx</code> to be set.</li>
<li>Uses ensemble mode if <code>ctl-&gt;nens &gt; 0</code> and assigns each parcel to its ensemble member via <code>ctl-&gt;qnt_ens</code>.</li>
<li>Grid box volume mixing ratios are computed assuming ideal gas law and a layered spherical grid.</li>
<li>The output quantity (e.g., <code>qnt_Cx</code>) is given in ppbv.</li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="mptrac_8h.html#a5819df4f969928e2f45144e44feb50a6" title="Interpolates meteorological data in 3D space and time.">intpol_met_time_3d()</a> </dd>
<dd>
<a class="el" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86" title="Compute pressure at given altitude.">P()</a>, <a class="el" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf" title="Convert pressure to altitude.">Z()</a>, <a class="el" href="mptrac_8h.html#ae088e183d18a16fd6ab469d48ce3f06a" title="Compute density of air.">RHO()</a> </dd>
<dd>
<a class="el" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26" title="Compute the linear index of a 3D array element.">ARRAY_3D</a> macro</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mingzhao Liu </dd>
<dd>
Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l03258">3258</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3263</span>                   {</div>
<div class="line"><span class="lineno"> 3264</span> </div>
<div class="line"><span class="lineno"> 3265</span>  <span class="comment">/* Check quantities... */</span></div>
<div class="line"><span class="lineno"> 3266</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae56fa1a240420b87bd2b7a0d040e6d11">qnt_Cx</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 3267</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3268</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> &lt;= 0)</div>
<div class="line"><span class="lineno"> 3269</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Molar mass is not defined!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3270</span> </div>
<div class="line"><span class="lineno"> 3271</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 3272</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_CHEM_GRID&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3273</span> </div>
<div class="line"><span class="lineno"> 3274</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 3275</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ensemble_mode = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">nens</a> &gt; 0);</div>
<div class="line"><span class="lineno"> 3276</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> np = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>;</div>
<div class="line"><span class="lineno"> 3277</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nz = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9fab7dd94afddfff20c4596605e3f18a">chemgrid_nz</a>;</div>
<div class="line"><span class="lineno"> 3278</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nx = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab7ed13e186108a02ff64f4bccc4ec775">chemgrid_nx</a>;</div>
<div class="line"><span class="lineno"> 3279</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ny = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac43809de3c73cb9793c567813452cfca">chemgrid_ny</a>;</div>
<div class="line"><span class="lineno"> 3280</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ngrid = nx * ny * nz;</div>
<div class="line"><span class="lineno"> 3281</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nens = ensemble_mode ? ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">nens</a> : 1;</div>
<div class="line"><span class="lineno"> 3282</span> </div>
<div class="line"><span class="lineno"> 3283</span>  <span class="keywordtype">double</span> *restrict <span class="keyword">const</span> z = (<span class="keywordtype">double</span> *) malloc((<span class="keywordtype">size_t</span>) nz * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><span class="lineno"> 3284</span>  <span class="keywordtype">double</span> *restrict <span class="keyword">const</span> press =</div>
<div class="line"><span class="lineno"> 3285</span>    (<span class="keywordtype">double</span> *) malloc((<span class="keywordtype">size_t</span>) nz * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><span class="lineno"> 3286</span>  <span class="keywordtype">double</span> *restrict <span class="keyword">const</span> mass =</div>
<div class="line"><span class="lineno"> 3287</span>    (<span class="keywordtype">double</span> *) calloc((<span class="keywordtype">size_t</span>) ngrid * (size_t) nens, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno"> 3288</span>  <span class="keywordtype">double</span> *restrict <span class="keyword">const</span> area =</div>
<div class="line"><span class="lineno"> 3289</span>    (<span class="keywordtype">double</span> *) malloc((<span class="keywordtype">size_t</span>) ny * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><span class="lineno"> 3290</span>  <span class="keywordtype">double</span> *restrict <span class="keyword">const</span> lon =</div>
<div class="line"><span class="lineno"> 3291</span>    (<span class="keywordtype">double</span> *) malloc((<span class="keywordtype">size_t</span>) nx * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><span class="lineno"> 3292</span>  <span class="keywordtype">double</span> *restrict <span class="keyword">const</span> lat =</div>
<div class="line"><span class="lineno"> 3293</span>    (<span class="keywordtype">double</span> *) malloc((<span class="keywordtype">size_t</span>) ny * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><span class="lineno"> 3294</span> </div>
<div class="line"><span class="lineno"> 3295</span>  <span class="keywordtype">int</span> *restrict <span class="keyword">const</span> ixs = (<span class="keywordtype">int</span> *) malloc((<span class="keywordtype">size_t</span>) np * <span class="keyword">sizeof</span>(int));</div>
<div class="line"><span class="lineno"> 3296</span>  <span class="keywordtype">int</span> *restrict <span class="keyword">const</span> iys = (<span class="keywordtype">int</span> *) malloc((<span class="keywordtype">size_t</span>) np * <span class="keyword">sizeof</span>(int));</div>
<div class="line"><span class="lineno"> 3297</span>  <span class="keywordtype">int</span> *restrict <span class="keyword">const</span> izs = (<span class="keywordtype">int</span> *) malloc((<span class="keywordtype">size_t</span>) np * <span class="keyword">sizeof</span>(int));</div>
<div class="line"><span class="lineno"> 3298</span> </div>
<div class="line"><span class="lineno"> 3299</span>  <span class="comment">/* Set grid box size... */</span></div>
<div class="line"><span class="lineno"> 3300</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> dz = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a080fa58f76fcfad970b76ca112706154">chemgrid_z1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1834cd1e787e3aa2f391cd942a7f37c7">chemgrid_z0</a>) / nz;</div>
<div class="line"><span class="lineno"> 3301</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> dlon = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4b601fe8e527664c96b12b9eafee4762">chemgrid_lon1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3e1bc34453198d5854a7f0271f503f7c">chemgrid_lon0</a>) / nx;</div>
<div class="line"><span class="lineno"> 3302</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> dlat = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2e99a15cc98b378ffc96a6df73fe6048">chemgrid_lat1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a189dce731fb0c3210161ca328a93a327">chemgrid_lat0</a>) / ny;</div>
<div class="line"><span class="lineno"> 3303</span> </div>
<div class="line"><span class="lineno"> 3304</span>  <span class="comment">/* Set vertical coordinates... */</span></div>
<div class="line"><span class="lineno"> 3305</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 3306</span><span class="preprocessor">#pragma acc enter data create(ixs[0:np],iys[0:np],izs[0:np],z[0:nz],press[0:nz],mass[0:ngrid*nens],area[0:ny],lon[0:nx],lat[0:ny])</span></div>
<div class="line"><span class="lineno"> 3307</span><span class="preprocessor">#pragma acc data present(ctl,met0,met1,atm,ixs,iys,izs,z,press,mass,area,lon,lat)</span></div>
<div class="line"><span class="lineno"> 3308</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 3309</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 3310</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 3311</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3312</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; nz; iz++) {</div>
<div class="line"><span class="lineno"> 3313</span>    z[iz] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1834cd1e787e3aa2f391cd942a7f37c7">chemgrid_z0</a> + dz * (iz + 0.5);</div>
<div class="line"><span class="lineno"> 3314</span>    press[iz] = <a class="code hl_define" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>(z[iz]);</div>
<div class="line"><span class="lineno"> 3315</span>  }</div>
<div class="line"><span class="lineno"> 3316</span> </div>
<div class="line"><span class="lineno"> 3317</span>  <span class="comment">/* Set time interval for output... */</span></div>
<div class="line"><span class="lineno"> 3318</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = tt - 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno"> 3319</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t1 = tt + 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno"> 3320</span> </div>
<div class="line"><span class="lineno"> 3321</span>  <span class="comment">/* Get indices... */</span></div>
<div class="line"><span class="lineno"> 3322</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 3323</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 3324</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 3325</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 3326</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3327</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; np; ip++) {</div>
<div class="line"><span class="lineno"> 3328</span>    ixs[ip] = (int) ((atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3e1bc34453198d5854a7f0271f503f7c">chemgrid_lon0</a>) / dlon);</div>
<div class="line"><span class="lineno"> 3329</span>    iys[ip] = (int) ((atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a189dce731fb0c3210161ca328a93a327">chemgrid_lat0</a>) / dlat);</div>
<div class="line"><span class="lineno"> 3330</span>    izs[ip] = (int) ((<a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]) - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1834cd1e787e3aa2f391cd942a7f37c7">chemgrid_z0</a>) / dz);</div>
<div class="line"><span class="lineno"> 3331</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1</div>
<div class="line"><span class="lineno"> 3332</span>        || ixs[ip] &lt; 0 || ixs[ip] &gt;= nx</div>
<div class="line"><span class="lineno"> 3333</span>        || iys[ip] &lt; 0 || iys[ip] &gt;= ny || izs[ip] &lt; 0 || izs[ip] &gt;= nz)</div>
<div class="line"><span class="lineno"> 3334</span>      izs[ip] = -1;</div>
<div class="line"><span class="lineno"> 3335</span>  }</div>
<div class="line"><span class="lineno"> 3336</span> </div>
<div class="line"><span class="lineno"> 3337</span>  <span class="comment">/* Set horizontal coordinates... */</span></div>
<div class="line"><span class="lineno"> 3338</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 3339</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 3340</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 3341</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 3342</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3343</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; nx; ix++)</div>
<div class="line"><span class="lineno"> 3344</span>    lon[ix] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3e1bc34453198d5854a7f0271f503f7c">chemgrid_lon0</a> + dlon * (ix + 0.5);</div>
<div class="line"><span class="lineno"> 3345</span> </div>
<div class="line"><span class="lineno"> 3346</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 3347</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 3348</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 3349</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 3350</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3351</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ny; iy++) {</div>
<div class="line"><span class="lineno"> 3352</span>    lat[iy] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a189dce731fb0c3210161ca328a93a327">chemgrid_lat0</a> + dlat * (iy + 0.5);</div>
<div class="line"><span class="lineno"> 3353</span>    area[iy] = dlat * dlon * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(<a class="code hl_define" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a> * M_PI / 180.) * cos(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(lat[iy]));</div>
<div class="line"><span class="lineno"> 3354</span>  }</div>
<div class="line"><span class="lineno"> 3355</span> </div>
<div class="line"><span class="lineno"> 3356</span>  <span class="comment">/* Get mass per grid box... */</span></div>
<div class="line"><span class="lineno"> 3357</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 3358</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 3359</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3360</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; np; ip++) {</div>
<div class="line"><span class="lineno"> 3361</span>    <span class="keywordflow">if</span> (izs[ip] &gt;= 0) {</div>
<div class="line"><span class="lineno"> 3362</span>      <span class="keywordtype">int</span> mass_idx = <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ixs[ip], iys[ip], ny, izs[ip], nz);</div>
<div class="line"><span class="lineno"> 3363</span>      <span class="keywordflow">if</span> (ensemble_mode) {</div>
<div class="line"><span class="lineno"> 3364</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> ens = (int) atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>][ip];</div>
<div class="line"><span class="lineno"> 3365</span>        mass_idx += ens * ngrid;</div>
<div class="line"><span class="lineno"> 3366</span>      }</div>
<div class="line"><span class="lineno"> 3367</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 3368</span><span class="preprocessor">#pragma acc atomic update</span></div>
<div class="line"><span class="lineno"> 3369</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3370</span>      mass[mass_idx] += atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip];</div>
<div class="line"><span class="lineno"> 3371</span>    }</div>
<div class="line"><span class="lineno"> 3372</span>  }</div>
<div class="line"><span class="lineno"> 3373</span> </div>
<div class="line"><span class="lineno"> 3374</span>  <span class="comment">/* Assign grid data to air parcels ... */</span></div>
<div class="line"><span class="lineno"> 3375</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 3376</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 3377</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 3378</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 3379</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3380</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; np; ip++)</div>
<div class="line"><span class="lineno"> 3381</span>    <span class="keywordflow">if</span> (izs[ip] &gt;= 0) {</div>
<div class="line"><span class="lineno"> 3382</span> </div>
<div class="line"><span class="lineno"> 3383</span>      <span class="comment">/* Interpolate temperature... */</span></div>
<div class="line"><span class="lineno"> 3384</span>      <span class="keywordtype">double</span> temp;</div>
<div class="line"><span class="lineno"> 3385</span>      <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 3386</span>      <a class="code hl_function" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, tt,</div>
<div class="line"><span class="lineno"> 3387</span>                         press[izs[ip]],</div>
<div class="line"><span class="lineno"> 3388</span>                         lon[ixs[ip]], lat[iys[ip]], &amp;temp, ci, cw, 1);</div>
<div class="line"><span class="lineno"> 3389</span> </div>
<div class="line"><span class="lineno"> 3390</span>      <span class="comment">/* Set mass... */</span></div>
<div class="line"><span class="lineno"> 3391</span>      <span class="keywordtype">int</span> mass_idx = <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ixs[ip], iys[ip], ny, izs[ip], nz);</div>
<div class="line"><span class="lineno"> 3392</span>      <span class="keywordflow">if</span> (ensemble_mode) {</div>
<div class="line"><span class="lineno"> 3393</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> ens = (int) atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>][ip];</div>
<div class="line"><span class="lineno"> 3394</span>        mass_idx += ens * ngrid;</div>
<div class="line"><span class="lineno"> 3395</span>      }</div>
<div class="line"><span class="lineno"> 3396</span> </div>
<div class="line"><span class="lineno"> 3397</span>      <span class="comment">/* Calculate volume mixing ratio... */</span></div>
<div class="line"><span class="lineno"> 3398</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> m = mass[mass_idx];</div>
<div class="line"><span class="lineno"> 3399</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae56fa1a240420b87bd2b7a0d040e6d11">qnt_Cx</a>][ip] = <a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a> / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> * m</div>
<div class="line"><span class="lineno"> 3400</span>        / (<a class="code hl_define" href="mptrac_8h.html#ae088e183d18a16fd6ab469d48ce3f06a">RHO</a>(press[izs[ip]], temp) * area[iys[ip]] * dz * 1e9);</div>
<div class="line"><span class="lineno"> 3401</span>    }</div>
<div class="line"><span class="lineno"> 3402</span> </div>
<div class="line"><span class="lineno"> 3403</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 3404</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 3405</span><span class="preprocessor">#pragma acc exit data delete(ixs,iys,izs,z,press,mass,area,lon,lat)</span></div>
<div class="line"><span class="lineno"> 3406</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3407</span>  free(mass);</div>
<div class="line"><span class="lineno"> 3408</span>  free(lon);</div>
<div class="line"><span class="lineno"> 3409</span>  free(lat);</div>
<div class="line"><span class="lineno"> 3410</span>  free(area);</div>
<div class="line"><span class="lineno"> 3411</span>  free(z);</div>
<div class="line"><span class="lineno"> 3412</span>  free(press);</div>
<div class="line"><span class="lineno"> 3413</span>  free(ixs);</div>
<div class="line"><span class="lineno"> 3414</span>  free(iys);</div>
<div class="line"><span class="lineno"> 3415</span>  free(izs);</div>
<div class="line"><span class="lineno"> 3416</span>}</div>
<div class="ttc" id="amptrac_8h_html_a0a81bdec7708d9599d0dcfa7a41caa26"><div class="ttname"><a href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a></div><div class="ttdeci">#define ARRAY_3D(ix, iy, ny, iz, nz)</div><div class="ttdoc">Compute the linear index of a 3D array element.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00458">mptrac.h:458</a></div></div>
<div class="ttc" id="amptrac_8h_html_a5e1d0f42ad38aba63907665ccdd43b86"><div class="ttname"><a href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a></div><div class="ttdeci">#define P(z)</div><div class="ttdoc">Compute pressure at given altitude.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01443">mptrac.h:1443</a></div></div>
<div class="ttc" id="amptrac_8h_html_ae088e183d18a16fd6ab469d48ce3f06a"><div class="ttname"><a href="mptrac_8h.html#ae088e183d18a16fd6ab469d48ce3f06a">RHO</a></div><div class="ttdeci">#define RHO(p, t)</div><div class="ttdoc">Compute density of air.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01620">mptrac.h:1620</a></div></div>
<div class="ttc" id="astructctl__t_html_a0522c3f4f840a3fabbfa786c2dfba4b0"><div class="ttname"><a href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">ctl_t::molmass</a></div><div class="ttdeci">double molmass</div><div class="ttdoc">Molar mass [g/mol].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02736">mptrac.h:2736</a></div></div>
<div class="ttc" id="astructctl__t_html_a080fa58f76fcfad970b76ca112706154"><div class="ttname"><a href="structctl__t.html#a080fa58f76fcfad970b76ca112706154">ctl_t::chemgrid_z1</a></div><div class="ttdeci">double chemgrid_z1</div><div class="ttdoc">Upper altitude of chemistry grid [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02823">mptrac.h:2823</a></div></div>
<div class="ttc" id="astructctl__t_html_a1834cd1e787e3aa2f391cd942a7f37c7"><div class="ttname"><a href="structctl__t.html#a1834cd1e787e3aa2f391cd942a7f37c7">ctl_t::chemgrid_z0</a></div><div class="ttdeci">double chemgrid_z0</div><div class="ttdoc">Lower altitude of chemistry grid [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02820">mptrac.h:2820</a></div></div>
<div class="ttc" id="astructctl__t_html_a189dce731fb0c3210161ca328a93a327"><div class="ttname"><a href="structctl__t.html#a189dce731fb0c3210161ca328a93a327">ctl_t::chemgrid_lat0</a></div><div class="ttdeci">double chemgrid_lat0</div><div class="ttdoc">Lower latitude of chemistry grid [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02838">mptrac.h:2838</a></div></div>
<div class="ttc" id="astructctl__t_html_a2e99a15cc98b378ffc96a6df73fe6048"><div class="ttname"><a href="structctl__t.html#a2e99a15cc98b378ffc96a6df73fe6048">ctl_t::chemgrid_lat1</a></div><div class="ttdeci">double chemgrid_lat1</div><div class="ttdoc">Upper latitude of chemistry grid [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02841">mptrac.h:2841</a></div></div>
<div class="ttc" id="astructctl__t_html_a3e1bc34453198d5854a7f0271f503f7c"><div class="ttname"><a href="structctl__t.html#a3e1bc34453198d5854a7f0271f503f7c">ctl_t::chemgrid_lon0</a></div><div class="ttdeci">double chemgrid_lon0</div><div class="ttdoc">Lower longitude of chemistry grid [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02829">mptrac.h:2829</a></div></div>
<div class="ttc" id="astructctl__t_html_a4b601fe8e527664c96b12b9eafee4762"><div class="ttname"><a href="structctl__t.html#a4b601fe8e527664c96b12b9eafee4762">ctl_t::chemgrid_lon1</a></div><div class="ttdeci">double chemgrid_lon1</div><div class="ttdoc">Upper longitude of chemistry grid [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02832">mptrac.h:2832</a></div></div>
<div class="ttc" id="astructctl__t_html_a718d3200f867d9018369f12f66464807"><div class="ttname"><a href="structctl__t.html#a718d3200f867d9018369f12f66464807">ctl_t::dt_mod</a></div><div class="ttdeci">double dt_mod</div><div class="ttdoc">Time step of simulation [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02450">mptrac.h:2450</a></div></div>
<div class="ttc" id="astructctl__t_html_a8be23ace67543cf50c8b071a3111694f"><div class="ttname"><a href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">ctl_t::nens</a></div><div class="ttdeci">int nens</div><div class="ttdoc">Number of ensembles.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02989">mptrac.h:2989</a></div></div>
<div class="ttc" id="astructctl__t_html_a9fab7dd94afddfff20c4596605e3f18a"><div class="ttname"><a href="structctl__t.html#a9fab7dd94afddfff20c4596605e3f18a">ctl_t::chemgrid_nz</a></div><div class="ttdeci">int chemgrid_nz</div><div class="ttdoc">Number of altitudes of chemistry grid.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02817">mptrac.h:2817</a></div></div>
<div class="ttc" id="astructctl__t_html_ab7ed13e186108a02ff64f4bccc4ec775"><div class="ttname"><a href="structctl__t.html#ab7ed13e186108a02ff64f4bccc4ec775">ctl_t::chemgrid_nx</a></div><div class="ttdeci">int chemgrid_nx</div><div class="ttdoc">Number of longitudes of chemistry grid.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02826">mptrac.h:2826</a></div></div>
<div class="ttc" id="astructctl__t_html_ac43809de3c73cb9793c567813452cfca"><div class="ttname"><a href="structctl__t.html#ac43809de3c73cb9793c567813452cfca">ctl_t::chemgrid_ny</a></div><div class="ttdeci">int chemgrid_ny</div><div class="ttdoc">Number of latitudes of chemistry grid.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02835">mptrac.h:2835</a></div></div>
<div class="ttc" id="astructctl__t_html_ace61e592378505a9011133dc02d249a7"><div class="ttname"><a href="structctl__t.html#ace61e592378505a9011133dc02d249a7">ctl_t::qnt_ens</a></div><div class="ttdeci">int qnt_ens</div><div class="ttdoc">Quantity array index for ensemble IDs.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02156">mptrac.h:2156</a></div></div>
<div class="ttc" id="astructctl__t_html_ae56fa1a240420b87bd2b7a0d040e6d11"><div class="ttname"><a href="structctl__t.html#ae56fa1a240420b87bd2b7a0d040e6d11">ctl_t::qnt_Cx</a></div><div class="ttdeci">int qnt_Cx</div><div class="ttdoc">Quantity array index for trace species x volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02387">mptrac.h:2387</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a904c7f663617b319b69d5ff6fe04507a_cgraph.png" border="0" usemap="#amptrac_8h_a904c7f663617b319b69d5ff6fe04507a_cgraph" alt=""/></div>
<map name="amptrac_8h_a904c7f663617b319b69d5ff6fe04507a_cgraph" id="amptrac_8h_a904c7f663617b319b69d5ff6fe04507a_cgraph">
<area shape="rect" title="Computes gridded chemical tracer concentrations (volume mixing ratio) from individual air parcel mass..." alt="" coords="5,56,136,83"/>
<area shape="rect" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6" title="Interpolates meteorological data in 3D space and time." alt="" coords="184,56,319,83"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="367,56,512,83"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="560,5,700,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="593,56,667,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="589,107,671,133"/>
</map>
</div>

</div>
</div>
<a id="a2a04fee6c403d3d912d89d9666c0fd7b" name="a2a04fee6c403d3d912d89d9666c0fd7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a04fee6c403d3d912d89d9666c0fd7b">&#9670;&nbsp;</a></span>module_chem_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_chem_init </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the chemistry modules by setting atmospheric composition. </p>
<p >This function initializes various chemical components of the atmosphere using meteorological data and climatological information. It interpolates and sets values for water vapor (H2O), ozone (O3), and several radical species such as OH, HO2, H2O2, and O1D for each air parcel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing quantity flags. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climatology structure containing climatological data. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the initial meteorological data structure. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the final meteorological data structure. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the air parcel data structure.</td></tr>
  </table>
  </dd>
</dl>
<p>The function uses OpenMP for parallel processing, iterating over each point in the atmosphere (atm-&gt;np) to initialize chemical species concentrations. It performs the following steps:</p><ul>
<li>Interpolates H2O and O3 data from meteorological input if the respective quantity flags (ctl-&gt;qnt_Ch2o and ctl-&gt;qnt_Co3) are set.</li>
<li>Sets the concentrations of OH, HO2, H2O2, and O1D using climatological data if the respective quantity flags are set.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l03420">3420</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3426</span>              {</div>
<div class="line"><span class="lineno"> 3427</span> </div>
<div class="line"><span class="lineno"> 3428</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 3429</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_CHEM_INIT&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3430</span> </div>
<div class="line"><span class="lineno"> 3431</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 3432</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 0,</div>
<div class="line"><span class="lineno"> 3433</span>                <span class="stringliteral">&quot;acc data present(ctl,cache,clim,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 3434</span> </div>
<div class="line"><span class="lineno"> 3435</span>    <span class="comment">/* Set H2O and O3 using meteo data... */</span></div>
<div class="line"><span class="lineno"> 3436</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 3437</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9baf6b24cc12d9b589576a173bed3b8b">qnt_Ch2o</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 3438</span>      <span class="keywordtype">double</span> h2o;</div>
<div class="line"><span class="lineno"> 3439</span>      <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(h2o, 1);</div>
<div class="line"><span class="lineno"> 3440</span>      <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_Ch2o, h2o);</div>
<div class="line"><span class="lineno"> 3441</span>    }</div>
<div class="line"><span class="lineno"> 3442</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa1dc44e429c2e407559577b86c9fc170">qnt_Co3</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 3443</span>      <span class="keywordtype">double</span> o3;</div>
<div class="line"><span class="lineno"> 3444</span>      <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(o3, 1);</div>
<div class="line"><span class="lineno"> 3445</span>      <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_Co3, o3);</div>
<div class="line"><span class="lineno"> 3446</span>    }</div>
<div class="line"><span class="lineno"> 3447</span> </div>
<div class="line"><span class="lineno"> 3448</span>    <span class="comment">/* Set radical species... */</span></div>
<div class="line"><span class="lineno"> 3449</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_Coh, <a class="code hl_function" href="mptrac_8c.html#a9ba00889eeb600010467d8b62de94a36">clim_oh</a>(ctl, clim, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip],</div>
<div class="line"><span class="lineno"> 3450</span>                             atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]));</div>
<div class="line"><span class="lineno"> 3451</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_Cho2, <a class="code hl_function" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a2ba0d75a451d9382ba20ec54d1784e05">ho2</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip],</div>
<div class="line"><span class="lineno"> 3452</span>                              atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]));</div>
<div class="line"><span class="lineno"> 3453</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_Ch2o2, <a class="code hl_function" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#ab7f787719be51524b1389bb0bf347934">h2o2</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip],</div>
<div class="line"><span class="lineno"> 3454</span>                               atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]));</div>
<div class="line"><span class="lineno"> 3455</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_Co1d, <a class="code hl_function" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a9a7486ab639da63d6ac55d6cbacdcf0e">o1d</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip],</div>
<div class="line"><span class="lineno"> 3456</span>                              atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]));</div>
<div class="line"><span class="lineno"> 3457</span>  }</div>
<div class="line"><span class="lineno"> 3458</span>}</div>
<div class="ttc" id="amptrac_8c_html_a9ba00889eeb600010467d8b62de94a36"><div class="ttname"><a href="mptrac_8c.html#a9ba00889eeb600010467d8b62de94a36">clim_oh</a></div><div class="ttdeci">double clim_oh(const ctl_t *ctl, const clim_t *clim, const double t, const double lon, const double lat, const double p)</div><div class="ttdoc">Calculates the hydroxyl radical (OH) concentration from climatology data, with an optional diurnal co...</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l00089">mptrac.c:89</a></div></div>
<div class="ttc" id="amptrac_8h_html_a9c741a27b379cebf498901dc7d271296"><div class="ttname"><a href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a></div><div class="ttdeci">#define SET_ATM(qnt, val)</div><div class="ttdoc">Set atmospheric quantity value.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01639">mptrac.h:1639</a></div></div>
<div class="ttc" id="astructclim__t_html_a2ba0d75a451d9382ba20ec54d1784e05"><div class="ttname"><a href="structclim__t.html#a2ba0d75a451d9382ba20ec54d1784e05">clim_t::ho2</a></div><div class="ttdeci">clim_zm_t ho2</div><div class="ttdoc">HO2 zonal means.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03389">mptrac.h:3389</a></div></div>
<div class="ttc" id="astructclim__t_html_a9a7486ab639da63d6ac55d6cbacdcf0e"><div class="ttname"><a href="structclim__t.html#a9a7486ab639da63d6ac55d6cbacdcf0e">clim_t::o1d</a></div><div class="ttdeci">clim_zm_t o1d</div><div class="ttdoc">O(1D) zonal means.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03392">mptrac.h:3392</a></div></div>
<div class="ttc" id="astructclim__t_html_ab7f787719be51524b1389bb0bf347934"><div class="ttname"><a href="structclim__t.html#ab7f787719be51524b1389bb0bf347934">clim_t::h2o2</a></div><div class="ttdeci">clim_zm_t h2o2</div><div class="ttdoc">H2O2 zonal means.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03386">mptrac.h:3386</a></div></div>
<div class="ttc" id="astructctl__t_html_a9baf6b24cc12d9b589576a173bed3b8b"><div class="ttname"><a href="structctl__t.html#a9baf6b24cc12d9b589576a173bed3b8b">ctl_t::qnt_Ch2o</a></div><div class="ttdeci">int qnt_Ch2o</div><div class="ttdoc">Quantity array index for H2O volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02390">mptrac.h:2390</a></div></div>
<div class="ttc" id="astructctl__t_html_aa1dc44e429c2e407559577b86c9fc170"><div class="ttname"><a href="structctl__t.html#aa1dc44e429c2e407559577b86c9fc170">ctl_t::qnt_Co3</a></div><div class="ttdeci">int qnt_Co3</div><div class="ttdoc">Quantity array index for O3 volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02393">mptrac.h:2393</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a2a04fee6c403d3d912d89d9666c0fd7b_cgraph.png" border="0" usemap="#amptrac_8h_a2a04fee6c403d3d912d89d9666c0fd7b_cgraph" alt=""/></div>
<map name="amptrac_8h_a2a04fee6c403d3d912d89d9666c0fd7b_cgraph" id="amptrac_8h_a2a04fee6c403d3d912d89d9666c0fd7b_cgraph">
<area shape="rect" title="Initializes the chemistry modules by setting atmospheric composition." alt="" coords="5,56,132,83"/>
<area shape="rect" href="mptrac_8c.html#a9ba00889eeb600010467d8b62de94a36" title="Calculates the hydroxyl radical (OH) concentration from climatology data, with an optional diurnal co..." alt="" coords="180,81,247,108"/>
<area shape="rect" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a" title="Interpolates monthly mean zonal mean climatological variables." alt="" coords="295,31,365,57"/>
<area shape="rect" href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="295,81,365,108"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="417,5,492,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="413,56,496,83"/>
</map>
</div>

</div>
</div>
<a id="a799ef256c15dc112842d1dbc5afc787c" name="a799ef256c15dc112842d1dbc5afc787c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a799ef256c15dc112842d1dbc5afc787c">&#9670;&nbsp;</a></span>module_convection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_convection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs convective mixing of atmospheric particles. </p>
<p >This function adjusts the pressure of atmospheric particles based on boundary layer (PBL) mixing and convective conditions driven by CAPE (Convective Available Potential Energy) and CIN (Convective Inhibition). It uses meteorological data and random numbers for vertical mixing calculations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the control structure with simulation settings. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">met0</td><td>Pointer to the meteorological data at the initial timestep. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">met1</td><td>Pointer to the meteorological data at the subsequent timestep. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atm</td><td>Pointer to the atmospheric data structure with particle properties.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>This function modifies the <code>atm</code> structure in place.</li>
<li>Interpolates CAPE, CIN, and other meteorological parameters.</li>
<li>Determines the pressure range for PBL and convective mixing.</li>
<li>Updates the pressure of particles based on calculated mixing.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l03462">3462</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3467</span>              {</div>
<div class="line"><span class="lineno"> 3468</span> </div>
<div class="line"><span class="lineno"> 3469</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 3470</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_CONVECTION&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3471</span> </div>
<div class="line"><span class="lineno"> 3472</span>  <span class="comment">/* Create random numbers... */</span></div>
<div class="line"><span class="lineno"> 3473</span>  <a class="code hl_function" href="mptrac_8c.html#aab313e4929e7379aca2aee1ee36873d9">module_rng</a>(ctl, cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 0);</div>
<div class="line"><span class="lineno"> 3474</span> </div>
<div class="line"><span class="lineno"> 3475</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 3476</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(ctl,cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 3477</span> </div>
<div class="line"><span class="lineno"> 3478</span>    <span class="comment">/* Interpolate surface pressure... */</span></div>
<div class="line"><span class="lineno"> 3479</span>    <span class="keywordtype">double</span> ps;</div>
<div class="line"><span class="lineno"> 3480</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 3481</span>    <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(ps, 1);</div>
<div class="line"><span class="lineno"> 3482</span> </div>
<div class="line"><span class="lineno"> 3483</span>    <span class="comment">/* Initialize pressure range for vertical mixing... */</span></div>
<div class="line"><span class="lineno"> 3484</span>    <span class="keywordtype">double</span> pbot = ps, ptop = ps;</div>
<div class="line"><span class="lineno"> 3485</span> </div>
<div class="line"><span class="lineno"> 3486</span>    <span class="comment">/* Mixing in the PBL... */</span></div>
<div class="line"><span class="lineno"> 3487</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9d400510c073db38fb10c9fc2bdff74d">conv_mix_pbl</a>) {</div>
<div class="line"><span class="lineno"> 3488</span> </div>
<div class="line"><span class="lineno"> 3489</span>      <span class="comment">/* Interpolate PBL... */</span></div>
<div class="line"><span class="lineno"> 3490</span>      <span class="keywordtype">double</span> pbl;</div>
<div class="line"><span class="lineno"> 3491</span>      <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(pbl, 0);</div>
<div class="line"><span class="lineno"> 3492</span> </div>
<div class="line"><span class="lineno"> 3493</span>      <span class="comment">/* Set pressure range... */</span></div>
<div class="line"><span class="lineno"> 3494</span>      ptop = pbl - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9478265650dbad91e098fd4bd95d6ff5">conv_pbl_trans</a> * (ps - pbl);</div>
<div class="line"><span class="lineno"> 3495</span>    }</div>
<div class="line"><span class="lineno"> 3496</span> </div>
<div class="line"><span class="lineno"> 3497</span>    <span class="comment">/* Convective mixing... */</span></div>
<div class="line"><span class="lineno"> 3498</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a18c1107433d1e9c7867025e8a0fbe6d2">conv_cape</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 3499</span> </div>
<div class="line"><span class="lineno"> 3500</span>      <span class="comment">/* Interpolate CAPE, CIN, and equilibrium level... */</span></div>
<div class="line"><span class="lineno"> 3501</span>      <span class="keywordtype">double</span> cape, cin, pel;</div>
<div class="line"><span class="lineno"> 3502</span>      <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(cape, 0);</div>
<div class="line"><span class="lineno"> 3503</span>      <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(cin, 0);</div>
<div class="line"><span class="lineno"> 3504</span>      <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(pel, 0);</div>
<div class="line"><span class="lineno"> 3505</span> </div>
<div class="line"><span class="lineno"> 3506</span>      <span class="comment">/* Set pressure range... */</span></div>
<div class="line"><span class="lineno"> 3507</span>      <span class="keywordflow">if</span> (isfinite(cape) &amp;&amp; cape &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a18c1107433d1e9c7867025e8a0fbe6d2">conv_cape</a></div>
<div class="line"><span class="lineno"> 3508</span>          &amp;&amp; (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad6e15e5c23446b0ac2f5f48f70f575a1">conv_cin</a> &lt;= 0 || (isfinite(cin) &amp;&amp; cin &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad6e15e5c23446b0ac2f5f48f70f575a1">conv_cin</a>)))</div>
<div class="line"><span class="lineno"> 3509</span>        ptop = GSL_MIN(ptop, pel);</div>
<div class="line"><span class="lineno"> 3510</span>    }</div>
<div class="line"><span class="lineno"> 3511</span> </div>
<div class="line"><span class="lineno"> 3512</span>    <span class="comment">/* Apply vertical mixing... */</span></div>
<div class="line"><span class="lineno"> 3513</span>    <span class="keywordflow">if</span> (ptop != pbot &amp;&amp; atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &gt;= ptop) {</div>
<div class="line"><span class="lineno"> 3514</span> </div>
<div class="line"><span class="lineno"> 3515</span>      <span class="comment">/* Get density range... */</span></div>
<div class="line"><span class="lineno"> 3516</span>      <span class="keywordtype">double</span> tbot, ttop;</div>
<div class="line"><span class="lineno"> 3517</span>      <a class="code hl_function" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip],</div>
<div class="line"><span class="lineno"> 3518</span>                         pbot, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], &amp;tbot, ci, cw, 1);</div>
<div class="line"><span class="lineno"> 3519</span>      <a class="code hl_function" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], ptop,</div>
<div class="line"><span class="lineno"> 3520</span>                         atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], &amp;ttop, ci, cw, 1);</div>
<div class="line"><span class="lineno"> 3521</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> rhobot = pbot / tbot;</div>
<div class="line"><span class="lineno"> 3522</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> rhotop = ptop / ttop;</div>
<div class="line"><span class="lineno"> 3523</span> </div>
<div class="line"><span class="lineno"> 3524</span>      <span class="comment">/* Get new density... */</span></div>
<div class="line"><span class="lineno"> 3525</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> rho = rhobot + (rhotop - rhobot) * cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>[ip];</div>
<div class="line"><span class="lineno"> 3526</span> </div>
<div class="line"><span class="lineno"> 3527</span>      <span class="comment">/* Get pressure... */</span></div>
<div class="line"><span class="lineno"> 3528</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(rhobot, pbot, rhotop, ptop, rho);</div>
<div class="line"><span class="lineno"> 3529</span>    }</div>
<div class="line"><span class="lineno"> 3530</span>  }</div>
<div class="line"><span class="lineno"> 3531</span>}</div>
<div class="ttc" id="amptrac_8c_html_aab313e4929e7379aca2aee1ee36873d9"><div class="ttname"><a href="mptrac_8c.html#aab313e4929e7379aca2aee1ee36873d9">module_rng</a></div><div class="ttdeci">void module_rng(const ctl_t *ctl, double *rs, const size_t n, const int method)</div><div class="ttdoc">Generate random numbers using various methods and distributions.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04635">mptrac.c:4635</a></div></div>
<div class="ttc" id="astructcache__t_html_aa35b7fdf9768493f676a4e24ad78e4d9"><div class="ttname"><a href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">cache_t::rs</a></div><div class="ttdeci">double rs[3 *NP+1]</div><div class="ttdoc">Random numbers.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03237">mptrac.h:3237</a></div></div>
<div class="ttc" id="astructctl__t_html_a18c1107433d1e9c7867025e8a0fbe6d2"><div class="ttname"><a href="structctl__t.html#a18c1107433d1e9c7867025e8a0fbe6d2">ctl_t::conv_cape</a></div><div class="ttdeci">double conv_cape</div><div class="ttdoc">CAPE threshold for convection module [J/kg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02688">mptrac.h:2688</a></div></div>
<div class="ttc" id="astructctl__t_html_a9478265650dbad91e098fd4bd95d6ff5"><div class="ttname"><a href="structctl__t.html#a9478265650dbad91e098fd4bd95d6ff5">ctl_t::conv_pbl_trans</a></div><div class="ttdeci">double conv_pbl_trans</div><div class="ttdoc">Depth of PBL transition layer (fraction of PBL depth).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02685">mptrac.h:2685</a></div></div>
<div class="ttc" id="astructctl__t_html_a9d400510c073db38fb10c9fc2bdff74d"><div class="ttname"><a href="structctl__t.html#a9d400510c073db38fb10c9fc2bdff74d">ctl_t::conv_mix_pbl</a></div><div class="ttdeci">int conv_mix_pbl</div><div class="ttdoc">Vertical mixing in the PBL (0=off, 1=on).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02682">mptrac.h:2682</a></div></div>
<div class="ttc" id="astructctl__t_html_ad6e15e5c23446b0ac2f5f48f70f575a1"><div class="ttname"><a href="structctl__t.html#ad6e15e5c23446b0ac2f5f48f70f575a1">ctl_t::conv_cin</a></div><div class="ttdeci">double conv_cin</div><div class="ttdoc">CIN threshold for convection module [J/kg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02691">mptrac.h:2691</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a799ef256c15dc112842d1dbc5afc787c_cgraph.png" border="0" usemap="#amptrac_8h_a799ef256c15dc112842d1dbc5afc787c_cgraph" alt=""/></div>
<map name="amptrac_8h_a799ef256c15dc112842d1dbc5afc787c_cgraph" id="amptrac_8h_a799ef256c15dc112842d1dbc5afc787c_cgraph">
<area shape="rect" title="Performs convective mixing of atmospheric particles." alt="" coords="5,81,140,108"/>
<area shape="rect" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6" title="Interpolates meteorological data in 3D space and time." alt="" coords="188,56,323,83"/>
<area shape="rect" href="mptrac_8c.html#aab313e4929e7379aca2aee1ee36873d9" title="Generate random numbers using various methods and distributions." alt="" coords="211,107,300,133"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="371,56,516,83"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="564,5,704,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="597,56,671,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="593,107,675,133"/>
</map>
</div>

</div>
</div>
<a id="ac7dbcc9e4768175409c30a110dcd8308" name="ac7dbcc9e4768175409c30a110dcd8308"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7dbcc9e4768175409c30a110dcd8308">&#9670;&nbsp;</a></span>module_dd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_dd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> **&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Manages domain decomposition and particle communication in parallel processing. </p>
<p >The <code>module_dd</code> function orchestrates the domain decomposition process, including particle assignment, sorting, transformation, and communication across MPI processes. It handles the initialization of particles, their assignment to subdomains, and communication between neighbouring processes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data. </td></tr>
    <tr><td class="paramname">cache</td><td>A pointer to a <code><a class="el" href="structcache__t.html" title="Cache data structure.">cache_t</a></code> structure used for storing intermediate values. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a pointer of a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure containing meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Initializes a local array of particles.</li>
<li>Assigns particles to subdomains using <code>dd_assign_rect_subdomains_atm</code>.</li>
<li>Sorts particles according to their location and target rank using <code>dd_sort</code>.</li>
<li>Transforms atmospheric data to particle data using <code>atm2particles</code>.</li>
<li>Communicates particles between neighbouring MPI processes using <code>dd_communicate_particles</code>.</li>
<li>Transforms particle data back to atmospheric data using <code>dd_particles2atm</code>.</li>
<li>Frees the local particle array after processing.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the <code>ctl</code>, <code>atm</code>, <code>cache</code>, <code>dd</code>, and <code>met</code> structures are properly initialized. It is designed to work in a parallel processing environment using MPI.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

</div>
</div>
<a id="a1b4a2c668aae5a7ae522eab2489a464c" name="a1b4a2c668aae5a7ae522eab2489a464c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b4a2c668aae5a7ae522eab2489a464c">&#9670;&nbsp;</a></span>module_decay()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_decay </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulate exponential decay processes for atmospheric particles. </p>
<p >This function simulates decay processes for atmospheric particles based on their mass or volume mixing ratio. It loops over each particle and calculates the decay rate using weighting factors for tropospheric and stratospheric lifetimes. Exponential decay is then calculated, and the mass or volume mixing ratio of particles is updated accordingly. Loss rates can also be calculated and updated based on the decay process.</p>
<p >The function checks for quantity flags to ensure that mass or volume mixing ratio data is available. It then calculates the weighting factor based on the particle's location in the atmosphere and sets the lifetime accordingly. Exponential decay is calculated using the time step and the lifetime, and the particle's mass or volume mixing ratio is updated. Loss rates can also be updated based on the decay process.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climate data structure containing atmospheric data. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l03575">3575</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3579</span>              {</div>
<div class="line"><span class="lineno"> 3580</span> </div>
<div class="line"><span class="lineno"> 3581</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 3582</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_DECAY&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3583</span> </div>
<div class="line"><span class="lineno"> 3584</span>  <span class="comment">/* Check quantity flags... */</span></div>
<div class="line"><span class="lineno"> 3585</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &lt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 3586</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Module needs quantity mass or volume mixing ratio!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3587</span> </div>
<div class="line"><span class="lineno"> 3588</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 3589</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(ctl,cache,clim,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 3590</span> </div>
<div class="line"><span class="lineno"> 3591</span>    <span class="comment">/* Get weighting factor... */</span></div>
<div class="line"><span class="lineno"> 3592</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> w = <a class="code hl_function" href="mptrac_8c.html#a90bdbbffe8b8633d84a48d2ddd311180">tropo_weight</a>(clim, atm, ip);</div>
<div class="line"><span class="lineno"> 3593</span> </div>
<div class="line"><span class="lineno"> 3594</span>    <span class="comment">/* Set lifetime... */</span></div>
<div class="line"><span class="lineno"> 3595</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> tdec = w * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af276258494c92c24ab0de0b54759e9a9">tdec_trop</a> + (1 - w) * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a86977d0f97ee8db6974efc896822a7db">tdec_strat</a>;</div>
<div class="line"><span class="lineno"> 3596</span> </div>
<div class="line"><span class="lineno"> 3597</span>    <span class="comment">/* Calculate exponential decay... */</span></div>
<div class="line"><span class="lineno"> 3598</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux = exp(-cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] / tdec);</div>
<div class="line"><span class="lineno"> 3599</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 3600</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5bb49c284e2579630f1eae77a769aba8">qnt_mloss_decay</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3601</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5bb49c284e2579630f1eae77a769aba8">qnt_mloss_decay</a>][ip]</div>
<div class="line"><span class="lineno"> 3602</span>          += atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip] * (1 - aux);</div>
<div class="line"><span class="lineno"> 3603</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip] *= aux;</div>
<div class="line"><span class="lineno"> 3604</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3605</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a>][ip] += 1. / tdec;</div>
<div class="line"><span class="lineno"> 3606</span>    }</div>
<div class="line"><span class="lineno"> 3607</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3608</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a>][ip] *= aux;</div>
<div class="line"><span class="lineno"> 3609</span>  }</div>
<div class="line"><span class="lineno"> 3610</span>}</div>
<div class="ttc" id="amptrac_8c_html_a90bdbbffe8b8633d84a48d2ddd311180"><div class="ttname"><a href="mptrac_8c.html#a90bdbbffe8b8633d84a48d2ddd311180">tropo_weight</a></div><div class="ttdeci">double tropo_weight(const clim_t *clim, const atm_t *atm, const int ip)</div><div class="ttdoc">Computes a weighting factor based on tropopause pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11258">mptrac.c:11258</a></div></div>
<div class="ttc" id="astructctl__t_html_a26c2f638a10b553ee8b07f1cc5907c86"><div class="ttname"><a href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">ctl_t::qnt_loss_rate</a></div><div class="ttdeci">int qnt_loss_rate</div><div class="ttdoc">Quantity array index for total loss rate.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02321">mptrac.h:2321</a></div></div>
<div class="ttc" id="astructctl__t_html_a5bb49c284e2579630f1eae77a769aba8"><div class="ttname"><a href="structctl__t.html#a5bb49c284e2579630f1eae77a769aba8">ctl_t::qnt_mloss_decay</a></div><div class="ttdeci">int qnt_mloss_decay</div><div class="ttdoc">Quantity array index for total mass loss due to exponential decay.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02318">mptrac.h:2318</a></div></div>
<div class="ttc" id="astructctl__t_html_a86977d0f97ee8db6974efc896822a7db"><div class="ttname"><a href="structctl__t.html#a86977d0f97ee8db6974efc896822a7db">ctl_t::tdec_strat</a></div><div class="ttdeci">double tdec_strat</div><div class="ttdoc">Life time of particles in the stratosphere [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02742">mptrac.h:2742</a></div></div>
<div class="ttc" id="astructctl__t_html_af276258494c92c24ab0de0b54759e9a9"><div class="ttname"><a href="structctl__t.html#af276258494c92c24ab0de0b54759e9a9">ctl_t::tdec_trop</a></div><div class="ttdeci">double tdec_trop</div><div class="ttdoc">Life time of particles in the troposphere [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02739">mptrac.h:2739</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a1b4a2c668aae5a7ae522eab2489a464c_cgraph.png" border="0" usemap="#amptrac_8h_a1b4a2c668aae5a7ae522eab2489a464c_cgraph" alt=""/></div>
<map name="amptrac_8h_a1b4a2c668aae5a7ae522eab2489a464c_cgraph" id="amptrac_8h_a1b4a2c668aae5a7ae522eab2489a464c_cgraph">
<area shape="rect" title="Simulate exponential decay processes for atmospheric particles." alt="" coords="5,31,111,57"/>
<area shape="rect" href="mptrac_8c.html#a90bdbbffe8b8633d84a48d2ddd311180" title="Computes a weighting factor based on tropopause pressure." alt="" coords="159,31,255,57"/>
<area shape="rect" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692" title="Calculates the tropopause pressure based on climatological data." alt="" coords="303,31,385,57"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="437,5,512,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="433,56,516,83"/>
</map>
</div>

</div>
</div>
<a id="ac7d1bdf49d0da3ca1911eebe2a96a2ac" name="ac7d1bdf49d0da3ca1911eebe2a96a2ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7d1bdf49d0da3ca1911eebe2a96a2ac">&#9670;&nbsp;</a></span>module_diff_meso()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_diff_meso </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulate mesoscale diffusion for atmospheric particles. </p>
<p >This function simulates mesoscale diffusion for atmospheric particles, including horizontal and vertical wind fluctuations. It calculates standard deviations of local wind data and temporal correlations for mesoscale fluctuations. Mesoscale wind fluctuations are then calculated based on the provided random numbers and turbulence parameters. The particle positions are updated accordingly.</p>
<p >The function loops over each particle and calculates indices for interpolation of wind data. It then computes standard deviations of local wind data and temporal correlations for mesoscale fluctuations. Based on the turbulence parameters and provided random numbers, it calculates horizontal and vertical mesoscale wind fluctuations. Finally, it updates the particle positions based on the calculated wind fluctuations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data structure at the current time step. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the meteorological data structure at the next time step. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Control parameters <code>TURB_MESOX</code> and <code>TURB_MESOZ</code> define the subgrid-scale variability as a fraction of the grid-scale variance. Stohl et al. (2005) recommend a default value of 0.16 for both parameters, providing a standard approach for turbulence representation. However, recent findings by Bakels et al. (2024) suggest disabling this approach to improve model accuracy under certain conditions. It is advised to evaluate the applicability of these recommendations based on the specific simulation context and objectives.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l03614">3614</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3619</span>              {</div>
<div class="line"><span class="lineno"> 3620</span> </div>
<div class="line"><span class="lineno"> 3621</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 3622</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_DIFF_MESO&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3623</span> </div>
<div class="line"><span class="lineno"> 3624</span>  <span class="comment">/* Create random numbers... */</span></div>
<div class="line"><span class="lineno"> 3625</span>  <a class="code hl_function" href="mptrac_8c.html#aab313e4929e7379aca2aee1ee36873d9">module_rng</a>(ctl, cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>, 3 * (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1);</div>
<div class="line"><span class="lineno"> 3626</span> </div>
<div class="line"><span class="lineno"> 3627</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 3628</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(ctl,cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 3629</span> </div>
<div class="line"><span class="lineno"> 3630</span>    <span class="comment">/* Get indices... */</span></div>
<div class="line"><span class="lineno"> 3631</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> ix = <a class="code hl_function" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip]);</div>
<div class="line"><span class="lineno"> 3632</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iy = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]);</div>
<div class="line"><span class="lineno"> 3633</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iz = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]);</div>
<div class="line"><span class="lineno"> 3634</span> </div>
<div class="line"><span class="lineno"> 3635</span>    <span class="comment">/* Get standard deviations of local wind data... */</span></div>
<div class="line"><span class="lineno"> 3636</span>    <span class="keywordtype">float</span> umean = 0, usig = 0, vmean = 0, vsig = 0, wmean = 0, wsig = 0;</div>
<div class="line"><span class="lineno"> 3637</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno"> 3638</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><span class="lineno"> 3639</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++) {</div>
<div class="line"><span class="lineno"> 3640</span>          umean += met0-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix + i][iy + j][iz + k];</div>
<div class="line"><span class="lineno"> 3641</span>          usig += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix + i][iy + j][iz + k]);</div>
<div class="line"><span class="lineno"> 3642</span>          vmean += met0-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix + i][iy + j][iz + k];</div>
<div class="line"><span class="lineno"> 3643</span>          vsig += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix + i][iy + j][iz + k]);</div>
<div class="line"><span class="lineno"> 3644</span>          wmean += met0-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix + i][iy + j][iz + k];</div>
<div class="line"><span class="lineno"> 3645</span>          wsig += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix + i][iy + j][iz + k]);</div>
<div class="line"><span class="lineno"> 3646</span> </div>
<div class="line"><span class="lineno"> 3647</span>          umean += met1-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix + i][iy + j][iz + k];</div>
<div class="line"><span class="lineno"> 3648</span>          usig += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(met1-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix + i][iy + j][iz + k]);</div>
<div class="line"><span class="lineno"> 3649</span>          vmean += met1-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix + i][iy + j][iz + k];</div>
<div class="line"><span class="lineno"> 3650</span>          vsig += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(met1-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix + i][iy + j][iz + k]);</div>
<div class="line"><span class="lineno"> 3651</span>          wmean += met1-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix + i][iy + j][iz + k];</div>
<div class="line"><span class="lineno"> 3652</span>          wsig += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(met1-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix + i][iy + j][iz + k]);</div>
<div class="line"><span class="lineno"> 3653</span>        }</div>
<div class="line"><span class="lineno"> 3654</span>    usig = usig / 16.f - <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(umean / 16.f);</div>
<div class="line"><span class="lineno"> 3655</span>    usig = (usig &gt; 0 ? sqrtf(usig) : 0);</div>
<div class="line"><span class="lineno"> 3656</span>    vsig = vsig / 16.f - <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(vmean / 16.f);</div>
<div class="line"><span class="lineno"> 3657</span>    vsig = (vsig &gt; 0 ? sqrtf(vsig) : 0);</div>
<div class="line"><span class="lineno"> 3658</span>    wsig = wsig / 16.f - <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(wmean / 16.f);</div>
<div class="line"><span class="lineno"> 3659</span>    wsig = (wsig &gt; 0 ? sqrtf(wsig) : 0);</div>
<div class="line"><span class="lineno"> 3660</span> </div>
<div class="line"><span class="lineno"> 3661</span>    <span class="comment">/* Set temporal correlations for mesoscale fluctuations... */</span></div>
<div class="line"><span class="lineno"> 3662</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> r = 1 - 2 * fabs(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip]) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a>;</div>
<div class="line"><span class="lineno"> 3663</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> r2 = sqrt(1 - r * r);</div>
<div class="line"><span class="lineno"> 3664</span> </div>
<div class="line"><span class="lineno"> 3665</span>    <span class="comment">/* Calculate horizontal mesoscale wind fluctuations... */</span></div>
<div class="line"><span class="lineno"> 3666</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4c410e0dddb3e5a5cad1ca66f99967cd">turb_mesox</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 3667</span>      cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][0] =</div>
<div class="line"><span class="lineno"> 3668</span>        (float) (r * cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][0] +</div>
<div class="line"><span class="lineno"> 3669</span>                 r2 * cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>[3 * ip] * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4c410e0dddb3e5a5cad1ca66f99967cd">turb_mesox</a> * usig);</div>
<div class="line"><span class="lineno"> 3670</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] +=</div>
<div class="line"><span class="lineno"> 3671</span>        <a class="code hl_define" href="mptrac_8h.html#a6b22b78dc1239748a44cbd2db4862ef4">DX2DEG</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][0] * cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] / 1000., atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]);</div>
<div class="line"><span class="lineno"> 3672</span> </div>
<div class="line"><span class="lineno"> 3673</span>      cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][1] =</div>
<div class="line"><span class="lineno"> 3674</span>        (float) (r * cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][1] +</div>
<div class="line"><span class="lineno"> 3675</span>                 r2 * cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>[3 * ip + 1] * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4c410e0dddb3e5a5cad1ca66f99967cd">turb_mesox</a> * vsig);</div>
<div class="line"><span class="lineno"> 3676</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] += <a class="code hl_define" href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">DY2DEG</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][1] * cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] / 1000.);</div>
<div class="line"><span class="lineno"> 3677</span>    }</div>
<div class="line"><span class="lineno"> 3678</span> </div>
<div class="line"><span class="lineno"> 3679</span>    <span class="comment">/* Calculate vertical mesoscale wind fluctuations... */</span></div>
<div class="line"><span class="lineno"> 3680</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a22edf991ef6c26556d13aa822a65da63">turb_mesoz</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 3681</span>      cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][2] =</div>
<div class="line"><span class="lineno"> 3682</span>        (float) (r * cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][2] +</div>
<div class="line"><span class="lineno"> 3683</span>                 r2 * cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>[3 * ip + 2] * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a22edf991ef6c26556d13aa822a65da63">turb_mesoz</a> * wsig);</div>
<div class="line"><span class="lineno"> 3684</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] += cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][2] * cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip];</div>
<div class="line"><span class="lineno"> 3685</span>    }</div>
<div class="line"><span class="lineno"> 3686</span>  }</div>
<div class="line"><span class="lineno"> 3687</span>}</div>
<div class="ttc" id="astructcache__t_html_aaa7f03cf8194b0babb1d9c14dcabc84e"><div class="ttname"><a href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">cache_t::uvwp</a></div><div class="ttdeci">float uvwp[NP][3]</div><div class="ttdoc">Wind perturbations [m/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03234">mptrac.h:3234</a></div></div>
<div class="ttc" id="astructctl__t_html_a22edf991ef6c26556d13aa822a65da63"><div class="ttname"><a href="structctl__t.html#a22edf991ef6c26556d13aa822a65da63">ctl_t::turb_mesoz</a></div><div class="ttdeci">double turb_mesoz</div><div class="ttdoc">Vertical scaling factor for mesoscale wind fluctuations.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02679">mptrac.h:2679</a></div></div>
<div class="ttc" id="astructctl__t_html_a2d7b8100a2949004420841d81bcc6ab4"><div class="ttname"><a href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">ctl_t::dt_met</a></div><div class="ttdeci">double dt_met</div><div class="ttdoc">Time step of meteo data [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02460">mptrac.h:2460</a></div></div>
<div class="ttc" id="astructctl__t_html_a4c410e0dddb3e5a5cad1ca66f99967cd"><div class="ttname"><a href="structctl__t.html#a4c410e0dddb3e5a5cad1ca66f99967cd">ctl_t::turb_mesox</a></div><div class="ttdeci">double turb_mesox</div><div class="ttdoc">Horizontal scaling factor for mesoscale wind fluctuations.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02676">mptrac.h:2676</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_ac7d1bdf49d0da3ca1911eebe2a96a2ac_cgraph.png" border="0" usemap="#amptrac_8h_ac7d1bdf49d0da3ca1911eebe2a96a2ac_cgraph" alt=""/></div>
<map name="amptrac_8h_ac7d1bdf49d0da3ca1911eebe2a96a2ac_cgraph" id="amptrac_8h_ac7d1bdf49d0da3ca1911eebe2a96a2ac_cgraph">
<area shape="rect" title="Simulate mesoscale diffusion for atmospheric particles." alt="" coords="5,56,132,83"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="187,5,262,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="183,56,266,83"/>
<area shape="rect" href="mptrac_8c.html#aab313e4929e7379aca2aee1ee36873d9" title="Generate random numbers using various methods and distributions." alt="" coords="180,107,269,133"/>
</map>
</div>

</div>
</div>
<a id="ae102581d80f5817f4c5ef356bde43184" name="ae102581d80f5817f4c5ef356bde43184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae102581d80f5817f4c5ef356bde43184">&#9670;&nbsp;</a></span>module_diff_pbl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_diff_pbl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes particle diffusion within the planetary boundary layer (PBL). </p>
<p >This function handles the effects of turbulence on particles within the PBL. It calculates turbulent velocity variances, Lagrangian timescales, and updates particle positions and perturbations based on random fluctuations and boundary layer physics. This module adapts the approach of Ryall and Maryon (1998) and Stohl et al. (2005).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing model settings. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data structure for the current timestep. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the meteorological data structure for the next timestep. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle states.</td></tr>
  </table>
  </dd>
</dl>
<p>The function:</p><ul>
<li>Allocates memory for random numbers and generates them using <code>module_rng</code>.</li>
<li>Loops over all particles to compute their behavior within the boundary layer.</li>
<li>Handles both stable/neutral and unstable conditions based on the surface sensible heat flux.</li>
<li>Calculates turbulent velocity variances (<code>sig_u</code>, <code>sig_w</code>), their vertical derivatives, and Lagrangian timescales (<code>tau_u</code>, <code>tau_w</code>).</li>
<li>Updates particle velocity perturbations and positions using turbulent diffusion equations.</li>
</ul>
<p >The function uses OpenACC directives for GPU acceleration.</p>
<dl class="section note"><dt>Note</dt><dd>The function handles edge cases like zero diffusivity and imposes minimum limits on calculated values to ensure stability.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure that all input pointers are properly initialized and accessible before calling this function.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l03691">3691</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3696</span>              {</div>
<div class="line"><span class="lineno"> 3697</span> </div>
<div class="line"><span class="lineno"> 3698</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 3699</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_DIFF_PBL&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3700</span> </div>
<div class="line"><span class="lineno"> 3701</span>  <span class="comment">/* Create random numbers... */</span></div>
<div class="line"><span class="lineno"> 3702</span>  <a class="code hl_function" href="mptrac_8c.html#aab313e4929e7379aca2aee1ee36873d9">module_rng</a>(ctl, cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>, 3 * (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1);</div>
<div class="line"><span class="lineno"> 3703</span> </div>
<div class="line"><span class="lineno"> 3704</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 3705</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(ctl,cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 3706</span> </div>
<div class="line"><span class="lineno"> 3707</span>    <span class="keywordtype">double</span> dsigw_dz = 0.0, sig_u = 0.25, sig_w = 0.1,</div>
<div class="line"><span class="lineno"> 3708</span>      tau_u = 300., tau_w = 100.;</div>
<div class="line"><span class="lineno"> 3709</span> </div>
<div class="line"><span class="lineno"> 3710</span>    <span class="comment">/* Get surface and PBL pressure... */</span></div>
<div class="line"><span class="lineno"> 3711</span>    <span class="keywordtype">double</span> pbl, ps;</div>
<div class="line"><span class="lineno"> 3712</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 3713</span>    <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(ps, 1);</div>
<div class="line"><span class="lineno"> 3714</span>    <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(pbl, 0);</div>
<div class="line"><span class="lineno"> 3715</span> </div>
<div class="line"><span class="lineno"> 3716</span>    <span class="comment">/* Boundary layer... */</span></div>
<div class="line"><span class="lineno"> 3717</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &gt;= pbl) {</div>
<div class="line"><span class="lineno"> 3718</span> </div>
<div class="line"><span class="lineno"> 3719</span>      <span class="comment">/* Calculate heights... */</span></div>
<div class="line"><span class="lineno"> 3720</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> p = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], ps);</div>
<div class="line"><span class="lineno"> 3721</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> zs = <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(ps);</div>
<div class="line"><span class="lineno"> 3722</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> z = 1e3 * (<a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(p) - zs);</div>
<div class="line"><span class="lineno"> 3723</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> zi = 1e3 * (<a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(pbl) - zs);</div>
<div class="line"><span class="lineno"> 3724</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> zratio = z / zi;</div>
<div class="line"><span class="lineno"> 3725</span> </div>
<div class="line"><span class="lineno"> 3726</span>      <span class="comment">/* Calculate friction velocity... */</span></div>
<div class="line"><span class="lineno"> 3727</span>      <span class="keywordtype">double</span> ess, nss, h2o, t;</div>
<div class="line"><span class="lineno"> 3728</span>      <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(ess, 0);</div>
<div class="line"><span class="lineno"> 3729</span>      <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(nss, 0);</div>
<div class="line"><span class="lineno"> 3730</span>      <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 1);</div>
<div class="line"><span class="lineno"> 3731</span>      <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(h2o, 0);</div>
<div class="line"><span class="lineno"> 3732</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> rho = <a class="code hl_define" href="mptrac_8h.html#ae088e183d18a16fd6ab469d48ce3f06a">RHO</a>(p, <a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(t, h2o));</div>
<div class="line"><span class="lineno"> 3733</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> tau = sqrt(<a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(ess) + <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(nss));</div>
<div class="line"><span class="lineno"> 3734</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> ustar = sqrt(tau / rho);</div>
<div class="line"><span class="lineno"> 3735</span> </div>
<div class="line"><span class="lineno"> 3736</span>      <span class="comment">/* Get surface sensible heat flux... */</span></div>
<div class="line"><span class="lineno"> 3737</span>      <span class="keywordtype">double</span> shf;</div>
<div class="line"><span class="lineno"> 3738</span>      <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(shf, 1);</div>
<div class="line"><span class="lineno"> 3739</span> </div>
<div class="line"><span class="lineno"> 3740</span>      <span class="comment">/* Stable or neutral conditions... */</span></div>
<div class="line"><span class="lineno"> 3741</span>      <span class="keywordflow">if</span> (shf &lt;= 0) {</div>
<div class="line"><span class="lineno"> 3742</span> </div>
<div class="line"><span class="lineno"> 3743</span>        <span class="comment">/* Calcalute turbulent velocity variances... */</span></div>
<div class="line"><span class="lineno"> 3744</span>        sig_u = 1e-2 + 2.0 * ustar * (1.0 - zratio);</div>
<div class="line"><span class="lineno"> 3745</span>        sig_w = 1e-2 + 1.3 * ustar * (1.0 - zratio);</div>
<div class="line"><span class="lineno"> 3746</span> </div>
<div class="line"><span class="lineno"> 3747</span>        <span class="comment">/* Calculate derivative dsig_w/dz... */</span></div>
<div class="line"><span class="lineno"> 3748</span>        dsigw_dz = -1.3 * ustar / zi;</div>
<div class="line"><span class="lineno"> 3749</span> </div>
<div class="line"><span class="lineno"> 3750</span>        <span class="comment">/* Calcalute Lagrangian timescales... */</span></div>
<div class="line"><span class="lineno"> 3751</span>        tau_u = 0.07 * zi / sig_u * sqrt(zratio);</div>
<div class="line"><span class="lineno"> 3752</span>        tau_w = 0.1 * zi / sig_w * pow(zratio, 0.8);</div>
<div class="line"><span class="lineno"> 3753</span>      }</div>
<div class="line"><span class="lineno"> 3754</span> </div>
<div class="line"><span class="lineno"> 3755</span>      <span class="comment">/* Unstable conditions... */</span></div>
<div class="line"><span class="lineno"> 3756</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3757</span> </div>
<div class="line"><span class="lineno"> 3758</span>        <span class="comment">/* Convective velocity... */</span></div>
<div class="line"><span class="lineno"> 3759</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> wstar =</div>
<div class="line"><span class="lineno"> 3760</span>          pow(<a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> / <a class="code hl_define" href="mptrac_8h.html#a8cbdab681e71d411200fb104480f4862">THETAVIRT</a>(p, t, h2o) * shf / (rho * <a class="code hl_define" href="mptrac_8h.html#af48c8f42b5451a04703d55d62ea50a3e">CPD</a>) * zi, 1. / 3.);</div>
<div class="line"><span class="lineno"> 3761</span> </div>
<div class="line"><span class="lineno"> 3762</span>        <span class="comment">/* Calcalute turbulent velocity variances... */</span></div>
<div class="line"><span class="lineno"> 3763</span>        sig_u = 1e-2</div>
<div class="line"><span class="lineno"> 3764</span>          + sqrt(0.4 * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(wstar) + (5.0 - 4.0 * zratio) * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(ustar));</div>
<div class="line"><span class="lineno"> 3765</span>        sig_w = 1e-2 + sqrt(1.2 * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(wstar) * (1.0 - 0.9 * zratio)</div>
<div class="line"><span class="lineno"> 3766</span>                            * pow(zratio, 2.0 / 3.0)</div>
<div class="line"><span class="lineno"> 3767</span>                            + (1.8 - 1.4 * zratio) * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(ustar));</div>
<div class="line"><span class="lineno"> 3768</span> </div>
<div class="line"><span class="lineno"> 3769</span>        <span class="comment">/* Calculate derivative dsig_w/dz... */</span></div>
<div class="line"><span class="lineno"> 3770</span>        dsigw_dz = 0.5 / sig_w / zi * (-1.4 * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(ustar) + <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(wstar)</div>
<div class="line"><span class="lineno"> 3771</span>                                       * (0.8 *</div>
<div class="line"><span class="lineno"> 3772</span>                                          pow(<a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(zratio, 1e-3), -1.0 / 3.0)</div>
<div class="line"><span class="lineno"> 3773</span>                                          - 1.8 * pow(zratio, 2.0 / 3.0)));</div>
<div class="line"><span class="lineno"> 3774</span> </div>
<div class="line"><span class="lineno"> 3775</span>        <span class="comment">/* Calculate Lagrangian timescales... */</span></div>
<div class="line"><span class="lineno"> 3776</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> C0 = 3.0;  <span class="comment">// TODO: typically 3...6, NAME model uses 3?</span></div>
<div class="line"><span class="lineno"> 3777</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> eps =</div>
<div class="line"><span class="lineno"> 3778</span>          (1.5 - 1.2 * pow(zratio, 1.0 / 3.0)) * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(wstar) * wstar / zi</div>
<div class="line"><span class="lineno"> 3779</span>          + <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(ustar) * ustar * (1.0 - 0.8 * zratio) / (<a class="code hl_define" href="mptrac_8h.html#a3566596468c1f46bc90ad143b5c9e203">KARMAN</a> * z);</div>
<div class="line"><span class="lineno"> 3780</span>        tau_u = 2 * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(sig_u) / (C0 * eps);</div>
<div class="line"><span class="lineno"> 3781</span>        tau_w = 2 * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(sig_w) / (C0 * eps);</div>
<div class="line"><span class="lineno"> 3782</span>      }</div>
<div class="line"><span class="lineno"> 3783</span>    }</div>
<div class="line"><span class="lineno"> 3784</span> </div>
<div class="line"><span class="lineno"> 3785</span>    <span class="comment">/* Set minimum values... */</span></div>
<div class="line"><span class="lineno"> 3786</span>    sig_u = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(sig_u, 0.25);</div>
<div class="line"><span class="lineno"> 3787</span>    sig_w = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(sig_w, 0.1);</div>
<div class="line"><span class="lineno"> 3788</span>    tau_u = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(tau_u, 300.);</div>
<div class="line"><span class="lineno"> 3789</span>    tau_w = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(tau_w, 100.);</div>
<div class="line"><span class="lineno"> 3790</span> </div>
<div class="line"><span class="lineno"> 3791</span>    <span class="comment">/* Update perturbations... */</span></div>
<div class="line"><span class="lineno"> 3792</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> ru = exp(-fabs(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip]) / tau_u);</div>
<div class="line"><span class="lineno"> 3793</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> ru2 = sqrt(1.0 - <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(ru));</div>
<div class="line"><span class="lineno"> 3794</span>    cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][0]</div>
<div class="line"><span class="lineno"> 3795</span>      = (float) (cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][0] * ru + ru2 * cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>[3 * ip]);</div>
<div class="line"><span class="lineno"> 3796</span>    cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][1]</div>
<div class="line"><span class="lineno"> 3797</span>      = (float) (cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][1] * ru + ru2 * cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>[3 * ip + 1]);</div>
<div class="line"><span class="lineno"> 3798</span> </div>
<div class="line"><span class="lineno"> 3799</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> rw = exp(-fabs(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip]) / tau_w);</div>
<div class="line"><span class="lineno"> 3800</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> rw2 = sqrt(1.0 - <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(rw));</div>
<div class="line"><span class="lineno"> 3801</span>    cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][2]</div>
<div class="line"><span class="lineno"> 3802</span>      = (float) (cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][2] * rw + rw2 * cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>[3 * ip + 2]</div>
<div class="line"><span class="lineno"> 3803</span>                 + sig_w * dsigw_dz * cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip]);   <span class="comment">// TODO: check approx for density correction?</span></div>
<div class="line"><span class="lineno"> 3804</span> </div>
<div class="line"><span class="lineno"> 3805</span>    <span class="comment">/* Calculate new air parcel position... */</span></div>
<div class="line"><span class="lineno"> 3806</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] +=</div>
<div class="line"><span class="lineno"> 3807</span>      <a class="code hl_define" href="mptrac_8h.html#a6b22b78dc1239748a44cbd2db4862ef4">DX2DEG</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][0] * cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] / 1000., atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]);</div>
<div class="line"><span class="lineno"> 3808</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] += <a class="code hl_define" href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">DY2DEG</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][1] * cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] / 1000.);</div>
<div class="line"><span class="lineno"> 3809</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] +=</div>
<div class="line"><span class="lineno"> 3810</span>      <a class="code hl_define" href="mptrac_8h.html#a8d7cc5a9d3263cea4b432e83ab58c286">DZ2DP</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#aaa7f03cf8194b0babb1d9c14dcabc84e">uvwp</a>[ip][2] * cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] / 1000., atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]);</div>
<div class="line"><span class="lineno"> 3811</span>  }</div>
<div class="line"><span class="lineno"> 3812</span>}</div>
<div class="ttc" id="amptrac_8h_html_a3566596468c1f46bc90ad143b5c9e203"><div class="ttname"><a href="mptrac_8h.html#a3566596468c1f46bc90ad143b5c9e203">KARMAN</a></div><div class="ttdeci">#define KARMAN</div><div class="ttdoc">Karman's constant.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00229">mptrac.h:229</a></div></div>
<div class="ttc" id="amptrac_8h_html_a8cbdab681e71d411200fb104480f4862"><div class="ttname"><a href="mptrac_8h.html#a8cbdab681e71d411200fb104480f4862">THETAVIRT</a></div><div class="ttdeci">#define THETAVIRT(p, t, h2o)</div><div class="ttdoc">Compute virtual potential temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01812">mptrac.h:1812</a></div></div>
<div class="ttc" id="amptrac_8h_html_a8d7cc5a9d3263cea4b432e83ab58c286"><div class="ttname"><a href="mptrac_8h.html#a8d7cc5a9d3263cea4b432e83ab58c286">DZ2DP</a></div><div class="ttdeci">#define DZ2DP(dz, p)</div><div class="ttdoc">Convert a change in altitude to a change in pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00651">mptrac.h:651</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_ae102581d80f5817f4c5ef356bde43184_cgraph.png" border="0" usemap="#amptrac_8h_ae102581d80f5817f4c5ef356bde43184_cgraph" alt=""/></div>
<map name="amptrac_8h_ae102581d80f5817f4c5ef356bde43184_cgraph" id="amptrac_8h_ae102581d80f5817f4c5ef356bde43184_cgraph">
<area shape="rect" title="Computes particle diffusion within the planetary boundary layer (PBL)." alt="" coords="5,5,117,32"/>
<area shape="rect" href="mptrac_8c.html#aab313e4929e7379aca2aee1ee36873d9" title="Generate random numbers using various methods and distributions." alt="" coords="165,5,255,32"/>
</map>
</div>

</div>
</div>
<a id="ad3e7ae644cd3068669c3f7c7669f4a02" name="ad3e7ae644cd3068669c3f7c7669f4a02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3e7ae644cd3068669c3f7c7669f4a02">&#9670;&nbsp;</a></span>module_diff_turb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_diff_turb </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies turbulent diffusion processes to atmospheric particles. </p>
<p >This function calculates and applies turbulent diffusion effects, including horizontal and vertical diffusion, as well as vertical mixing in the planetary boundary layer (PBL), to a set of atmospheric particles based on input parameters and environmental conditions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clim</td><td>Pointer to the climate structure containing climatological data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">met0</td><td>Pointer to the meteorological data structure for the initial timestep. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">met1</td><td>Pointer to the meteorological data structure for the next timestep. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atm</td><td>Pointer to the atmospheric structure containing particle data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following operations:</p><ul>
<li>Allocates temporary arrays for random number generation.</li>
<li>Generates random numbers for simulating diffusion effects.</li>
<li>Loops over atmospheric particles to compute and apply:<ul>
<li>Horizontal turbulent diffusion, based on prescribed diffusivity values.</li>
<li>Vertical turbulent diffusion, using vertical diffusivity values.</li>
</ul>
</li>
<li>Cleans up allocated resources after processing.</li>
</ul>
<p >Turbulent diffusivity parameters are derived from control inputs and weighted based on atmospheric layer influences (PBL, troposphere, stratosphere).</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Control parameters <code>TURB_DX_PBL</code>, <code>TURB_DX_TROP</code>, <code>TURB_DX_STRAT</code>, <code>TURB_DZ_TROP</code> and <code>TURB_DZ_PBL</code>, <code>TURB_DZ_TROP</code>, <code>TURB_DZ_STRAT</code> define horizontal and vertical diffusivities (in units of m**2 s**-1) in the PBL, troposphere, and stratosphere, respectively. The control parameter <code>DIFF_MIX_PBL</code> is used to switch vertical mixing in the PBL on or off.</li>
<li>Apply the following settings to reproduce Stohl et al. (2005): TURB_DX_PBL = 50 TURB_DX_TROP = 50 TURB_DX_STRAT = 0 TURB_DX_PBL = 0 TURB_DX_TROP = 0 TURB_DX_STRAT = 0.1 TURB_MESOX = 0.16 TURB_MESOZ = 0.16 DIFF_MIX_PBL = 0</li>
<li>Apply the following setting to reproduce Maryon et al. (1991) and Ryall et al. (1998): TURB_DX_PBL = 5300 TURB_DX_TROP = 1325 TURB_DX_STRAT = 1325 TURB_DX_PBL = 0 TURB_DX_TROP = 1.5 TURB_DX_STRAT = 1.5 TURB_MESOX = 0 TURB_MESOZ = 0 DIFF_MIX_PBL = 1</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l03816">3816</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3822</span>              {</div>
<div class="line"><span class="lineno"> 3823</span> </div>
<div class="line"><span class="lineno"> 3824</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 3825</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_DIFF_TURB&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3826</span> </div>
<div class="line"><span class="lineno"> 3827</span>  <span class="comment">/* Create random numbers... */</span></div>
<div class="line"><span class="lineno"> 3828</span>  <a class="code hl_function" href="mptrac_8c.html#aab313e4929e7379aca2aee1ee36873d9">module_rng</a>(ctl, cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>, 3 * (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1);</div>
<div class="line"><span class="lineno"> 3829</span> </div>
<div class="line"><span class="lineno"> 3830</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 3831</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1,</div>
<div class="line"><span class="lineno"> 3832</span>                <span class="stringliteral">&quot;acc data present(ctl,cache,clim,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 3833</span> </div>
<div class="line"><span class="lineno"> 3834</span>    <span class="comment">/* Get PBL and surface pressure... */</span></div>
<div class="line"><span class="lineno"> 3835</span>    <span class="keywordtype">double</span> pbl, ps;</div>
<div class="line"><span class="lineno"> 3836</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 3837</span>    <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(pbl, 1);</div>
<div class="line"><span class="lineno"> 3838</span>    <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(ps, 0);</div>
<div class="line"><span class="lineno"> 3839</span> </div>
<div class="line"><span class="lineno"> 3840</span>    <span class="comment">/* Get weighting factors... */</span></div>
<div class="line"><span class="lineno"> 3841</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> wpbl = <a class="code hl_function" href="mptrac_8c.html#ae0ce53cb5230060c17ee4766ca910e79">pbl_weight</a>(ctl, atm, ip, pbl, ps);</div>
<div class="line"><span class="lineno"> 3842</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> wtrop = <a class="code hl_function" href="mptrac_8c.html#a90bdbbffe8b8633d84a48d2ddd311180">tropo_weight</a>(clim, atm, ip) * (1.0 - wpbl);</div>
<div class="line"><span class="lineno"> 3843</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> wstrat = 1.0 - wpbl - wtrop;</div>
<div class="line"><span class="lineno"> 3844</span> </div>
<div class="line"><span class="lineno"> 3845</span>    <span class="comment">/* Set diffusivity... */</span></div>
<div class="line"><span class="lineno"> 3846</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dx = wpbl * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad5a979592dd8c284d07bb25698339f04">turb_dx_pbl</a> + wtrop * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a37abd3e7cbc687a515ba1bbac5ec77f2">turb_dx_trop</a></div>
<div class="line"><span class="lineno"> 3847</span>      + wstrat * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3173408e0e9c39c17c39367aee1c5641">turb_dx_strat</a>;</div>
<div class="line"><span class="lineno"> 3848</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dz = wpbl * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af7af2185257f30f792f903af3fcbc041">turb_dz_pbl</a> + wtrop * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a21f2e759e0c5d8cfae2ba9ed551c768e">turb_dz_trop</a></div>
<div class="line"><span class="lineno"> 3849</span>      + wstrat * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae797044bfedbdf7e058c6fb02195e586">turb_dz_strat</a>;</div>
<div class="line"><span class="lineno"> 3850</span> </div>
<div class="line"><span class="lineno"> 3851</span>    <span class="comment">/* Horizontal turbulent diffusion... */</span></div>
<div class="line"><span class="lineno"> 3852</span>    <span class="keywordflow">if</span> (dx &gt; 0) {</div>
<div class="line"><span class="lineno"> 3853</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> sigma = sqrt(2.0 * dx * fabs(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip])) / 1000.;</div>
<div class="line"><span class="lineno"> 3854</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] += <a class="code hl_define" href="mptrac_8h.html#a6b22b78dc1239748a44cbd2db4862ef4">DX2DEG</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>[3 * ip] * sigma, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]);</div>
<div class="line"><span class="lineno"> 3855</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] += <a class="code hl_define" href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">DY2DEG</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>[3 * ip + 1] * sigma);</div>
<div class="line"><span class="lineno"> 3856</span>    }</div>
<div class="line"><span class="lineno"> 3857</span> </div>
<div class="line"><span class="lineno"> 3858</span>    <span class="comment">/* Vertical turbulent diffusion... */</span></div>
<div class="line"><span class="lineno"> 3859</span>    <span class="keywordflow">if</span> (dz &gt; 0) {</div>
<div class="line"><span class="lineno"> 3860</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> sigma = sqrt(2.0 * dz * fabs(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip])) / 1000.;</div>
<div class="line"><span class="lineno"> 3861</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] += <a class="code hl_define" href="mptrac_8h.html#a8d7cc5a9d3263cea4b432e83ab58c286">DZ2DP</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#aa35b7fdf9768493f676a4e24ad78e4d9">rs</a>[3 * ip + 2] * sigma, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]);</div>
<div class="line"><span class="lineno"> 3862</span>    }</div>
<div class="line"><span class="lineno"> 3863</span>  }</div>
<div class="line"><span class="lineno"> 3864</span>}</div>
<div class="ttc" id="amptrac_8c_html_ae0ce53cb5230060c17ee4766ca910e79"><div class="ttname"><a href="mptrac_8c.html#ae0ce53cb5230060c17ee4766ca910e79">pbl_weight</a></div><div class="ttdeci">double pbl_weight(const ctl_t *ctl, const atm_t *atm, const int ip, const double pbl, const double ps)</div><div class="ttdoc">Computes a weighting factor based on planetary boundary layer pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l06997">mptrac.c:6997</a></div></div>
<div class="ttc" id="astructctl__t_html_a21f2e759e0c5d8cfae2ba9ed551c768e"><div class="ttname"><a href="structctl__t.html#a21f2e759e0c5d8cfae2ba9ed551c768e">ctl_t::turb_dz_trop</a></div><div class="ttdeci">double turb_dz_trop</div><div class="ttdoc">Vertical turbulent diffusion coefficient (troposphere) [m^2/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02670">mptrac.h:2670</a></div></div>
<div class="ttc" id="astructctl__t_html_a3173408e0e9c39c17c39367aee1c5641"><div class="ttname"><a href="structctl__t.html#a3173408e0e9c39c17c39367aee1c5641">ctl_t::turb_dx_strat</a></div><div class="ttdeci">double turb_dx_strat</div><div class="ttdoc">Horizontal turbulent diffusion coefficient (stratosphere) [m^2/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02664">mptrac.h:2664</a></div></div>
<div class="ttc" id="astructctl__t_html_a37abd3e7cbc687a515ba1bbac5ec77f2"><div class="ttname"><a href="structctl__t.html#a37abd3e7cbc687a515ba1bbac5ec77f2">ctl_t::turb_dx_trop</a></div><div class="ttdeci">double turb_dx_trop</div><div class="ttdoc">Horizontal turbulent diffusion coefficient (troposphere) [m^2/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02661">mptrac.h:2661</a></div></div>
<div class="ttc" id="astructctl__t_html_ad5a979592dd8c284d07bb25698339f04"><div class="ttname"><a href="structctl__t.html#ad5a979592dd8c284d07bb25698339f04">ctl_t::turb_dx_pbl</a></div><div class="ttdeci">double turb_dx_pbl</div><div class="ttdoc">Horizontal turbulent diffusion coefficient (PBL) [m^2/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02658">mptrac.h:2658</a></div></div>
<div class="ttc" id="astructctl__t_html_ae797044bfedbdf7e058c6fb02195e586"><div class="ttname"><a href="structctl__t.html#ae797044bfedbdf7e058c6fb02195e586">ctl_t::turb_dz_strat</a></div><div class="ttdeci">double turb_dz_strat</div><div class="ttdoc">Vertical turbulent diffusion coefficient (stratosphere) [m^2/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02673">mptrac.h:2673</a></div></div>
<div class="ttc" id="astructctl__t_html_af7af2185257f30f792f903af3fcbc041"><div class="ttname"><a href="structctl__t.html#af7af2185257f30f792f903af3fcbc041">ctl_t::turb_dz_pbl</a></div><div class="ttdeci">double turb_dz_pbl</div><div class="ttdoc">Vertical turbulent diffusion coefficient (PBL) [m^2/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02667">mptrac.h:2667</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_ad3e7ae644cd3068669c3f7c7669f4a02_cgraph.png" border="0" usemap="#amptrac_8h_ad3e7ae644cd3068669c3f7c7669f4a02_cgraph" alt=""/></div>
<map name="amptrac_8h_ad3e7ae644cd3068669c3f7c7669f4a02_cgraph" id="amptrac_8h_ad3e7ae644cd3068669c3f7c7669f4a02_cgraph">
<area shape="rect" title="Applies turbulent diffusion processes to atmospheric particles." alt="" coords="5,56,123,83"/>
<area shape="rect" href="mptrac_8c.html#aab313e4929e7379aca2aee1ee36873d9" title="Generate random numbers using various methods and distributions." alt="" coords="174,5,263,32"/>
<area shape="rect" href="mptrac_8c.html#ae0ce53cb5230060c17ee4766ca910e79" title="Computes a weighting factor based on planetary boundary layer pressure." alt="" coords="177,56,261,83"/>
<area shape="rect" href="mptrac_8c.html#a90bdbbffe8b8633d84a48d2ddd311180" title="Computes a weighting factor based on tropopause pressure." alt="" coords="171,107,267,133"/>
<area shape="rect" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692" title="Calculates the tropopause pressure based on climatological data." alt="" coords="315,107,397,133"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="449,81,524,108"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="445,132,528,159"/>
</map>
</div>

</div>
</div>
<a id="af237449d9c3c8fec9e5f062cdc579105" name="af237449d9c3c8fec9e5f062cdc579105"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af237449d9c3c8fec9e5f062cdc579105">&#9670;&nbsp;</a></span>module_dry_depo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_dry_depo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulate dry deposition of atmospheric particles. </p>
<p >This function simulates the dry deposition of atmospheric particles, including both particulate matter and gases. It calculates the sedimentation velocity for particles based on the atmospheric properties and applies it to determine the loss of mass or volume mixing ratio due to deposition. The function loops over each particle and calculates the loss of mass or volume mixing ratio based on the deposition velocity and time step.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data structure at the current time step. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the meteorological data structure at the next time step. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l03868">3868</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3873</span>              {</div>
<div class="line"><span class="lineno"> 3874</span> </div>
<div class="line"><span class="lineno"> 3875</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 3876</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_DRY_DEPO&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3877</span> </div>
<div class="line"><span class="lineno"> 3878</span>  <span class="comment">/* Check quantity flags... */</span></div>
<div class="line"><span class="lineno"> 3879</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &lt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 3880</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Module needs quantity mass or volume mixing ratio!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3881</span> </div>
<div class="line"><span class="lineno"> 3882</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 3883</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(ctl,cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 3884</span> </div>
<div class="line"><span class="lineno"> 3885</span>    <span class="comment">/* Get surface pressure... */</span></div>
<div class="line"><span class="lineno"> 3886</span>    <span class="keywordtype">double</span> ps;</div>
<div class="line"><span class="lineno"> 3887</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 3888</span>    <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(ps, 1);</div>
<div class="line"><span class="lineno"> 3889</span> </div>
<div class="line"><span class="lineno"> 3890</span>    <span class="comment">/* Check whether particle is above the surface layer... */</span></div>
<div class="line"><span class="lineno"> 3891</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &lt; ps - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a60da7ce4a7b610712585fde03773bf7f">dry_depo_dp</a>)</div>
<div class="line"><span class="lineno"> 3892</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3893</span> </div>
<div class="line"><span class="lineno"> 3894</span>    <span class="comment">/* Set depth of surface layer... */</span></div>
<div class="line"><span class="lineno"> 3895</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dz = 1000. * (<a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(ps - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a60da7ce4a7b610712585fde03773bf7f">dry_depo_dp</a>) - <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(ps));</div>
<div class="line"><span class="lineno"> 3896</span> </div>
<div class="line"><span class="lineno"> 3897</span>    <span class="comment">/* Calculate sedimentation velocity for particles... */</span></div>
<div class="line"><span class="lineno"> 3898</span>    <span class="keywordtype">double</span> v_dep;</div>
<div class="line"><span class="lineno"> 3899</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54a37ca01ed5643d41ee63768e5ad941">qnt_rp</a> &gt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a08ad320f9953658f5346a123ba03ad86">qnt_rhop</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 3900</span> </div>
<div class="line"><span class="lineno"> 3901</span>      <span class="comment">/* Get temperature... */</span></div>
<div class="line"><span class="lineno"> 3902</span>      <span class="keywordtype">double</span> t;</div>
<div class="line"><span class="lineno"> 3903</span>      <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 1);</div>
<div class="line"><span class="lineno"> 3904</span> </div>
<div class="line"><span class="lineno"> 3905</span>      <span class="comment">/* Set deposition velocity... */</span></div>
<div class="line"><span class="lineno"> 3906</span>      v_dep = <a class="code hl_function" href="mptrac_8c.html#a1b580107362b559d90f6766d340cc370">sedi</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54a37ca01ed5643d41ee63768e5ad941">qnt_rp</a>][ip],</div>
<div class="line"><span class="lineno"> 3907</span>                   atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a08ad320f9953658f5346a123ba03ad86">qnt_rhop</a>][ip]);</div>
<div class="line"><span class="lineno"> 3908</span>    }</div>
<div class="line"><span class="lineno"> 3909</span> </div>
<div class="line"><span class="lineno"> 3910</span>    <span class="comment">/* Use explicit sedimentation velocity for gases... */</span></div>
<div class="line"><span class="lineno"> 3911</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3912</span>      v_dep = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acadcfbb95971c47b377fbd4443c68723">dry_depo_vdep</a>;</div>
<div class="line"><span class="lineno"> 3913</span> </div>
<div class="line"><span class="lineno"> 3914</span>    <span class="comment">/* Calculate loss of mass based on deposition velocity... */</span></div>
<div class="line"><span class="lineno"> 3915</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux = exp(-cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * v_dep / dz);</div>
<div class="line"><span class="lineno"> 3916</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 3917</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7900d5f3a8de6333a91c3794599a8e46">qnt_mloss_dry</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3918</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7900d5f3a8de6333a91c3794599a8e46">qnt_mloss_dry</a>][ip]</div>
<div class="line"><span class="lineno"> 3919</span>          += atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip] * (1 - aux);</div>
<div class="line"><span class="lineno"> 3920</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip] *= aux;</div>
<div class="line"><span class="lineno"> 3921</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3922</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a>][ip] += v_dep / dz;</div>
<div class="line"><span class="lineno"> 3923</span>    }</div>
<div class="line"><span class="lineno"> 3924</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3925</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a>][ip] *= aux;</div>
<div class="line"><span class="lineno"> 3926</span>  }</div>
<div class="line"><span class="lineno"> 3927</span>}</div>
<div class="ttc" id="amptrac_8c_html_a1b580107362b559d90f6766d340cc370"><div class="ttname"><a href="mptrac_8c.html#a1b580107362b559d90f6766d340cc370">sedi</a></div><div class="ttdeci">double sedi(const double p, const double T, const double rp, const double rhop)</div><div class="ttdoc">Calculates the sedimentation velocity of a particle in air.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11023">mptrac.c:11023</a></div></div>
<div class="ttc" id="astructctl__t_html_a08ad320f9953658f5346a123ba03ad86"><div class="ttname"><a href="structctl__t.html#a08ad320f9953658f5346a123ba03ad86">ctl_t::qnt_rhop</a></div><div class="ttdeci">int qnt_rhop</div><div class="ttdoc">Quantity array index for particle density.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02171">mptrac.h:2171</a></div></div>
<div class="ttc" id="astructctl__t_html_a54a37ca01ed5643d41ee63768e5ad941"><div class="ttname"><a href="structctl__t.html#a54a37ca01ed5643d41ee63768e5ad941">ctl_t::qnt_rp</a></div><div class="ttdeci">int qnt_rp</div><div class="ttdoc">Quantity array index for particle radius.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02168">mptrac.h:2168</a></div></div>
<div class="ttc" id="astructctl__t_html_a60da7ce4a7b610712585fde03773bf7f"><div class="ttname"><a href="structctl__t.html#a60da7ce4a7b610712585fde03773bf7f">ctl_t::dry_depo_dp</a></div><div class="ttdeci">double dry_depo_dp</div><div class="ttdoc">Dry deposition surface layer [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02895">mptrac.h:2895</a></div></div>
<div class="ttc" id="astructctl__t_html_a7900d5f3a8de6333a91c3794599a8e46"><div class="ttname"><a href="structctl__t.html#a7900d5f3a8de6333a91c3794599a8e46">ctl_t::qnt_mloss_dry</a></div><div class="ttdeci">int qnt_mloss_dry</div><div class="ttdoc">Quantity array index for total mass loss due to dry deposition.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02315">mptrac.h:2315</a></div></div>
<div class="ttc" id="astructctl__t_html_acadcfbb95971c47b377fbd4443c68723"><div class="ttname"><a href="structctl__t.html#acadcfbb95971c47b377fbd4443c68723">ctl_t::dry_depo_vdep</a></div><div class="ttdeci">double dry_depo_vdep</div><div class="ttdoc">Dry deposition velocity [m/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02898">mptrac.h:2898</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_af237449d9c3c8fec9e5f062cdc579105_cgraph.png" border="0" usemap="#amptrac_8h_af237449d9c3c8fec9e5f062cdc579105_cgraph" alt=""/></div>
<map name="amptrac_8h_af237449d9c3c8fec9e5f062cdc579105_cgraph" id="amptrac_8h_af237449d9c3c8fec9e5f062cdc579105_cgraph">
<area shape="rect" title="Simulate dry deposition of atmospheric particles." alt="" coords="5,5,128,32"/>
<area shape="rect" href="mptrac_8c.html#a1b580107362b559d90f6766d340cc370" title="Calculates the sedimentation velocity of a particle in air." alt="" coords="176,5,223,32"/>
</map>
</div>

</div>
</div>
<a id="adeecfbf32977d527d934a778edd84f38" name="adeecfbf32977d527d934a778edd84f38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeecfbf32977d527d934a778edd84f38">&#9670;&nbsp;</a></span>module_h2o2_chem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_h2o2_chem </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform chemical reactions involving H2O2 within cloud particles. </p>
<p >This function simulates chemical reactions involving hydrogen peroxide (H2O2) within cloud particles. It calculates the change in H2O2 concentration over time due to chemical reactions. The reaction rates are determined based on temperature and cloud properties such as liquid water content.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climatological data structure. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the first meteorological data structure. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the second meteorological data structure. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the necessary control structure (ctl), climatological data structure (clim), meteorological data structures (met0, met1), and atmospheric data structure (atm) have been initialized and are accessible. </dd>
<dd>
Chemical reactions involving H2O2 are simulated for particles within clouds, as indicated by a positive liquid water content (LWC). </dd>
<dd>
The function calculates reaction rates based on temperature and cloud properties, including the liquid water content (LWC) and the concentration of SO2. </dd>
<dd>
The exponential decay of H2O2 concentration due to chemical reactions is calculated using the reaction rate coefficient and the time step (dt) for each particle. </dd>
<dd>
If the particle has a quantity flag for either mass (ctl-&gt;qnt_m) or volume mixing ratio (ctl-&gt;qnt_vmr), the function updates the quantity based on the exponential decay. </dd>
<dd>
If the particle has a loss rate quantity flag (ctl-&gt;qnt_loss_rate), the function accumulates the reaction rate coefficient to quantify the loss rate.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l03931">3931</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3937</span>              {</div>
<div class="line"><span class="lineno"> 3938</span> </div>
<div class="line"><span class="lineno"> 3939</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 3940</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_H2O2_CHEM&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 3941</span> </div>
<div class="line"><span class="lineno"> 3942</span>  <span class="comment">/* Check quantity flags... */</span></div>
<div class="line"><span class="lineno"> 3943</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &lt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 3944</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Module needs quantity mass or volume mixing ratio!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3945</span> </div>
<div class="line"><span class="lineno"> 3946</span>  <span class="comment">/* Parameter of SO2 correction... */</span></div>
<div class="line"><span class="lineno"> 3947</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> a = 3.12541941e-06;</div>
<div class="line"><span class="lineno"> 3948</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> b = -5.72532259e-01;</div>
<div class="line"><span class="lineno"> 3949</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> low = pow(1. / a, 1. / b);</div>
<div class="line"><span class="lineno"> 3950</span> </div>
<div class="line"><span class="lineno"> 3951</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 3952</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(ctl,cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 3953</span> </div>
<div class="line"><span class="lineno"> 3954</span>    <span class="comment">/* Check whether particle is inside cloud... */</span></div>
<div class="line"><span class="lineno"> 3955</span>    <span class="keywordtype">double</span> lwc, rwc;</div>
<div class="line"><span class="lineno"> 3956</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 3957</span>    <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(lwc, 1);</div>
<div class="line"><span class="lineno"> 3958</span>    <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(rwc, 0);</div>
<div class="line"><span class="lineno"> 3959</span>    <span class="keywordflow">if</span> (!(lwc &gt; 0 || rwc &gt; 0))</div>
<div class="line"><span class="lineno"> 3960</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3961</span> </div>
<div class="line"><span class="lineno"> 3962</span>    <span class="comment">/* Get temperature... */</span></div>
<div class="line"><span class="lineno"> 3963</span>    <span class="keywordtype">double</span> t;</div>
<div class="line"><span class="lineno"> 3964</span>    <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 0);</div>
<div class="line"><span class="lineno"> 3965</span> </div>
<div class="line"><span class="lineno"> 3966</span>    <span class="comment">/* Get molecular density... */</span></div>
<div class="line"><span class="lineno"> 3967</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> M = <a class="code hl_define" href="mptrac_8h.html#a241767dd865cc665eeee896fb598eb9f">MOLEC_DENS</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t);</div>
<div class="line"><span class="lineno"> 3968</span> </div>
<div class="line"><span class="lineno"> 3969</span>    <span class="comment">/* Reaction rate (Berglen et al., 2004)... */</span></div>
<div class="line"><span class="lineno"> 3970</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> k = 9.1e7 * exp(-29700. / <a class="code hl_define" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> * (1. / t - 1. / 298.15));        <span class="comment">/* (Maass, 1999), unit: M^(-2) */</span></div>
<div class="line"><span class="lineno"> 3971</span> </div>
<div class="line"><span class="lineno"> 3972</span>    <span class="comment">/* Henry constant of SO2... */</span></div>
<div class="line"><span class="lineno"> 3973</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> H_SO2 =</div>
<div class="line"><span class="lineno"> 3974</span>      1.3e-2 * exp(2900. * (1. / t - 1. / 298.15)) * <a class="code hl_define" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> * t;</div>
<div class="line"><span class="lineno"> 3975</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> K_1S = 1.23e-2 * exp(2.01e3 * (1. / t - 1. / 298.15)); <span class="comment">/* unit: mol/L */</span></div>
<div class="line"><span class="lineno"> 3976</span> </div>
<div class="line"><span class="lineno"> 3977</span>    <span class="comment">/* Henry constant of H2O2... */</span></div>
<div class="line"><span class="lineno"> 3978</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> H_h2o2 =</div>
<div class="line"><span class="lineno"> 3979</span>      8.3e2 * exp(7600. * (1. / t - 1. / 298.15)) * <a class="code hl_define" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> * t;</div>
<div class="line"><span class="lineno"> 3980</span> </div>
<div class="line"><span class="lineno"> 3981</span>    <span class="comment">/* Correction factor for high SO2 concentration</span></div>
<div class="line"><span class="lineno"> 3982</span><span class="comment">       (if qnt_Cx is defined, the correction is switched on)... */</span></div>
<div class="line"><span class="lineno"> 3983</span>    <span class="keywordtype">double</span> cor = 1.0;</div>
<div class="line"><span class="lineno"> 3984</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae56fa1a240420b87bd2b7a0d040e6d11">qnt_Cx</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 3985</span>      cor = atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae56fa1a240420b87bd2b7a0d040e6d11">qnt_Cx</a>][ip] &gt;</div>
<div class="line"><span class="lineno"> 3986</span>        low ? a * pow(atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae56fa1a240420b87bd2b7a0d040e6d11">qnt_Cx</a>][ip], b) : 1;</div>
<div class="line"><span class="lineno"> 3987</span> </div>
<div class="line"><span class="lineno"> 3988</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> h2o2 = H_h2o2</div>
<div class="line"><span class="lineno"> 3989</span>      * <a class="code hl_function" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#ab7f787719be51524b1389bb0bf347934">h2o2</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip])</div>
<div class="line"><span class="lineno"> 3990</span>      * M * cor * 1000. / <a class="code hl_define" href="mptrac_8h.html#a174754c04acfba9e1f66ba249e68643a">AVO</a>;  <span class="comment">/* unit: mol/L */</span></div>
<div class="line"><span class="lineno"> 3991</span> </div>
<div class="line"><span class="lineno"> 3992</span>    <span class="comment">/* Volume water content in cloud [m^3 m^(-3)]... */</span></div>
<div class="line"><span class="lineno"> 3993</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> rho_air = atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] / (<a class="code hl_define" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> * t) * <a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a> / 10.;</div>
<div class="line"><span class="lineno"> 3994</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> CWC = (lwc + rwc) * rho_air / 1e3;</div>
<div class="line"><span class="lineno"> 3995</span> </div>
<div class="line"><span class="lineno"> 3996</span>    <span class="comment">/* Calculate exponential decay (Rolph et al., 1992)... */</span></div>
<div class="line"><span class="lineno"> 3997</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> rate_coef = k * K_1S * h2o2 * H_SO2 * CWC;</div>
<div class="line"><span class="lineno"> 3998</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux = exp(-cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * rate_coef);</div>
<div class="line"><span class="lineno"> 3999</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 4000</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad1397317442e511e037568026f964bf0">qnt_mloss_h2o2</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 4001</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad1397317442e511e037568026f964bf0">qnt_mloss_h2o2</a>][ip] += atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip] * (1 - aux);</div>
<div class="line"><span class="lineno"> 4002</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip] *= aux;</div>
<div class="line"><span class="lineno"> 4003</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 4004</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a>][ip] += rate_coef;</div>
<div class="line"><span class="lineno"> 4005</span>    }</div>
<div class="line"><span class="lineno"> 4006</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 4007</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a>][ip] *= aux;</div>
<div class="line"><span class="lineno"> 4008</span>  }</div>
<div class="line"><span class="lineno"> 4009</span>}</div>
<div class="ttc" id="amptrac_8h_html_a174754c04acfba9e1f66ba249e68643a"><div class="ttname"><a href="mptrac_8h.html#a174754c04acfba9e1f66ba249e68643a">AVO</a></div><div class="ttdeci">#define AVO</div><div class="ttdoc">Avogadro constant [1/mol].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00199">mptrac.h:199</a></div></div>
<div class="ttc" id="amptrac_8h_html_a241767dd865cc665eeee896fb598eb9f"><div class="ttname"><a href="mptrac_8h.html#a241767dd865cc665eeee896fb598eb9f">MOLEC_DENS</a></div><div class="ttdeci">#define MOLEC_DENS(p, t)</div><div class="ttdoc">Calculate the density of a gas molecule.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01153">mptrac.h:1153</a></div></div>
<div class="ttc" id="astructctl__t_html_ad1397317442e511e037568026f964bf0"><div class="ttname"><a href="structctl__t.html#ad1397317442e511e037568026f964bf0">ctl_t::qnt_mloss_h2o2</a></div><div class="ttdeci">int qnt_mloss_h2o2</div><div class="ttdoc">Quantity array index for total mass loss due to H2O2 chemistry.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02306">mptrac.h:2306</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_adeecfbf32977d527d934a778edd84f38_cgraph.png" border="0" usemap="#amptrac_8h_adeecfbf32977d527d934a778edd84f38_cgraph" alt=""/></div>
<map name="amptrac_8h_adeecfbf32977d527d934a778edd84f38_cgraph" id="amptrac_8h_adeecfbf32977d527d934a778edd84f38_cgraph">
<area shape="rect" title="Perform chemical reactions involving H2O2 within cloud particles." alt="" coords="5,31,144,57"/>
<area shape="rect" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a" title="Interpolates monthly mean zonal mean climatological variables." alt="" coords="192,31,263,57"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="315,5,389,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="311,56,393,83"/>
</map>
</div>

</div>
</div>
<a id="a51093927ceae5630067278cee548797f" name="a51093927ceae5630067278cee548797f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51093927ceae5630067278cee548797f">&#9670;&nbsp;</a></span>module_isosurf_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_isosurf_init </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the isosurface module based on atmospheric data. </p>
<p >This function initializes the isosurface module based on the atmospheric data provided. It calculates the necessary variables required for generating the isosurface, such as pressure, density, or potential temperature. Additionally, it can read balloon pressure data from a file if specified in the control structure. The initialized data is stored in the cache for later use.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data structure at the current time step. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the meteorological data structure at the next time step. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for storing initialized data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04013">4013</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4018</span>              {</div>
<div class="line"><span class="lineno"> 4019</span> </div>
<div class="line"><span class="lineno"> 4020</span>  <span class="keywordtype">double</span> t;</div>
<div class="line"><span class="lineno"> 4021</span> </div>
<div class="line"><span class="lineno"> 4022</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 4023</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_ISOSURF_INIT&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 4024</span> </div>
<div class="line"><span class="lineno"> 4025</span>  <span class="comment">/* Save pressure... */</span></div>
<div class="line"><span class="lineno"> 4026</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> == 1) {</div>
<div class="line"><span class="lineno"> 4027</span>    <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 0, <span class="stringliteral">&quot;acc data present(cache,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 4028</span>      cache-&gt;<a class="code hl_variable" href="structcache__t.html#ac3b83913cce35ef5ec582c54dce239d0">iso_var</a>[ip] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip];</div>
<div class="line"><span class="lineno"> 4029</span>    }</div>
<div class="line"><span class="lineno"> 4030</span>  }</div>
<div class="line"><span class="lineno"> 4031</span> </div>
<div class="line"><span class="lineno"> 4032</span>  <span class="comment">/* Save density... */</span></div>
<div class="line"><span class="lineno"> 4033</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> == 2) {</div>
<div class="line"><span class="lineno"> 4034</span>    <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 0, <span class="stringliteral">&quot;acc data present(cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 4035</span>      <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 4036</span>      <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 1);</div>
<div class="line"><span class="lineno"> 4037</span>      cache-&gt;<a class="code hl_variable" href="structcache__t.html#ac3b83913cce35ef5ec582c54dce239d0">iso_var</a>[ip] = atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] / t;</div>
<div class="line"><span class="lineno"> 4038</span>    }</div>
<div class="line"><span class="lineno"> 4039</span>  }</div>
<div class="line"><span class="lineno"> 4040</span> </div>
<div class="line"><span class="lineno"> 4041</span>  <span class="comment">/* Save potential temperature... */</span></div>
<div class="line"><span class="lineno"> 4042</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> == 3) {</div>
<div class="line"><span class="lineno"> 4043</span>    <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 0, <span class="stringliteral">&quot;acc data present(cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 4044</span>      <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 4045</span>      <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 1);</div>
<div class="line"><span class="lineno"> 4046</span>      cache-&gt;<a class="code hl_variable" href="structcache__t.html#ac3b83913cce35ef5ec582c54dce239d0">iso_var</a>[ip] = <a class="code hl_define" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t);</div>
<div class="line"><span class="lineno"> 4047</span>    }</div>
<div class="line"><span class="lineno"> 4048</span>  }</div>
<div class="line"><span class="lineno"> 4049</span> </div>
<div class="line"><span class="lineno"> 4050</span>  <span class="comment">/* Read balloon pressure data... */</span></div>
<div class="line"><span class="lineno"> 4051</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> == 4) {</div>
<div class="line"><span class="lineno"> 4052</span> </div>
<div class="line"><span class="lineno"> 4053</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 4054</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read balloon pressure data: %s&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1aee054abc8c3fbaa1f6828f78f4e2f5">balloon</a>);</div>
<div class="line"><span class="lineno"> 4055</span> </div>
<div class="line"><span class="lineno"> 4056</span>    <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 4057</span>    FILE *in;</div>
<div class="line"><span class="lineno"> 4058</span>    <span class="keywordflow">if</span> (!(in = fopen(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1aee054abc8c3fbaa1f6828f78f4e2f5">balloon</a>, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno"> 4059</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4060</span> </div>
<div class="line"><span class="lineno"> 4061</span>    <span class="comment">/* Read pressure time series... */</span></div>
<div class="line"><span class="lineno"> 4062</span>    <span class="keywordtype">char</span> line[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 4063</span>    <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in))</div>
<div class="line"><span class="lineno"> 4064</span>      <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%lg %lg&quot;</span>, &amp;(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4039e32188d12d6a86086d236676d993">iso_ts</a>[cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4df585fc5eb4099f8cd54d77703ebf45">iso_n</a>]),</div>
<div class="line"><span class="lineno"> 4065</span>                 &amp;(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a8ce0e8a193211fc8461b2043daf9b17c">iso_ps</a>[cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4df585fc5eb4099f8cd54d77703ebf45">iso_n</a>])) == 2)</div>
<div class="line"><span class="lineno"> 4066</span>        <span class="keywordflow">if</span> ((++cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4df585fc5eb4099f8cd54d77703ebf45">iso_n</a>) &gt; <a class="code hl_define" href="mptrac_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a>)</div>
<div class="line"><span class="lineno"> 4067</span>          <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many data points!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4068</span> </div>
<div class="line"><span class="lineno"> 4069</span>    <span class="comment">/* Check number of points... */</span></div>
<div class="line"><span class="lineno"> 4070</span>    <span class="keywordflow">if</span> (cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4df585fc5eb4099f8cd54d77703ebf45">iso_n</a> &lt; 1)</div>
<div class="line"><span class="lineno"> 4071</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Could not read any data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4072</span> </div>
<div class="line"><span class="lineno"> 4073</span>    <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 4074</span>    fclose(in);</div>
<div class="line"><span class="lineno"> 4075</span> </div>
<div class="line"><span class="lineno"> 4076</span>    <span class="comment">/* Update of cache data on device... */</span></div>
<div class="line"><span class="lineno"> 4077</span>    <a class="code hl_function" href="mptrac_8c.html#a55562b13a38a124b0abc09ce8511dde9">mptrac_update_device</a>(NULL, cache, NULL, NULL, NULL, NULL);</div>
<div class="line"><span class="lineno"> 4078</span>  }</div>
<div class="line"><span class="lineno"> 4079</span>}</div>
<div class="ttc" id="amptrac_8c_html_a55562b13a38a124b0abc09ce8511dde9"><div class="ttname"><a href="mptrac_8c.html#a55562b13a38a124b0abc09ce8511dde9">mptrac_update_device</a></div><div class="ttdeci">void mptrac_update_device(const ctl_t *ctl, const cache_t *cache, const clim_t *clim, met_t **met0, met_t **met1, const atm_t *atm)</div><div class="ttdoc">Updates device memory for specified data structures.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l06666">mptrac.c:6666</a></div></div>
<div class="ttc" id="amptrac_8h_html_ab04c88bedc6b2be8ddfe7aa8d3e93f06"><div class="ttname"><a href="mptrac_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a></div><div class="ttdeci">#define NP</div><div class="ttdoc">Maximum number of atmospheric data points.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00308">mptrac.h:308</a></div></div>
<div class="ttc" id="astructcache__t_html_a4039e32188d12d6a86086d236676d993"><div class="ttname"><a href="structcache__t.html#a4039e32188d12d6a86086d236676d993">cache_t::iso_ts</a></div><div class="ttdeci">double iso_ts[NP]</div><div class="ttdoc">Isosurface balloon time [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03228">mptrac.h:3228</a></div></div>
<div class="ttc" id="astructcache__t_html_a4df585fc5eb4099f8cd54d77703ebf45"><div class="ttname"><a href="structcache__t.html#a4df585fc5eb4099f8cd54d77703ebf45">cache_t::iso_n</a></div><div class="ttdeci">int iso_n</div><div class="ttdoc">Isosurface balloon number of data points.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03231">mptrac.h:3231</a></div></div>
<div class="ttc" id="astructcache__t_html_a8ce0e8a193211fc8461b2043daf9b17c"><div class="ttname"><a href="structcache__t.html#a8ce0e8a193211fc8461b2043daf9b17c">cache_t::iso_ps</a></div><div class="ttdeci">double iso_ps[NP]</div><div class="ttdoc">Isosurface balloon pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03225">mptrac.h:3225</a></div></div>
<div class="ttc" id="astructcache__t_html_ac3b83913cce35ef5ec582c54dce239d0"><div class="ttname"><a href="structcache__t.html#ac3b83913cce35ef5ec582c54dce239d0">cache_t::iso_var</a></div><div class="ttdeci">double iso_var[NP]</div><div class="ttdoc">Isosurface variables.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03222">mptrac.h:3222</a></div></div>
<div class="ttc" id="astructctl__t_html_a1aee054abc8c3fbaa1f6828f78f4e2f5"><div class="ttname"><a href="structctl__t.html#a1aee054abc8c3fbaa1f6828f78f4e2f5">ctl_t::balloon</a></div><div class="ttdeci">char balloon[LEN]</div><div class="ttdoc">Balloon position filename.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02642">mptrac.h:2642</a></div></div>
<div class="ttc" id="astructctl__t_html_a4438b70bfa3ff0fe6cc36f3d0086e301"><div class="ttname"><a href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">ctl_t::isosurf</a></div><div class="ttdeci">int isosurf</div><div class="ttdoc">Isosurface parameter (0=none, 1=pressure, 2=density, 3=theta, 4=balloon).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02639">mptrac.h:2639</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a51093927ceae5630067278cee548797f_cgraph.png" border="0" usemap="#amptrac_8h_a51093927ceae5630067278cee548797f_cgraph" alt=""/></div>
<map name="amptrac_8h_a51093927ceae5630067278cee548797f_cgraph" id="amptrac_8h_a51093927ceae5630067278cee548797f_cgraph">
<area shape="rect" title="Initialize the isosurface module based on atmospheric data." alt="" coords="5,5,140,32"/>
<area shape="rect" href="mptrac_8c.html#a55562b13a38a124b0abc09ce8511dde9" title="Updates device memory for specified data structures." alt="" coords="188,5,341,32"/>
</map>
</div>

</div>
</div>
<a id="ae194c1be6a486d2bd92f5794637d53e2" name="ae194c1be6a486d2bd92f5794637d53e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae194c1be6a486d2bd92f5794637d53e2">&#9670;&nbsp;</a></span>module_isosurf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_isosurf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the isosurface module to adjust atmospheric properties. </p>
<p >This function applies the isosurface module to adjust atmospheric properties based on the initialized data stored in the cache. It interpolates and restores atmospheric pressure, density, or potential temperature according to the specified isosurface mode in the control structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data structure at the current time step. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the meteorological data structure at the next time step. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04083">4083</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4088</span>              {</div>
<div class="line"><span class="lineno"> 4089</span> </div>
<div class="line"><span class="lineno"> 4090</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 4091</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_ISOSURF&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 4092</span> </div>
<div class="line"><span class="lineno"> 4093</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 4094</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 0, <span class="stringliteral">&quot;acc data present(ctl,cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 4095</span> </div>
<div class="line"><span class="lineno"> 4096</span>    <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 4097</span>    <span class="keywordtype">double</span> t;</div>
<div class="line"><span class="lineno"> 4098</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 4099</span> </div>
<div class="line"><span class="lineno"> 4100</span>    <span class="comment">/* Restore pressure... */</span></div>
<div class="line"><span class="lineno"> 4101</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> == 1)</div>
<div class="line"><span class="lineno"> 4102</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] = cache-&gt;<a class="code hl_variable" href="structcache__t.html#ac3b83913cce35ef5ec582c54dce239d0">iso_var</a>[ip];</div>
<div class="line"><span class="lineno"> 4103</span> </div>
<div class="line"><span class="lineno"> 4104</span>    <span class="comment">/* Restore density... */</span></div>
<div class="line"><span class="lineno"> 4105</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> == 2) {</div>
<div class="line"><span class="lineno"> 4106</span>      <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 1);</div>
<div class="line"><span class="lineno"> 4107</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] = cache-&gt;<a class="code hl_variable" href="structcache__t.html#ac3b83913cce35ef5ec582c54dce239d0">iso_var</a>[ip] * t;</div>
<div class="line"><span class="lineno"> 4108</span>    }</div>
<div class="line"><span class="lineno"> 4109</span> </div>
<div class="line"><span class="lineno"> 4110</span>    <span class="comment">/* Restore potential temperature... */</span></div>
<div class="line"><span class="lineno"> 4111</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> == 3) {</div>
<div class="line"><span class="lineno"> 4112</span>      <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 1);</div>
<div class="line"><span class="lineno"> 4113</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] = 1000. * pow(cache-&gt;<a class="code hl_variable" href="structcache__t.html#ac3b83913cce35ef5ec582c54dce239d0">iso_var</a>[ip] / t, -1. / 0.286);</div>
<div class="line"><span class="lineno"> 4114</span>    }</div>
<div class="line"><span class="lineno"> 4115</span> </div>
<div class="line"><span class="lineno"> 4116</span>    <span class="comment">/* Interpolate pressure... */</span></div>
<div class="line"><span class="lineno"> 4117</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> == 4) {</div>
<div class="line"><span class="lineno"> 4118</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt;= cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4039e32188d12d6a86086d236676d993">iso_ts</a>[0])</div>
<div class="line"><span class="lineno"> 4119</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] = cache-&gt;<a class="code hl_variable" href="structcache__t.html#a8ce0e8a193211fc8461b2043daf9b17c">iso_ps</a>[0];</div>
<div class="line"><span class="lineno"> 4120</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt;= cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4039e32188d12d6a86086d236676d993">iso_ts</a>[cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4df585fc5eb4099f8cd54d77703ebf45">iso_n</a> - 1])</div>
<div class="line"><span class="lineno"> 4121</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] = cache-&gt;<a class="code hl_variable" href="structcache__t.html#a8ce0e8a193211fc8461b2043daf9b17c">iso_ps</a>[cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4df585fc5eb4099f8cd54d77703ebf45">iso_n</a> - 1];</div>
<div class="line"><span class="lineno"> 4122</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4123</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> idx =</div>
<div class="line"><span class="lineno"> 4124</span>          <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4039e32188d12d6a86086d236676d993">iso_ts</a>, cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4df585fc5eb4099f8cd54d77703ebf45">iso_n</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip]);</div>
<div class="line"><span class="lineno"> 4125</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] =</div>
<div class="line"><span class="lineno"> 4126</span>          <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4039e32188d12d6a86086d236676d993">iso_ts</a>[idx], cache-&gt;<a class="code hl_variable" href="structcache__t.html#a8ce0e8a193211fc8461b2043daf9b17c">iso_ps</a>[idx], cache-&gt;<a class="code hl_variable" href="structcache__t.html#a4039e32188d12d6a86086d236676d993">iso_ts</a>[idx + 1],</div>
<div class="line"><span class="lineno"> 4127</span>              cache-&gt;<a class="code hl_variable" href="structcache__t.html#a8ce0e8a193211fc8461b2043daf9b17c">iso_ps</a>[idx + 1], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip]);</div>
<div class="line"><span class="lineno"> 4128</span>      }</div>
<div class="line"><span class="lineno"> 4129</span>    }</div>
<div class="line"><span class="lineno"> 4130</span>  }</div>
<div class="line"><span class="lineno"> 4131</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_ae194c1be6a486d2bd92f5794637d53e2_cgraph.png" border="0" usemap="#amptrac_8h_ae194c1be6a486d2bd92f5794637d53e2_cgraph" alt=""/></div>
<map name="amptrac_8h_ae194c1be6a486d2bd92f5794637d53e2_cgraph" id="amptrac_8h_ae194c1be6a486d2bd92f5794637d53e2_cgraph">
<area shape="rect" title="Apply the isosurface module to adjust atmospheric properties." alt="" coords="5,5,116,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="164,5,239,32"/>
</map>
</div>

</div>
</div>
<a id="ae1de15701f752a97b1d2858125e851fc" name="ae1de15701f752a97b1d2858125e851fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1de15701f752a97b1d2858125e851fc">&#9670;&nbsp;</a></span>module_kpp_chem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_kpp_chem </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KPP chemistry module. </p>
<p >Simulate chemical reactions using the Kinetic PreProcessor (KPP) integration scheme.</p>
<p >This function simulates chemical reactions using the Kinetic PreProcessor (KPP) integration scheme for atmospheric particles. It loops over each particle in the atmospheric data structure and integrates chemical reactions over a specified time step using the KPP algorithm.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climatological data structure. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the first meteorological data structure. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the second meteorological data structure. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function initializes a timer to measure the execution time of the chemical simulation. </dd>
<dd>
Chemical integration using KPP is performed for particles with a positive time step (dt &gt; 0). </dd>
<dd>
For each particle, the function allocates memory for variable (VAR) and fixed (FIX) arrays, sets the range of time steps (STEPMIN and STEPMAX), and defines relative and absolute tolerances. </dd>
<dd>
The chemical system is initialized for each particle using the kpp_chem_initialize function. </dd>
<dd>
Chemical integration is performed over a specified time step (ctl-&gt;dt_kpp) using the INTEGRATE macro, which is part of the KPP integration scheme. </dd>
<dd>
The function outputs the integrated chemical concentrations back to the atmospheric data structure using the kpp_chem_output2atm function. </dd>
<dd>
Memory allocated for the variable (VAR) and fixed (FIX) arrays is freed after the integration is completed for each particle.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mingzhao Liu </dd></dl>

</div>
</div>
<a id="a1a15f897588f202b09b4eea27b89f734" name="a1a15f897588f202b09b4eea27b89f734"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a15f897588f202b09b4eea27b89f734">&#9670;&nbsp;</a></span>module_meteo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_meteo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update atmospheric properties using meteorological data. </p>
<p >This function updates atmospheric properties based on meteorological data interpolated between two time steps. It calculates various atmospheric quantities such as pressure, temperature, wind speed, humidity, etc., and updates the corresponding fields in the atmospheric data structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climate data structure containing climatological data. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data structure at the current time step. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the meteorological data structure at the next time step. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04189">4189</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4195</span>              {</div>
<div class="line"><span class="lineno"> 4196</span> </div>
<div class="line"><span class="lineno"> 4197</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 4198</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_METEO&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 4199</span> </div>
<div class="line"><span class="lineno"> 4200</span>  <span class="comment">/* Check quantity flags... */</span></div>
<div class="line"><span class="lineno"> 4201</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa29a4ab3048a143622094d93886aa0db">qnt_tsts</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 4202</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7606f8b8ba4df727e0c0c9386f527119">qnt_tice</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a742e33a97813e9a50cb0e17a680e815a">qnt_tnat</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 4203</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Need T_ice and T_NAT to calculate T_STS!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4204</span> </div>
<div class="line"><span class="lineno"> 4205</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 4206</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 0,</div>
<div class="line"><span class="lineno"> 4207</span>                <span class="stringliteral">&quot;acc data present(ctl,cache,clim,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 4208</span> </div>
<div class="line"><span class="lineno"> 4209</span>    <span class="keywordtype">double</span> ps, ts, zs, us, vs, ess, nss, shf, lsm, sst, pbl, pt, pct, pcb,</div>
<div class="line"><span class="lineno"> 4210</span>      cl, plcl, plfc, pel, cape, cin, o3c, pv, t, tt, u, v, w, h2o, h2ot,</div>
<div class="line"><span class="lineno"> 4211</span>      o3, lwc, rwc, iwc, swc, cc, z, zt;</div>
<div class="line"><span class="lineno"> 4212</span> </div>
<div class="line"><span class="lineno"> 4213</span>    <span class="comment">/* Interpolate meteo data... */</span></div>
<div class="line"><span class="lineno"> 4214</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 4215</span>    <a class="code hl_define" href="mptrac_8h.html#a983e27f3f3845d3e6bc38716aab60cdd">INTPOL_TIME_ALL</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]);</div>
<div class="line"><span class="lineno"> 4216</span> </div>
<div class="line"><span class="lineno"> 4217</span>    <span class="comment">/* Set quantities... */</span></div>
<div class="line"><span class="lineno"> 4218</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_ps, ps);</div>
<div class="line"><span class="lineno"> 4219</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_ts, ts);</div>
<div class="line"><span class="lineno"> 4220</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_zs, zs);</div>
<div class="line"><span class="lineno"> 4221</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_us, us);</div>
<div class="line"><span class="lineno"> 4222</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_vs, vs);</div>
<div class="line"><span class="lineno"> 4223</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_ess, ess);</div>
<div class="line"><span class="lineno"> 4224</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_nss, nss);</div>
<div class="line"><span class="lineno"> 4225</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_shf, shf);</div>
<div class="line"><span class="lineno"> 4226</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_lsm, lsm);</div>
<div class="line"><span class="lineno"> 4227</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_sst, sst);</div>
<div class="line"><span class="lineno"> 4228</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_pbl, pbl);</div>
<div class="line"><span class="lineno"> 4229</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_pt, pt);</div>
<div class="line"><span class="lineno"> 4230</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_tt, tt);</div>
<div class="line"><span class="lineno"> 4231</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_zt, zt);</div>
<div class="line"><span class="lineno"> 4232</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_h2ot, h2ot);</div>
<div class="line"><span class="lineno"> 4233</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_zg, z);</div>
<div class="line"><span class="lineno"> 4234</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_p, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]);</div>
<div class="line"><span class="lineno"> 4235</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_t, t);</div>
<div class="line"><span class="lineno"> 4236</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_rho, <a class="code hl_define" href="mptrac_8h.html#ae088e183d18a16fd6ab469d48ce3f06a">RHO</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t));</div>
<div class="line"><span class="lineno"> 4237</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_u, u);</div>
<div class="line"><span class="lineno"> 4238</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_v, v);</div>
<div class="line"><span class="lineno"> 4239</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_w, w);</div>
<div class="line"><span class="lineno"> 4240</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_h2o, h2o);</div>
<div class="line"><span class="lineno"> 4241</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_o3, o3);</div>
<div class="line"><span class="lineno"> 4242</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_lwc, lwc);</div>
<div class="line"><span class="lineno"> 4243</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_rwc, rwc);</div>
<div class="line"><span class="lineno"> 4244</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_iwc, iwc);</div>
<div class="line"><span class="lineno"> 4245</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_swc, swc);</div>
<div class="line"><span class="lineno"> 4246</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_cc, cc);</div>
<div class="line"><span class="lineno"> 4247</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_pct, pct);</div>
<div class="line"><span class="lineno"> 4248</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_pcb, pcb);</div>
<div class="line"><span class="lineno"> 4249</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_cl, cl);</div>
<div class="line"><span class="lineno"> 4250</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_plcl, plcl);</div>
<div class="line"><span class="lineno"> 4251</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_plfc, plfc);</div>
<div class="line"><span class="lineno"> 4252</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_pel, pel);</div>
<div class="line"><span class="lineno"> 4253</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_cape, cape);</div>
<div class="line"><span class="lineno"> 4254</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_cin, cin);</div>
<div class="line"><span class="lineno"> 4255</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_o3c, o3c);</div>
<div class="line"><span class="lineno"> 4256</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_hno3,</div>
<div class="line"><span class="lineno"> 4257</span>            <a class="code hl_function" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a4fdb5d9229fc193f2e526a6aebf97558">hno3</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]));</div>
<div class="line"><span class="lineno"> 4258</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_oh, <a class="code hl_function" href="mptrac_8c.html#a9ba00889eeb600010467d8b62de94a36">clim_oh</a>(ctl, clim, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip],</div>
<div class="line"><span class="lineno"> 4259</span>                            atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]));</div>
<div class="line"><span class="lineno"> 4260</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_h2o2, <a class="code hl_function" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#ab7f787719be51524b1389bb0bf347934">h2o2</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip],</div>
<div class="line"><span class="lineno"> 4261</span>                              atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]));</div>
<div class="line"><span class="lineno"> 4262</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_ho2, <a class="code hl_function" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a2ba0d75a451d9382ba20ec54d1784e05">ho2</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip],</div>
<div class="line"><span class="lineno"> 4263</span>                             atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]));</div>
<div class="line"><span class="lineno"> 4264</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_o1d, <a class="code hl_function" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a9a7486ab639da63d6ac55d6cbacdcf0e">o1d</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip],</div>
<div class="line"><span class="lineno"> 4265</span>                             atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]));</div>
<div class="line"><span class="lineno"> 4266</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_vh, sqrt(u * u + v * v));</div>
<div class="line"><span class="lineno"> 4267</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_vz, -1e3 * <a class="code hl_define" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a> / atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] * w);</div>
<div class="line"><span class="lineno"> 4268</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_psat, <a class="code hl_define" href="mptrac_8h.html#adc5ae7e10b1b021fb68397df5bad0a64">PSAT</a>(t));</div>
<div class="line"><span class="lineno"> 4269</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_psice, <a class="code hl_define" href="mptrac_8h.html#a70eb939aa0b84d808a49a4a18111ae9f">PSICE</a>(t));</div>
<div class="line"><span class="lineno"> 4270</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_pw, <a class="code hl_define" href="mptrac_8h.html#a1f71059c62f3f9c3db1f6eb5f94dd7a8">PW</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], h2o));</div>
<div class="line"><span class="lineno"> 4271</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_sh, <a class="code hl_define" href="mptrac_8h.html#a47b5bc0bd14e22c0329d967e3c6657bd">SH</a>(h2o));</div>
<div class="line"><span class="lineno"> 4272</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_rh, <a class="code hl_define" href="mptrac_8h.html#ab72fd70a37f29f2192b751999b6c7cc2">RH</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t, h2o));</div>
<div class="line"><span class="lineno"> 4273</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_rhice, <a class="code hl_define" href="mptrac_8h.html#a9431567784929c9e462e16f393e04088">RHICE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t, h2o));</div>
<div class="line"><span class="lineno"> 4274</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_theta, <a class="code hl_define" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t));</div>
<div class="line"><span class="lineno"> 4275</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_zeta, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9382d9e9b29e10eeee582e1e10ff365a">qnt_zeta</a>][ip]);</div>
<div class="line"><span class="lineno"> 4276</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_zeta_d, <a class="code hl_define" href="mptrac_8h.html#a90ee947c906d48ce71affad259ac991d">ZETA</a>(ps, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t));</div>
<div class="line"><span class="lineno"> 4277</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_zeta_dot, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9fd6dd75539124eff0a56876653ae771">qnt_zeta_dot</a>][ip]);</div>
<div class="line"><span class="lineno"> 4278</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_eta, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a59254cd97a92694d95b7fb6b384c4d3f">qnt_eta</a>][ip]);</div>
<div class="line"><span class="lineno"> 4279</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_eta_dot, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a758245d1a36fda8f475e4041f5efcf7c">qnt_eta_dot</a>][ip]);</div>
<div class="line"><span class="lineno"> 4280</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_tvirt, <a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(t, h2o));</div>
<div class="line"><span class="lineno"> 4281</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_lapse, <a class="code hl_function" href="mptrac_8c.html#afa485eb277a5ced6dac0ed77665c976c">lapse_rate</a>(t, h2o));</div>
<div class="line"><span class="lineno"> 4282</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_pv, pv);</div>
<div class="line"><span class="lineno"> 4283</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_tdew, <a class="code hl_define" href="mptrac_8h.html#accf0b870a4ce9e19153c59f88898543a">TDEW</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], h2o));</div>
<div class="line"><span class="lineno"> 4284</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_tice, <a class="code hl_define" href="mptrac_8h.html#a879f63fc7d15755d06ff79084410b6c9">TICE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], h2o));</div>
<div class="line"><span class="lineno"> 4285</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_tnat,</div>
<div class="line"><span class="lineno"> 4286</span>            <a class="code hl_function" href="mptrac_8c.html#a623b433e01381315e5d49fc4c2bc3548">nat_temperature</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], h2o,</div>
<div class="line"><span class="lineno"> 4287</span>                            <a class="code hl_function" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a4fdb5d9229fc193f2e526a6aebf97558">hno3</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip],</div>
<div class="line"><span class="lineno"> 4288</span>                                    atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip])));</div>
<div class="line"><span class="lineno"> 4289</span>    <a class="code hl_define" href="mptrac_8h.html#a9c741a27b379cebf498901dc7d271296">SET_ATM</a>(qnt_tsts,</div>
<div class="line"><span class="lineno"> 4290</span>            0.5 * (atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7606f8b8ba4df727e0c0c9386f527119">qnt_tice</a>][ip] + atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a742e33a97813e9a50cb0e17a680e815a">qnt_tnat</a>][ip]));</div>
<div class="line"><span class="lineno"> 4291</span>  }</div>
<div class="line"><span class="lineno"> 4292</span>}</div>
<div class="ttc" id="amptrac_8c_html_a623b433e01381315e5d49fc4c2bc3548"><div class="ttname"><a href="mptrac_8c.html#a623b433e01381315e5d49fc4c2bc3548">nat_temperature</a></div><div class="ttdeci">double nat_temperature(const double p, const double h2o, const double hno3)</div><div class="ttdoc">Calculates the nitric acid trihydrate (NAT) temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l06973">mptrac.c:6973</a></div></div>
<div class="ttc" id="amptrac_8c_html_afa485eb277a5ced6dac0ed77665c976c"><div class="ttname"><a href="mptrac_8c.html#afa485eb277a5ced6dac0ed77665c976c">lapse_rate</a></div><div class="ttdeci">double lapse_rate(const double t, const double h2o)</div><div class="ttdoc">Calculates the moist adiabatic lapse rate in Kelvin per kilometer.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02641">mptrac.c:2641</a></div></div>
<div class="ttc" id="amptrac_8h_html_a2091e935ef46727f066804a98a0d039f"><div class="ttname"><a href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a></div><div class="ttdeci">#define H0</div><div class="ttdoc">Scale height [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00219">mptrac.h:219</a></div></div>
<div class="ttc" id="amptrac_8h_html_a70eb939aa0b84d808a49a4a18111ae9f"><div class="ttname"><a href="mptrac_8h.html#a70eb939aa0b84d808a49a4a18111ae9f">PSICE</a></div><div class="ttdeci">#define PSICE(t)</div><div class="ttdoc">Compute saturation pressure over ice (WMO, 2018).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01491">mptrac.h:1491</a></div></div>
<div class="ttc" id="amptrac_8h_html_a879f63fc7d15755d06ff79084410b6c9"><div class="ttname"><a href="mptrac_8h.html#a879f63fc7d15755d06ff79084410b6c9">TICE</a></div><div class="ttdeci">#define TICE(p, h2o)</div><div class="ttdoc">Calculate frost point temperature (WMO, 2018).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01759">mptrac.h:1759</a></div></div>
<div class="ttc" id="amptrac_8h_html_a9431567784929c9e462e16f393e04088"><div class="ttname"><a href="mptrac_8h.html#a9431567784929c9e462e16f393e04088">RHICE</a></div><div class="ttdeci">#define RHICE(p, t, h2o)</div><div class="ttdoc">Compute relative humidity over ice.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01595">mptrac.h:1595</a></div></div>
<div class="ttc" id="amptrac_8h_html_a983e27f3f3845d3e6bc38716aab60cdd"><div class="ttname"><a href="mptrac_8h.html#a983e27f3f3845d3e6bc38716aab60cdd">INTPOL_TIME_ALL</a></div><div class="ttdeci">#define INTPOL_TIME_ALL(time, p, lon, lat)</div><div class="ttdoc">Interpolate multiple meteorological variables in time.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00937">mptrac.h:937</a></div></div>
<div class="ttc" id="amptrac_8h_html_ab72fd70a37f29f2192b751999b6c7cc2"><div class="ttname"><a href="mptrac_8h.html#ab72fd70a37f29f2192b751999b6c7cc2">RH</a></div><div class="ttdeci">#define RH(p, t, h2o)</div><div class="ttdoc">Compute relative humidity over water.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01565">mptrac.h:1565</a></div></div>
<div class="ttc" id="amptrac_8h_html_accf0b870a4ce9e19153c59f88898543a"><div class="ttname"><a href="mptrac_8h.html#accf0b870a4ce9e19153c59f88898543a">TDEW</a></div><div class="ttdeci">#define TDEW(p, h2o)</div><div class="ttdoc">Calculate dew point temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01734">mptrac.h:1734</a></div></div>
<div class="ttc" id="amptrac_8h_html_adc5ae7e10b1b021fb68397df5bad0a64"><div class="ttname"><a href="mptrac_8h.html#adc5ae7e10b1b021fb68397df5bad0a64">PSAT</a></div><div class="ttdeci">#define PSAT(t)</div><div class="ttdoc">Compute saturation pressure over water.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01467">mptrac.h:1467</a></div></div>
<div class="ttc" id="astructclim__t_html_a4fdb5d9229fc193f2e526a6aebf97558"><div class="ttname"><a href="structclim__t.html#a4fdb5d9229fc193f2e526a6aebf97558">clim_t::hno3</a></div><div class="ttdeci">clim_zm_t hno3</div><div class="ttdoc">HNO3 zonal means.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03380">mptrac.h:3380</a></div></div>
<div class="ttc" id="astructctl__t_html_a742e33a97813e9a50cb0e17a680e815a"><div class="ttname"><a href="structctl__t.html#a742e33a97813e9a50cb0e17a680e815a">ctl_t::qnt_tnat</a></div><div class="ttdeci">int qnt_tnat</div><div class="ttdoc">Quantity array index for T_NAT.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02384">mptrac.h:2384</a></div></div>
<div class="ttc" id="astructctl__t_html_a758245d1a36fda8f475e4041f5efcf7c"><div class="ttname"><a href="structctl__t.html#a758245d1a36fda8f475e4041f5efcf7c">ctl_t::qnt_eta_dot</a></div><div class="ttdeci">int qnt_eta_dot</div><div class="ttdoc">Quantity array index for velocity of eta vertical coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02357">mptrac.h:2357</a></div></div>
<div class="ttc" id="astructctl__t_html_a7606f8b8ba4df727e0c0c9386f527119"><div class="ttname"><a href="structctl__t.html#a7606f8b8ba4df727e0c0c9386f527119">ctl_t::qnt_tice</a></div><div class="ttdeci">int qnt_tice</div><div class="ttdoc">Quantity array index for T_ice.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02378">mptrac.h:2378</a></div></div>
<div class="ttc" id="astructctl__t_html_a9fd6dd75539124eff0a56876653ae771"><div class="ttname"><a href="structctl__t.html#a9fd6dd75539124eff0a56876653ae771">ctl_t::qnt_zeta_dot</a></div><div class="ttdeci">int qnt_zeta_dot</div><div class="ttdoc">Quantity array index for velocity of zeta vertical coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02351">mptrac.h:2351</a></div></div>
<div class="ttc" id="astructctl__t_html_aa29a4ab3048a143622094d93886aa0db"><div class="ttname"><a href="structctl__t.html#aa29a4ab3048a143622094d93886aa0db">ctl_t::qnt_tsts</a></div><div class="ttdeci">int qnt_tsts</div><div class="ttdoc">Quantity array index for T_STS.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02381">mptrac.h:2381</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a1a15f897588f202b09b4eea27b89f734_cgraph.png" border="0" usemap="#amptrac_8h_a1a15f897588f202b09b4eea27b89f734_cgraph" alt=""/></div>
<map name="amptrac_8h_a1a15f897588f202b09b4eea27b89f734_cgraph" id="amptrac_8h_a1a15f897588f202b09b4eea27b89f734_cgraph">
<area shape="rect" title="Update atmospheric properties using meteorological data." alt="" coords="5,107,112,133"/>
<area shape="rect" href="mptrac_8c.html#a9ba00889eeb600010467d8b62de94a36" title="Calculates the hydroxyl radical (OH) concentration from climatology data, with an optional diurnal co..." alt="" coords="185,81,251,108"/>
<area shape="rect" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a" title="Interpolates monthly mean zonal mean climatological variables." alt="" coords="324,31,395,57"/>
<area shape="rect" href="mptrac_8c.html#afa485eb277a5ced6dac0ed77665c976c" title="Calculates the moist adiabatic lapse rate in Kelvin per kilometer." alt="" coords="177,132,259,159"/>
<area shape="rect" href="mptrac_8c.html#a623b433e01381315e5d49fc4c2bc3548" title="Calculates the nitric acid trihydrate (NAT) temperature." alt="" coords="160,183,276,209"/>
<area shape="rect" href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="324,81,395,108"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="447,5,521,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="443,56,525,83"/>
</map>
</div>

</div>
</div>
<a id="a40777319fe0947dcf920f10de9d55085" name="a40777319fe0947dcf920f10de9d55085"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40777319fe0947dcf920f10de9d55085">&#9670;&nbsp;</a></span>module_mixing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_mixing </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update atmospheric properties through interparcel mixing. </p>
<p >This function updates atmospheric properties by performing interparcel mixing based on the given meteorological and climatological data. It calculates the indices of grid boxes and performs mixing for various quantities such as mass, volume mixing ratio, and other chemical species concentrations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climate data structure containing climatological data. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information. </td></tr>
    <tr><td class="paramname">t</td><td>Time at which mixing is performed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mingzhao Liu </dd>
<dd>
Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04296">4296</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4300</span>                  {</div>
<div class="line"><span class="lineno"> 4301</span> </div>
<div class="line"><span class="lineno"> 4302</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 4303</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_MIXING&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 4304</span> </div>
<div class="line"><span class="lineno"> 4305</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 4306</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> np = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>;</div>
<div class="line"><span class="lineno"> 4307</span>  <span class="keywordtype">int</span> *restrict <span class="keyword">const</span> ixs = (<span class="keywordtype">int</span> *) malloc((<span class="keywordtype">size_t</span>) np * <span class="keyword">sizeof</span>(int));</div>
<div class="line"><span class="lineno"> 4308</span>  <span class="keywordtype">int</span> *restrict <span class="keyword">const</span> iys = (<span class="keywordtype">int</span> *) malloc((<span class="keywordtype">size_t</span>) np * <span class="keyword">sizeof</span>(int));</div>
<div class="line"><span class="lineno"> 4309</span>  <span class="keywordtype">int</span> *restrict <span class="keyword">const</span> izs = (<span class="keywordtype">int</span> *) malloc((<span class="keywordtype">size_t</span>) np * <span class="keyword">sizeof</span>(int));</div>
<div class="line"><span class="lineno"> 4310</span> </div>
<div class="line"><span class="lineno"> 4311</span>  <span class="comment">/* Set grid box size... */</span></div>
<div class="line"><span class="lineno"> 4312</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> dz = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a12d69b44d99afb975f0df6fe5486f896">mixing_z1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5b956c530addc8d909afaf00f5bf9fb4">mixing_z0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa027a38882f39332262de958c1e8880b">mixing_nz</a>;</div>
<div class="line"><span class="lineno"> 4313</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> dlon = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb72c2a4599dd7bc44ef279da5de7ff">mixing_lon1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa161bb16963a0fb4340b8e6fda492be6">mixing_lon0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a073b97a29712daaee8212c8a673418bf">mixing_nx</a>;</div>
<div class="line"><span class="lineno"> 4314</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> dlat = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aabd109b7477b116b0542aafeb8056180">mixing_lat1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8bc3cf78a652568f5e5f04d7c28e82ea">mixing_lat0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6cc8f7e22a69a8fec9e11c2cd4a84644">mixing_ny</a>;</div>
<div class="line"><span class="lineno"> 4315</span> </div>
<div class="line"><span class="lineno"> 4316</span>  <span class="comment">/* Set time interval... */</span></div>
<div class="line"><span class="lineno"> 4317</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = t - 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno"> 4318</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t1 = t + 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno"> 4319</span> </div>
<div class="line"><span class="lineno"> 4320</span>  <span class="comment">/* Get indices... */</span></div>
<div class="line"><span class="lineno"> 4321</span>#ifdef _OPENACC</div>
<div class="line"><span class="lineno"> 4322</span>#pragma acc enter data create(ixs[0:np],iys[0:np],izs[0:np])</div>
<div class="line"><span class="lineno"> 4323</span><span class="preprocessor">#pragma acc data present(ctl,clim,atm,ixs,iys,izs)</span></div>
<div class="line"><span class="lineno"> 4324</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 4325</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4326</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 4327</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4328</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; np; ip++) {</div>
<div class="line"><span class="lineno"> 4329</span>    ixs[ip] = (int) ((atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa161bb16963a0fb4340b8e6fda492be6">mixing_lon0</a>) / dlon);</div>
<div class="line"><span class="lineno"> 4330</span>    iys[ip] = (int) ((atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8bc3cf78a652568f5e5f04d7c28e82ea">mixing_lat0</a>) / dlat);</div>
<div class="line"><span class="lineno"> 4331</span>    izs[ip] = (int) ((<a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]) - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5b956c530addc8d909afaf00f5bf9fb4">mixing_z0</a>) / dz);</div>
<div class="line"><span class="lineno"> 4332</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1</div>
<div class="line"><span class="lineno"> 4333</span>        || ixs[ip] &lt; 0 || ixs[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a073b97a29712daaee8212c8a673418bf">mixing_nx</a></div>
<div class="line"><span class="lineno"> 4334</span>        || iys[ip] &lt; 0 || iys[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6cc8f7e22a69a8fec9e11c2cd4a84644">mixing_ny</a></div>
<div class="line"><span class="lineno"> 4335</span>        || izs[ip] &lt; 0 || izs[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa027a38882f39332262de958c1e8880b">mixing_nz</a>)</div>
<div class="line"><span class="lineno"> 4336</span>      izs[ip] = -1;</div>
<div class="line"><span class="lineno"> 4337</span>  }</div>
<div class="line"><span class="lineno"> 4338</span> </div>
<div class="line"><span class="lineno"> 4339</span>  <span class="comment">/* Calculate interparcel mixing... */</span></div>
<div class="line"><span class="lineno"> 4340</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> use_ensemble = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">nens</a> &gt; 0);</div>
<div class="line"><span class="lineno"> 4341</span> </div>
<div class="line"><span class="lineno"> 4342</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> quantities[] = {</div>
<div class="line"><span class="lineno"> 4343</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9baf6b24cc12d9b589576a173bed3b8b">qnt_Ch2o</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa1dc44e429c2e407559577b86c9fc170">qnt_Co3</a>,</div>
<div class="line"><span class="lineno"> 4344</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a63128061ebb75c105f1774fa894d91c9">qnt_Cco</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a028e098ce1133fc1a3993ea74d330330">qnt_Coh</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7ef2d94a86e63af36c9022a55db08024">qnt_Ch</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a99d38b5d6024bb51436e6271202d8968">qnt_Cho2</a>,</div>
<div class="line"><span class="lineno"> 4345</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adaa906f8d83e26dde37b9242f567e329">qnt_Ch2o2</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a18e4fa9a68e03ee2aa1be7e2feb6130f">qnt_Co1d</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac04dce247fe52429fca4b3ddd32c4ed1">qnt_Co3p</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1ba53bf2909cfe859cdd8d3e6db31e9a">qnt_Cccl4</a>,</div>
<div class="line"><span class="lineno"> 4346</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a43ba4811191565b719506351b40515">qnt_Cccl3f</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a066b3cab4ae3633d7f5a4cc178f8d655">qnt_Cccl2f2</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a3a8cc8108f6dce4fcf6b82ceb97d22">qnt_Cn2o</a>,</div>
<div class="line"><span class="lineno"> 4347</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ad1be4d2d7d089ba9311f6c6b17baa2">qnt_Csf6</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a08aa70d2f116af5dfe779b6ecec4dd19">qnt_aoa</a></div>
<div class="line"><span class="lineno"> 4348</span>  };</div>
<div class="line"><span class="lineno"> 4349</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> n_qnt = <span class="keyword">sizeof</span>(quantities) / <span class="keyword">sizeof</span>(quantities[0]);</div>
<div class="line"><span class="lineno"> 4350</span> </div>
<div class="line"><span class="lineno"> 4351</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_qnt; i++)</div>
<div class="line"><span class="lineno"> 4352</span>    <span class="keywordflow">if</span> (quantities[i] &gt;= 0)</div>
<div class="line"><span class="lineno"> 4353</span>      <a class="code hl_function" href="mptrac_8c.html#a433c00a5ba68e33cc6ac08ee2217a76f">module_mixing_help</a>(ctl, clim, atm, ixs, iys, izs, quantities[i],</div>
<div class="line"><span class="lineno"> 4354</span>                         use_ensemble);</div>
<div class="line"><span class="lineno"> 4355</span> </div>
<div class="line"><span class="lineno"> 4356</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 4357</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4358</span><span class="preprocessor">#pragma acc exit data delete(ixs,iys,izs)</span></div>
<div class="line"><span class="lineno"> 4359</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4360</span>  free(ixs);</div>
<div class="line"><span class="lineno"> 4361</span>  free(iys);</div>
<div class="line"><span class="lineno"> 4362</span>  free(izs);</div>
<div class="line"><span class="lineno"> 4363</span>}</div>
<div class="ttc" id="amptrac_8c_html_a433c00a5ba68e33cc6ac08ee2217a76f"><div class="ttname"><a href="mptrac_8c.html#a433c00a5ba68e33cc6ac08ee2217a76f">module_mixing_help</a></div><div class="ttdeci">void module_mixing_help(const ctl_t *ctl, const clim_t *clim, atm_t *atm, const int *ixs, const int *iys, const int *izs, const int qnt_idx, const int use_ensemble)</div><div class="ttdoc">Perform subgrid-scale interparcel mixing of a given quantity.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04367">mptrac.c:4367</a></div></div>
<div class="ttc" id="astructctl__t_html_a028e098ce1133fc1a3993ea74d330330"><div class="ttname"><a href="structctl__t.html#a028e098ce1133fc1a3993ea74d330330">ctl_t::qnt_Coh</a></div><div class="ttdeci">int qnt_Coh</div><div class="ttdoc">Quantity array index for OH volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02399">mptrac.h:2399</a></div></div>
<div class="ttc" id="astructctl__t_html_a073b97a29712daaee8212c8a673418bf"><div class="ttname"><a href="structctl__t.html#a073b97a29712daaee8212c8a673418bf">ctl_t::mixing_nx</a></div><div class="ttdeci">int mixing_nx</div><div class="ttdoc">Number of longitudes of mixing grid.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02799">mptrac.h:2799</a></div></div>
<div class="ttc" id="astructctl__t_html_a12d69b44d99afb975f0df6fe5486f896"><div class="ttname"><a href="structctl__t.html#a12d69b44d99afb975f0df6fe5486f896">ctl_t::mixing_z1</a></div><div class="ttdeci">double mixing_z1</div><div class="ttdoc">Upper altitude of mixing grid [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02796">mptrac.h:2796</a></div></div>
<div class="ttc" id="astructctl__t_html_a18e4fa9a68e03ee2aa1be7e2feb6130f"><div class="ttname"><a href="structctl__t.html#a18e4fa9a68e03ee2aa1be7e2feb6130f">ctl_t::qnt_Co1d</a></div><div class="ttdeci">int qnt_Co1d</div><div class="ttdoc">Quantity array index for O(1D) volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02411">mptrac.h:2411</a></div></div>
<div class="ttc" id="astructctl__t_html_a5b956c530addc8d909afaf00f5bf9fb4"><div class="ttname"><a href="structctl__t.html#a5b956c530addc8d909afaf00f5bf9fb4">ctl_t::mixing_z0</a></div><div class="ttdeci">double mixing_z0</div><div class="ttdoc">Lower altitude of mixing grid [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02793">mptrac.h:2793</a></div></div>
<div class="ttc" id="astructctl__t_html_a63128061ebb75c105f1774fa894d91c9"><div class="ttname"><a href="structctl__t.html#a63128061ebb75c105f1774fa894d91c9">ctl_t::qnt_Cco</a></div><div class="ttdeci">int qnt_Cco</div><div class="ttdoc">Quantity array index for CO volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02396">mptrac.h:2396</a></div></div>
<div class="ttc" id="astructctl__t_html_a6cc8f7e22a69a8fec9e11c2cd4a84644"><div class="ttname"><a href="structctl__t.html#a6cc8f7e22a69a8fec9e11c2cd4a84644">ctl_t::mixing_ny</a></div><div class="ttdeci">int mixing_ny</div><div class="ttdoc">Number of latitudes of mixing grid.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02808">mptrac.h:2808</a></div></div>
<div class="ttc" id="astructctl__t_html_a7ef2d94a86e63af36c9022a55db08024"><div class="ttname"><a href="structctl__t.html#a7ef2d94a86e63af36c9022a55db08024">ctl_t::qnt_Ch</a></div><div class="ttdeci">int qnt_Ch</div><div class="ttdoc">Quantity array index for H volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02402">mptrac.h:2402</a></div></div>
<div class="ttc" id="astructctl__t_html_a8bc3cf78a652568f5e5f04d7c28e82ea"><div class="ttname"><a href="structctl__t.html#a8bc3cf78a652568f5e5f04d7c28e82ea">ctl_t::mixing_lat0</a></div><div class="ttdeci">double mixing_lat0</div><div class="ttdoc">Lower latitude of mixing grid [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02811">mptrac.h:2811</a></div></div>
<div class="ttc" id="astructctl__t_html_a99d38b5d6024bb51436e6271202d8968"><div class="ttname"><a href="structctl__t.html#a99d38b5d6024bb51436e6271202d8968">ctl_t::qnt_Cho2</a></div><div class="ttdeci">int qnt_Cho2</div><div class="ttdoc">Quantity array index for HO2 volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02405">mptrac.h:2405</a></div></div>
<div class="ttc" id="astructctl__t_html_aa027a38882f39332262de958c1e8880b"><div class="ttname"><a href="structctl__t.html#aa027a38882f39332262de958c1e8880b">ctl_t::mixing_nz</a></div><div class="ttdeci">int mixing_nz</div><div class="ttdoc">Number of altitudes of mixing grid.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02790">mptrac.h:2790</a></div></div>
<div class="ttc" id="astructctl__t_html_aa161bb16963a0fb4340b8e6fda492be6"><div class="ttname"><a href="structctl__t.html#aa161bb16963a0fb4340b8e6fda492be6">ctl_t::mixing_lon0</a></div><div class="ttdeci">double mixing_lon0</div><div class="ttdoc">Lower longitude of mixing grid [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02802">mptrac.h:2802</a></div></div>
<div class="ttc" id="astructctl__t_html_aabd109b7477b116b0542aafeb8056180"><div class="ttname"><a href="structctl__t.html#aabd109b7477b116b0542aafeb8056180">ctl_t::mixing_lat1</a></div><div class="ttdeci">double mixing_lat1</div><div class="ttdoc">Upper latitude of mixing grid [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02814">mptrac.h:2814</a></div></div>
<div class="ttc" id="astructctl__t_html_ac04dce247fe52429fca4b3ddd32c4ed1"><div class="ttname"><a href="structctl__t.html#ac04dce247fe52429fca4b3ddd32c4ed1">ctl_t::qnt_Co3p</a></div><div class="ttdeci">int qnt_Co3p</div><div class="ttdoc">Quantity array index for O(3P) volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02414">mptrac.h:2414</a></div></div>
<div class="ttc" id="astructctl__t_html_adaa906f8d83e26dde37b9242f567e329"><div class="ttname"><a href="structctl__t.html#adaa906f8d83e26dde37b9242f567e329">ctl_t::qnt_Ch2o2</a></div><div class="ttdeci">int qnt_Ch2o2</div><div class="ttdoc">Quantity array index for H2O2 volume mixing ratio (chemistry code).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02408">mptrac.h:2408</a></div></div>
<div class="ttc" id="astructctl__t_html_adbb72c2a4599dd7bc44ef279da5de7ff"><div class="ttname"><a href="structctl__t.html#adbb72c2a4599dd7bc44ef279da5de7ff">ctl_t::mixing_lon1</a></div><div class="ttdeci">double mixing_lon1</div><div class="ttdoc">Upper longitude of mixing grid [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02805">mptrac.h:2805</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a40777319fe0947dcf920f10de9d55085_cgraph.png" border="0" usemap="#amptrac_8h_a40777319fe0947dcf920f10de9d55085_cgraph" alt=""/></div>
<map name="amptrac_8h_a40777319fe0947dcf920f10de9d55085_cgraph" id="amptrac_8h_a40777319fe0947dcf920f10de9d55085_cgraph">
<area shape="rect" title="Update atmospheric properties through interparcel mixing." alt="" coords="5,31,113,57"/>
<area shape="rect" href="mptrac_8c.html#a433c00a5ba68e33cc6ac08ee2217a76f" title="Perform subgrid&#45;scale interparcel mixing of a given quantity." alt="" coords="161,31,300,57"/>
<area shape="rect" href="mptrac_8c.html#a90bdbbffe8b8633d84a48d2ddd311180" title="Computes a weighting factor based on tropopause pressure." alt="" coords="348,31,444,57"/>
<area shape="rect" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692" title="Calculates the tropopause pressure based on climatological data." alt="" coords="492,31,575,57"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="627,5,701,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="623,56,705,83"/>
</map>
</div>

</div>
</div>
<a id="a433c00a5ba68e33cc6ac08ee2217a76f" name="a433c00a5ba68e33cc6ac08ee2217a76f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a433c00a5ba68e33cc6ac08ee2217a76f">&#9670;&nbsp;</a></span>module_mixing_help()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_mixing_help </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>ixs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>iys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>izs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>qnt_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>use_ensemble</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform subgrid-scale interparcel mixing of a given quantity. </p>
<p >This function computes the average of a specified quantity within each subgrid box (and optionally for each ensemble member) and applies a mixing adjustment to particle values based on the computed local mean.</p>
<p >The mixing accounts for differences in tropopause and stratosphere mixing via a weighted parameterization. It supports both ensemble and non-ensemble modes using the <code>use_ensemble</code> flag.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to control/configuration structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clim</td><td>Pointer to climatological data structure. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">atm</td><td>Pointer to atmospheric state (includes particles). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ixs</td><td>Array of x-grid indices for each particle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iys</td><td>Array of y-grid indices for each particle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">izs</td><td>Array of z-grid indices for each particle (-1 for invalid). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qnt_idx</td><td>Index of the quantity in atm-&gt;q to be mixed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">use_ensemble</td><td>Flag indicating whether to use ensemble-aware logic (0 = no, 1 = yes).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Particles with <code>izs[ip] &lt; 0</code> are excluded from mixing. </dd>
<dd>
Uses OpenACC or OpenMP for parallelism depending on compilation options. </dd>
<dd>
Requires <code>ctl-&gt;qnt_ens</code> to be valid if <code>use_ensemble</code> is true.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mingzhao Liu </dd>
<dd>
Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04367">4367</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4375</span>                          {</div>
<div class="line"><span class="lineno"> 4376</span> </div>
<div class="line"><span class="lineno"> 4377</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> np = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>;</div>
<div class="line"><span class="lineno"> 4378</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ngrid = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a073b97a29712daaee8212c8a673418bf">mixing_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6cc8f7e22a69a8fec9e11c2cd4a84644">mixing_ny</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa027a38882f39332262de958c1e8880b">mixing_nz</a>;</div>
<div class="line"><span class="lineno"> 4379</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nens = use_ensemble ? ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">nens</a> : 1;</div>
<div class="line"><span class="lineno"> 4380</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> total_grid = ngrid * nens;</div>
<div class="line"><span class="lineno"> 4381</span> </div>
<div class="line"><span class="lineno"> 4382</span>  <span class="keywordtype">double</span> *restrict <span class="keyword">const</span> cmean =</div>
<div class="line"><span class="lineno"> 4383</span>    (<span class="keywordtype">double</span> *) malloc((<span class="keywordtype">size_t</span>) total_grid * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><span class="lineno"> 4384</span>  <span class="keywordtype">int</span> *restrict <span class="keyword">const</span> count =</div>
<div class="line"><span class="lineno"> 4385</span>    (<span class="keywordtype">int</span> *) malloc((<span class="keywordtype">size_t</span>) total_grid * <span class="keyword">sizeof</span>(int));</div>
<div class="line"><span class="lineno"> 4386</span> </div>
<div class="line"><span class="lineno"> 4387</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 4388</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4389</span><span class="preprocessor">#pragma acc enter data create(cmean[0:total_grid],count[0:total_grid])</span></div>
<div class="line"><span class="lineno"> 4390</span><span class="preprocessor">#pragma acc data present(ctl,clim,atm,ixs,iys,izs,cmean,count)</span></div>
<div class="line"><span class="lineno"> 4391</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 4392</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4393</span><span class="preprocessor">#ifdef __NVCOMPILER</span></div>
<div class="line"><span class="lineno"> 4394</span><span class="preprocessor">#pragma novector</span></div>
<div class="line"><span class="lineno"> 4395</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4396</span><span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 4397</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4398</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; total_grid; i++) {</div>
<div class="line"><span class="lineno"> 4399</span>    count[i] = 0;</div>
<div class="line"><span class="lineno"> 4400</span>    cmean[i] = 0.0;</div>
<div class="line"><span class="lineno"> 4401</span>  }</div>
<div class="line"><span class="lineno"> 4402</span> </div>
<div class="line"><span class="lineno"> 4403</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 4404</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4405</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 4406</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4407</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; np; ip++)</div>
<div class="line"><span class="lineno"> 4408</span>    <span class="keywordflow">if</span> (izs[ip] &gt;= 0) {</div>
<div class="line"><span class="lineno"> 4409</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> ens = use_ensemble ? (int) atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>][ip] : 0;</div>
<div class="line"><span class="lineno"> 4410</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> idx =</div>
<div class="line"><span class="lineno"> 4411</span>        ens * ngrid + <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ixs[ip], iys[ip], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6cc8f7e22a69a8fec9e11c2cd4a84644">mixing_ny</a>, izs[ip],</div>
<div class="line"><span class="lineno"> 4412</span>                               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa027a38882f39332262de958c1e8880b">mixing_nz</a>);</div>
<div class="line"><span class="lineno"> 4413</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4414</span><span class="preprocessor">#pragma acc atomic update</span></div>
<div class="line"><span class="lineno"> 4415</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4416</span>      cmean[idx] += atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[qnt_idx][ip];</div>
<div class="line"><span class="lineno"> 4417</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4418</span><span class="preprocessor">#pragma acc atomic update</span></div>
<div class="line"><span class="lineno"> 4419</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4420</span>      count[idx]++;</div>
<div class="line"><span class="lineno"> 4421</span>    }</div>
<div class="line"><span class="lineno"> 4422</span> </div>
<div class="line"><span class="lineno"> 4423</span>  <span class="comment">/* Compute means... */</span></div>
<div class="line"><span class="lineno"> 4424</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4425</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 4426</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4427</span><span class="preprocessor">#ifdef __NVCOMPILER</span></div>
<div class="line"><span class="lineno"> 4428</span><span class="preprocessor">#pragma novector</span></div>
<div class="line"><span class="lineno"> 4429</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4430</span><span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 4431</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4432</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; total_grid; i++)</div>
<div class="line"><span class="lineno"> 4433</span>    <span class="keywordflow">if</span> (count[i] &gt; 0)</div>
<div class="line"><span class="lineno"> 4434</span>      cmean[i] /= count[i];</div>
<div class="line"><span class="lineno"> 4435</span> </div>
<div class="line"><span class="lineno"> 4436</span>  <span class="comment">/* Interparcel mixing... */</span></div>
<div class="line"><span class="lineno"> 4437</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4438</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 4439</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4440</span><span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 4441</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4442</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; np; ip++) {</div>
<div class="line"><span class="lineno"> 4443</span>    <span class="keywordflow">if</span> (izs[ip] &gt;= 0) {</div>
<div class="line"><span class="lineno"> 4444</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> ens = use_ensemble ? (int) atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>][ip] : 0;</div>
<div class="line"><span class="lineno"> 4445</span> </div>
<div class="line"><span class="lineno"> 4446</span>      <span class="keywordtype">double</span> mixparam = 1.0;</div>
<div class="line"><span class="lineno"> 4447</span>      if (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a11a33decd5490249e5251aaec901bd4c">mixing_trop</a> &lt; 1 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54e8203aaa728ca33e8db070896eec5a">mixing_strat</a> &lt; 1) {</div>
<div class="line"><span class="lineno"> 4448</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> w = <a class="code hl_function" href="mptrac_8c.html#a90bdbbffe8b8633d84a48d2ddd311180">tropo_weight</a>(clim, atm, ip);</div>
<div class="line"><span class="lineno"> 4449</span>        mixparam = w * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a11a33decd5490249e5251aaec901bd4c">mixing_trop</a> + (1.0 - w) * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54e8203aaa728ca33e8db070896eec5a">mixing_strat</a>;</div>
<div class="line"><span class="lineno"> 4450</span>      }</div>
<div class="line"><span class="lineno"> 4451</span> </div>
<div class="line"><span class="lineno"> 4452</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> idx =</div>
<div class="line"><span class="lineno"> 4453</span>        ens * ngrid + <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ixs[ip], iys[ip], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6cc8f7e22a69a8fec9e11c2cd4a84644">mixing_ny</a>, izs[ip],</div>
<div class="line"><span class="lineno"> 4454</span>                               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa027a38882f39332262de958c1e8880b">mixing_nz</a>);</div>
<div class="line"><span class="lineno"> 4455</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[qnt_idx][ip] += (cmean[idx] - atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[qnt_idx][ip]) * mixparam;</div>
<div class="line"><span class="lineno"> 4456</span>    }</div>
<div class="line"><span class="lineno"> 4457</span>  }</div>
<div class="line"><span class="lineno"> 4458</span> </div>
<div class="line"><span class="lineno"> 4459</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 4460</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4461</span><span class="preprocessor">#pragma acc exit data delete(cmean,count)</span></div>
<div class="line"><span class="lineno"> 4462</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4463</span>  free(cmean);</div>
<div class="line"><span class="lineno"> 4464</span>  free(count);</div>
<div class="line"><span class="lineno"> 4465</span>}</div>
<div class="ttc" id="astructctl__t_html_a11a33decd5490249e5251aaec901bd4c"><div class="ttname"><a href="structctl__t.html#a11a33decd5490249e5251aaec901bd4c">ctl_t::mixing_trop</a></div><div class="ttdeci">double mixing_trop</div><div class="ttdoc">Interparcel exchange parameter for mixing in the troposphere.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02784">mptrac.h:2784</a></div></div>
<div class="ttc" id="astructctl__t_html_a54e8203aaa728ca33e8db070896eec5a"><div class="ttname"><a href="structctl__t.html#a54e8203aaa728ca33e8db070896eec5a">ctl_t::mixing_strat</a></div><div class="ttdeci">double mixing_strat</div><div class="ttdoc">Interparcel exchange parameter for mixing in the stratosphere.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02787">mptrac.h:2787</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a433c00a5ba68e33cc6ac08ee2217a76f_cgraph.png" border="0" usemap="#amptrac_8h_a433c00a5ba68e33cc6ac08ee2217a76f_cgraph" alt=""/></div>
<map name="amptrac_8h_a433c00a5ba68e33cc6ac08ee2217a76f_cgraph" id="amptrac_8h_a433c00a5ba68e33cc6ac08ee2217a76f_cgraph">
<area shape="rect" title="Perform subgrid&#45;scale interparcel mixing of a given quantity." alt="" coords="5,31,144,57"/>
<area shape="rect" href="mptrac_8c.html#a90bdbbffe8b8633d84a48d2ddd311180" title="Computes a weighting factor based on tropopause pressure." alt="" coords="192,31,288,57"/>
<area shape="rect" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692" title="Calculates the tropopause pressure based on climatological data." alt="" coords="336,31,419,57"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="471,5,545,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="467,56,549,83"/>
</map>
</div>

</div>
</div>
<a id="ae27eb9636b812ae9155ac23c86856d1b" name="ae27eb9636b812ae9155ac23c86856d1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae27eb9636b812ae9155ac23c86856d1b">&#9670;&nbsp;</a></span>module_oh_chem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_oh_chem </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform hydroxyl chemistry calculations for atmospheric particles. </p>
<p >This function calculates the OH chemistry for each atmospheric particle based on the specified reaction mechanism and updates the particle quantities accordingly. The OH chemistry includes bimolecular and termolecular reactions, and the reaction rates are calculated based on the provided climatological data and atmospheric conditions. The function supports both mass and volume mixing ratio quantities for the particles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climate data structure containing climatological data. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the first meteorological data structure. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the second meteorological data structure. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the necessary meteorological and climatological data structures have been initialized and are accessible via the pointers met0, met1, and clim, respectively. </dd>
<dd>
The reaction rates are calculated based on the provided reaction mechanism and atmospheric conditions, including temperature, pressure, and the concentrations of relevant species. </dd>
<dd>
The function updates the particle quantities based on the calculated reaction rates and the specified time steps. The update can include both mass and volume mixing ratio quantities, as determined by the control structure (ctl).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04469">4469</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4475</span>              {</div>
<div class="line"><span class="lineno"> 4476</span> </div>
<div class="line"><span class="lineno"> 4477</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 4478</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_OH_CHEM&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 4479</span> </div>
<div class="line"><span class="lineno"> 4480</span>  <span class="comment">/* Check quantity flags... */</span></div>
<div class="line"><span class="lineno"> 4481</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &lt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 4482</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Module needs quantity mass or volume mixing ratio!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4483</span> </div>
<div class="line"><span class="lineno"> 4484</span>  <span class="comment">/* Parameter of SO2 correction... */</span></div>
<div class="line"><span class="lineno"> 4485</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> a = 4.71572206e-08;</div>
<div class="line"><span class="lineno"> 4486</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> b = -8.28782867e-01;</div>
<div class="line"><span class="lineno"> 4487</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> low = pow(1. / a, 1. / b);</div>
<div class="line"><span class="lineno"> 4488</span> </div>
<div class="line"><span class="lineno"> 4489</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 4490</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1,</div>
<div class="line"><span class="lineno"> 4491</span>                <span class="stringliteral">&quot;acc data present(ctl,cache,clim,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 4492</span> </div>
<div class="line"><span class="lineno"> 4493</span>    <span class="comment">/* Get temperature... */</span></div>
<div class="line"><span class="lineno"> 4494</span>    <span class="keywordtype">double</span> t;</div>
<div class="line"><span class="lineno"> 4495</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 4496</span>    <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 1);</div>
<div class="line"><span class="lineno"> 4497</span> </div>
<div class="line"><span class="lineno"> 4498</span>    <span class="comment">/* Calculate molecular density... */</span></div>
<div class="line"><span class="lineno"> 4499</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> M = <a class="code hl_define" href="mptrac_8h.html#a241767dd865cc665eeee896fb598eb9f">MOLEC_DENS</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t);</div>
<div class="line"><span class="lineno"> 4500</span> </div>
<div class="line"><span class="lineno"> 4501</span>    <span class="comment">/* Use constant reaction rate... */</span></div>
<div class="line"><span class="lineno"> 4502</span>    <span class="keywordtype">double</span> k = NAN;</div>
<div class="line"><span class="lineno"> 4503</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> == 1)</div>
<div class="line"><span class="lineno"> 4504</span>      k = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[0];</div>
<div class="line"><span class="lineno"> 4505</span> </div>
<div class="line"><span class="lineno"> 4506</span>    <span class="comment">/* Calculate bimolecular reaction rate... */</span></div>
<div class="line"><span class="lineno"> 4507</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> == 2)</div>
<div class="line"><span class="lineno"> 4508</span>      k = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[0] * exp(-ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[1] / t);</div>
<div class="line"><span class="lineno"> 4509</span> </div>
<div class="line"><span class="lineno"> 4510</span>    <span class="comment">/* Calculate termolecular reaction rate... */</span></div>
<div class="line"><span class="lineno"> 4511</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> == 3) {</div>
<div class="line"><span class="lineno"> 4512</span> </div>
<div class="line"><span class="lineno"> 4513</span>      <span class="comment">/* Calculate rate coefficient for X + OH + M -&gt; XOH + M</span></div>
<div class="line"><span class="lineno"> 4514</span><span class="comment">         (JPL Publication 19-05) ... */</span></div>
<div class="line"><span class="lineno"> 4515</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> k0 =</div>
<div class="line"><span class="lineno"> 4516</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[0] * (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[1] !=</div>
<div class="line"><span class="lineno"> 4517</span>                           0 ? pow(298. / t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[1]) : 1.);</div>
<div class="line"><span class="lineno"> 4518</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> ki =</div>
<div class="line"><span class="lineno"> 4519</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[2] * (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[3] !=</div>
<div class="line"><span class="lineno"> 4520</span>                           0 ? pow(298. / t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[3]) : 1.);</div>
<div class="line"><span class="lineno"> 4521</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> c = log10(k0 * M / ki);</div>
<div class="line"><span class="lineno"> 4522</span>      k = k0 * M / (1. + k0 * M / ki) * pow(0.6, 1. / (1. + c * c));</div>
<div class="line"><span class="lineno"> 4523</span>    }</div>
<div class="line"><span class="lineno"> 4524</span> </div>
<div class="line"><span class="lineno"> 4525</span>    <span class="comment">/* Correction factor for high SO2 concentration</span></div>
<div class="line"><span class="lineno"> 4526</span><span class="comment">       (if qnt_Cx is defined, the correction is switched on)... */</span></div>
<div class="line"><span class="lineno"> 4527</span>    <span class="keywordtype">double</span> cor = 1;</div>
<div class="line"><span class="lineno"> 4528</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae56fa1a240420b87bd2b7a0d040e6d11">qnt_Cx</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 4529</span>      cor =</div>
<div class="line"><span class="lineno"> 4530</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae56fa1a240420b87bd2b7a0d040e6d11">qnt_Cx</a>][ip] &gt;</div>
<div class="line"><span class="lineno"> 4531</span>        low ? a * pow(atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae56fa1a240420b87bd2b7a0d040e6d11">qnt_Cx</a>][ip], b) : 1;</div>
<div class="line"><span class="lineno"> 4532</span> </div>
<div class="line"><span class="lineno"> 4533</span>    <span class="comment">/* Calculate exponential decay... */</span></div>
<div class="line"><span class="lineno"> 4534</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> rate_coef =</div>
<div class="line"><span class="lineno"> 4535</span>      k * <a class="code hl_function" href="mptrac_8c.html#a9ba00889eeb600010467d8b62de94a36">clim_oh</a>(ctl, clim, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip],</div>
<div class="line"><span class="lineno"> 4536</span>                  atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]) * M * cor;</div>
<div class="line"><span class="lineno"> 4537</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux = exp(-cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * rate_coef);</div>
<div class="line"><span class="lineno"> 4538</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 4539</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9a389376b1aa37b73df1b45d1ac214d">qnt_mloss_oh</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 4540</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9a389376b1aa37b73df1b45d1ac214d">qnt_mloss_oh</a>][ip]</div>
<div class="line"><span class="lineno"> 4541</span>          += atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip] * (1 - aux);</div>
<div class="line"><span class="lineno"> 4542</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip] *= aux;</div>
<div class="line"><span class="lineno"> 4543</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 4544</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a>][ip] += rate_coef;</div>
<div class="line"><span class="lineno"> 4545</span>    }</div>
<div class="line"><span class="lineno"> 4546</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 4547</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a>][ip] *= aux;</div>
<div class="line"><span class="lineno"> 4548</span>  }</div>
<div class="line"><span class="lineno"> 4549</span>}</div>
<div class="ttc" id="astructctl__t_html_a3a6b353625c774d90aa5286e69f1fc5f"><div class="ttname"><a href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">ctl_t::oh_chem</a></div><div class="ttdeci">double oh_chem[4]</div><div class="ttdoc">Coefficients for OH reaction rate (A, E/R or k0, n, kinf, m).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02847">mptrac.h:2847</a></div></div>
<div class="ttc" id="astructctl__t_html_a81cc25ede9c434e2ac0d7e341f3113e1"><div class="ttname"><a href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">ctl_t::oh_chem_reaction</a></div><div class="ttdeci">int oh_chem_reaction</div><div class="ttdoc">Reaction type for OH chemistry (0=none, 2=bimolecular, 3=termolecular).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02844">mptrac.h:2844</a></div></div>
<div class="ttc" id="astructctl__t_html_ad9a389376b1aa37b73df1b45d1ac214d"><div class="ttname"><a href="structctl__t.html#ad9a389376b1aa37b73df1b45d1ac214d">ctl_t::qnt_mloss_oh</a></div><div class="ttdeci">int qnt_mloss_oh</div><div class="ttdoc">Quantity array index for total mass loss due to OH chemistry.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02303">mptrac.h:2303</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_ae27eb9636b812ae9155ac23c86856d1b_cgraph.png" border="0" usemap="#amptrac_8h_ae27eb9636b812ae9155ac23c86856d1b_cgraph" alt=""/></div>
<map name="amptrac_8h_ae27eb9636b812ae9155ac23c86856d1b_cgraph" id="amptrac_8h_ae27eb9636b812ae9155ac23c86856d1b_cgraph">
<area shape="rect" title="Perform hydroxyl chemistry calculations for atmospheric particles." alt="" coords="5,56,129,83"/>
<area shape="rect" href="mptrac_8c.html#a9ba00889eeb600010467d8b62de94a36" title="Calculates the hydroxyl radical (OH) concentration from climatology data, with an optional diurnal co..." alt="" coords="177,56,244,83"/>
<area shape="rect" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a" title="Interpolates monthly mean zonal mean climatological variables." alt="" coords="292,31,363,57"/>
<area shape="rect" href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="292,81,363,108"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="415,5,489,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="411,56,493,83"/>
</map>
</div>

</div>
</div>
<a id="ab8f2e9219b39e8eb46e7d5c9d8398e53" name="ab8f2e9219b39e8eb46e7d5c9d8398e53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8f2e9219b39e8eb46e7d5c9d8398e53">&#9670;&nbsp;</a></span>module_position()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_position </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the positions and pressure levels of atmospheric particles. </p>
<p >This function updates the positions and pressure levels of atmospheric particles based on the meteorological data and the specified time step. It loops over each particle in the atmospheric data structure and performs the following operations:</p><ul>
<li>Initializes variables required for interpolation.</li>
<li>Calculates modulo for longitude and latitude to ensure they remain within valid ranges.</li>
<li>Adjusts latitude if it exceeds the range [-90, 90] degrees.</li>
<li>Adjusts longitude if it exceeds the range [-180, 180] degrees.</li>
<li>Checks and adjusts pressure levels:<ul>
<li>Reflects pressure levels if they are below the minimum pressure in meteorological data.</li>
<li>Clamps pressure levels to the maximum pressure in meteorological data if they exceed a predefined threshold (300 hPa).</li>
</ul>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the first meteorological data structure. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the second meteorological data structure. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function initializes a timer to measure the execution time of the position update process. </dd>
<dd>
Position and pressure updates are performed for each particle using linear interpolation. </dd>
<dd>
Longitude and latitude are adjusted to ensure they remain within valid ranges. </dd>
<dd>
Pressure levels are adjusted based on meteorological data and a predefined threshold.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04553">4553</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4557</span>              {</div>
<div class="line"><span class="lineno"> 4558</span> </div>
<div class="line"><span class="lineno"> 4559</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 4560</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_POSITION&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 4561</span> </div>
<div class="line"><span class="lineno"> 4562</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 4563</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 4564</span> </div>
<div class="line"><span class="lineno"> 4565</span>    <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 4566</span>    <span class="keywordtype">double</span> ps;</div>
<div class="line"><span class="lineno"> 4567</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 4568</span> </div>
<div class="line"><span class="lineno"> 4569</span>    <span class="comment">/* Calculate modulo... */</span></div>
<div class="line"><span class="lineno"> 4570</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] = <a class="code hl_define" href="mptrac_8h.html#aff4e721b49a057c4e4a3a6f56cc06469">FMOD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], 360.);</div>
<div class="line"><span class="lineno"> 4571</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] = <a class="code hl_define" href="mptrac_8h.html#aff4e721b49a057c4e4a3a6f56cc06469">FMOD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], 360.);</div>
<div class="line"><span class="lineno"> 4572</span> </div>
<div class="line"><span class="lineno"> 4573</span>    <span class="comment">/* Check latitude... */</span></div>
<div class="line"><span class="lineno"> 4574</span>    <span class="keywordflow">while</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] &lt; -90 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] &gt; 90) {</div>
<div class="line"><span class="lineno"> 4575</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] &gt; 90) {</div>
<div class="line"><span class="lineno"> 4576</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] = 180 - atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip];</div>
<div class="line"><span class="lineno"> 4577</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] += 180;</div>
<div class="line"><span class="lineno"> 4578</span>      }</div>
<div class="line"><span class="lineno"> 4579</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] &lt; -90) {</div>
<div class="line"><span class="lineno"> 4580</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] = -180 - atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip];</div>
<div class="line"><span class="lineno"> 4581</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] += 180;</div>
<div class="line"><span class="lineno"> 4582</span>      }</div>
<div class="line"><span class="lineno"> 4583</span>    }</div>
<div class="line"><span class="lineno"> 4584</span> </div>
<div class="line"><span class="lineno"> 4585</span>    <span class="comment">/* Check longitude... */</span></div>
<div class="line"><span class="lineno"> 4586</span>    <span class="keywordflow">while</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] &lt; -180)</div>
<div class="line"><span class="lineno"> 4587</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] += 360;</div>
<div class="line"><span class="lineno"> 4588</span>    <span class="keywordflow">while</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] &gt;= 180)</div>
<div class="line"><span class="lineno"> 4589</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] -= 360;</div>
<div class="line"><span class="lineno"> 4590</span> </div>
<div class="line"><span class="lineno"> 4591</span>    <span class="comment">/* Check pressure... */</span></div>
<div class="line"><span class="lineno"> 4592</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &lt; met0-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[met0-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1]) {</div>
<div class="line"><span class="lineno"> 4593</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] = met0-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[met0-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1];</div>
<div class="line"><span class="lineno"> 4594</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &gt; 300.) {</div>
<div class="line"><span class="lineno"> 4595</span>      <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(ps, 1);</div>
<div class="line"><span class="lineno"> 4596</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &gt; ps)</div>
<div class="line"><span class="lineno"> 4597</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] = ps;</div>
<div class="line"><span class="lineno"> 4598</span>    }</div>
<div class="line"><span class="lineno"> 4599</span>  }</div>
<div class="line"><span class="lineno"> 4600</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9430c769e61661f2da526feb29d2d032" name="a9430c769e61661f2da526feb29d2d032"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9430c769e61661f2da526feb29d2d032">&#9670;&nbsp;</a></span>module_rng_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_rng_init </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ntask</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize random number generators for parallel tasks. </p>
<p >This function initializes random number generators for parallel tasks using both GSL (GNU Scientific Library) and cuRAND (NVIDIA CUDA Random Number Generation Library) if available. It sets up GSL random number generators for each OpenMP thread and initializes them with unique seeds. For cuRAND, it creates a pseudo-random number generator and sets its seed. The initialization ensures that each task or thread has its own independent random number generator to prevent interference between parallel executions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ntask</td><td>The number of tasks or parallel threads for which random number generators are initialized.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function must be called before using any random number generation functions to ensure proper initialization of random number generators. </dd>
<dd>
GSL random number generators are initialized for each OpenMP thread, while cuRAND is initialized for the entire task set. </dd>
<dd>
If cuRAND is not available (CURAND macro not defined), the cuRAND initialization section is skipped. </dd>
<dd>
Random number generators are allocated and seeded uniquely for each task or thread to ensure independence and avoid interference between parallel executions.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04604">4604</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4605</span>                   {</div>
<div class="line"><span class="lineno"> 4606</span> </div>
<div class="line"><span class="lineno"> 4607</span>  <span class="comment">/* Initialize GSL random number generators... */</span></div>
<div class="line"><span class="lineno"> 4608</span>  gsl_rng_env_setup();</div>
<div class="line"><span class="lineno"> 4609</span>  <span class="keywordflow">if</span> (omp_get_max_threads() &gt; <a class="code hl_define" href="mptrac_8h.html#a51ca9914034cd3e92903476fd4eebbd6">NTHREADS</a>)</div>
<div class="line"><span class="lineno"> 4610</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many threads!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4611</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="mptrac_8h.html#a51ca9914034cd3e92903476fd4eebbd6">NTHREADS</a>; i++) {</div>
<div class="line"><span class="lineno"> 4612</span>    rng[i] = gsl_rng_alloc(gsl_rng_default);</div>
<div class="line"><span class="lineno"> 4613</span>    gsl_rng_set(rng[i], gsl_rng_default_seed</div>
<div class="line"><span class="lineno"> 4614</span>                + (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>) (ntask * <a class="code hl_define" href="mptrac_8h.html#a51ca9914034cd3e92903476fd4eebbd6">NTHREADS</a> + i));</div>
<div class="line"><span class="lineno"> 4615</span>  }</div>
<div class="line"><span class="lineno"> 4616</span> </div>
<div class="line"><span class="lineno"> 4617</span>  <span class="comment">/* Initialize cuRAND random number generators... */</span></div>
<div class="line"><span class="lineno"> 4618</span><span class="preprocessor">#ifdef CURAND</span></div>
<div class="line"><span class="lineno"> 4619</span>  <span class="keywordflow">if</span> (curandCreateGenerator(&amp;rng_curand, CURAND_RNG_PSEUDO_DEFAULT) !=</div>
<div class="line"><span class="lineno"> 4620</span>      CURAND_STATUS_SUCCESS)</div>
<div class="line"><span class="lineno"> 4621</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create random number generator!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4622</span>  <span class="keywordflow">if</span> (curandSetPseudoRandomGeneratorSeed(rng_curand, ntask) !=</div>
<div class="line"><span class="lineno"> 4623</span>      CURAND_STATUS_SUCCESS)</div>
<div class="line"><span class="lineno"> 4624</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot set seed for random number generator!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4625</span>  <span class="keywordflow">if</span> (curandSetStream</div>
<div class="line"><span class="lineno"> 4626</span>      (rng_curand,</div>
<div class="line"><span class="lineno"> 4627</span>       (cudaStream_t) acc_get_cuda_stream(acc_async_sync)) !=</div>
<div class="line"><span class="lineno"> 4628</span>      CURAND_STATUS_SUCCESS)</div>
<div class="line"><span class="lineno"> 4629</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot set stream for random number generator!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4630</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4631</span>}</div>
<div class="ttc" id="amptrac_8h_html_a51ca9914034cd3e92903476fd4eebbd6"><div class="ttname"><a href="mptrac_8h.html#a51ca9914034cd3e92903476fd4eebbd6">NTHREADS</a></div><div class="ttdeci">#define NTHREADS</div><div class="ttdoc">Maximum number of OpenMP threads.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00333">mptrac.h:333</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aab313e4929e7379aca2aee1ee36873d9" name="aab313e4929e7379aca2aee1ee36873d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab313e4929e7379aca2aee1ee36873d9">&#9670;&nbsp;</a></span>module_rng()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_rng </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate random numbers using various methods and distributions. </p>
<p >This function generates random numbers using different methods and distributions based on the specified method and random number generator type. It supports uniform and normal distributions and can utilize GSL, Squares (Widynski, 2022), or cuRAND random number generators.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing parameters and settings. </td></tr>
    <tr><td class="paramname">rs</td><td>Pointer to the array where the generated random numbers will be stored. </td></tr>
    <tr><td class="paramname">n</td><td>The number of random numbers to generate. </td></tr>
    <tr><td class="paramname">method</td><td>The method for generating random numbers:<ul>
<li>0: Uniform distribution</li>
<li>1: Normal distribution</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function selects the appropriate random number generator based on the specified method and the random number generator type defined in the control structure (ctl-&gt;rng_type). </dd>
<dd>
For uniform distribution, the generated random numbers are in the range [0, 1). </dd>
<dd>
For normal distribution, the Box-Muller transform is used to generate pairs of random numbers and transform them into a normal distribution. </dd>
<dd>
If cuRAND is not available (CURAND macro not defined), the function returns an error message.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04635">4635</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4639</span>                    {</div>
<div class="line"><span class="lineno"> 4640</span> </div>
<div class="line"><span class="lineno"> 4641</span>  <span class="comment">/* Use GSL random number generators... */</span></div>
<div class="line"><span class="lineno"> 4642</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a42c9413e93cc78f0e6ad427693a4e796">rng_type</a> == 0) {</div>
<div class="line"><span class="lineno"> 4643</span> </div>
<div class="line"><span class="lineno"> 4644</span>    <span class="comment">/* Uniform distribution... */</span></div>
<div class="line"><span class="lineno"> 4645</span>    <span class="keywordflow">if</span> (method == 0) {</div>
<div class="line"><span class="lineno"> 4646</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 4647</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i)</div>
<div class="line"><span class="lineno"> 4648</span>        rs[i] = gsl_rng_uniform(rng[omp_get_thread_num()]);</div>
<div class="line"><span class="lineno"> 4649</span>    }</div>
<div class="line"><span class="lineno"> 4650</span> </div>
<div class="line"><span class="lineno"> 4651</span>    <span class="comment">/* Normal distribution... */</span></div>
<div class="line"><span class="lineno"> 4652</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (method == 1) {</div>
<div class="line"><span class="lineno"> 4653</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 4654</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i)</div>
<div class="line"><span class="lineno"> 4655</span>        rs[i] = gsl_ran_gaussian_ziggurat(rng[omp_get_thread_num()], 1.0);</div>
<div class="line"><span class="lineno"> 4656</span>    }</div>
<div class="line"><span class="lineno"> 4657</span> </div>
<div class="line"><span class="lineno"> 4658</span>    <span class="comment">/* Update of random numbers on device... */</span></div>
<div class="line"><span class="lineno"> 4659</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4660</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_DEVICE&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 4661</span><span class="preprocessor">#pragma acc update device(rs[:n])</span></div>
<div class="line"><span class="lineno"> 4662</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4663</span>  }</div>
<div class="line"><span class="lineno"> 4664</span> </div>
<div class="line"><span class="lineno"> 4665</span>  <span class="comment">/* Use Squares random number generator (Widynski, 2022)... */</span></div>
<div class="line"><span class="lineno"> 4666</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a42c9413e93cc78f0e6ad427693a4e796">rng_type</a> == 1) {</div>
<div class="line"><span class="lineno"> 4667</span> </div>
<div class="line"><span class="lineno"> 4668</span>    <span class="comment">/* Set key (don&#39;t change this!)... */</span></div>
<div class="line"><span class="lineno"> 4669</span>    <span class="keyword">const</span> uint64_t key = 0xc8e4fd154ce32f6d;</div>
<div class="line"><span class="lineno"> 4670</span> </div>
<div class="line"><span class="lineno"> 4671</span>    <span class="comment">/* Uniform distribution... */</span></div>
<div class="line"><span class="lineno"> 4672</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4673</span><span class="preprocessor">#pragma acc data present(rs)</span></div>
<div class="line"><span class="lineno"> 4674</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 4675</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4676</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 4677</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4678</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n + 1; ++i) {</div>
<div class="line"><span class="lineno"> 4679</span>      uint64_t r, t, x, y, z;</div>
<div class="line"><span class="lineno"> 4680</span>      y = x = (rng_ctr + i) * key;</div>
<div class="line"><span class="lineno"> 4681</span>      z = y + key;</div>
<div class="line"><span class="lineno"> 4682</span>      x = x * x + y;</div>
<div class="line"><span class="lineno"> 4683</span>      x = (x &gt;&gt; 32) | (x &lt;&lt; 32);</div>
<div class="line"><span class="lineno"> 4684</span>      x = x * x + z;</div>
<div class="line"><span class="lineno"> 4685</span>      x = (x &gt;&gt; 32) | (x &lt;&lt; 32);</div>
<div class="line"><span class="lineno"> 4686</span>      x = x * x + y;</div>
<div class="line"><span class="lineno"> 4687</span>      x = (x &gt;&gt; 32) | (x &lt;&lt; 32);</div>
<div class="line"><span class="lineno"> 4688</span>      t = x = x * x + z;</div>
<div class="line"><span class="lineno"> 4689</span>      x = (x &gt;&gt; 32) | (x &lt;&lt; 32);</div>
<div class="line"><span class="lineno"> 4690</span>      r = t ^ ((x * x + y) &gt;&gt; 32);</div>
<div class="line"><span class="lineno"> 4691</span>      rs[i] = (double) r / (<span class="keywordtype">double</span>) UINT64_MAX;</div>
<div class="line"><span class="lineno"> 4692</span>    }</div>
<div class="line"><span class="lineno"> 4693</span>    rng_ctr += n + 1;</div>
<div class="line"><span class="lineno"> 4694</span> </div>
<div class="line"><span class="lineno"> 4695</span>    <span class="comment">/* Normal distribution... */</span></div>
<div class="line"><span class="lineno"> 4696</span>    <span class="keywordflow">if</span> (method == 1) {</div>
<div class="line"><span class="lineno"> 4697</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4698</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 4699</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4700</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 4701</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4702</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; i += 2) {</div>
<div class="line"><span class="lineno"> 4703</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> r = sqrt(-2.0 * log(rs[i]));</div>
<div class="line"><span class="lineno"> 4704</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> phi = 2.0 * M_PI * rs[i + 1];</div>
<div class="line"><span class="lineno"> 4705</span>        rs[i] = r * cosf((<span class="keywordtype">float</span>) phi);</div>
<div class="line"><span class="lineno"> 4706</span>        rs[i + 1] = r * sinf((<span class="keywordtype">float</span>) phi);</div>
<div class="line"><span class="lineno"> 4707</span>      }</div>
<div class="line"><span class="lineno"> 4708</span>    }</div>
<div class="line"><span class="lineno"> 4709</span>  }</div>
<div class="line"><span class="lineno"> 4710</span> </div>
<div class="line"><span class="lineno"> 4711</span>  <span class="comment">/* Use cuRAND random number generators... */</span></div>
<div class="line"><span class="lineno"> 4712</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a42c9413e93cc78f0e6ad427693a4e796">rng_type</a> == 2) {</div>
<div class="line"><span class="lineno"> 4713</span><span class="preprocessor">#ifdef CURAND</span></div>
<div class="line"><span class="lineno"> 4714</span><span class="preprocessor">#pragma acc host_data use_device(rs)</span></div>
<div class="line"><span class="lineno"> 4715</span>    {</div>
<div class="line"><span class="lineno"> 4716</span> </div>
<div class="line"><span class="lineno"> 4717</span>      <span class="comment">/* Uniform distribution... */</span></div>
<div class="line"><span class="lineno"> 4718</span>      <span class="keywordflow">if</span> (method == 0) {</div>
<div class="line"><span class="lineno"> 4719</span>        <span class="keywordflow">if</span> (curandGenerateUniformDouble(rng_curand, rs, (n &lt; 4 ? 4 : n)) !=</div>
<div class="line"><span class="lineno"> 4720</span>            CURAND_STATUS_SUCCESS)</div>
<div class="line"><span class="lineno"> 4721</span>          <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create random numbers!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4722</span>      }</div>
<div class="line"><span class="lineno"> 4723</span> </div>
<div class="line"><span class="lineno"> 4724</span>      <span class="comment">/* Normal distribution... */</span></div>
<div class="line"><span class="lineno"> 4725</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (method == 1) {</div>
<div class="line"><span class="lineno"> 4726</span>        <span class="keywordflow">if</span> (curandGenerateNormalDouble</div>
<div class="line"><span class="lineno"> 4727</span>            (rng_curand, rs, (n &lt; 4 ? 4 : n), 0.0,</div>
<div class="line"><span class="lineno"> 4728</span>             1.0) != CURAND_STATUS_SUCCESS)</div>
<div class="line"><span class="lineno"> 4729</span>          <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create random numbers!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4730</span>      }</div>
<div class="line"><span class="lineno"> 4731</span>    }</div>
<div class="line"><span class="lineno"> 4732</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4733</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MPTRAC was compiled without cuRAND!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4734</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4735</span>  }</div>
<div class="line"><span class="lineno"> 4736</span>}</div>
<div class="ttc" id="astructctl__t_html_a42c9413e93cc78f0e6ad427693a4e796"><div class="ttname"><a href="structctl__t.html#a42c9413e93cc78f0e6ad427693a4e796">ctl_t::rng_type</a></div><div class="ttdeci">int rng_type</div><div class="ttdoc">Random number generator (0=GSL, 1=Squares, 2=cuRAND).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02652">mptrac.h:2652</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cdd8f72190aa0901f08f48afc240ee1" name="a6cdd8f72190aa0901f08f48afc240ee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cdd8f72190aa0901f08f48afc240ee1">&#9670;&nbsp;</a></span>module_sedi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_sedi </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulate sedimentation of particles in the atmosphere. </p>
<p >This function calculates the sedimentation velocity of particles based on atmospheric pressure, temperature, and particle properties such as radius and density. It then updates the pressure of each particle based on the sedimentation velocity and the specified time step.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing parameters and settings. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data at the current time step. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the meteorological data at the next time step. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The sedimentation velocity is calculated using the <code>sedi</code> function, which takes atmospheric pressure, temperature, particle radius, and particle density as inputs. </dd>
<dd>
The pressure change for each particle is calculated based on the sedimentation velocity and the specified time step using the <code>DZ2DP</code> function.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04740">4740</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4745</span>              {</div>
<div class="line"><span class="lineno"> 4746</span> </div>
<div class="line"><span class="lineno"> 4747</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 4748</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_SEDI&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 4749</span> </div>
<div class="line"><span class="lineno"> 4750</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 4751</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(ctl,cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 4752</span> </div>
<div class="line"><span class="lineno"> 4753</span>    <span class="comment">/* Get temperature... */</span></div>
<div class="line"><span class="lineno"> 4754</span>    <span class="keywordtype">double</span> t;</div>
<div class="line"><span class="lineno"> 4755</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 4756</span>    <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 1);</div>
<div class="line"><span class="lineno"> 4757</span> </div>
<div class="line"><span class="lineno"> 4758</span>    <span class="comment">/* Sedimentation velocity... */</span></div>
<div class="line"><span class="lineno"> 4759</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> v_s = <a class="code hl_function" href="mptrac_8c.html#a1b580107362b559d90f6766d340cc370">sedi</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54a37ca01ed5643d41ee63768e5ad941">qnt_rp</a>][ip],</div>
<div class="line"><span class="lineno"> 4760</span>                            atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a08ad320f9953658f5346a123ba03ad86">qnt_rhop</a>][ip]);</div>
<div class="line"><span class="lineno"> 4761</span> </div>
<div class="line"><span class="lineno"> 4762</span>    <span class="comment">/* Calculate pressure change... */</span></div>
<div class="line"><span class="lineno"> 4763</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] += <a class="code hl_define" href="mptrac_8h.html#a8d7cc5a9d3263cea4b432e83ab58c286">DZ2DP</a>(v_s * cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] / 1000., atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]);</div>
<div class="line"><span class="lineno"> 4764</span>  }</div>
<div class="line"><span class="lineno"> 4765</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a6cdd8f72190aa0901f08f48afc240ee1_cgraph.png" border="0" usemap="#amptrac_8h_a6cdd8f72190aa0901f08f48afc240ee1_cgraph" alt=""/></div>
<map name="amptrac_8h_a6cdd8f72190aa0901f08f48afc240ee1_cgraph" id="amptrac_8h_a6cdd8f72190aa0901f08f48afc240ee1_cgraph">
<area shape="rect" title="Simulate sedimentation of particles in the atmosphere." alt="" coords="5,5,100,32"/>
<area shape="rect" href="mptrac_8c.html#a1b580107362b559d90f6766d340cc370" title="Calculates the sedimentation velocity of a particle in air." alt="" coords="148,5,195,32"/>
</map>
</div>

</div>
</div>
<a id="ac9a4606b5ab8abb85a6f4b833e9f13f2" name="ac9a4606b5ab8abb85a6f4b833e9f13f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a4606b5ab8abb85a6f4b833e9f13f2">&#9670;&nbsp;</a></span>module_sort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_sort </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sort particles according to box index. </p>
<p >This function sorts particles within the atmosphere data structure based on their geographical coordinates (longitude and latitude) and pressure level. It allocates temporary arrays to store indices and auxiliary data for sorting, then performs the sorting operation. After sorting, it updates the order of particles in the atmosphere data structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing parameters and settings. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the meteorological data at the current time step. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function utilizes the <code>locate_reg</code> and <code>locate_irr</code> functions to determine the appropriate index for sorting particles based on their longitude, latitude, and pressure level. </dd>
<dd>
Particle sorting is performed using either the Thrust library (if compiled with Thrust support) or a custom sorting algorithm. If compiled without Thrust support, an error message is displayed. </dd>
<dd>
After sorting, the function updates the order of particle-related data arrays in the atmosphere data structure to maintain consistency.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04769">4769</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4772</span>              {</div>
<div class="line"><span class="lineno"> 4773</span> </div>
<div class="line"><span class="lineno"> 4774</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 4775</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_SORT&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 4776</span> </div>
<div class="line"><span class="lineno"> 4777</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 4778</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> np = atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>;</div>
<div class="line"><span class="lineno"> 4779</span>  <span class="keywordtype">double</span> *restrict <span class="keyword">const</span> a = (<span class="keywordtype">double</span> *) malloc((<span class="keywordtype">size_t</span>) np * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><span class="lineno"> 4780</span>  <span class="keywordtype">int</span> *restrict <span class="keyword">const</span> p = (<span class="keywordtype">int</span> *) malloc((<span class="keywordtype">size_t</span>) np * <span class="keyword">sizeof</span>(int));</div>
<div class="line"><span class="lineno"> 4781</span>  <span class="keywordflow">if</span> (a == NULL || p == NULL)</div>
<div class="line"><span class="lineno"> 4782</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Out of memory!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4783</span> </div>
<div class="line"><span class="lineno"> 4784</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4785</span><span class="preprocessor">#pragma acc enter data create(a[0:np],p[0:np])</span></div>
<div class="line"><span class="lineno"> 4786</span><span class="preprocessor">#pragma acc data present(ctl,met0,atm,a,p)</span></div>
<div class="line"><span class="lineno"> 4787</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4788</span> </div>
<div class="line"><span class="lineno"> 4789</span>  <span class="comment">/* Get box index... */</span></div>
<div class="line"><span class="lineno"> 4790</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4791</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 4792</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4793</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 4794</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4795</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; np; ip++) {</div>
<div class="line"><span class="lineno"> 4796</span>    a[ip] =</div>
<div class="line"><span class="lineno"> 4797</span>      (double) ((<a class="code hl_function" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d">locate_reg</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip]) * met0-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> +</div>
<div class="line"><span class="lineno"> 4798</span>                 <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]))</div>
<div class="line"><span class="lineno"> 4799</span>                * met0-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> + <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(met0-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]));</div>
<div class="line"><span class="lineno"> 4800</span>    p[ip] = ip;</div>
<div class="line"><span class="lineno"> 4801</span>  }</div>
<div class="line"><span class="lineno"> 4802</span> </div>
<div class="line"><span class="lineno"> 4803</span>  <span class="comment">/* Sorting... */</span></div>
<div class="line"><span class="lineno"> 4804</span><span class="preprocessor">#ifdef THRUST</span></div>
<div class="line"><span class="lineno"> 4805</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4806</span><span class="preprocessor">#pragma acc host_data use_device(a,p)</span></div>
<div class="line"><span class="lineno"> 4807</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4808</span>  thrustSortWrapper(a, np, p);</div>
<div class="line"><span class="lineno"> 4809</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4810</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4811</span>  <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;GSL sort fallback not available on GPU, use THRUST!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4812</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4813</span>  gsl_sort_index((<span class="keywordtype">size_t</span> *) p, a, 1, (<span class="keywordtype">size_t</span>) np);</div>
<div class="line"><span class="lineno"> 4814</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4815</span> </div>
<div class="line"><span class="lineno"> 4816</span>  <span class="comment">/* Sort data... */</span></div>
<div class="line"><span class="lineno"> 4817</span>  <a class="code hl_function" href="mptrac_8c.html#a8540fc571513e0d8f82e268b80c6bd3b">module_sort_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, p, np);</div>
<div class="line"><span class="lineno"> 4818</span>  <a class="code hl_function" href="mptrac_8c.html#a8540fc571513e0d8f82e268b80c6bd3b">module_sort_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, p, np);</div>
<div class="line"><span class="lineno"> 4819</span>  <a class="code hl_function" href="mptrac_8c.html#a8540fc571513e0d8f82e268b80c6bd3b">module_sort_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, p, np);</div>
<div class="line"><span class="lineno"> 4820</span>  <a class="code hl_function" href="mptrac_8c.html#a8540fc571513e0d8f82e268b80c6bd3b">module_sort_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, p, np);</div>
<div class="line"><span class="lineno"> 4821</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno"> 4822</span>    <a class="code hl_function" href="mptrac_8c.html#a8540fc571513e0d8f82e268b80c6bd3b">module_sort_help</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq], p, np);</div>
<div class="line"><span class="lineno"> 4823</span> </div>
<div class="line"><span class="lineno"> 4824</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 4825</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4826</span><span class="preprocessor">#pragma acc exit data delete(a,p)</span></div>
<div class="line"><span class="lineno"> 4827</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4828</span>  free(a);</div>
<div class="line"><span class="lineno"> 4829</span>  free(p);</div>
<div class="line"><span class="lineno"> 4830</span>}</div>
<div class="ttc" id="amptrac_8c_html_a8540fc571513e0d8f82e268b80c6bd3b"><div class="ttname"><a href="mptrac_8c.html#a8540fc571513e0d8f82e268b80c6bd3b">module_sort_help</a></div><div class="ttdeci">void module_sort_help(double *a, const int *p, const int np)</div><div class="ttdoc">Reorder an array based on a given permutation.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04834">mptrac.c:4834</a></div></div>
<div class="ttc" id="astructctl__t_html_af189b70e15b3ed95191357717b80a2cc"><div class="ttname"><a href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">ctl_t::nq</a></div><div class="ttdeci">int nq</div><div class="ttdoc">Number of quantities.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02138">mptrac.h:2138</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_ac9a4606b5ab8abb85a6f4b833e9f13f2_cgraph.png" border="0" usemap="#amptrac_8h_ac9a4606b5ab8abb85a6f4b833e9f13f2_cgraph" alt=""/></div>
<map name="amptrac_8h_ac9a4606b5ab8abb85a6f4b833e9f13f2_cgraph" id="amptrac_8h_ac9a4606b5ab8abb85a6f4b833e9f13f2_cgraph">
<area shape="rect" title="Sort particles according to box index." alt="" coords="5,56,99,83"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="171,5,246,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="167,56,250,83"/>
<area shape="rect" href="mptrac_8c.html#a8540fc571513e0d8f82e268b80c6bd3b" title="Reorder an array based on a given permutation." alt="" coords="147,107,271,133"/>
</map>
</div>

</div>
</div>
<a id="a8540fc571513e0d8f82e268b80c6bd3b" name="a8540fc571513e0d8f82e268b80c6bd3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8540fc571513e0d8f82e268b80c6bd3b">&#9670;&nbsp;</a></span>module_sort_help()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_sort_help </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>np</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reorder an array based on a given permutation. </p>
<p >This function reorders the elements of a given array based on a specified permutation array. It allocates temporary memory to store the reordered elements, performs the reordering operation, and then updates the original array with the reordered elements.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Pointer to the array to be reordered. </td></tr>
    <tr><td class="paramname">p</td><td>Pointer to the permutation array defining the order of elements. </td></tr>
    <tr><td class="paramname">np</td><td>The number of elements in the array.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function utilizes temporary memory to store the reordered elements before updating the original array to prevent data loss or corruption. </dd>
<dd>
Reordering is performed based on the permutation array <code>p</code>, which defines the new order of elements in the array <code>a</code>.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04834">4834</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4837</span>                {</div>
<div class="line"><span class="lineno"> 4838</span> </div>
<div class="line"><span class="lineno"> 4839</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 4840</span>  <span class="keywordtype">double</span> *restrict <span class="keyword">const</span> help =</div>
<div class="line"><span class="lineno"> 4841</span>    (<span class="keywordtype">double</span> *) malloc((<span class="keywordtype">size_t</span>) np * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><span class="lineno"> 4842</span>  <span class="keywordflow">if</span> (help == NULL)</div>
<div class="line"><span class="lineno"> 4843</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Out of memory!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4844</span> </div>
<div class="line"><span class="lineno"> 4845</span>  <span class="comment">/* Reordering of array... */</span></div>
<div class="line"><span class="lineno"> 4846</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4847</span><span class="preprocessor">#pragma acc enter data create(help[0:np])</span></div>
<div class="line"><span class="lineno"> 4848</span><span class="preprocessor">#pragma acc data present(a,p,help)</span></div>
<div class="line"><span class="lineno"> 4849</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 4850</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4851</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 4852</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4853</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; np; ip++)</div>
<div class="line"><span class="lineno"> 4854</span>    help[ip] = a[p[ip]];</div>
<div class="line"><span class="lineno"> 4855</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4856</span><span class="preprocessor">#pragma acc parallel loop independent gang vector</span></div>
<div class="line"><span class="lineno"> 4857</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4858</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 4859</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4860</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; np; ip++)</div>
<div class="line"><span class="lineno"> 4861</span>    a[ip] = help[ip];</div>
<div class="line"><span class="lineno"> 4862</span> </div>
<div class="line"><span class="lineno"> 4863</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 4864</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 4865</span><span class="preprocessor">#pragma acc exit data delete(help)</span></div>
<div class="line"><span class="lineno"> 4866</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4867</span>  free(help);</div>
<div class="line"><span class="lineno"> 4868</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a186195c8bbbd5cac5c1f52eed531804c" name="a186195c8bbbd5cac5c1f52eed531804c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a186195c8bbbd5cac5c1f52eed531804c">&#9670;&nbsp;</a></span>module_timesteps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_timesteps </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate time steps for air parcels based on specified conditions. </p>
<p >This function calculates the time steps for air parcels based on specified conditions, including the direction of simulation, start and stop times, and a given target time. It adjusts the time step for each air parcel accordingly and checks for horizontal boundary conditions of local meteorological data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the initial meteorological data structure. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing air parcel information. </td></tr>
    <tr><td class="paramname">t</td><td>The target time for which time steps are calculated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function sets the time step for each air parcel based on its current time relative to the start and stop times of the simulation, as well as the specified target time <code>t</code>. </dd>
<dd>
It also checks for horizontal boundaries of local meteorological data and adjusts the time step accordingly if necessary.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04872">4872</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4877</span>                  {</div>
<div class="line"><span class="lineno"> 4878</span> </div>
<div class="line"><span class="lineno"> 4879</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 4880</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_TIMESTEPS&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 4881</span> </div>
<div class="line"><span class="lineno"> 4882</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> latmin = gsl_stats_min(met0-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, 1, (<span class="keywordtype">size_t</span>) met0-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>),</div>
<div class="line"><span class="lineno"> 4883</span>    latmax = gsl_stats_max(met0-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, 1, (<span class="keywordtype">size_t</span>) met0-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>);</div>
<div class="line"><span class="lineno"> 4884</span> </div>
<div class="line"><span class="lineno"> 4885</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> local =</div>
<div class="line"><span class="lineno"> 4886</span>    (fabs(met0-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[met0-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1] - met0-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[0] - 360.0) &gt;= 0.01);</div>
<div class="line"><span class="lineno"> 4887</span> </div>
<div class="line"><span class="lineno"> 4888</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 4889</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 0, <span class="stringliteral">&quot;acc data present(ctl,cache,met0,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 4890</span> </div>
<div class="line"><span class="lineno"> 4891</span>    <span class="comment">/* Set time step for each air parcel... */</span></div>
<div class="line"><span class="lineno"> 4892</span>    <span class="keywordflow">if</span> ((ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a> * (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a>) &gt;= 0</div>
<div class="line"><span class="lineno"> 4893</span>         &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a> * (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a>) &lt;= 0</div>
<div class="line"><span class="lineno"> 4894</span>         &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a> * (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] - t) &lt; 0))</div>
<div class="line"><span class="lineno"> 4895</span>      cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] = t - atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip];</div>
<div class="line"><span class="lineno"> 4896</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4897</span>      cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] = 0.0;</div>
<div class="line"><span class="lineno"> 4898</span> </div>
<div class="line"><span class="lineno"> 4899</span>    <span class="comment">/* Check horizontal boundaries of local meteo data... */</span></div>
<div class="line"><span class="lineno"> 4900</span><span class="preprocessor">#ifndef DD</span></div>
<div class="line"><span class="lineno"> 4901</span>    <span class="keywordtype">int</span> dd = 1;</div>
<div class="line"><span class="lineno"> 4902</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 4903</span>    <span class="keywordtype">int</span> dd = 0;</div>
<div class="line"><span class="lineno"> 4904</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4905</span>    <span class="keywordflow">if</span> (dd) {</div>
<div class="line"><span class="lineno"> 4906</span>      <span class="keywordflow">if</span> (local &amp;&amp; (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] &lt;= met0-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[0]</div>
<div class="line"><span class="lineno"> 4907</span>                    || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] &gt;= met0-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[met0-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1]</div>
<div class="line"><span class="lineno"> 4908</span>                    || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] &lt;= latmin || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] &gt;= latmax))</div>
<div class="line"><span class="lineno"> 4909</span>        cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] = 0.0;</div>
<div class="line"><span class="lineno"> 4910</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4911</span>      <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abb36100b62be343d46deae568209e001">qnt_subdomain</a>][ip] == -1)</div>
<div class="line"><span class="lineno"> 4912</span>        cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] = 0;</div>
<div class="line"><span class="lineno"> 4913</span>    }</div>
<div class="line"><span class="lineno"> 4914</span>  }</div>
<div class="line"><span class="lineno"> 4915</span>}</div>
<div class="ttc" id="astructctl__t_html_a1a6d5b4003ebd8f9c77b3b45933779e6"><div class="ttname"><a href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">ctl_t::direction</a></div><div class="ttdeci">int direction</div><div class="ttdoc">Direction flag (1=forward calculation, -1=backward calculation).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02441">mptrac.h:2441</a></div></div>
<div class="ttc" id="astructctl__t_html_a649752813806c995ee09923a44d0e974"><div class="ttname"><a href="structctl__t.html#a649752813806c995ee09923a44d0e974">ctl_t::t_stop</a></div><div class="ttdeci">double t_stop</div><div class="ttdoc">Stop time of simulation [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02447">mptrac.h:2447</a></div></div>
<div class="ttc" id="astructctl__t_html_abb36100b62be343d46deae568209e001"><div class="ttname"><a href="structctl__t.html#abb36100b62be343d46deae568209e001">ctl_t::qnt_subdomain</a></div><div class="ttdeci">int qnt_subdomain</div><div class="ttdoc">Quantity array index for current subdomain in domain decomposition.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02435">mptrac.h:2435</a></div></div>
<div class="ttc" id="astructctl__t_html_aee3354b4dacf5d89944ae0b7faaa12c6"><div class="ttname"><a href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">ctl_t::t_start</a></div><div class="ttdeci">double t_start</div><div class="ttdoc">Start time of simulation [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02444">mptrac.h:2444</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f42ca12ace33e1168edaaf4b96e5a60" name="a3f42ca12ace33e1168edaaf4b96e5a60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f42ca12ace33e1168edaaf4b96e5a60">&#9670;&nbsp;</a></span>module_timesteps_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_timesteps_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize start time and time interval for time-stepping. </p>
<p >This function initializes the start time and time interval for time-stepping based on the direction of simulation and the provided atmospheric data. It sets the start time according to the minimum or maximum time in the atmospheric data, depending on the simulation direction. Additionally, it checks the time interval and adjusts the start time accordingly for rounding purposes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing air parcel information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function sets the start time based on the direction of simulation and the minimum or maximum time in the atmospheric data. </dd>
<dd>
It checks the time interval to ensure that there is a valid time range for simulation and adjusts the start time for rounding purposes.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04919">4919</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4921</span>                    {</div>
<div class="line"><span class="lineno"> 4922</span> </div>
<div class="line"><span class="lineno"> 4923</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 4924</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_TIMESTEPS_INIT&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 4925</span> </div>
<div class="line"><span class="lineno"> 4926</span>  <span class="comment">/* Set start time... */</span></div>
<div class="line"><span class="lineno"> 4927</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a> == 1) {</div>
<div class="line"><span class="lineno"> 4928</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a> = gsl_stats_min(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 4929</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a> &gt; 1e99)</div>
<div class="line"><span class="lineno"> 4930</span>      ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a> = gsl_stats_max(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 4931</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4932</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a> = gsl_stats_max(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 4933</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a> &gt; 1e99)</div>
<div class="line"><span class="lineno"> 4934</span>      ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a> = gsl_stats_min(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 4935</span>  }</div>
<div class="line"><span class="lineno"> 4936</span> </div>
<div class="line"><span class="lineno"> 4937</span>  <span class="comment">/* Check time interval... */</span></div>
<div class="line"><span class="lineno"> 4938</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a> * (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a>) &lt;= 0)</div>
<div class="line"><span class="lineno"> 4939</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Nothing to do! Check T_STOP and DIRECTION!&quot;</span>);</div>
<div class="line"><span class="lineno"> 4940</span> </div>
<div class="line"><span class="lineno"> 4941</span>  <span class="comment">/* Round start time... */</span></div>
<div class="line"><span class="lineno"> 4942</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a> == 1)</div>
<div class="line"><span class="lineno"> 4943</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a> = floor(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a> / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>) * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno"> 4944</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4945</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a> = ceil(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a> / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>) * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno"> 4946</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adb66834f81688452a86c1a574bafca03" name="adb66834f81688452a86c1a574bafca03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb66834f81688452a86c1a574bafca03">&#9670;&nbsp;</a></span>module_tracer_chem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_tracer_chem </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulate chemical reactions involving long-lived atmospheric tracers. </p>
<p >This function simulates chemical reactions involving atmospheric tracers, such as CFC-10, CFC-11, CFC-12, and N2O. It calculates the change in tracer concentrations over time based on reaction rates and environmental factors such as temperature, ozone concentration, solar zenith angle, and O(1D) volume mixing ratio.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climatological data structure. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the first meteorological data structure. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the second meteorological data structure. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing particle information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the necessary control structure (ctl), climatological data structure (clim), meteorological data structures (met0, met1), and atmospheric data structure (atm) have been initialized and are accessible. </dd>
<dd>
Chemical reactions involving CFC-10, CFC-11, CFC-12, and N2O are simulated for each particle in the atmospheric data structure. </dd>
<dd>
The function calculates reaction rates based on temperature, solar zenith angle, total column ozone, and the volume mixing ratio of O(1D). </dd>
<dd>
The exponential decay of tracer concentrations due to chemical reactions is calculated using reaction rate coefficients and the time step (dt) for each particle. </dd>
<dd>
If the particle has a quantity flag for the tracer species (e.g., ctl-&gt;qnt_Cccl4, ctl-&gt;qnt_Cccl3f, ctl-&gt;qnt_Cccl2f2, ctl-&gt;qnt_Cn2o), the function updates the concentration of the tracer based on the exponential decay.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mingzhao Liu </dd>
<dd>
Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l04950">4950</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4956</span>              {</div>
<div class="line"><span class="lineno"> 4957</span> </div>
<div class="line"><span class="lineno"> 4958</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 4959</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_TRACER_CHEM&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 4960</span> </div>
<div class="line"><span class="lineno"> 4961</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 4962</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1,</div>
<div class="line"><span class="lineno"> 4963</span>                <span class="stringliteral">&quot;acc data present(ctl,cache,clim,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 4964</span> </div>
<div class="line"><span class="lineno"> 4965</span>    <span class="comment">/* Get temperature... */</span></div>
<div class="line"><span class="lineno"> 4966</span>    <span class="keywordtype">double</span> t;</div>
<div class="line"><span class="lineno"> 4967</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 4968</span>    <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 1);</div>
<div class="line"><span class="lineno"> 4969</span> </div>
<div class="line"><span class="lineno"> 4970</span>    <span class="comment">/* Get molecular density... */</span></div>
<div class="line"><span class="lineno"> 4971</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> M = <a class="code hl_define" href="mptrac_8h.html#a241767dd865cc665eeee896fb598eb9f">MOLEC_DENS</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], t);</div>
<div class="line"><span class="lineno"> 4972</span> </div>
<div class="line"><span class="lineno"> 4973</span>    <span class="comment">/* Get total column ozone... */</span></div>
<div class="line"><span class="lineno"> 4974</span>    <span class="keywordtype">double</span> o3c;</div>
<div class="line"><span class="lineno"> 4975</span>    <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(o3c, 1);</div>
<div class="line"><span class="lineno"> 4976</span> </div>
<div class="line"><span class="lineno"> 4977</span>    <span class="comment">/* Get solar zenith angle... */</span></div>
<div class="line"><span class="lineno"> 4978</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> sza =</div>
<div class="line"><span class="lineno"> 4979</span>      acos(<a class="code hl_function" href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b">cos_sza</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]));</div>
<div class="line"><span class="lineno"> 4980</span> </div>
<div class="line"><span class="lineno"> 4981</span>    <span class="comment">/* Get O(1D) volume mixing ratio... */</span></div>
<div class="line"><span class="lineno"> 4982</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> o1d =</div>
<div class="line"><span class="lineno"> 4983</span>      <a class="code hl_function" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a">clim_zm</a>(&amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a9a7486ab639da63d6ac55d6cbacdcf0e">o1d</a>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]);</div>
<div class="line"><span class="lineno"> 4984</span> </div>
<div class="line"><span class="lineno"> 4985</span>    <span class="comment">/* Reactions for CFC-10... */</span></div>
<div class="line"><span class="lineno"> 4986</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1ba53bf2909cfe859cdd8d3e6db31e9a">qnt_Cccl4</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 4987</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> K_o1d = <a class="code hl_define" href="mptrac_8h.html#ad6fd608dae29bc65e5c4ad1480f7b891">ARRHENIUS</a>(3.30e-10, 0, t) * o1d * M;</div>
<div class="line"><span class="lineno"> 4988</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> K_hv = <a class="code hl_function" href="mptrac_8c.html#a69a55a5bcd0af800ddc35cbe3b16cd15">clim_photo</a>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#a0e767d8c469bec62f4457cf1cb9312ea">photo</a>.<a class="code hl_variable" href="structclim__photo__t.html#ab827be0252e456de341c167ab5e15bab">ccl4</a>, &amp;(clim-&gt;<a class="code hl_variable" href="structclim__t.html#a0e767d8c469bec62f4457cf1cb9312ea">photo</a>),</div>
<div class="line"><span class="lineno"> 4989</span>                                     atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], sza, o3c);</div>
<div class="line"><span class="lineno"> 4990</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1ba53bf2909cfe859cdd8d3e6db31e9a">qnt_Cccl4</a>][ip] *= exp(-cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * (K_hv + K_o1d));</div>
<div class="line"><span class="lineno"> 4991</span>    }</div>
<div class="line"><span class="lineno"> 4992</span> </div>
<div class="line"><span class="lineno"> 4993</span>    <span class="comment">/* Reactions for CFC-11... */</span></div>
<div class="line"><span class="lineno"> 4994</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a43ba4811191565b719506351b40515">qnt_Cccl3f</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 4995</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> K_o1d = <a class="code hl_define" href="mptrac_8h.html#ad6fd608dae29bc65e5c4ad1480f7b891">ARRHENIUS</a>(2.30e-10, 0, t) * o1d * M;</div>
<div class="line"><span class="lineno"> 4996</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> K_hv = <a class="code hl_function" href="mptrac_8c.html#a69a55a5bcd0af800ddc35cbe3b16cd15">clim_photo</a>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#a0e767d8c469bec62f4457cf1cb9312ea">photo</a>.<a class="code hl_variable" href="structclim__photo__t.html#a6b698126dd4714ceb22e8d8c3dfdcf8e">ccl3f</a>, &amp;(clim-&gt;<a class="code hl_variable" href="structclim__t.html#a0e767d8c469bec62f4457cf1cb9312ea">photo</a>),</div>
<div class="line"><span class="lineno"> 4997</span>                                     atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], sza, o3c);</div>
<div class="line"><span class="lineno"> 4998</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a43ba4811191565b719506351b40515">qnt_Cccl3f</a>][ip] *= exp(-cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * (K_hv + K_o1d));</div>
<div class="line"><span class="lineno"> 4999</span>    }</div>
<div class="line"><span class="lineno"> 5000</span> </div>
<div class="line"><span class="lineno"> 5001</span>    <span class="comment">/* Reactions for CFC-12... */</span></div>
<div class="line"><span class="lineno"> 5002</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a066b3cab4ae3633d7f5a4cc178f8d655">qnt_Cccl2f2</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 5003</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> K_o1d = <a class="code hl_define" href="mptrac_8h.html#ad6fd608dae29bc65e5c4ad1480f7b891">ARRHENIUS</a>(1.40e-10, -25, t) * o1d * M;</div>
<div class="line"><span class="lineno"> 5004</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> K_hv = <a class="code hl_function" href="mptrac_8c.html#a69a55a5bcd0af800ddc35cbe3b16cd15">clim_photo</a>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#a0e767d8c469bec62f4457cf1cb9312ea">photo</a>.<a class="code hl_variable" href="structclim__photo__t.html#a33f019b0c8014e92822dd8e25481284a">ccl2f2</a>, &amp;(clim-&gt;<a class="code hl_variable" href="structclim__t.html#a0e767d8c469bec62f4457cf1cb9312ea">photo</a>),</div>
<div class="line"><span class="lineno"> 5005</span>                                     atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], sza, o3c);</div>
<div class="line"><span class="lineno"> 5006</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a066b3cab4ae3633d7f5a4cc178f8d655">qnt_Cccl2f2</a>][ip] *= exp(-cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * (K_hv + K_o1d));</div>
<div class="line"><span class="lineno"> 5007</span>    }</div>
<div class="line"><span class="lineno"> 5008</span> </div>
<div class="line"><span class="lineno"> 5009</span>    <span class="comment">/* Reactions for N2O... */</span></div>
<div class="line"><span class="lineno"> 5010</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a3a8cc8108f6dce4fcf6b82ceb97d22">qnt_Cn2o</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 5011</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> K_o1d = <a class="code hl_define" href="mptrac_8h.html#ad6fd608dae29bc65e5c4ad1480f7b891">ARRHENIUS</a>(1.19e-10, -20, t) * o1d * M;</div>
<div class="line"><span class="lineno"> 5012</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> K_hv = <a class="code hl_function" href="mptrac_8c.html#a69a55a5bcd0af800ddc35cbe3b16cd15">clim_photo</a>(clim-&gt;<a class="code hl_variable" href="structclim__t.html#a0e767d8c469bec62f4457cf1cb9312ea">photo</a>.<a class="code hl_variable" href="structclim__photo__t.html#a6ce3ae3dcee69c935d6db4a040d655bc">n2o</a>, &amp;(clim-&gt;<a class="code hl_variable" href="structclim__t.html#a0e767d8c469bec62f4457cf1cb9312ea">photo</a>),</div>
<div class="line"><span class="lineno"> 5013</span>                                     atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip], sza, o3c);</div>
<div class="line"><span class="lineno"> 5014</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a3a8cc8108f6dce4fcf6b82ceb97d22">qnt_Cn2o</a>][ip] *= exp(-cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * (K_hv + K_o1d));</div>
<div class="line"><span class="lineno"> 5015</span>    }</div>
<div class="line"><span class="lineno"> 5016</span>  }</div>
<div class="line"><span class="lineno"> 5017</span>}</div>
<div class="ttc" id="amptrac_8c_html_a69a55a5bcd0af800ddc35cbe3b16cd15"><div class="ttname"><a href="mptrac_8c.html#a69a55a5bcd0af800ddc35cbe3b16cd15">clim_photo</a></div><div class="ttdeci">double clim_photo(const double rate[CP][CSZA][CO3], const clim_photo_t *photo, const double p, const double sza, const double o3c)</div><div class="ttdoc">Calculates the photolysis rate for a given set of atmospheric conditions.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l00147">mptrac.c:147</a></div></div>
<div class="ttc" id="amptrac_8h_html_ad6fd608dae29bc65e5c4ad1480f7b891"><div class="ttname"><a href="mptrac_8h.html#ad6fd608dae29bc65e5c4ad1480f7b891">ARRHENIUS</a></div><div class="ttdeci">#define ARRHENIUS(a, b, t)</div><div class="ttdoc">Calculate the Arrhenius rate constant.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00483">mptrac.h:483</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_a33f019b0c8014e92822dd8e25481284a"><div class="ttname"><a href="structclim__photo__t.html#a33f019b0c8014e92822dd8e25481284a">clim_photo_t::ccl2f2</a></div><div class="ttdeci">double ccl2f2[CP][CSZA][CO3]</div><div class="ttdoc">CCl2F2 photolysis rate [1/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03281">mptrac.h:3281</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_a6b698126dd4714ceb22e8d8c3dfdcf8e"><div class="ttname"><a href="structclim__photo__t.html#a6b698126dd4714ceb22e8d8c3dfdcf8e">clim_photo_t::ccl3f</a></div><div class="ttdeci">double ccl3f[CP][CSZA][CO3]</div><div class="ttdoc">CCl3F photolysis rate [1/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03278">mptrac.h:3278</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_a6ce3ae3dcee69c935d6db4a040d655bc"><div class="ttname"><a href="structclim__photo__t.html#a6ce3ae3dcee69c935d6db4a040d655bc">clim_photo_t::n2o</a></div><div class="ttdeci">double n2o[CP][CSZA][CO3]</div><div class="ttdoc">N2O photolysis rate [1/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03272">mptrac.h:3272</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_ab827be0252e456de341c167ab5e15bab"><div class="ttname"><a href="structclim__photo__t.html#ab827be0252e456de341c167ab5e15bab">clim_photo_t::ccl4</a></div><div class="ttdeci">double ccl4[CP][CSZA][CO3]</div><div class="ttdoc">CCl4 photolysis rate [1/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03275">mptrac.h:3275</a></div></div>
<div class="ttc" id="astructclim__t_html_a0e767d8c469bec62f4457cf1cb9312ea"><div class="ttname"><a href="structclim__t.html#a0e767d8c469bec62f4457cf1cb9312ea">clim_t::photo</a></div><div class="ttdeci">clim_photo_t photo</div><div class="ttdoc">Photolysis rates.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03377">mptrac.h:3377</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_adb66834f81688452a86c1a574bafca03_cgraph.png" border="0" usemap="#amptrac_8h_adb66834f81688452a86c1a574bafca03_cgraph" alt=""/></div>
<map name="amptrac_8h_adb66834f81688452a86c1a574bafca03_cgraph" id="amptrac_8h_adb66834f81688452a86c1a574bafca03_cgraph">
<area shape="rect" title="Simulate chemical reactions involving long&#45;lived atmospheric tracers." alt="" coords="5,56,148,83"/>
<area shape="rect" href="mptrac_8c.html#a69a55a5bcd0af800ddc35cbe3b16cd15" title="Calculates the photolysis rate for a given set of atmospheric conditions." alt="" coords="196,56,281,83"/>
<area shape="rect" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a" title="Interpolates monthly mean zonal mean climatological variables." alt="" coords="203,5,274,32"/>
<area shape="rect" href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="203,107,274,133"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="333,5,408,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="329,56,412,83"/>
</map>
</div>

</div>
</div>
<a id="a5e35405aee5829cf062bd3cab20b0425" name="a5e35405aee5829cf062bd3cab20b0425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e35405aee5829cf062bd3cab20b0425">&#9670;&nbsp;</a></span>module_wet_depo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void module_wet_depo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform wet deposition calculations for air parcels. </p>
<p >This function calculates the wet deposition process for each air parcel based on provided atmospheric and meteorological data. It estimates the precipitation rate and scavenging coefficients for particles and gases inside and below cloud layers. The scavenging coefficients are used to calculate the exponential decay of mass or volume mixing ratio over time due to wet deposition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing simulation parameters. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure for temporary data and random numbers. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the initial meteorological data structure. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the updated meteorological data structure. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing air parcel information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function calculates the wet deposition process for particles and gases based on precipitation rate and scavenging coefficients inside and below cloud layers. </dd>
<dd>
It estimates the exponential decay of mass or volume mixing ratio over time due to wet deposition. </dd>
<dd>
For exponential form A and B coefficients see Bakels et al. (2024, Table B2). </dd>
<dd>
For Henry's law constants see Sander (2023) or <a href="https://henrys-law.org/">https://henrys-law.org/</a>. </dd>
<dd>
Some species (e.g. SO2) require an effective Henry constant to account not only for physical solubility in water but also for chemical reactions, such as hydrolysis and ionization, which significantly enhance dissolution in aqueous solutions.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l05021">5021</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5026</span>              {</div>
<div class="line"><span class="lineno"> 5027</span> </div>
<div class="line"><span class="lineno"> 5028</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 5029</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;MODULE_WET_DEPO&quot;</span>, <span class="stringliteral">&quot;PHYSICS&quot;</span>);</div>
<div class="line"><span class="lineno"> 5030</span> </div>
<div class="line"><span class="lineno"> 5031</span>  <span class="comment">/* Check quantity flags... */</span></div>
<div class="line"><span class="lineno"> 5032</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &lt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 5033</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Module needs quantity mass or volume mixing ratio!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5034</span> </div>
<div class="line"><span class="lineno"> 5035</span>  <span class="comment">/* Loop over particles... */</span></div>
<div class="line"><span class="lineno"> 5036</span>  <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(ctl,cache,met0,met1,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 5037</span> </div>
<div class="line"><span class="lineno"> 5038</span>    <span class="comment">/* Check whether particle is below cloud top... */</span></div>
<div class="line"><span class="lineno"> 5039</span>    <span class="keywordtype">double</span> pct;</div>
<div class="line"><span class="lineno"> 5040</span>    <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 5041</span>    <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(pct, 1);</div>
<div class="line"><span class="lineno"> 5042</span>    <span class="keywordflow">if</span> (!isfinite(pct) || atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &lt;= pct)</div>
<div class="line"><span class="lineno"> 5043</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 5044</span> </div>
<div class="line"><span class="lineno"> 5045</span>    <span class="comment">/* Get cloud bottom pressure... */</span></div>
<div class="line"><span class="lineno"> 5046</span>    <span class="keywordtype">double</span> pcb;</div>
<div class="line"><span class="lineno"> 5047</span>    <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(pcb, 0);</div>
<div class="line"><span class="lineno"> 5048</span> </div>
<div class="line"><span class="lineno"> 5049</span>    <span class="comment">/* Estimate precipitation rate (Pisso et al., 2019)... */</span></div>
<div class="line"><span class="lineno"> 5050</span>    <span class="keywordtype">double</span> cl;</div>
<div class="line"><span class="lineno"> 5051</span>    <a class="code hl_define" href="mptrac_8h.html#ab4d615b798ce84f6ee2eb42df3c90998">INTPOL_2D</a>(cl, 0);</div>
<div class="line"><span class="lineno"> 5052</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Is =</div>
<div class="line"><span class="lineno"> 5053</span>      pow(1. / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a96e4c97eb8f6a2b81d7ddb7a3ce4ae81">wet_depo_pre</a>[0] * cl, 1. / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a96e4c97eb8f6a2b81d7ddb7a3ce4ae81">wet_depo_pre</a>[1]);</div>
<div class="line"><span class="lineno"> 5054</span>    <span class="keywordflow">if</span> (Is &lt; 0.01)</div>
<div class="line"><span class="lineno"> 5055</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 5056</span> </div>
<div class="line"><span class="lineno"> 5057</span>    <span class="comment">/* Check whether particle is inside or below cloud... */</span></div>
<div class="line"><span class="lineno"> 5058</span>    <span class="keywordtype">double</span> lwc, rwc, iwc, swc;</div>
<div class="line"><span class="lineno"> 5059</span>    <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(lwc, 1);</div>
<div class="line"><span class="lineno"> 5060</span>    <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(rwc, 0);</div>
<div class="line"><span class="lineno"> 5061</span>    <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(iwc, 0);</div>
<div class="line"><span class="lineno"> 5062</span>    <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(swc, 0);</div>
<div class="line"><span class="lineno"> 5063</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> inside = (lwc &gt; 0 || rwc &gt; 0 || iwc &gt; 0 || swc &gt; 0);</div>
<div class="line"><span class="lineno"> 5064</span> </div>
<div class="line"><span class="lineno"> 5065</span>    <span class="comment">/* Get temperature... */</span></div>
<div class="line"><span class="lineno"> 5066</span>    <span class="keywordtype">double</span> t;</div>
<div class="line"><span class="lineno"> 5067</span>    <a class="code hl_define" href="mptrac_8h.html#a48e10ecee070acb7be2df6a8ca3d9764">INTPOL_3D</a>(t, 0);</div>
<div class="line"><span class="lineno"> 5068</span> </div>
<div class="line"><span class="lineno"> 5069</span>    <span class="comment">/* Calculate in-cloud scavenging coefficient... */</span></div>
<div class="line"><span class="lineno"> 5070</span>    <span class="keywordtype">double</span> lambda = 0;</div>
<div class="line"><span class="lineno"> 5071</span>    <span class="keywordflow">if</span> (inside) {</div>
<div class="line"><span class="lineno"> 5072</span> </div>
<div class="line"><span class="lineno"> 5073</span>      <span class="comment">/* Calculate retention factor... */</span></div>
<div class="line"><span class="lineno"> 5074</span>      <span class="keywordtype">double</span> eta;</div>
<div class="line"><span class="lineno"> 5075</span>      <span class="keywordflow">if</span> (t &gt; 273.15)</div>
<div class="line"><span class="lineno"> 5076</span>        eta = 1;</div>
<div class="line"><span class="lineno"> 5077</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t &lt;= 238.15)</div>
<div class="line"><span class="lineno"> 5078</span>        eta = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adfd76ffde125821097d58b4b3978a355">wet_depo_ic_ret_ratio</a>;</div>
<div class="line"><span class="lineno"> 5079</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5080</span>        eta = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(273.15, 1, 238.15, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adfd76ffde125821097d58b4b3978a355">wet_depo_ic_ret_ratio</a>, t);</div>
<div class="line"><span class="lineno"> 5081</span> </div>
<div class="line"><span class="lineno"> 5082</span>      <span class="comment">/* Use exponential dependency for particles (Bakels et al., 2024)... */</span></div>
<div class="line"><span class="lineno"> 5083</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a032306df4b235c20af95d5b30edc694a">wet_depo_ic_a</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 5084</span>        lambda = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a032306df4b235c20af95d5b30edc694a">wet_depo_ic_a</a> * pow(Is, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae48763f1caad155cb48c8bcb536061c0">wet_depo_ic_b</a>) * eta;</div>
<div class="line"><span class="lineno"> 5085</span> </div>
<div class="line"><span class="lineno"> 5086</span>      <span class="comment">/* Use Henry&#39;s law for gases... */</span></div>
<div class="line"><span class="lineno"> 5087</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] &gt; 0) {</div>
<div class="line"><span class="lineno"> 5088</span> </div>
<div class="line"><span class="lineno"> 5089</span>        <span class="comment">/* Get Henry&#39;s constant (Burkholder et al., 2019; Sander, 2023)... */</span></div>
<div class="line"><span class="lineno"> 5090</span>        <span class="keywordtype">double</span> h = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0]</div>
<div class="line"><span class="lineno"> 5091</span>          * exp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] * (1. / t - 1. / 298.15));</div>
<div class="line"><span class="lineno"> 5092</span> </div>
<div class="line"><span class="lineno"> 5093</span>        <span class="comment">/* Use effective Henry&#39;s constant for SO2</span></div>
<div class="line"><span class="lineno"> 5094</span><span class="comment">           (Berglen, 2004; Simpson, 2012)... */</span></div>
<div class="line"><span class="lineno"> 5095</span>        <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5ac7339d5350bb6d64df67a8df70c4b8">wet_depo_so2_ph</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 5096</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> H_ion = pow(10., -ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5ac7339d5350bb6d64df67a8df70c4b8">wet_depo_so2_ph</a>);</div>
<div class="line"><span class="lineno"> 5097</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> K_1 = 1.23e-2 * exp(2.01e3 * (1. / t - 1. / 298.15));</div>
<div class="line"><span class="lineno"> 5098</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> K_2 = 6e-8 * exp(1.12e3 * (1. / t - 1. / 298.15));</div>
<div class="line"><span class="lineno"> 5099</span>          h *= (1. + K_1 / H_ion + K_1 * K_2 / <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(H_ion));</div>
<div class="line"><span class="lineno"> 5100</span>        }</div>
<div class="line"><span class="lineno"> 5101</span> </div>
<div class="line"><span class="lineno"> 5102</span>        <span class="comment">/* Estimate depth of cloud layer... */</span></div>
<div class="line"><span class="lineno"> 5103</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> dz = 1e3 * (<a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(pct) - <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(pcb));</div>
<div class="line"><span class="lineno"> 5104</span> </div>
<div class="line"><span class="lineno"> 5105</span>        <span class="comment">/* Calculate scavenging coefficient... */</span></div>
<div class="line"><span class="lineno"> 5106</span>        lambda = h * <a class="code hl_define" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> * t * Is / 3.6e6 / dz * eta;</div>
<div class="line"><span class="lineno"> 5107</span>      }</div>
<div class="line"><span class="lineno"> 5108</span>    }</div>
<div class="line"><span class="lineno"> 5109</span> </div>
<div class="line"><span class="lineno"> 5110</span>    <span class="comment">/* Calculate below-cloud scavenging coefficient... */</span></div>
<div class="line"><span class="lineno"> 5111</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5112</span> </div>
<div class="line"><span class="lineno"> 5113</span>      <span class="comment">/* Calculate retention factor... */</span></div>
<div class="line"><span class="lineno"> 5114</span>      <span class="keywordtype">double</span> eta;</div>
<div class="line"><span class="lineno"> 5115</span>      <span class="keywordflow">if</span> (t &gt; 270)</div>
<div class="line"><span class="lineno"> 5116</span>        eta = 1;</div>
<div class="line"><span class="lineno"> 5117</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5118</span>        eta = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac2b6871df347638e7154410038690871">wet_depo_bc_ret_ratio</a>;</div>
<div class="line"><span class="lineno"> 5119</span> </div>
<div class="line"><span class="lineno"> 5120</span>      <span class="comment">/* Use exponential dependency for particles (Bakels et al., 2024)... */</span></div>
<div class="line"><span class="lineno"> 5121</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1550c0159a3a3374a1ebccef46604ad8">wet_depo_bc_a</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 5122</span>        lambda = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1550c0159a3a3374a1ebccef46604ad8">wet_depo_bc_a</a> * pow(Is, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae49e5d87420514bf64f3150e75c8b07f">wet_depo_bc_b</a>) * eta;</div>
<div class="line"><span class="lineno"> 5123</span> </div>
<div class="line"><span class="lineno"> 5124</span>      <span class="comment">/* Use Henry&#39;s law for gases... */</span></div>
<div class="line"><span class="lineno"> 5125</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] &gt; 0) {</div>
<div class="line"><span class="lineno"> 5126</span> </div>
<div class="line"><span class="lineno"> 5127</span>        <span class="comment">/* Get Henry&#39;s constant (Burkholder et al., 2019; Sander, 2023)... */</span></div>
<div class="line"><span class="lineno"> 5128</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> h = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0]</div>
<div class="line"><span class="lineno"> 5129</span>          * exp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] * (1. / t - 1. / 298.15));</div>
<div class="line"><span class="lineno"> 5130</span> </div>
<div class="line"><span class="lineno"> 5131</span>        <span class="comment">/* Estimate depth of cloud layer... */</span></div>
<div class="line"><span class="lineno"> 5132</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> dz = 1e3 * (<a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(pct) - <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(pcb));</div>
<div class="line"><span class="lineno"> 5133</span> </div>
<div class="line"><span class="lineno"> 5134</span>        <span class="comment">/* Calculate scavenging coefficient... */</span></div>
<div class="line"><span class="lineno"> 5135</span>        lambda = h * <a class="code hl_define" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> * t * Is / 3.6e6 / dz * eta;</div>
<div class="line"><span class="lineno"> 5136</span>      }</div>
<div class="line"><span class="lineno"> 5137</span>    }</div>
<div class="line"><span class="lineno"> 5138</span> </div>
<div class="line"><span class="lineno"> 5139</span>    <span class="comment">/* Calculate exponential decay of mass... */</span></div>
<div class="line"><span class="lineno"> 5140</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> aux = exp(-cache-&gt;<a class="code hl_variable" href="structcache__t.html#a2ea05d5c51e9149cac55020d5c1b8c92">dt</a>[ip] * lambda);</div>
<div class="line"><span class="lineno"> 5141</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 5142</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a402ce921786cefb5ce431bda7dbf7f3c">qnt_mloss_wet</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 5143</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a402ce921786cefb5ce431bda7dbf7f3c">qnt_mloss_wet</a>][ip]</div>
<div class="line"><span class="lineno"> 5144</span>          += atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip] * (1 - aux);</div>
<div class="line"><span class="lineno"> 5145</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip] *= aux;</div>
<div class="line"><span class="lineno"> 5146</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 5147</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a>][ip] += lambda;</div>
<div class="line"><span class="lineno"> 5148</span>    }</div>
<div class="line"><span class="lineno"> 5149</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 5150</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a>][ip] *= aux;</div>
<div class="line"><span class="lineno"> 5151</span>  }</div>
<div class="line"><span class="lineno"> 5152</span>}</div>
<div class="ttc" id="astructctl__t_html_a032306df4b235c20af95d5b30edc694a"><div class="ttname"><a href="structctl__t.html#a032306df4b235c20af95d5b30edc694a">ctl_t::wet_depo_ic_a</a></div><div class="ttdeci">double wet_depo_ic_a</div><div class="ttdoc">Coefficient A for wet deposition in cloud (exponential form).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02874">mptrac.h:2874</a></div></div>
<div class="ttc" id="astructctl__t_html_a1550c0159a3a3374a1ebccef46604ad8"><div class="ttname"><a href="structctl__t.html#a1550c0159a3a3374a1ebccef46604ad8">ctl_t::wet_depo_bc_a</a></div><div class="ttdeci">double wet_depo_bc_a</div><div class="ttdoc">Coefficient A for wet deposition below cloud (exponential form).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02868">mptrac.h:2868</a></div></div>
<div class="ttc" id="astructctl__t_html_a402ce921786cefb5ce431bda7dbf7f3c"><div class="ttname"><a href="structctl__t.html#a402ce921786cefb5ce431bda7dbf7f3c">ctl_t::qnt_mloss_wet</a></div><div class="ttdeci">int qnt_mloss_wet</div><div class="ttdoc">Quantity array index for total mass loss due to wet deposition.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02312">mptrac.h:2312</a></div></div>
<div class="ttc" id="astructctl__t_html_a5ac7339d5350bb6d64df67a8df70c4b8"><div class="ttname"><a href="structctl__t.html#a5ac7339d5350bb6d64df67a8df70c4b8">ctl_t::wet_depo_so2_ph</a></div><div class="ttdeci">double wet_depo_so2_ph</div><div class="ttdoc">pH value used to calculate effective Henry constant of SO2.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02886">mptrac.h:2886</a></div></div>
<div class="ttc" id="astructctl__t_html_a96e4c97eb8f6a2b81d7ddb7a3ce4ae81"><div class="ttname"><a href="structctl__t.html#a96e4c97eb8f6a2b81d7ddb7a3ce4ae81">ctl_t::wet_depo_pre</a></div><div class="ttdeci">double wet_depo_pre[2]</div><div class="ttdoc">Coefficients for precipitation calculation.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02865">mptrac.h:2865</a></div></div>
<div class="ttc" id="astructctl__t_html_a9a0cd464bdd8eac81b99b88a93e21536"><div class="ttname"><a href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">ctl_t::wet_depo_bc_h</a></div><div class="ttdeci">double wet_depo_bc_h[2]</div><div class="ttdoc">Coefficients for wet deposition below cloud (Henry's law: Hb, Cb).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02883">mptrac.h:2883</a></div></div>
<div class="ttc" id="astructctl__t_html_ac2b6871df347638e7154410038690871"><div class="ttname"><a href="structctl__t.html#ac2b6871df347638e7154410038690871">ctl_t::wet_depo_bc_ret_ratio</a></div><div class="ttdeci">double wet_depo_bc_ret_ratio</div><div class="ttdoc">Coefficients for wet deposition below cloud: retention ratio.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02892">mptrac.h:2892</a></div></div>
<div class="ttc" id="astructctl__t_html_ad33a970fead17226fb2b208975bee8a2"><div class="ttname"><a href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">ctl_t::wet_depo_ic_h</a></div><div class="ttdeci">double wet_depo_ic_h[2]</div><div class="ttdoc">Coefficients for wet deposition in cloud (Henry's law: Hb, Cb).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02880">mptrac.h:2880</a></div></div>
<div class="ttc" id="astructctl__t_html_adfd76ffde125821097d58b4b3978a355"><div class="ttname"><a href="structctl__t.html#adfd76ffde125821097d58b4b3978a355">ctl_t::wet_depo_ic_ret_ratio</a></div><div class="ttdeci">double wet_depo_ic_ret_ratio</div><div class="ttdoc">Coefficients for wet deposition in cloud: retention ratio.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02889">mptrac.h:2889</a></div></div>
<div class="ttc" id="astructctl__t_html_ae48763f1caad155cb48c8bcb536061c0"><div class="ttname"><a href="structctl__t.html#ae48763f1caad155cb48c8bcb536061c0">ctl_t::wet_depo_ic_b</a></div><div class="ttdeci">double wet_depo_ic_b</div><div class="ttdoc">Coefficient B for wet deposition in cloud (exponential form).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02877">mptrac.h:2877</a></div></div>
<div class="ttc" id="astructctl__t_html_ae49e5d87420514bf64f3150e75c8b07f"><div class="ttname"><a href="structctl__t.html#ae49e5d87420514bf64f3150e75c8b07f">ctl_t::wet_depo_bc_b</a></div><div class="ttdeci">double wet_depo_bc_b</div><div class="ttdoc">Coefficient B for wet deposition below cloud (exponential form).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02871">mptrac.h:2871</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05eca328a1d7b6ea06252dca2f83961d" name="a05eca328a1d7b6ea06252dca2f83961d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05eca328a1d7b6ea06252dca2f83961d">&#9670;&nbsp;</a></span>mptrac_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_alloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> **&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> **&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__t.html">clim_t</a> **&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> **&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> **&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> **&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> **&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates and initializes memory resources for MPTRAC. </p>
<p >This function handles memory allocation for various data structures and sets up GPU resources if available. It also creates the necessary data regions on GPUs for OpenACC-enabled execution.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ctl</td><td>Pointer to the control structure (<a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cache</td><td>Pointer to the cache structure (<a class="el" href="structcache__t.html" title="Cache data structure.">cache_t</a>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">clim</td><td>Pointer to the climatology structure (<a class="el" href="structclim__t.html" title="Climatological data.">clim_t</a>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">met0</td><td>Pointer to the first meteorology structure (<a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">met1</td><td>Pointer to the second meteorology structure (<a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">atm</td><td>Pointer to the atmospheric structure (<a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dd</td><td>pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information, including rank and neighbours.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function uses OpenACC for GPU initialization and memory management. If OpenACC is not enabled, the GPU-specific code is ignored.</dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>The function requires an environment supporting OpenACC for GPU operations. MPI support is optional but assumed if compiled with MPI.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>Allocated structures are ready for use, and data regions on GPUs are initialized if OpenACC is enabled.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Runtime</td><td>error if no GPU devices are available when OpenACC is enabled.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l05156">5156</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5163</span>             {</div>
<div class="line"><span class="lineno"> 5164</span> </div>
<div class="line"><span class="lineno"> 5165</span>  <span class="comment">/* Initialize GPU... */</span></div>
<div class="line"><span class="lineno"> 5166</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 5167</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;ACC_INIT&quot;</span>, <span class="stringliteral">&quot;INIT&quot;</span>);</div>
<div class="line"><span class="lineno"> 5168</span>  <span class="keywordtype">int</span> rank = 0;</div>
<div class="line"><span class="lineno"> 5169</span><span class="preprocessor">#ifdef MPI</span></div>
<div class="line"><span class="lineno"> 5170</span>  MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);</div>
<div class="line"><span class="lineno"> 5171</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5172</span>  <span class="keywordflow">if</span> (acc_get_num_devices(acc_device_nvidia) &lt;= 0)</div>
<div class="line"><span class="lineno"> 5173</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Not running on a GPU device!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5174</span>  acc_set_device_num(rank % acc_get_num_devices(acc_device_nvidia),</div>
<div class="line"><span class="lineno"> 5175</span>                     acc_device_nvidia);</div>
<div class="line"><span class="lineno"> 5176</span>  acc_device_t device_type = acc_get_device_type();</div>
<div class="line"><span class="lineno"> 5177</span>  acc_init(device_type);</div>
<div class="line"><span class="lineno"> 5178</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5179</span> </div>
<div class="line"><span class="lineno"> 5180</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 5181</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;ALLOC&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 5182</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(*ctl, <a class="code hl_struct" href="structctl__t.html">ctl_t</a>, 1);</div>
<div class="line"><span class="lineno"> 5183</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(*cache, <a class="code hl_struct" href="structcache__t.html">cache_t</a>, 1);</div>
<div class="line"><span class="lineno"> 5184</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(*clim, <a class="code hl_struct" href="structclim__t.html">clim_t</a>, 1);</div>
<div class="line"><span class="lineno"> 5185</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(*met0, <a class="code hl_struct" href="structmet__t.html">met_t</a>, 1);</div>
<div class="line"><span class="lineno"> 5186</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(*met1, <a class="code hl_struct" href="structmet__t.html">met_t</a>, 1);</div>
<div class="line"><span class="lineno"> 5187</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(*atm, <a class="code hl_struct" href="structatm__t.html">atm_t</a>, 1);</div>
<div class="line"><span class="lineno"> 5188</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(*dd, <a class="code hl_struct" href="structdd__t.html">dd_t</a>, 1);</div>
<div class="line"><span class="lineno"> 5189</span> </div>
<div class="line"><span class="lineno"> 5190</span>  <span class="comment">/* Create data region on GPU... */</span></div>
<div class="line"><span class="lineno"> 5191</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 5192</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;CREATE_DATA_REGION&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 5193</span>  <a class="code hl_struct" href="structctl__t.html">ctl_t</a> *ctlup = *ctl;</div>
<div class="line"><span class="lineno"> 5194</span>  <a class="code hl_struct" href="structcache__t.html">cache_t</a> *cacheup = *cache;</div>
<div class="line"><span class="lineno"> 5195</span>  <a class="code hl_struct" href="structclim__t.html">clim_t</a> *climup = *clim;</div>
<div class="line"><span class="lineno"> 5196</span>  <a class="code hl_struct" href="structmet__t.html">met_t</a> *met0up = *met0;</div>
<div class="line"><span class="lineno"> 5197</span>  <a class="code hl_struct" href="structmet__t.html">met_t</a> *met1up = *met1;</div>
<div class="line"><span class="lineno"> 5198</span>  <a class="code hl_struct" href="structatm__t.html">atm_t</a> *atmup = *atm;</div>
<div class="line"><span class="lineno"> 5199</span><span class="preprocessor">#pragma acc enter data create(ctlup[:1],cacheup[:1],climup[:1],met0up[:1],met1up[:1],atmup[:1])</span></div>
<div class="line"><span class="lineno"> 5200</span><span class="preprocessor">#ifdef DD</span></div>
<div class="line"><span class="lineno"> 5201</span>  <a class="code hl_struct" href="structdd__t.html">dd_t</a> *ddup = *dd;</div>
<div class="line"><span class="lineno"> 5202</span><span class="preprocessor">#pragma acc enter data create(ddup[:1])</span></div>
<div class="line"><span class="lineno"> 5203</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5204</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5205</span>}</div>
<div class="ttc" id="astructatm__t_html"><div class="ttname"><a href="structatm__t.html">atm_t</a></div><div class="ttdoc">Air parcel data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03164">mptrac.h:3164</a></div></div>
<div class="ttc" id="astructcache__t_html"><div class="ttname"><a href="structcache__t.html">cache_t</a></div><div class="ttdoc">Cache data structure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03219">mptrac.h:3219</a></div></div>
<div class="ttc" id="astructclim__t_html"><div class="ttname"><a href="structclim__t.html">clim_t</a></div><div class="ttdoc">Climatological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03359">mptrac.h:3359</a></div></div>
<div class="ttc" id="astructctl__t_html"><div class="ttname"><a href="structctl__t.html">ctl_t</a></div><div class="ttdoc">Control parameters.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02131">mptrac.h:2131</a></div></div>
<div class="ttc" id="astructdd__t_html"><div class="ttname"><a href="structdd__t.html">dd_t</a></div><div class="ttdoc">Domain decomposition data structure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03592">mptrac.h:3592</a></div></div>
<div class="ttc" id="astructmet__t_html"><div class="ttname"><a href="structmet__t.html">met_t</a></div><div class="ttdoc">Meteo data structure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03418">mptrac.h:3418</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adba57d9fe55a3a455520de070702f8e1" name="adba57d9fe55a3a455520de070702f8e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adba57d9fe55a3a455520de070702f8e1">&#9670;&nbsp;</a></span>mptrac_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees memory resources allocated for MPTRAC. </p>
<p >This function releases the memory allocated for various data structures and deletes any associated data regions on GPUs if OpenACC is enabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the control structure (<a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a>) to be freed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cache</td><td>Pointer to the cache structure (<a class="el" href="structcache__t.html" title="Cache data structure.">cache_t</a>) to be freed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clim</td><td>Pointer to the climatology structure (<a class="el" href="structclim__t.html" title="Climatological data.">clim_t</a>) to be freed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met0</td><td>Pointer to the first meteorology structure (<a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a>) to be freed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met1</td><td>Pointer to the second meteorology structure (<a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a>) to be freed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Pointer to the atmospheric structure (<a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a>) to be freed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dd</td><td>Pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information, including rank and neighbours.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function uses OpenACC for GPU memory management. If OpenACC is not enabled, the GPU-specific code is ignored.</dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>All input pointers must point to valid allocated memory. The function assumes that the memory was allocated using compatible allocation methods.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>All input pointers are freed, and the associated data regions on GPUs are deleted if OpenACC is enabled.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure that the input pointers are not used after calling this function as they will be invalidated.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l05209">5209</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5216</span>            {</div>
<div class="line"><span class="lineno"> 5217</span> </div>
<div class="line"><span class="lineno"> 5218</span>  <span class="comment">/* Delete data region on GPU... */</span></div>
<div class="line"><span class="lineno"> 5219</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 5220</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;DELETE_DATA_REGION&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 5221</span><span class="preprocessor">#pragma acc exit data delete (ctl,cache,clim,met0,met1,atm)</span></div>
<div class="line"><span class="lineno"> 5222</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5223</span> </div>
<div class="line"><span class="lineno"> 5224</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 5225</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;FREE&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 5226</span>  free(atm);</div>
<div class="line"><span class="lineno"> 5227</span>  free(ctl);</div>
<div class="line"><span class="lineno"> 5228</span>  free(cache);</div>
<div class="line"><span class="lineno"> 5229</span>  free(clim);</div>
<div class="line"><span class="lineno"> 5230</span>  free(met0);</div>
<div class="line"><span class="lineno"> 5231</span>  free(met1);</div>
<div class="line"><span class="lineno"> 5232</span> </div>
<div class="line"><span class="lineno"> 5233</span>  <span class="comment">/* Free MPI datatype... */</span></div>
<div class="line"><span class="lineno"> 5234</span><span class="preprocessor">#ifdef DD</span></div>
<div class="line"><span class="lineno"> 5235</span>  MPI_Type_free(&amp;dd-&gt;MPI_Particle);</div>
<div class="line"><span class="lineno"> 5236</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5237</span>  free(dd);</div>
<div class="line"><span class="lineno"> 5238</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8435d2ccfa5de00f6d8080d363737cd6" name="a8435d2ccfa5de00f6d8080d363737cd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8435d2ccfa5de00f6d8080d363737cd6">&#9670;&nbsp;</a></span>mptrac_get_met()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_get_met </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> **&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> **&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves meteorological data for the specified time. </p>
<p >This function retrieves meteorological data for the given time <code>t</code> and updates the provided pointers to the met0 and met1 structures accordingly. It handles both the initialization and subsequent updates of the meteorological data based on the direction of time integration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing configuration settings. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climate structure. </td></tr>
    <tr><td class="paramname">t</td><td>The current time for which meteorological data is to be retrieved. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the pointer of the first meteorological data structure. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the pointer of the second meteorological data structure. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information, including rank and neighbours.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Initializes meteorological data on the first call or when the simulation restarts.</li>
<li>Reads new meteorological data when advancing forward or backward in time.</li>
<li>Swaps pointers to manage double buffering of the meteorological data.</li>
<li>Performs caching to optimize subsequent data retrieval.</li>
<li>Ensures consistency of the meteorological grids.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function utilizes GPU acceleration with OpenACC directives if enabled. </dd>
<dd>
Ensure that <code>ctl</code>, <code>clim</code>, <code>met0</code>, and <code>met1</code> are properly initialized before calling this function.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="mptrac_8h.html#aad0e01f51c815c87fccaae55195d8a35" title="Generates a formatted filename for meteorological data files based on the input parameters.">get_met_help</a> </dd>
<dd>
read_met </dd>
<dd>
<a class="el" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749" title="Select and start a timer with specific attributes.">SELECT_TIMER</a> </dd>
<dd>
<a class="el" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251" title="Print a log message with a specified logging level.">LOG</a> </dd>
<dd>
<a class="el" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875" title="Print an error message with contextual information and terminate the program.">ERRMSG</a> </dd>
<dd>
<a class="el" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8" title="Print a warning message with contextual information.">WARN</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l05242">5242</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5248</span>            {</div>
<div class="line"><span class="lineno"> 5249</span> </div>
<div class="line"><span class="lineno"> 5250</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> init;</div>
<div class="line"><span class="lineno"> 5251</span> </div>
<div class="line"><span class="lineno"> 5252</span>  <a class="code hl_struct" href="structmet__t.html">met_t</a> *mets;</div>
<div class="line"><span class="lineno"> 5253</span> </div>
<div class="line"><span class="lineno"> 5254</span>  <span class="keywordtype">char</span> cachefile[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], cmd[2 * <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], filename[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 5255</span> </div>
<div class="line"><span class="lineno"> 5256</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 5257</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;GET_MET&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 5258</span> </div>
<div class="line"><span class="lineno"> 5259</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 5260</span>  <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a> || !init) {</div>
<div class="line"><span class="lineno"> 5261</span>    init = 1;</div>
<div class="line"><span class="lineno"> 5262</span> </div>
<div class="line"><span class="lineno"> 5263</span>    <span class="comment">/* Read meteo data... */</span></div>
<div class="line"><span class="lineno"> 5264</span>    <a class="code hl_function" href="mptrac_8c.html#aad0e01f51c815c87fccaae55195d8a35">get_met_help</a>(ctl, t + (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a> == -1 ? -1 : 0), -1,</div>
<div class="line"><span class="lineno"> 5265</span>                 ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ddc0221c9ee329efb265672a14026c9">metbase</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a>, filename);</div>
<div class="line"><span class="lineno"> 5266</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#ad761ca965e59ad9246ab5825a3730058">mptrac_read_met</a>(filename, ctl, clim, *met0, dd))</div>
<div class="line"><span class="lineno"> 5267</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5268</span> </div>
<div class="line"><span class="lineno"> 5269</span>    <a class="code hl_function" href="mptrac_8c.html#aad0e01f51c815c87fccaae55195d8a35">get_met_help</a>(ctl, t + (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a> == 1 ? 1 : 0), 1,</div>
<div class="line"><span class="lineno"> 5270</span>                 ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ddc0221c9ee329efb265672a14026c9">metbase</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a>, filename);</div>
<div class="line"><span class="lineno"> 5271</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#ad761ca965e59ad9246ab5825a3730058">mptrac_read_met</a>(filename, ctl, clim, *met1, dd))</div>
<div class="line"><span class="lineno"> 5272</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5273</span> </div>
<div class="line"><span class="lineno"> 5274</span>    <span class="comment">/* Update GPU... */</span></div>
<div class="line"><span class="lineno"> 5275</span>    <a class="code hl_function" href="mptrac_8c.html#a55562b13a38a124b0abc09ce8511dde9">mptrac_update_device</a>(NULL, NULL, NULL, met0, met1, NULL);</div>
<div class="line"><span class="lineno"> 5276</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;GET_MET&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 5277</span> </div>
<div class="line"><span class="lineno"> 5278</span>    <span class="comment">/* Caching... */</span></div>
<div class="line"><span class="lineno"> 5279</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7ae3a516b2b17723a02f5e0627d886c2">met_cache</a> &amp;&amp; t != ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a>) {</div>
<div class="line"><span class="lineno"> 5280</span>      <a class="code hl_function" href="mptrac_8c.html#aad0e01f51c815c87fccaae55195d8a35">get_met_help</a>(ctl, t + 1.1 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a>,</div>
<div class="line"><span class="lineno"> 5281</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ddc0221c9ee329efb265672a14026c9">metbase</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a>, cachefile);</div>
<div class="line"><span class="lineno"> 5282</span>      sprintf(cmd, <span class="stringliteral">&quot;cat %s &gt; /dev/null &amp;&quot;</span>, cachefile);</div>
<div class="line"><span class="lineno"> 5283</span>      <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Caching: %s&quot;</span>, cachefile);</div>
<div class="line"><span class="lineno"> 5284</span>      <span class="keywordflow">if</span> (system(cmd) != 0)</div>
<div class="line"><span class="lineno"> 5285</span>        <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Caching command failed!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5286</span>    }</div>
<div class="line"><span class="lineno"> 5287</span>  }</div>
<div class="line"><span class="lineno"> 5288</span> </div>
<div class="line"><span class="lineno"> 5289</span>  <span class="comment">/* Read new data for forward trajectories... */</span></div>
<div class="line"><span class="lineno"> 5290</span>  <span class="keywordflow">if</span> (t &gt; (*met1)-&gt;time) {</div>
<div class="line"><span class="lineno"> 5291</span> </div>
<div class="line"><span class="lineno"> 5292</span>    <span class="comment">/* Pointer swap... */</span></div>
<div class="line"><span class="lineno"> 5293</span>    mets = *met1;</div>
<div class="line"><span class="lineno"> 5294</span>    *met1 = *met0;</div>
<div class="line"><span class="lineno"> 5295</span>    *met0 = mets;</div>
<div class="line"><span class="lineno"> 5296</span> </div>
<div class="line"><span class="lineno"> 5297</span>    <span class="comment">/* Read new meteo data... */</span></div>
<div class="line"><span class="lineno"> 5298</span>    <a class="code hl_function" href="mptrac_8c.html#aad0e01f51c815c87fccaae55195d8a35">get_met_help</a>(ctl, t, 1, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ddc0221c9ee329efb265672a14026c9">metbase</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a>, filename);</div>
<div class="line"><span class="lineno"> 5299</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#ad761ca965e59ad9246ab5825a3730058">mptrac_read_met</a>(filename, ctl, clim, *met1, dd))</div>
<div class="line"><span class="lineno"> 5300</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5301</span> </div>
<div class="line"><span class="lineno"> 5302</span>    <span class="comment">/* Update GPU... */</span></div>
<div class="line"><span class="lineno"> 5303</span>    <a class="code hl_function" href="mptrac_8c.html#a55562b13a38a124b0abc09ce8511dde9">mptrac_update_device</a>(NULL, NULL, NULL, NULL, met1, NULL);</div>
<div class="line"><span class="lineno"> 5304</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;GET_MET&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 5305</span> </div>
<div class="line"><span class="lineno"> 5306</span>    <span class="comment">/* Caching... */</span></div>
<div class="line"><span class="lineno"> 5307</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7ae3a516b2b17723a02f5e0627d886c2">met_cache</a> &amp;&amp; t != ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a>) {</div>
<div class="line"><span class="lineno"> 5308</span>      <a class="code hl_function" href="mptrac_8c.html#aad0e01f51c815c87fccaae55195d8a35">get_met_help</a>(ctl, t + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a>, 1, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ddc0221c9ee329efb265672a14026c9">metbase</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a>,</div>
<div class="line"><span class="lineno"> 5309</span>                   cachefile);</div>
<div class="line"><span class="lineno"> 5310</span>      sprintf(cmd, <span class="stringliteral">&quot;cat %s &gt; /dev/null &amp;&quot;</span>, cachefile);</div>
<div class="line"><span class="lineno"> 5311</span>      <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Caching: %s&quot;</span>, cachefile);</div>
<div class="line"><span class="lineno"> 5312</span>      <span class="keywordflow">if</span> (system(cmd) != 0)</div>
<div class="line"><span class="lineno"> 5313</span>        <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Caching command failed!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5314</span>    }</div>
<div class="line"><span class="lineno"> 5315</span>  }</div>
<div class="line"><span class="lineno"> 5316</span> </div>
<div class="line"><span class="lineno"> 5317</span>  <span class="comment">/* Read new data for backward trajectories... */</span></div>
<div class="line"><span class="lineno"> 5318</span>  <span class="keywordflow">if</span> (t &lt; (*met0)-&gt;time) {</div>
<div class="line"><span class="lineno"> 5319</span> </div>
<div class="line"><span class="lineno"> 5320</span>    <span class="comment">/* Pointer swap... */</span></div>
<div class="line"><span class="lineno"> 5321</span>    mets = *met1;</div>
<div class="line"><span class="lineno"> 5322</span>    *met1 = *met0;</div>
<div class="line"><span class="lineno"> 5323</span>    *met0 = mets;</div>
<div class="line"><span class="lineno"> 5324</span> </div>
<div class="line"><span class="lineno"> 5325</span>    <span class="comment">/* Read new meteo data... */</span></div>
<div class="line"><span class="lineno"> 5326</span>    <a class="code hl_function" href="mptrac_8c.html#aad0e01f51c815c87fccaae55195d8a35">get_met_help</a>(ctl, t, -1, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ddc0221c9ee329efb265672a14026c9">metbase</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a>, filename);</div>
<div class="line"><span class="lineno"> 5327</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#ad761ca965e59ad9246ab5825a3730058">mptrac_read_met</a>(filename, ctl, clim, *met0, dd))</div>
<div class="line"><span class="lineno"> 5328</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5329</span> </div>
<div class="line"><span class="lineno"> 5330</span>    <span class="comment">/* Update GPU... */</span></div>
<div class="line"><span class="lineno"> 5331</span>    <a class="code hl_function" href="mptrac_8c.html#a55562b13a38a124b0abc09ce8511dde9">mptrac_update_device</a>(NULL, NULL, NULL, met0, NULL, NULL);</div>
<div class="line"><span class="lineno"> 5332</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;GET_MET&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 5333</span> </div>
<div class="line"><span class="lineno"> 5334</span>    <span class="comment">/* Caching... */</span></div>
<div class="line"><span class="lineno"> 5335</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7ae3a516b2b17723a02f5e0627d886c2">met_cache</a> &amp;&amp; t != ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a>) {</div>
<div class="line"><span class="lineno"> 5336</span>      <a class="code hl_function" href="mptrac_8c.html#aad0e01f51c815c87fccaae55195d8a35">get_met_help</a>(ctl, t - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a>, -1, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ddc0221c9ee329efb265672a14026c9">metbase</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a>,</div>
<div class="line"><span class="lineno"> 5337</span>                   cachefile);</div>
<div class="line"><span class="lineno"> 5338</span>      sprintf(cmd, <span class="stringliteral">&quot;cat %s &gt; /dev/null &amp;&quot;</span>, cachefile);</div>
<div class="line"><span class="lineno"> 5339</span>      <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Caching: %s&quot;</span>, cachefile);</div>
<div class="line"><span class="lineno"> 5340</span>      <span class="keywordflow">if</span> (system(cmd) != 0)</div>
<div class="line"><span class="lineno"> 5341</span>        <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Caching command failed!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5342</span>    }</div>
<div class="line"><span class="lineno"> 5343</span>  }</div>
<div class="line"><span class="lineno"> 5344</span> </div>
<div class="line"><span class="lineno"> 5345</span>  <span class="comment">/* Check that grids are consistent... */</span></div>
<div class="line"><span class="lineno"> 5346</span>  <span class="keywordflow">if</span> ((*met0)-&gt;nx != 0 &amp;&amp; (*met1)-&gt;nx != 0) {</div>
<div class="line"><span class="lineno"> 5347</span>    <span class="keywordflow">if</span> ((*met0)-&gt;nx != (*met1)-&gt;nx</div>
<div class="line"><span class="lineno"> 5348</span>        || (*met0)-&gt;ny != (*met1)-&gt;ny || (*met0)-&gt;np != (*met1)-&gt;np)</div>
<div class="line"><span class="lineno"> 5349</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Meteo grid dimensions do not match!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5350</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; (*met0)-&gt;nx; ix++)</div>
<div class="line"><span class="lineno"> 5351</span>      <span class="keywordflow">if</span> (fabs((*met0)-&gt;lon[ix] - (*met1)-&gt;lon[ix]) &gt; 0.001)</div>
<div class="line"><span class="lineno"> 5352</span>        <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Meteo grid longitudes do not match!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5353</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; (*met0)-&gt;ny; iy++)</div>
<div class="line"><span class="lineno"> 5354</span>      <span class="keywordflow">if</span> (fabs((*met0)-&gt;lat[iy] - (*met1)-&gt;lat[iy]) &gt; 0.001)</div>
<div class="line"><span class="lineno"> 5355</span>        <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Meteo grid latitudes do not match!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5356</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; (*met0)-&gt;np; ip++)</div>
<div class="line"><span class="lineno"> 5357</span>      <span class="keywordflow">if</span> (fabs((*met0)-&gt;p[ip] - (*met1)-&gt;p[ip]) &gt; 0.001)</div>
<div class="line"><span class="lineno"> 5358</span>        <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Meteo grid pressure levels do not match!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5359</span>  }</div>
<div class="line"><span class="lineno"> 5360</span>}</div>
<div class="ttc" id="amptrac_8c_html_aad0e01f51c815c87fccaae55195d8a35"><div class="ttname"><a href="mptrac_8c.html#aad0e01f51c815c87fccaae55195d8a35">get_met_help</a></div><div class="ttdeci">void get_met_help(const ctl_t *ctl, const double t, const int direct, const char *metbase, const double dt_met, char *filename)</div><div class="ttdoc">Generates a formatted filename for meteorological data files based on the input parameters.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l01980">mptrac.c:1980</a></div></div>
<div class="ttc" id="amptrac_8c_html_ad761ca965e59ad9246ab5825a3730058"><div class="ttname"><a href="mptrac_8c.html#ad761ca965e59ad9246ab5825a3730058">mptrac_read_met</a></div><div class="ttdeci">int mptrac_read_met(const char *filename, const ctl_t *ctl, const clim_t *clim, met_t *met, dd_t *dd)</div><div class="ttdoc">Reads meteorological data from a file, supporting multiple formats and MPI broadcasting.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l06409">mptrac.c:6409</a></div></div>
<div class="ttc" id="astructctl__t_html_a7ae3a516b2b17723a02f5e0627d886c2"><div class="ttname"><a href="structctl__t.html#a7ae3a516b2b17723a02f5e0627d886c2">ctl_t::met_cache</a></div><div class="ttdeci">int met_cache</div><div class="ttdoc">Preload meteo data into disk cache (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02625">mptrac.h:2625</a></div></div>
<div class="ttc" id="astructctl__t_html_a9ddc0221c9ee329efb265672a14026c9"><div class="ttname"><a href="structctl__t.html#a9ddc0221c9ee329efb265672a14026c9">ctl_t::metbase</a></div><div class="ttdeci">char metbase[LEN]</div><div class="ttdoc">Basename for meteo data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02457">mptrac.h:2457</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a8435d2ccfa5de00f6d8080d363737cd6_cgraph.png" border="0" usemap="#amptrac_8h_a8435d2ccfa5de00f6d8080d363737cd6_cgraph" alt=""/></div>
<map name="amptrac_8h_a8435d2ccfa5de00f6d8080d363737cd6_cgraph" id="amptrac_8h_a8435d2ccfa5de00f6d8080d363737cd6_cgraph">
<area shape="rect" title="Retrieves meteorological data for the specified time." alt="" coords="5,597,121,624"/>
<area shape="rect" href="mptrac_8c.html#aad0e01f51c815c87fccaae55195d8a35" title="Generates a formatted filename for meteorological data files based on the input parameters." alt="" coords="196,167,296,193"/>
<area shape="rect" href="mptrac_8c.html#ad761ca965e59ad9246ab5825a3730058" title="Reads meteorological data from a file, supporting multiple formats and MPI broadcasting." alt="" coords="185,597,307,624"/>
<area shape="rect" href="mptrac_8c.html#a55562b13a38a124b0abc09ce8511dde9" title="Updates device memory for specified data structures." alt="" coords="169,648,323,675"/>
<area shape="rect" href="mptrac_8c.html#ac54a92b848d49b96ef6091df37b552f2" title="Replaces occurrences of a substring in a string with another substring." alt="" coords="387,116,506,143"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="799,259,878,285"/>
<area shape="rect" href="mptrac_8h.html#aa4b5f89a098befae2a864decab80f133" title="Broadcasts large data across all processes in an MPI communicator." alt="" coords="373,623,520,649"/>
<area shape="rect" href="mptrac_8c.html#acc520c5d948ea75f0acb9b351a6b8b75" title="Reads meteorological data from a binary file." alt="" coords="397,319,497,345"/>
<area shape="rect" href="mptrac_8c.html#af61accbe7a6587652bb15ea68d6aee03" title="Calculates Convective Available Potential Energy (CAPE) for each grid point." alt="" coords="589,677,699,704"/>
<area shape="rect" href="mptrac_8c.html#a1b20694a5f995be231b64a5121eab7a9" title="Calculates cloud&#45;related variables for each grid point." alt="" coords="389,825,504,852"/>
<area shape="rect" href="mptrac_8c.html#a2776502fa762ba5034c0759d7645d1e1" title="Detrends meteorological data." alt="" coords="383,876,510,903"/>
<area shape="rect" href="mptrac_8c.html#a089d9c0099e3fc6944c2a48667362ca0" title="Extrapolates meteorological data." alt="" coords="373,927,520,953"/>
<area shape="rect" href="mptrac_8c.html#a01594c9f21549808fcf2f2f8be781e79" title="Calculates geopotential heights from meteorological data." alt="" coords="583,801,705,828"/>
<area shape="rect" href="mptrac_8h.html#a82c358b6cc1f736e2f186c8aef4d6a79" title="Reads meteorological data from a grib file and processes it." alt="" coords="395,977,499,1004"/>
<area shape="rect" href="mptrac_8c.html#a305d8ee431236c52e0fd21d26f23a695" title="Makes zeta and pressure profiles monotone." alt="" coords="372,1028,521,1055"/>
<area shape="rect" href="mptrac_8c.html#a6d5d9f14125739740b23f1ff88baf835" title="Reads meteorological data from a NetCDF file and processes it." alt="" coords="398,572,495,599"/>
<area shape="rect" href="mptrac_8c.html#a9ee63e8a6c82ac0dc569255455a50da2" title="Calculates the total column ozone from meteorological ozone data." alt="" coords="388,268,505,295"/>
<area shape="rect" href="mptrac_8c.html#a2723705c94110a3ddfc84f2f0c8ddc71" title="Computes the planetary boundary layer (PBL) pressure based on meteorological data." alt="" coords="397,217,497,244"/>
<area shape="rect" href="mptrac_8c.html#a38f91765df8eb0a66fb3a6408dca0600" title="Applies periodic boundary conditions to meteorological data along longitudinal axis." alt="" coords="383,369,511,396"/>
<area shape="rect" href="mptrac_8c.html#adea1a286e6ec2a763b560997203fd5b7" title="Applies a fix for polar winds in meteorological data." alt="" coords="371,420,523,447"/>
<area shape="rect" href="mptrac_8c.html#ac2c90884cb02bf90f095ff36f41e020a" title="Calculates potential vorticity (PV) from meteorological data." alt="" coords="398,471,495,497"/>
<area shape="rect" href="mptrac_8c.html#a0e6ef467d264f7b13436a460c753ed8a" title="Downsamples meteorological data based on specified parameters." alt="" coords="384,521,509,548"/>
<area shape="rect" href="mptrac_8c.html#a29701c07d5dded042b2031e09e11d679" title="Calculates the tropopause and related meteorological variables based on various methods and stores th..." alt="" coords="588,729,700,756"/>
<area shape="rect" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286" title="Reads a 2&#45;dimensional meteorological variable from a binary file and stores it in the provided array." alt="" coords="583,268,705,295"/>
<area shape="rect" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558" title="Reads 3D meteorological data from a binary file, potentially using different compression methods." alt="" coords="583,112,705,139"/>
<area shape="rect" href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14" title="Compresses or decompresses a 3&#45;D meteorological field using cmultiscale." alt="" coords="783,56,894,83"/>
<area shape="rect" href="mptrac_8c.html#a61bbe35a4ff7b797fdb64f9797a3ffd1" title="Compresses or decompresses a 3D array of floats." alt="" coords="785,107,892,133"/>
<area shape="rect" href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3" title="Compresses or decompresses a 3&#45;D float array using the SZ3 library." alt="" coords="785,157,892,184"/>
<area shape="rect" href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72" title="Compresses or decompresses a 3D array of floats using the ZFP library." alt="" coords="787,208,890,235"/>
<area shape="rect" href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c" title="Compresses or decompresses a float array using Zstandard (ZSTD)." alt="" coords="783,5,894,32"/>
<area shape="rect" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692" title="Calculates the tropopause pressure based on climatological data." alt="" coords="797,731,880,757"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="766,680,911,707"/>
<area shape="rect" href="mptrac_8c.html#afa485eb277a5ced6dac0ed77665c976c" title="Calculates the moist adiabatic lapse rate in Kelvin per kilometer." alt="" coords="797,629,880,656"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="993,756,1067,783"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="989,705,1071,732"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="960,655,1100,681"/>
<area shape="rect" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="608,876,680,903"/>
<area shape="rect" href="mptrac_8c.html#ae4562461a2883609e1768b1c3671eec4" title="Reads meteorological grid data from NetCDF files with domain decomposition." alt="" coords="581,369,707,396"/>
<area shape="rect" href="mptrac_8c.html#a2ee3cac435af17ad5aaf885cc2dc3262" title="Reads and processes meteorological level data from NetCDF files with domain decomposition." alt="" coords="575,576,713,603"/>
<area shape="rect" href="mptrac_8c.html#aa86499774fc9def653b04f95e56b4052" title="Reads and processes surface meteorological data from NetCDF files with domain decomposition." alt="" coords="571,525,717,552"/>
<area shape="rect" href="mptrac_8c.html#a6c6041039047d277d4836da1bb119e3d" title="Read meteorological grid data from a NetCDF file and set up subdomain decomposition with halos." alt="" coords="765,361,912,402"/>
<area shape="rect" href="mptrac_8c.html#a578e7ebaa62304182de8fe7ddf144b8f" title="Converts time components to seconds since January 1, 2000, 12:00:00 UTC." alt="" coords="991,368,1069,395"/>
<area shape="rect" href="mptrac_8c.html#a8c5064804f7b46a4130b5411374a771d" title="Extracts and converts a timestamp from a filename to Julian seconds." alt="" coords="771,309,906,336"/>
<area shape="rect" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b" title="Interpolates meteorological data to specified pressure levels." alt="" coords="781,579,896,605"/>
<area shape="rect" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3" title="Reads a 3&#45;dimensional meteorological variable from a NetCDF file." alt="" coords="779,528,898,555"/>
<area shape="rect" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed" title="Reads a 2&#45;dimensional meteorological variable from a NetCDF file." alt="" coords="779,477,898,504"/>
<area shape="rect" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861" title="Locate the index of the interval containing a given value in an irregularly spaced array." alt="" coords="591,217,697,244"/>
<area shape="rect" href="mptrac_8c.html#a62786d005ed312f3c9ba2fac7cd544fc" title="Performs spline interpolation or linear interpolation." alt="" coords="811,781,867,808"/>
</map>
</div>

</div>
</div>
<a id="a57d693a955f788f652b4d961ee5a29a7" name="a57d693a955f788f652b4d961ee5a29a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57d693a955f788f652b4d961ee5a29a7">&#9670;&nbsp;</a></span>mptrac_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ntask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the MPTRAC model and its associated components. </p>
<p >This function sets up the necessary components and subsystems for the MPTRAC module, including timesteps, random number generation, and GPU memory updates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing configuration and state information. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure used for data storage and retrieval. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climatology structure containing climate-related data. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric structure containing atmospheric state data. </td></tr>
    <tr><td class="paramname">ntask</td><td>Number of tasks or threads to initialize for the random number generator.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following operations:</p><ul>
<li>Initializes the timesteps using the <code>module_timesteps_init</code> function.</li>
<li>Initializes the random number generator using the <code>module_rng_init</code> function.</li>
<li>Updates GPU memory using the <code>mptrac_update_device</code> function.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l05364">5364</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5369</span>                   {</div>
<div class="line"><span class="lineno"> 5370</span> </div>
<div class="line"><span class="lineno"> 5371</span>  <span class="comment">/* Initialize timesteps... */</span></div>
<div class="line"><span class="lineno"> 5372</span>  <a class="code hl_function" href="mptrac_8c.html#a3f42ca12ace33e1168edaaf4b96e5a60">module_timesteps_init</a>(ctl, atm);</div>
<div class="line"><span class="lineno"> 5373</span> </div>
<div class="line"><span class="lineno"> 5374</span>  <span class="comment">/* Initialize random number generator... */</span></div>
<div class="line"><span class="lineno"> 5375</span>  <a class="code hl_function" href="mptrac_8c.html#a9430c769e61661f2da526feb29d2d032">module_rng_init</a>(ntask);</div>
<div class="line"><span class="lineno"> 5376</span> </div>
<div class="line"><span class="lineno"> 5377</span>  <span class="comment">/* Update GPU memory... */</span></div>
<div class="line"><span class="lineno"> 5378</span>  <a class="code hl_function" href="mptrac_8c.html#a55562b13a38a124b0abc09ce8511dde9">mptrac_update_device</a>(ctl, cache, clim, NULL, NULL, atm);</div>
<div class="line"><span class="lineno"> 5379</span>}</div>
<div class="ttc" id="amptrac_8c_html_a3f42ca12ace33e1168edaaf4b96e5a60"><div class="ttname"><a href="mptrac_8c.html#a3f42ca12ace33e1168edaaf4b96e5a60">module_timesteps_init</a></div><div class="ttdeci">void module_timesteps_init(ctl_t *ctl, const atm_t *atm)</div><div class="ttdoc">Initialize start time and time interval for time-stepping.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04919">mptrac.c:4919</a></div></div>
<div class="ttc" id="amptrac_8c_html_a9430c769e61661f2da526feb29d2d032"><div class="ttname"><a href="mptrac_8c.html#a9430c769e61661f2da526feb29d2d032">module_rng_init</a></div><div class="ttdeci">void module_rng_init(const int ntask)</div><div class="ttdoc">Initialize random number generators for parallel tasks.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04604">mptrac.c:4604</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a57d693a955f788f652b4d961ee5a29a7_cgraph.png" border="0" usemap="#amptrac_8h_a57d693a955f788f652b4d961ee5a29a7_cgraph" alt=""/></div>
<map name="amptrac_8h_a57d693a955f788f652b4d961ee5a29a7_cgraph" id="amptrac_8h_a57d693a955f788f652b4d961ee5a29a7_cgraph">
<area shape="rect" title="Initializes the MPTRAC model and its associated components." alt="" coords="5,56,92,83"/>
<area shape="rect" href="mptrac_8c.html#a9430c769e61661f2da526feb29d2d032" title="Initialize random number generators for parallel tasks." alt="" coords="160,5,273,32"/>
<area shape="rect" href="mptrac_8c.html#a3f42ca12ace33e1168edaaf4b96e5a60" title="Initialize start time and time interval for time&#45;stepping." alt="" coords="141,56,293,83"/>
<area shape="rect" href="mptrac_8c.html#a55562b13a38a124b0abc09ce8511dde9" title="Updates device memory for specified data structures." alt="" coords="140,107,293,133"/>
</map>
</div>

</div>
</div>
<a id="a96e5b8b7db1bad827222e732ac6d1633" name="a96e5b8b7db1bad827222e732ac6d1633"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96e5b8b7db1bad827222e732ac6d1633">&#9670;&nbsp;</a></span>mptrac_read_atm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mptrac_read_atm </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads air parcel data from a specified file into the given atmospheric structure. </p>
<p >This function reads air parcel data from a file and populates the provided <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure based on the type of data specified in the <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> control structure. It supports various data formats including ASCII, binary, netCDF, and CLaMS.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The name of the file containing the atmospheric data. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to the control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) that specifies the type of data. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to the atmospheric structure (<code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code>) that will be populated with the data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 on success, and 0 on failure.</dd></dl>
<p>This function performs the following steps:</p><ul>
<li>Sets a timer for performance measurement.</li>
<li>Initializes the atmospheric structure.</li>
<li>Logs the file being read.</li>
<li>Reads data from the file based on the specified type (<code>ctl-&gt;atm_type</code>):<ul>
<li><code>0</code> for ASCII data</li>
<li><code>1</code> for binary data</li>
<li><code>2</code> for netCDF data</li>
<li><code>3</code> or <code>4</code> for CLaMS data</li>
</ul>
</li>
<li>Handles errors if the data type is not supported.</li>
<li>Checks the result of the data reading function and ensures data was read successfully.</li>
<li>Logs information about the number of air parcels and the ranges of various parameters (time, altitude, pressure, longitude, latitude, and other quantities).</li>
</ul>
<p >The function utilizes several helper functions and macros:</p><ul>
<li><code>SELECT_TIMER</code> for setting the timer.</li>
<li><code>LOG</code> for logging information.</li>
<li><code>ERRMSG</code> for handling error messages.</li>
<li><code>gsl_stats_minmax</code> for calculating minimum and maximum values.</li>
<li><code>Z</code> for converting altitude.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l05383">5383</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5386</span>              {</div>
<div class="line"><span class="lineno"> 5387</span> </div>
<div class="line"><span class="lineno"> 5388</span>  <span class="keywordtype">int</span> result;</div>
<div class="line"><span class="lineno"> 5389</span> </div>
<div class="line"><span class="lineno"> 5390</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 5391</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_ATM&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 5392</span> </div>
<div class="line"><span class="lineno"> 5393</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 5394</span>  atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> = 0;</div>
<div class="line"><span class="lineno"> 5395</span> </div>
<div class="line"><span class="lineno"> 5396</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5397</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read atmospheric data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 5398</span> </div>
<div class="line"><span class="lineno"> 5399</span>  <span class="comment">/* Read ASCII data... */</span></div>
<div class="line"><span class="lineno"> 5400</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2509f56c50085b3d0f47c495da91b248">atm_type</a> == 0)</div>
<div class="line"><span class="lineno"> 5401</span>    result = <a class="code hl_function" href="mptrac_8c.html#af0092541e8eb2c51fc9a3fcd98043f3f">read_atm_asc</a>(filename, ctl, atm);</div>
<div class="line"><span class="lineno"> 5402</span> </div>
<div class="line"><span class="lineno"> 5403</span>  <span class="comment">/* Read binary data... */</span></div>
<div class="line"><span class="lineno"> 5404</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2509f56c50085b3d0f47c495da91b248">atm_type</a> == 1)</div>
<div class="line"><span class="lineno"> 5405</span>    result = <a class="code hl_function" href="mptrac_8c.html#ac51355e97453a01a70446623d0c382e5">read_atm_bin</a>(filename, ctl, atm);</div>
<div class="line"><span class="lineno"> 5406</span> </div>
<div class="line"><span class="lineno"> 5407</span>  <span class="comment">/* Read netCDF data... */</span></div>
<div class="line"><span class="lineno"> 5408</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2509f56c50085b3d0f47c495da91b248">atm_type</a> == 2)</div>
<div class="line"><span class="lineno"> 5409</span>    result = <a class="code hl_function" href="mptrac_8c.html#a2569c3ce3d8d46ce8aa186d42685494c">read_atm_nc</a>(filename, ctl, atm);</div>
<div class="line"><span class="lineno"> 5410</span> </div>
<div class="line"><span class="lineno"> 5411</span>  <span class="comment">/* Read CLaMS data... */</span></div>
<div class="line"><span class="lineno"> 5412</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2509f56c50085b3d0f47c495da91b248">atm_type</a> == 3 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2509f56c50085b3d0f47c495da91b248">atm_type</a> == 4)</div>
<div class="line"><span class="lineno"> 5413</span>    result = <a class="code hl_function" href="mptrac_8c.html#ad55d18eefcfa90b7c40d4a37dbb8fbf0">read_atm_clams</a>(filename, ctl, atm);</div>
<div class="line"><span class="lineno"> 5414</span> </div>
<div class="line"><span class="lineno"> 5415</span>  <span class="comment">/* Error... */</span></div>
<div class="line"><span class="lineno"> 5416</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5417</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Atmospheric data type not supported!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5418</span> </div>
<div class="line"><span class="lineno"> 5419</span>  <span class="comment">/* Check result... */</span></div>
<div class="line"><span class="lineno"> 5420</span>  <span class="keywordflow">if</span> (result != 1)</div>
<div class="line"><span class="lineno"> 5421</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 5422</span> </div>
<div class="line"><span class="lineno"> 5423</span>  <span class="comment">/* Check number of air parcels... */</span></div>
<div class="line"><span class="lineno"> 5424</span>  <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a> &lt; 1)</div>
<div class="line"><span class="lineno"> 5425</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Can not read any data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5426</span> </div>
<div class="line"><span class="lineno"> 5427</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5428</span>  <span class="keywordtype">double</span> mini, maxi;</div>
<div class="line"><span class="lineno"> 5429</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of particles: %d&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5430</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5431</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time range: %.2f ... %.2f s&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5432</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5433</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Altitude range: %g ... %g km&quot;</span>, <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(maxi), <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(mini));</div>
<div class="line"><span class="lineno"> 5434</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Pressure range: %g ... %g hPa&quot;</span>, maxi, mini);</div>
<div class="line"><span class="lineno"> 5435</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5436</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Longitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5437</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5438</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Latitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 5439</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno"> 5440</span>    <span class="keywordtype">char</span> msg[5 * <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 5441</span>    sprintf(msg, <span class="stringliteral">&quot;Quantity %s range: %s ... %s %s&quot;</span>,</div>
<div class="line"><span class="lineno"> 5442</span>            ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq],</div>
<div class="line"><span class="lineno"> 5443</span>            ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq]);</div>
<div class="line"><span class="lineno"> 5444</span>    gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq], 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 5445</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, msg, mini, maxi);</div>
<div class="line"><span class="lineno"> 5446</span>  }</div>
<div class="line"><span class="lineno"> 5447</span> </div>
<div class="line"><span class="lineno"> 5448</span>  <span class="comment">/* Return success... */</span></div>
<div class="line"><span class="lineno"> 5449</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 5450</span>}</div>
<div class="ttc" id="amptrac_8c_html_a2569c3ce3d8d46ce8aa186d42685494c"><div class="ttname"><a href="mptrac_8c.html#a2569c3ce3d8d46ce8aa186d42685494c">read_atm_nc</a></div><div class="ttdeci">int read_atm_nc(const char *filename, const ctl_t *ctl, atm_t *atm)</div><div class="ttdoc">Reads air parcel data from a generic netCDF file and populates the given atmospheric structure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07177">mptrac.c:7177</a></div></div>
<div class="ttc" id="amptrac_8c_html_ac51355e97453a01a70446623d0c382e5"><div class="ttname"><a href="mptrac_8c.html#ac51355e97453a01a70446623d0c382e5">read_atm_bin</a></div><div class="ttdeci">int read_atm_bin(const char *filename, const ctl_t *ctl, atm_t *atm)</div><div class="ttdoc">Reads air parcel data from a binary file and populates the given atmospheric structure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07061">mptrac.c:7061</a></div></div>
<div class="ttc" id="amptrac_8c_html_ad55d18eefcfa90b7c40d4a37dbb8fbf0"><div class="ttname"><a href="mptrac_8c.html#ad55d18eefcfa90b7c40d4a37dbb8fbf0">read_atm_clams</a></div><div class="ttdeci">int read_atm_clams(const char *filename, const ctl_t *ctl, atm_t *atm)</div><div class="ttdoc">Reads atmospheric data from a CLAMS NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07117">mptrac.c:7117</a></div></div>
<div class="ttc" id="amptrac_8c_html_af0092541e8eb2c51fc9a3fcd98043f3f"><div class="ttname"><a href="mptrac_8c.html#af0092541e8eb2c51fc9a3fcd98043f3f">read_atm_asc</a></div><div class="ttdeci">int read_atm_asc(const char *filename, const ctl_t *ctl, atm_t *atm)</div><div class="ttdoc">Reads air parcel data from an ASCII file and populates the given atmospheric structure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07019">mptrac.c:7019</a></div></div>
<div class="ttc" id="astructctl__t_html_a0811163b931ce18a07fbad57ea280a85"><div class="ttname"><a href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">ctl_t::qnt_format</a></div><div class="ttdeci">char qnt_format[NQ][LEN]</div><div class="ttdoc">Quantity output format.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02150">mptrac.h:2150</a></div></div>
<div class="ttc" id="astructctl__t_html_a2509f56c50085b3d0f47c495da91b248"><div class="ttname"><a href="structctl__t.html#a2509f56c50085b3d0f47c495da91b248">ctl_t::atm_type</a></div><div class="ttdeci">int atm_type</div><div class="ttdoc">Type of atmospheric data files (0=ASCII, 1=binary, 2=netCDF, 3=CLaMS_traj, 4=CLaMS_pos).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02927">mptrac.h:2927</a></div></div>
<div class="ttc" id="astructctl__t_html_a7dadf2efadc0802bd2c77aa8c39908dc"><div class="ttname"><a href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">ctl_t::qnt_unit</a></div><div class="ttdeci">char qnt_unit[NQ][LEN]</div><div class="ttdoc">Quantity units.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02147">mptrac.h:2147</a></div></div>
<div class="ttc" id="astructctl__t_html_a8a96f7d7b47b13cf7359afb9f513f690"><div class="ttname"><a href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">ctl_t::qnt_name</a></div><div class="ttdeci">char qnt_name[NQ][LEN]</div><div class="ttdoc">Quantity names.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02141">mptrac.h:2141</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a96e5b8b7db1bad827222e732ac6d1633_cgraph.png" border="0" usemap="#amptrac_8h_a96e5b8b7db1bad827222e732ac6d1633_cgraph" alt=""/></div>
<map name="amptrac_8h_a96e5b8b7db1bad827222e732ac6d1633_cgraph" id="amptrac_8h_a96e5b8b7db1bad827222e732ac6d1633_cgraph">
<area shape="rect" title="Reads air parcel data from a specified file into the given atmospheric structure." alt="" coords="5,81,128,108"/>
<area shape="rect" href="mptrac_8c.html#af0092541e8eb2c51fc9a3fcd98043f3f" title="Reads air parcel data from an ASCII file and populates the given atmospheric structure." alt="" coords="183,5,287,32"/>
<area shape="rect" href="mptrac_8c.html#ac51355e97453a01a70446623d0c382e5" title="Reads air parcel data from a binary file and populates the given atmospheric structure." alt="" coords="185,56,285,83"/>
<area shape="rect" href="mptrac_8c.html#ad55d18eefcfa90b7c40d4a37dbb8fbf0" title="Reads atmospheric data from a CLAMS NetCDF file." alt="" coords="176,107,295,133"/>
<area shape="rect" href="mptrac_8c.html#a2569c3ce3d8d46ce8aa186d42685494c" title="Reads air parcel data from a generic netCDF file and populates the given atmospheric structure." alt="" coords="187,157,284,184"/>
</map>
</div>

</div>
</div>
<a id="a8fc9ec02bd18b27c2e225161d833c766" name="a8fc9ec02bd18b27c2e225161d833c766"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fc9ec02bd18b27c2e225161d833c766">&#9670;&nbsp;</a></span>mptrac_read_clim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_read_clim </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads various climatological data and populates the given climatology structure. </p>
<p >This function reads a range of climatological datasets based on the specified control settings and stores the data in the provided <code><a class="el" href="structclim__t.html" title="Climatological data.">clim_t</a></code> structure. It handles initialization of tropopause climatology, photolysis rates, and multiple gas species' climatologies and time series.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>A pointer to the control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) that specifies file names and parameters for climatology data. </td></tr>
    <tr><td class="paramname">clim</td><td>A pointer to the climatology structure (<code><a class="el" href="structclim__t.html" title="Climatological data.">clim_t</a></code>) that will be populated with the data.</td></tr>
  </table>
  </dd>
</dl>
<p>This function performs the following steps:</p><ul>
<li>Sets a timer for reading climatology data.</li>
<li>Initializes the tropopause climatology.</li>
<li>Reads photolysis rates if specified in <code>ctl</code>.</li>
<li>Reads HNO3 climatology if specified in <code>ctl</code>.</li>
<li>Reads OH climatology if specified in <code>ctl</code> and applies a diurnal correction if specified.</li>
<li>Reads H2O2, HO2, O(1D) climatologies if specified in <code>ctl</code>.</li>
<li>Reads time series data for various gases (CFC-10, CFC-11, CFC-12, N2O, SF6) if specified in <code>ctl</code>.</li>
</ul>
<p >The function utilizes several helper functions:</p><ul>
<li><code>clim_tropo_init</code> for initializing tropopause climatology.</li>
<li><code>read_clim_photo</code> for reading photolysis rates.</li>
<li><code>read_clim_zm</code> for reading zonal mean climatologies.</li>
<li><code>clim_oh_diurnal_correction</code> for applying diurnal correction to OH climatology.</li>
<li><code>read_clim_ts</code> for reading time series data.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l05454">5454</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5456</span>                {</div>
<div class="line"><span class="lineno"> 5457</span> </div>
<div class="line"><span class="lineno"> 5458</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 5459</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_CLIM&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 5460</span> </div>
<div class="line"><span class="lineno"> 5461</span>  <span class="comment">/* Init tropopause climatology... */</span></div>
<div class="line"><span class="lineno"> 5462</span>  <a class="code hl_function" href="mptrac_8c.html#aa9cf40c6960c5078d1ea9e12a2fb0872">clim_tropo_init</a>(clim);</div>
<div class="line"><span class="lineno"> 5463</span> </div>
<div class="line"><span class="lineno"> 5464</span>  <span class="comment">/* Read photolysis rates... */</span></div>
<div class="line"><span class="lineno"> 5465</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5a52a92586476c70f20788fd481d98f3">clim_photo</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 5466</span>    <a class="code hl_function" href="mptrac_8c.html#a1a501ec43c01f1d742a133a7a3289d59">read_clim_photo</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5a52a92586476c70f20788fd481d98f3">clim_photo</a>, &amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a0e767d8c469bec62f4457cf1cb9312ea">photo</a>);</div>
<div class="line"><span class="lineno"> 5467</span> </div>
<div class="line"><span class="lineno"> 5468</span>  <span class="comment">/* Read HNO3 climatology... */</span></div>
<div class="line"><span class="lineno"> 5469</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adcb60205ef46f49695f9f06257dc0346">clim_hno3_filename</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 5470</span>    <a class="code hl_function" href="mptrac_8c.html#a6af2603c773b4d11bf7e187ccb123ba2">read_clim_zm</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adcb60205ef46f49695f9f06257dc0346">clim_hno3_filename</a>, <span class="stringliteral">&quot;HNO3&quot;</span>, &amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a4fdb5d9229fc193f2e526a6aebf97558">hno3</a>);</div>
<div class="line"><span class="lineno"> 5471</span> </div>
<div class="line"><span class="lineno"> 5472</span>  <span class="comment">/* Read OH climatology... */</span></div>
<div class="line"><span class="lineno"> 5473</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa7ad8811329e690f4a3c4431b16f8d19">clim_oh_filename</a>[0] != <span class="charliteral">&#39;-&#39;</span>) {</div>
<div class="line"><span class="lineno"> 5474</span>    <a class="code hl_function" href="mptrac_8c.html#a6af2603c773b4d11bf7e187ccb123ba2">read_clim_zm</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa7ad8811329e690f4a3c4431b16f8d19">clim_oh_filename</a>, <span class="stringliteral">&quot;OH&quot;</span>, &amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#ac67a2bf753276e20cc577a0134b29252">oh</a>);</div>
<div class="line"><span class="lineno"> 5475</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a572e117f02cbfced576c216d366d1a89">oh_chem_beta</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 5476</span>      <a class="code hl_function" href="mptrac_8c.html#aba22251f4ea0fe56c2a59719998c650a">clim_oh_diurnal_correction</a>(ctl, clim);</div>
<div class="line"><span class="lineno"> 5477</span>  }</div>
<div class="line"><span class="lineno"> 5478</span> </div>
<div class="line"><span class="lineno"> 5479</span>  <span class="comment">/* Read H2O2 climatology... */</span></div>
<div class="line"><span class="lineno"> 5480</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a711670450c0aa59e4ae6cc7b199ba63e">clim_h2o2_filename</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 5481</span>    <a class="code hl_function" href="mptrac_8c.html#a6af2603c773b4d11bf7e187ccb123ba2">read_clim_zm</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a711670450c0aa59e4ae6cc7b199ba63e">clim_h2o2_filename</a>, <span class="stringliteral">&quot;H2O2&quot;</span>, &amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#ab7f787719be51524b1389bb0bf347934">h2o2</a>);</div>
<div class="line"><span class="lineno"> 5482</span> </div>
<div class="line"><span class="lineno"> 5483</span>  <span class="comment">/* Read HO2 climatology... */</span></div>
<div class="line"><span class="lineno"> 5484</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d8c402293e6879df38c55a4241b1ad5">clim_ho2_filename</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 5485</span>    <a class="code hl_function" href="mptrac_8c.html#a6af2603c773b4d11bf7e187ccb123ba2">read_clim_zm</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d8c402293e6879df38c55a4241b1ad5">clim_ho2_filename</a>, <span class="stringliteral">&quot;HO2&quot;</span>, &amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a2ba0d75a451d9382ba20ec54d1784e05">ho2</a>);</div>
<div class="line"><span class="lineno"> 5486</span> </div>
<div class="line"><span class="lineno"> 5487</span>  <span class="comment">/* Read O(1D) climatology... */</span></div>
<div class="line"><span class="lineno"> 5488</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587e33a3eebf5c424f67d94200f598ff">clim_o1d_filename</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 5489</span>    <a class="code hl_function" href="mptrac_8c.html#a6af2603c773b4d11bf7e187ccb123ba2">read_clim_zm</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587e33a3eebf5c424f67d94200f598ff">clim_o1d_filename</a>, <span class="stringliteral">&quot;O1D&quot;</span>, &amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a9a7486ab639da63d6ac55d6cbacdcf0e">o1d</a>);</div>
<div class="line"><span class="lineno"> 5490</span> </div>
<div class="line"><span class="lineno"> 5491</span>  <span class="comment">/* Read CFC-10 time series... */</span></div>
<div class="line"><span class="lineno"> 5492</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa17140ad321005a763259a2ae7dcd858">clim_ccl4_timeseries</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 5493</span>    <a class="code hl_function" href="mptrac_8c.html#a3510fe56a6a6e589b5c2474495af03e2">read_clim_ts</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa17140ad321005a763259a2ae7dcd858">clim_ccl4_timeseries</a>, &amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a7c4cf5c511a125b4e3bc3731157037f3">ccl4</a>);</div>
<div class="line"><span class="lineno"> 5494</span> </div>
<div class="line"><span class="lineno"> 5495</span>  <span class="comment">/* Read CFC-11 time series... */</span></div>
<div class="line"><span class="lineno"> 5496</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac6e501659bef71188874bf710d510635">clim_ccl3f_timeseries</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 5497</span>    <a class="code hl_function" href="mptrac_8c.html#a3510fe56a6a6e589b5c2474495af03e2">read_clim_ts</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac6e501659bef71188874bf710d510635">clim_ccl3f_timeseries</a>, &amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a84f795c6c4934f9e215b74dffa177685">ccl3f</a>);</div>
<div class="line"><span class="lineno"> 5498</span> </div>
<div class="line"><span class="lineno"> 5499</span>  <span class="comment">/* Read CFC-12 time series... */</span></div>
<div class="line"><span class="lineno"> 5500</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad262595cbb226c73adcde30a4b7d3bf9">clim_ccl2f2_timeseries</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 5501</span>    <a class="code hl_function" href="mptrac_8c.html#a3510fe56a6a6e589b5c2474495af03e2">read_clim_ts</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad262595cbb226c73adcde30a4b7d3bf9">clim_ccl2f2_timeseries</a>, &amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a0d489a65c8c1cee839f3467a1c51c401">ccl2f2</a>);</div>
<div class="line"><span class="lineno"> 5502</span> </div>
<div class="line"><span class="lineno"> 5503</span>  <span class="comment">/* Read N2O time series... */</span></div>
<div class="line"><span class="lineno"> 5504</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0bdff7541fde7bd508072c44279519fd">clim_n2o_timeseries</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 5505</span>    <a class="code hl_function" href="mptrac_8c.html#a3510fe56a6a6e589b5c2474495af03e2">read_clim_ts</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0bdff7541fde7bd508072c44279519fd">clim_n2o_timeseries</a>, &amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#af11604629b6390f0fdbb734b0dce2554">n2o</a>);</div>
<div class="line"><span class="lineno"> 5506</span> </div>
<div class="line"><span class="lineno"> 5507</span>  <span class="comment">/* Read SF6 time series... */</span></div>
<div class="line"><span class="lineno"> 5508</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab08651e92983408ef0bebfe875c59851">clim_sf6_timeseries</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno"> 5509</span>    <a class="code hl_function" href="mptrac_8c.html#a3510fe56a6a6e589b5c2474495af03e2">read_clim_ts</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab08651e92983408ef0bebfe875c59851">clim_sf6_timeseries</a>, &amp;clim-&gt;<a class="code hl_variable" href="structclim__t.html#a787e837b08fea0fce0c6fe04140fb393">sf6</a>);</div>
<div class="line"><span class="lineno"> 5510</span>}</div>
<div class="ttc" id="amptrac_8c_html_a1a501ec43c01f1d742a133a7a3289d59"><div class="ttname"><a href="mptrac_8c.html#a1a501ec43c01f1d742a133a7a3289d59">read_clim_photo</a></div><div class="ttdeci">void read_clim_photo(const char *filename, clim_photo_t *photo)</div><div class="ttdoc">Reads photolysis rates from a NetCDF file and populates the given photolysis structure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07210">mptrac.c:7210</a></div></div>
<div class="ttc" id="amptrac_8c_html_a3510fe56a6a6e589b5c2474495af03e2"><div class="ttname"><a href="mptrac_8c.html#a3510fe56a6a6e589b5c2474495af03e2">read_clim_ts</a></div><div class="ttdeci">int read_clim_ts(const char *filename, clim_ts_t *ts)</div><div class="ttdoc">Reads a climatological time series from a file and populates the given time series structure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07329">mptrac.c:7329</a></div></div>
<div class="ttc" id="amptrac_8c_html_a6af2603c773b4d11bf7e187ccb123ba2"><div class="ttname"><a href="mptrac_8c.html#a6af2603c773b4d11bf7e187ccb123ba2">read_clim_zm</a></div><div class="ttdeci">void read_clim_zm(const char *filename, const char *varname, clim_zm_t *zm)</div><div class="ttdoc">Reads zonally averaged climatological data from a netCDF file and populates the given structure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07383">mptrac.c:7383</a></div></div>
<div class="ttc" id="amptrac_8c_html_aa9cf40c6960c5078d1ea9e12a2fb0872"><div class="ttname"><a href="mptrac_8c.html#aa9cf40c6960c5078d1ea9e12a2fb0872">clim_tropo_init</a></div><div class="ttdeci">void clim_tropo_init(clim_t *clim)</div><div class="ttdoc">Initializes the tropopause data in the climatology structure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l00232">mptrac.c:232</a></div></div>
<div class="ttc" id="amptrac_8c_html_aba22251f4ea0fe56c2a59719998c650a"><div class="ttname"><a href="mptrac_8c.html#aba22251f4ea0fe56c2a59719998c650a">clim_oh_diurnal_correction</a></div><div class="ttdeci">void clim_oh_diurnal_correction(const ctl_t *ctl, clim_t *clim)</div><div class="ttdoc">Applies a diurnal correction to the hydroxyl radical (OH) concentration in climatology data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l00115">mptrac.c:115</a></div></div>
<div class="ttc" id="astructctl__t_html_a2d8c402293e6879df38c55a4241b1ad5"><div class="ttname"><a href="structctl__t.html#a2d8c402293e6879df38c55a4241b1ad5">ctl_t::clim_ho2_filename</a></div><div class="ttdeci">char clim_ho2_filename[LEN]</div><div class="ttdoc">Filename of HO2 climatology.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02757">mptrac.h:2757</a></div></div>
<div class="ttc" id="astructctl__t_html_a587e33a3eebf5c424f67d94200f598ff"><div class="ttname"><a href="structctl__t.html#a587e33a3eebf5c424f67d94200f598ff">ctl_t::clim_o1d_filename</a></div><div class="ttdeci">char clim_o1d_filename[LEN]</div><div class="ttdoc">Filename of O(1D) climatology.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02760">mptrac.h:2760</a></div></div>
<div class="ttc" id="astructctl__t_html_a5a52a92586476c70f20788fd481d98f3"><div class="ttname"><a href="structctl__t.html#a5a52a92586476c70f20788fd481d98f3">ctl_t::clim_photo</a></div><div class="ttdeci">char clim_photo[LEN]</div><div class="ttdoc">Filename of photolysis rates climatology.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02745">mptrac.h:2745</a></div></div>
<div class="ttc" id="astructctl__t_html_a711670450c0aa59e4ae6cc7b199ba63e"><div class="ttname"><a href="structctl__t.html#a711670450c0aa59e4ae6cc7b199ba63e">ctl_t::clim_h2o2_filename</a></div><div class="ttdeci">char clim_h2o2_filename[LEN]</div><div class="ttdoc">Filename of H2O2 climatology.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02754">mptrac.h:2754</a></div></div>
<div class="ttc" id="astructctl__t_html_aa7ad8811329e690f4a3c4431b16f8d19"><div class="ttname"><a href="structctl__t.html#aa7ad8811329e690f4a3c4431b16f8d19">ctl_t::clim_oh_filename</a></div><div class="ttdeci">char clim_oh_filename[LEN]</div><div class="ttdoc">Filename of OH climatology.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02751">mptrac.h:2751</a></div></div>
<div class="ttc" id="astructctl__t_html_adcb60205ef46f49695f9f06257dc0346"><div class="ttname"><a href="structctl__t.html#adcb60205ef46f49695f9f06257dc0346">ctl_t::clim_hno3_filename</a></div><div class="ttdeci">char clim_hno3_filename[LEN]</div><div class="ttdoc">Filename of HNO3 climatology.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02748">mptrac.h:2748</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a8fc9ec02bd18b27c2e225161d833c766_cgraph.png" border="0" usemap="#amptrac_8h_a8fc9ec02bd18b27c2e225161d833c766_cgraph" alt=""/></div>
<map name="amptrac_8h_a8fc9ec02bd18b27c2e225161d833c766_cgraph" id="amptrac_8h_a8fc9ec02bd18b27c2e225161d833c766_cgraph">
<area shape="rect" title="Reads various climatological data and populates the given climatology structure." alt="" coords="5,107,131,133"/>
<area shape="rect" href="mptrac_8c.html#aba22251f4ea0fe56c2a59719998c650a" title="Applies a diurnal correction to the hydroxyl radical (OH) concentration in climatology data." alt="" coords="179,5,355,32"/>
<area shape="rect" href="mptrac_8c.html#aa9cf40c6960c5078d1ea9e12a2fb0872" title="Initializes the tropopause data in the climatology structure." alt="" coords="213,56,320,83"/>
<area shape="rect" href="mptrac_8c.html#a1a501ec43c01f1d742a133a7a3289d59" title="Reads photolysis rates from a NetCDF file and populates the given photolysis structure." alt="" coords="208,107,325,133"/>
<area shape="rect" href="mptrac_8c.html#a3510fe56a6a6e589b5c2474495af03e2" title="Reads a climatological time series from a file and populates the given time series structure." alt="" coords="219,157,315,184"/>
<area shape="rect" href="mptrac_8c.html#a6af2603c773b4d11bf7e187ccb123ba2" title="Reads zonally averaged climatological data from a netCDF file and populates the given structure." alt="" coords="215,208,318,235"/>
<area shape="rect" href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="441,5,512,32"/>
<area shape="rect" href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d" title="Reads a 3D climatological photochemistry variable from a NetCDF file." alt="" coords="403,107,551,133"/>
</map>
</div>

</div>
</div>
<a id="adb6e87e9f904fe4ad238e5a99ec9fbc6" name="adb6e87e9f904fe4ad238e5a99ec9fbc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb6e87e9f904fe4ad238e5a99ec9fbc6">&#9670;&nbsp;</a></span>mptrac_read_ctl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_read_ctl </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads control parameters from a configuration file and populates the given structure. </p>
<p >This function reads control parameters from a specified configuration file and command line arguments, populating the provided <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure with the parsed data. It handles a wide range of parameters, performing necessary checks and providing default values where applicable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string containing the path to the configuration file. </td></tr>
    <tr><td class="paramname">argc</td><td>An integer representing the number of command line arguments. </td></tr>
    <tr><td class="paramname">argv</td><td>An array of strings containing the command line arguments. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to the structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) that will be populated with the control parameters.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets a timer for reading the control file.</li>
<li>Logs information about the MPTRAC executable version and compilation details.</li>
<li>Initializes quantity indices.</li>
<li>Reads and sets various control parameters such as quantities, vertical coordinates, time steps, meteorological data, sorting options, isosurface parameters, random number generator type, advection parameters, diffusion parameters, convection parameters, boundary conditions, species parameters, molar mass, OH chemistry parameters, H2O2 chemistry parameters, KPP chemistry parameters, first order tracer chemistry parameters, wet deposition parameters, dry deposition parameters, climatological data paths, mixing parameters, chemistry grid parameters, exponential decay parameters, PSC analysis parameters, output parameters for atmospheric data, CSI data, ensemble data, grid data, profile data, sample data, station data, and VTK data.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l05514">5514</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5518</span>              {</div>
<div class="line"><span class="lineno"> 5519</span> </div>
<div class="line"><span class="lineno"> 5520</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 5521</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_CTL&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 5522</span> </div>
<div class="line"><span class="lineno"> 5523</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 5524</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;\nMassive-Parallel Trajectory Calculations (MPTRAC)\n&quot;</span></div>
<div class="line"><span class="lineno"> 5525</span>      <span class="stringliteral">&quot;(executable: %s | version: %s | compiled: %s, %s)\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 5526</span>      argv[0], VERSION, __DATE__, __TIME__);</div>
<div class="line"><span class="lineno"> 5527</span> </div>
<div class="line"><span class="lineno"> 5528</span>  <span class="comment">/* Initialize quantity indices... */</span></div>
<div class="line"><span class="lineno"> 5529</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeac7515d696805592f6ae25bf38b7ada">qnt_idx</a> = -1;</div>
<div class="line"><span class="lineno"> 5530</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a> = -1;</div>
<div class="line"><span class="lineno"> 5531</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a508aa1f5e4ba701e86557f114999b314">qnt_stat</a> = -1;</div>
<div class="line"><span class="lineno"> 5532</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> = -1;</div>
<div class="line"><span class="lineno"> 5533</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a323dd04f9b74b6bef349e3a91b649568">qnt_vmr</a> = -1;</div>
<div class="line"><span class="lineno"> 5534</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54a37ca01ed5643d41ee63768e5ad941">qnt_rp</a> = -1;</div>
<div class="line"><span class="lineno"> 5535</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a08ad320f9953658f5346a123ba03ad86">qnt_rhop</a> = -1;</div>
<div class="line"><span class="lineno"> 5536</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4217d6043a9429aa2c47517680d44453">qnt_ps</a> = -1;</div>
<div class="line"><span class="lineno"> 5537</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a262aa775e7fe82b123a62633d1c3d8b3">qnt_ts</a> = -1;</div>
<div class="line"><span class="lineno"> 5538</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a458f7cdd42fb5e2d9531e7d48038b730">qnt_zs</a> = -1;</div>
<div class="line"><span class="lineno"> 5539</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a88eb2c811b2a0c5482a020e41d26c270">qnt_us</a> = -1;</div>
<div class="line"><span class="lineno"> 5540</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a62b169930644e817a7275df51d40b51c">qnt_vs</a> = -1;</div>
<div class="line"><span class="lineno"> 5541</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae35e7cd824ea4b89ad435c45103f2758">qnt_ess</a> = -1;</div>
<div class="line"><span class="lineno"> 5542</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa8b0200a50b9f5530218ffa034865b74">qnt_nss</a> = -1;</div>
<div class="line"><span class="lineno"> 5543</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a614d6716edf50ef61ab09759c5c636eb">qnt_shf</a> = -1;</div>
<div class="line"><span class="lineno"> 5544</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3256dff5d8ff24754dfc04af56ae49d2">qnt_lsm</a> = -1;</div>
<div class="line"><span class="lineno"> 5545</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adb52d9a2f17944de5ed1b245ae0eb6b6">qnt_sst</a> = -1;</div>
<div class="line"><span class="lineno"> 5546</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a39d8a732f074ea0275ecb84832f60d59">qnt_pbl</a> = -1;</div>
<div class="line"><span class="lineno"> 5547</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8cd31f8b17d847f8012e472c89dbe164">qnt_pt</a> = -1;</div>
<div class="line"><span class="lineno"> 5548</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acc25e4fc819f75115dc6ae202437022d">qnt_tt</a> = -1;</div>
<div class="line"><span class="lineno"> 5549</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb9a716d40713cd9550a4a2d38389da0">qnt_zt</a> = -1;</div>
<div class="line"><span class="lineno"> 5550</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6755ea47ddbf456c114fe69d85e0424d">qnt_h2ot</a> = -1;</div>
<div class="line"><span class="lineno"> 5551</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7851aa93977a71a120361d75034a1808">qnt_zg</a> = -1;</div>
<div class="line"><span class="lineno"> 5552</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0545623fc0f39bea920d00bfc88c4d11">qnt_p</a> = -1;</div>
<div class="line"><span class="lineno"> 5553</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a91a6844a93bff2ff957aaf8bf31c1f3b">qnt_t</a> = -1;</div>
<div class="line"><span class="lineno"> 5554</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a850b57e663a4a8cde2952ecdad2c905f">qnt_rho</a> = -1;</div>
<div class="line"><span class="lineno"> 5555</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0f4b7179eb39bf6a1679f46e8826e1de">qnt_u</a> = -1;</div>
<div class="line"><span class="lineno"> 5556</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a78f8fa92da366751d4fe71f85661f9f3">qnt_v</a> = -1;</div>
<div class="line"><span class="lineno"> 5557</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4eff0a4676fbb4bb8a4b832900e16e48">qnt_w</a> = -1;</div>
<div class="line"><span class="lineno"> 5558</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a82e92a79bb65a2febe234d63f86fc91b">qnt_h2o</a> = -1;</div>
<div class="line"><span class="lineno"> 5559</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a013bc90afda842d7312647bfd0364232">qnt_o3</a> = -1;</div>
<div class="line"><span class="lineno"> 5560</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a22b2ba380a3c30089e5978c4a03311de">qnt_lwc</a> = -1;</div>
<div class="line"><span class="lineno"> 5561</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aedc44f2c1176820bd510219a03d3db53">qnt_rwc</a> = -1;</div>
<div class="line"><span class="lineno"> 5562</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a18974d6fa7e5e9e14a56338d638e730a">qnt_iwc</a> = -1;</div>
<div class="line"><span class="lineno"> 5563</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a09d4500bded056b92a7b3750d1af5ff1">qnt_swc</a> = -1;</div>
<div class="line"><span class="lineno"> 5564</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc9fd7f2b1a29910d6c37c9cb3bcee0d">qnt_cc</a> = -1;</div>
<div class="line"><span class="lineno"> 5565</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab7fd7495b74e0656e5a4c0a1e814899c">qnt_pct</a> = -1;</div>
<div class="line"><span class="lineno"> 5566</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0bdd43744dd2b92d5aa40627d028d42e">qnt_pcb</a> = -1;</div>
<div class="line"><span class="lineno"> 5567</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8dfbfb0242aca3ec0fa72564e8ceca6d">qnt_cl</a> = -1;</div>
<div class="line"><span class="lineno"> 5568</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afcd6307f3bcbd275ba14b572c6337dfa">qnt_plcl</a> = -1;</div>
<div class="line"><span class="lineno"> 5569</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a274f366df1c6e8dff7b16fc4cf2e1c0a">qnt_plfc</a> = -1;</div>
<div class="line"><span class="lineno"> 5570</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0350a3e6ada50d40416094ba8d079e4e">qnt_pel</a> = -1;</div>
<div class="line"><span class="lineno"> 5571</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9fce7d27388ac2b2a5fd8a0702243891">qnt_cape</a> = -1;</div>
<div class="line"><span class="lineno"> 5572</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abc63595c9161b9fd44ea2420514cb4cd">qnt_cin</a> = -1;</div>
<div class="line"><span class="lineno"> 5573</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa13722c873f7ec0c828c320546940528">qnt_o3c</a> = -1;</div>
<div class="line"><span class="lineno"> 5574</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a65efacd05321fc6c808732e77dc87c84">qnt_hno3</a> = -1;</div>
<div class="line"><span class="lineno"> 5575</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7c05d49d4f806a0f94c86ef932478cff">qnt_oh</a> = -1;</div>
<div class="line"><span class="lineno"> 5576</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a200b52904d3a14e04984a130528be5a0">qnt_h2o2</a> = -1;</div>
<div class="line"><span class="lineno"> 5577</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a554a6ad70e586d7aa1ac342cadb8c41e">qnt_ho2</a> = -1;</div>
<div class="line"><span class="lineno"> 5578</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2b485dd5916e7c0b346190afc5d2b437">qnt_o1d</a> = -1;</div>
<div class="line"><span class="lineno"> 5579</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9a389376b1aa37b73df1b45d1ac214d">qnt_mloss_oh</a> = -1;</div>
<div class="line"><span class="lineno"> 5580</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad1397317442e511e037568026f964bf0">qnt_mloss_h2o2</a> = -1;</div>
<div class="line"><span class="lineno"> 5581</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab8311e3b058164056666a4d284722545">qnt_mloss_kpp</a> = -1;</div>
<div class="line"><span class="lineno"> 5582</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a402ce921786cefb5ce431bda7dbf7f3c">qnt_mloss_wet</a> = -1;</div>
<div class="line"><span class="lineno"> 5583</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7900d5f3a8de6333a91c3794599a8e46">qnt_mloss_dry</a> = -1;</div>
<div class="line"><span class="lineno"> 5584</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5bb49c284e2579630f1eae77a769aba8">qnt_mloss_decay</a> = -1;</div>
<div class="line"><span class="lineno"> 5585</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a> = -1;</div>
<div class="line"><span class="lineno"> 5586</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab97b0cbae44a95ee03f10236380964ab">qnt_psat</a> = -1;</div>
<div class="line"><span class="lineno"> 5587</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3d8b0a7cd91c255170233ef509a24a84">qnt_psice</a> = -1;</div>
<div class="line"><span class="lineno"> 5588</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a19e02cd4b17e850b32bfd5d68d73d5a0">qnt_pw</a> = -1;</div>
<div class="line"><span class="lineno"> 5589</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae251e537db20eb4e1696488c89245d1b">qnt_sh</a> = -1;</div>
<div class="line"><span class="lineno"> 5590</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a682a2a90d1df78dd2a6cfb4fa77773cb">qnt_rh</a> = -1;</div>
<div class="line"><span class="lineno"> 5591</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8462c6531b8eba2bf01230b01a4b8a04">qnt_rhice</a> = -1;</div>
<div class="line"><span class="lineno"> 5592</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a33a185ae0cb5badcd525d961875d3b2c">qnt_theta</a> = -1;</div>
<div class="line"><span class="lineno"> 5593</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9382d9e9b29e10eeee582e1e10ff365a">qnt_zeta</a> = -1;</div>
<div class="line"><span class="lineno"> 5594</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6dcfd67edca4a35aeca78f6bfbd04487">qnt_zeta_d</a> = -1;</div>
<div class="line"><span class="lineno"> 5595</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9fd6dd75539124eff0a56876653ae771">qnt_zeta_dot</a> = -1;</div>
<div class="line"><span class="lineno"> 5596</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a59254cd97a92694d95b7fb6b384c4d3f">qnt_eta</a> = -1;</div>
<div class="line"><span class="lineno"> 5597</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a758245d1a36fda8f475e4041f5efcf7c">qnt_eta_dot</a> = -1;</div>
<div class="line"><span class="lineno"> 5598</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d0be917be3aba29baf2ed7f626bfa83">qnt_tvirt</a> = -1;</div>
<div class="line"><span class="lineno"> 5599</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a98ccf2cdccb18924d50cdcda383580ba">qnt_lapse</a> = -1;</div>
<div class="line"><span class="lineno"> 5600</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20196705d4eebddaeff4005ad88a20d2">qnt_vh</a> = -1;</div>
<div class="line"><span class="lineno"> 5601</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a55330859df8034626ba300905e35bb04">qnt_vz</a> = -1;</div>
<div class="line"><span class="lineno"> 5602</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad7e229a971d4aafe08bb607b7189b09f">qnt_pv</a> = -1;</div>
<div class="line"><span class="lineno"> 5603</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#affb8cb3c42f1f312990d97d7d49617e5">qnt_tdew</a> = -1;</div>
<div class="line"><span class="lineno"> 5604</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7606f8b8ba4df727e0c0c9386f527119">qnt_tice</a> = -1;</div>
<div class="line"><span class="lineno"> 5605</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa29a4ab3048a143622094d93886aa0db">qnt_tsts</a> = -1;</div>
<div class="line"><span class="lineno"> 5606</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a742e33a97813e9a50cb0e17a680e815a">qnt_tnat</a> = -1;</div>
<div class="line"><span class="lineno"> 5607</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae56fa1a240420b87bd2b7a0d040e6d11">qnt_Cx</a> = -1;</div>
<div class="line"><span class="lineno"> 5608</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9baf6b24cc12d9b589576a173bed3b8b">qnt_Ch2o</a> = -1;</div>
<div class="line"><span class="lineno"> 5609</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa1dc44e429c2e407559577b86c9fc170">qnt_Co3</a> = -1;</div>
<div class="line"><span class="lineno"> 5610</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a63128061ebb75c105f1774fa894d91c9">qnt_Cco</a> = -1;</div>
<div class="line"><span class="lineno"> 5611</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a028e098ce1133fc1a3993ea74d330330">qnt_Coh</a> = -1;</div>
<div class="line"><span class="lineno"> 5612</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7ef2d94a86e63af36c9022a55db08024">qnt_Ch</a> = -1;</div>
<div class="line"><span class="lineno"> 5613</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a99d38b5d6024bb51436e6271202d8968">qnt_Cho2</a> = -1;</div>
<div class="line"><span class="lineno"> 5614</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adaa906f8d83e26dde37b9242f567e329">qnt_Ch2o2</a> = -1;</div>
<div class="line"><span class="lineno"> 5615</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a18e4fa9a68e03ee2aa1be7e2feb6130f">qnt_Co1d</a> = -1;</div>
<div class="line"><span class="lineno"> 5616</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac04dce247fe52429fca4b3ddd32c4ed1">qnt_Co3p</a> = -1;</div>
<div class="line"><span class="lineno"> 5617</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1ba53bf2909cfe859cdd8d3e6db31e9a">qnt_Cccl4</a> = -1;</div>
<div class="line"><span class="lineno"> 5618</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a43ba4811191565b719506351b40515">qnt_Cccl3f</a> = -1;</div>
<div class="line"><span class="lineno"> 5619</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a066b3cab4ae3633d7f5a4cc178f8d655">qnt_Cccl2f2</a> = -1;</div>
<div class="line"><span class="lineno"> 5620</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a3a8cc8108f6dce4fcf6b82ceb97d22">qnt_Cn2o</a> = -1;</div>
<div class="line"><span class="lineno"> 5621</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ad1be4d2d7d089ba9311f6c6b17baa2">qnt_Csf6</a> = -1;</div>
<div class="line"><span class="lineno"> 5622</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a08aa70d2f116af5dfe779b6ecec4dd19">qnt_aoa</a> = -1;</div>
<div class="line"><span class="lineno"> 5623</span> </div>
<div class="line"><span class="lineno"> 5624</span><span class="preprocessor">#ifdef DD</span></div>
<div class="line"><span class="lineno"> 5625</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6b51b58d1fa0b7d78d7a7c6ce949cf35">qnt_destination</a> = -1;</div>
<div class="line"><span class="lineno"> 5626</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abb36100b62be343d46deae568209e001">qnt_subdomain</a> = -1;</div>
<div class="line"><span class="lineno"> 5627</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5628</span> </div>
<div class="line"><span class="lineno"> 5629</span>  <span class="comment">/* Read quantities... */</span></div>
<div class="line"><span class="lineno"> 5630</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;NQ&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5631</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a> &gt; <a class="code hl_define" href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>)</div>
<div class="line"><span class="lineno"> 5632</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many quantities!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5633</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno"> 5634</span> </div>
<div class="line"><span class="lineno"> 5635</span>    <span class="comment">/* Read quantity name and format... */</span></div>
<div class="line"><span class="lineno"> 5636</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;QNT_NAME&quot;</span>, iq, <span class="stringliteral">&quot;&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq]);</div>
<div class="line"><span class="lineno"> 5637</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;QNT_LONGNAME&quot;</span>, iq, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq],</div>
<div class="line"><span class="lineno"> 5638</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aef44654a72cbb96ba47c6284bd5f2316">qnt_longname</a>[iq]);</div>
<div class="line"><span class="lineno"> 5639</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;QNT_FORMAT&quot;</span>, iq, <span class="stringliteral">&quot;%g&quot;</span>,</div>
<div class="line"><span class="lineno"> 5640</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq]);</div>
<div class="line"><span class="lineno"> 5641</span>    <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], <span class="stringliteral">&quot;aoa&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 5642</span>      sprintf(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq], <span class="stringliteral">&quot;%%.2f&quot;</span>);</div>
<div class="line"><span class="lineno"> 5643</span> </div>
<div class="line"><span class="lineno"> 5644</span>    <span class="comment">/* Try to identify quantity... */</span></div>
<div class="line"><span class="lineno"> 5645</span>    <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_idx, <span class="stringliteral">&quot;idx&quot;</span>, <span class="stringliteral">&quot;particle index&quot;</span>, <span class="stringliteral">&quot;-&quot;</span>)</div>
<div class="line"><span class="lineno"> 5646</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_ens, &quot;ens&quot;, &quot;ensemble index&quot;, &quot;-&quot;)</div>
<div class="line"><span class="lineno"> 5647</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_stat, &quot;stat&quot;, &quot;station flag&quot;, &quot;-&quot;)</div>
<div class="line"><span class="lineno"> 5648</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_m, &quot;m&quot;, &quot;mass&quot;, &quot;kg&quot;)</div>
<div class="line"><span class="lineno"> 5649</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_vmr, &quot;vmr&quot;, &quot;volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5650</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_rp, &quot;rp&quot;, &quot;particle radius&quot;, &quot;microns&quot;)</div>
<div class="line"><span class="lineno"> 5651</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_rhop, &quot;rhop&quot;, &quot;particle density&quot;, &quot;kg/m^3&quot;)</div>
<div class="line"><span class="lineno"> 5652</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_ps, &quot;ps&quot;, &quot;surface pressure&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5653</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_ts, &quot;ts&quot;, &quot;surface temperature&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5654</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_zs, &quot;zs&quot;, &quot;surface height&quot;, &quot;km&quot;)</div>
<div class="line"><span class="lineno"> 5655</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_us, &quot;us&quot;, &quot;surface zonal wind&quot;, &quot;m/s&quot;)</div>
<div class="line"><span class="lineno"> 5656</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_vs, &quot;vs&quot;, &quot;surface meridional wind&quot;, &quot;m/s&quot;)</div>
<div class="line"><span class="lineno"> 5657</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_ess, &quot;ess&quot;, &quot;eastward turbulent surface stress&quot;, &quot;N/m^2&quot;)</div>
<div class="line"><span class="lineno"> 5658</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_nss, &quot;nss&quot;, &quot;northward turbulent surface stress&quot;, &quot;N/m^2&quot;)</div>
<div class="line"><span class="lineno"> 5659</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_shf, &quot;shf&quot;, &quot;surface sensible heat flux&quot;, &quot;W/m^2&quot;)</div>
<div class="line"><span class="lineno"> 5660</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_lsm, &quot;lsm&quot;, &quot;land-sea mask&quot;, &quot;1&quot;)</div>
<div class="line"><span class="lineno"> 5661</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_sst, &quot;sst&quot;, &quot;sea surface temperature&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5662</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_pbl, &quot;pbl&quot;, &quot;planetary boundary layer&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5663</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_pt, &quot;pt&quot;, &quot;tropopause pressure&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5664</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_tt, &quot;tt&quot;, &quot;tropopause temperature&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5665</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_zt, &quot;zt&quot;, &quot;tropopause geopotential height&quot;, &quot;km&quot;)</div>
<div class="line"><span class="lineno"> 5666</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_h2ot, &quot;h2ot&quot;, &quot;tropopause water vapor&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5667</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_zg, &quot;zg&quot;, &quot;geopotential height&quot;, &quot;km&quot;)</div>
<div class="line"><span class="lineno"> 5668</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_p, &quot;p&quot;, &quot;pressure&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5669</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_t, &quot;t&quot;, &quot;temperature&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5670</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_rho, &quot;rho&quot;, &quot;air density&quot;, &quot;kg/m^3&quot;)</div>
<div class="line"><span class="lineno"> 5671</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_u, &quot;u&quot;, &quot;zonal wind&quot;, &quot;m/s&quot;)</div>
<div class="line"><span class="lineno"> 5672</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_v, &quot;v&quot;, &quot;meridional wind&quot;, &quot;m/s&quot;)</div>
<div class="line"><span class="lineno"> 5673</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_w, &quot;w&quot;, &quot;vertical velocity&quot;, &quot;hPa/s&quot;)</div>
<div class="line"><span class="lineno"> 5674</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_h2o, &quot;h2o&quot;, &quot;water vapor&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5675</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_o3, &quot;o3&quot;, &quot;ozone&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5676</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_lwc, &quot;lwc&quot;, &quot;cloud liquid water content&quot;, &quot;kg/kg&quot;)</div>
<div class="line"><span class="lineno"> 5677</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_rwc, &quot;rwc&quot;, &quot;cloud rain water content&quot;, &quot;kg/kg&quot;)</div>
<div class="line"><span class="lineno"> 5678</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_iwc, &quot;iwc&quot;, &quot;cloud ice water content&quot;, &quot;kg/kg&quot;)</div>
<div class="line"><span class="lineno"> 5679</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_swc, &quot;swc&quot;, &quot;cloud snow water content&quot;, &quot;kg/kg&quot;)</div>
<div class="line"><span class="lineno"> 5680</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_cc, &quot;cc&quot;, &quot;cloud cover&quot;, &quot;1&quot;)</div>
<div class="line"><span class="lineno"> 5681</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_pct, &quot;pct&quot;, &quot;cloud top pressure&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5682</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_pcb, &quot;pcb&quot;, &quot;cloud bottom pressure&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5683</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_cl, &quot;cl&quot;, &quot;total column cloud water&quot;, &quot;kg/m^2&quot;)</div>
<div class="line"><span class="lineno"> 5684</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_plcl, &quot;plcl&quot;, &quot;lifted condensation level&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5685</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_plfc, &quot;plfc&quot;, &quot;level of free convection&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5686</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_pel, &quot;pel&quot;, &quot;equilibrium level&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5687</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_cape, &quot;cape&quot;, &quot;convective available potential energy&quot;,</div>
<div class="line"><span class="lineno"> 5688</span>              &quot;J/kg&quot;)</div>
<div class="line"><span class="lineno"> 5689</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_cin, &quot;cin&quot;, &quot;convective inhibition&quot;, &quot;J/kg&quot;)</div>
<div class="line"><span class="lineno"> 5690</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_o3c, &quot;o3c&quot;, &quot;total column ozone&quot;, &quot;DU&quot;)</div>
<div class="line"><span class="lineno"> 5691</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_hno3, &quot;hno3&quot;, &quot;nitric acid&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5692</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_oh, &quot;oh&quot;, &quot;hydroxyl radical&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5693</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_h2o2, &quot;h2o2&quot;, &quot;hydrogen peroxide&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5694</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_ho2, &quot;ho2&quot;, &quot;hydroperoxyl radical&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5695</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_o1d, &quot;o1d&quot;, &quot;atomic oxygen&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5696</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_mloss_oh, &quot;mloss_oh&quot;, &quot;mass loss due to OH chemistry&quot;, &quot;kg&quot;)</div>
<div class="line"><span class="lineno"> 5697</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_mloss_h2o2, &quot;mloss_h2o2&quot;,</div>
<div class="line"><span class="lineno"> 5698</span>              &quot;mass loss due to H2O2 chemistry&quot;, &quot;kg&quot;)</div>
<div class="line"><span class="lineno"> 5699</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_mloss_kpp, &quot;mloss_kpp&quot;, &quot;mass loss due to kpp chemistry&quot;,</div>
<div class="line"><span class="lineno"> 5700</span>              &quot;kg&quot;)</div>
<div class="line"><span class="lineno"> 5701</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_mloss_wet, &quot;mloss_wet&quot;, &quot;mass loss due to wet deposition&quot;,</div>
<div class="line"><span class="lineno"> 5702</span>              &quot;kg&quot;)</div>
<div class="line"><span class="lineno"> 5703</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_mloss_dry, &quot;mloss_dry&quot;, &quot;mass loss due to dry deposition&quot;,</div>
<div class="line"><span class="lineno"> 5704</span>              &quot;kg&quot;)</div>
<div class="line"><span class="lineno"> 5705</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_mloss_decay, &quot;mloss_decay&quot;,</div>
<div class="line"><span class="lineno"> 5706</span>              &quot;mass loss due to exponential decay&quot;, &quot;kg&quot;)</div>
<div class="line"><span class="lineno"> 5707</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_loss_rate, &quot;loss_rate&quot;, &quot;total loss rate&quot;, &quot;s^-1&quot;)</div>
<div class="line"><span class="lineno"> 5708</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_psat, &quot;psat&quot;, &quot;saturation pressure over water&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5709</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_psice, &quot;psice&quot;, &quot;saturation pressure over ice&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5710</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_pw, &quot;pw&quot;, &quot;partial water vapor pressure&quot;, &quot;hPa&quot;)</div>
<div class="line"><span class="lineno"> 5711</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_sh, &quot;sh&quot;, &quot;specific humidity&quot;, &quot;kg/kg&quot;)</div>
<div class="line"><span class="lineno"> 5712</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_rh, &quot;rh&quot;, &quot;relative humidity&quot;, &quot;%%&quot;)</div>
<div class="line"><span class="lineno"> 5713</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_rhice, &quot;rhice&quot;, &quot;relative humidity over ice&quot;, &quot;%%&quot;)</div>
<div class="line"><span class="lineno"> 5714</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_theta, &quot;theta&quot;, &quot;potential temperature&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5715</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_zeta, &quot;zeta&quot;, &quot;zeta coordinate&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5716</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_zeta_d, &quot;zeta_d&quot;, &quot;diagnosed zeta coordinate&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5717</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_zeta_dot, &quot;zeta_dot&quot;, &quot;velocity of zeta coordinate&quot;,</div>
<div class="line"><span class="lineno"> 5718</span>              &quot;K/day&quot;)</div>
<div class="line"><span class="lineno"> 5719</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_eta, &quot;eta&quot;, &quot;eta coordinate&quot;, &quot;1&quot;)</div>
<div class="line"><span class="lineno"> 5720</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_eta_dot, &quot;eta_dot&quot;, &quot;velocity of eta coordinate&quot;, &quot;1/s&quot;)</div>
<div class="line"><span class="lineno"> 5721</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_tvirt, &quot;tvirt&quot;, &quot;virtual temperature&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5722</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_lapse, &quot;lapse&quot;, &quot;temperature lapse rate&quot;, &quot;K/km&quot;)</div>
<div class="line"><span class="lineno"> 5723</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_vh, &quot;vh&quot;, &quot;horizontal velocity&quot;, &quot;m/s&quot;)</div>
<div class="line"><span class="lineno"> 5724</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_vz, &quot;vz&quot;, &quot;vertical velocity&quot;, &quot;m/s&quot;)</div>
<div class="line"><span class="lineno"> 5725</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_pv, &quot;pv&quot;, &quot;potential vorticity&quot;, &quot;PVU&quot;)</div>
<div class="line"><span class="lineno"> 5726</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_tdew, &quot;tdew&quot;, &quot;dew point temperature&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5727</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_tice, &quot;tice&quot;, &quot;frost point temperature&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5728</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_tsts, &quot;tsts&quot;, &quot;STS existence temperature&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5729</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_tnat, &quot;tnat&quot;, &quot;NAT existence temperature&quot;, &quot;K&quot;)</div>
<div class="line"><span class="lineno"> 5730</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Cx, &quot;Cx&quot;, &quot;Trace species x volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5731</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Ch2o, &quot;Ch2o&quot;, &quot;H2O volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5732</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Co3, &quot;Co3&quot;, &quot;O3 volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5733</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Cco, &quot;Cco&quot;, &quot;CO volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5734</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Coh, &quot;Coh&quot;, &quot;HO volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5735</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Ch, &quot;Ch&quot;, &quot;H radical volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5736</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Cho2, &quot;Cho2&quot;, &quot;HO2 volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5737</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Ch2o2, &quot;Ch2o2&quot;, &quot;H2O2 volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5738</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Co1d, &quot;Co1d&quot;, &quot;O(1D) volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5739</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Co3p, &quot;Co3p&quot;, &quot;O(3<a class="code hl_define" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>) radical volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5740</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Cccl4, &quot;Cccl4&quot;, &quot;CCl4 (CFC-10) volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5741</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Cccl3f, &quot;Cccl3f&quot;, &quot;CCl3F (CFC-11) volume mixing ratio&quot;,</div>
<div class="line"><span class="lineno"> 5742</span>              &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5743</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Cccl2f2, &quot;Cccl2f2&quot;, &quot;CCl2F2 (CFC-12) volume mixing ratio&quot;,</div>
<div class="line"><span class="lineno"> 5744</span>              &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5745</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Cn2o, &quot;Cn2o&quot;, &quot;N2O volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5746</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_Csf6, &quot;Csf6&quot;, &quot;SF6 volume mixing ratio&quot;, &quot;ppv&quot;)</div>
<div class="line"><span class="lineno"> 5747</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_aoa, &quot;aoa&quot;, &quot;age of air&quot;, &quot;s&quot;)</div>
<div class="line"><span class="lineno"> 5748</span><span class="preprocessor">#ifdef DD</span></div>
<div class="line"><span class="lineno"> 5749</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_destination, <span class="stringliteral">&quot;destination&quot;</span>,</div>
<div class="line"><span class="lineno"> 5750</span>              <span class="stringliteral">&quot;subdomain index of destination&quot;</span>, <span class="stringliteral">&quot;-&quot;</span>)</div>
<div class="line"><span class="lineno"> 5751</span>      <a class="code hl_define" href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a>(qnt_subdomain, &quot;subdomain&quot;, &quot;current subdomain index&quot;, &quot;-&quot;)</div>
<div class="line"><span class="lineno"> 5752</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5753</span>      <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;QNT_UNIT&quot;</span>, iq, <span class="stringliteral">&quot;&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq]);</div>
<div class="line"><span class="lineno"> 5754</span>  }</div>
<div class="line"><span class="lineno"> 5755</span> </div>
<div class="line"><span class="lineno"> 5756</span>  <span class="comment">/* Vertical coordinate and velocity... */</span></div>
<div class="line"><span class="lineno"> 5757</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> =</div>
<div class="line"><span class="lineno"> 5758</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ADVECT_VERT_COORD&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5759</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> &gt; 3)</div>
<div class="line"><span class="lineno"> 5760</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;ADVECT_VERT_COORD must be 0, 1, 2, or 3!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5761</span> </div>
<div class="line"><span class="lineno"> 5762</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 1 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9382d9e9b29e10eeee582e1e10ff365a">qnt_zeta</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 5763</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Add quantity zeta for diabatic advection!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5764</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 3 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a59254cd97a92694d95b7fb6b384c4d3f">qnt_eta</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 5765</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Add quantity eta for etadot avection!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5766</span> </div>
<div class="line"><span class="lineno"> 5767</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> =</div>
<div class="line"><span class="lineno"> 5768</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_VERT_COORD&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5769</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> &gt; 4)</div>
<div class="line"><span class="lineno"> 5770</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MET_VERT_COORD must be 0, 1, 2, 3, or 4!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5771</span> </div>
<div class="line"><span class="lineno"> 5772</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 2 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> == 0)</div>
<div class="line"><span class="lineno"> 5773</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a></div>
<div class="line"><span class="lineno"> 5774</span>      (<span class="stringliteral">&quot;Using ADVECT_VERT_COORD = 2 requires meteo data on model levels!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5775</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 3 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> != 3)</div>
<div class="line"><span class="lineno"> 5776</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a></div>
<div class="line"><span class="lineno"> 5777</span>      (<span class="stringliteral">&quot;Using ADVECT_VERT_COORD = 3 requires A and B model level coefficients!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5778</span> </div>
<div class="line"><span class="lineno"> 5779</span>  <span class="comment">/* Time steps of simulation... */</span></div>
<div class="line"><span class="lineno"> 5780</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a> =</div>
<div class="line"><span class="lineno"> 5781</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;DIRECTION&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5782</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a> != -1 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a6d5b4003ebd8f9c77b3b45933779e6">direction</a> != 1)</div>
<div class="line"><span class="lineno"> 5783</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set DIRECTION to -1 or 1!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5784</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;T_STOP&quot;</span>, -1, <span class="stringliteral">&quot;1e100&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5785</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;DT_MOD&quot;</span>, -1, <span class="stringliteral">&quot;180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5786</span> </div>
<div class="line"><span class="lineno"> 5787</span>  <span class="comment">/* Meteo data... */</span></div>
<div class="line"><span class="lineno"> 5788</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;METBASE&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9ddc0221c9ee329efb265672a14026c9">metbase</a>);</div>
<div class="line"><span class="lineno"> 5789</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d7b8100a2949004420841d81bcc6ab4">dt_met</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;DT_MET&quot;</span>, -1, <span class="stringliteral">&quot;3600&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5790</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6d866e961e374a254d7dc52ea52cb3db">met_convention</a> =</div>
<div class="line"><span class="lineno"> 5791</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CONVENTION&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5792</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> =</div>
<div class="line"><span class="lineno"> 5793</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_TYPE&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5794</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 1 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> != 0)</div>
<div class="line"><span class="lineno"> 5795</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a></div>
<div class="line"><span class="lineno"> 5796</span>      (<span class="stringliteral">&quot;Please use meteo files in netcdf format for diabatic calculations.&quot;</span>);</div>
<div class="line"><span class="lineno"> 5797</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 3 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> != 0)</div>
<div class="line"><span class="lineno"> 5798</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a></div>
<div class="line"><span class="lineno"> 5799</span>      (<span class="stringliteral">&quot;Please use meteo files in netcdf format for etadot calculations.&quot;</span>);</div>
<div class="line"><span class="lineno"> 5800</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6607c472936ade8396ee3095595f0475">met_clams</a> =</div>
<div class="line"><span class="lineno"> 5801</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CLAMS&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5802</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a034e61c3566760c5ebe4e16f3f3c3021">met_nc_scale</a> =</div>
<div class="line"><span class="lineno"> 5803</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_NC_SCALE&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5804</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a> =</div>
<div class="line"><span class="lineno"> 5805</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_NC_LEVEL&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5806</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a> =</div>
<div class="line"><span class="lineno"> 5807</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_NC_QUANT&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5808</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1601f7c2d8e163790e3a81cc647b7756">met_zstd_level</a> =</div>
<div class="line"><span class="lineno"> 5809</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_ZSTD_LEVEL&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5810</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="mptrac_8h.html#a1d2af32106d1fe82729714d3aa28a1c4">METVAR</a>; i++) {</div>
<div class="line"><span class="lineno"> 5811</span>    <span class="keywordtype">char</span> defprec[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>] = <span class="stringliteral">&quot;0&quot;</span>, deftol[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>] = <span class="stringliteral">&quot;0.0&quot;</span>;</div>
<div class="line"><span class="lineno"> 5812</span>    <span class="keywordflow">if</span> (i == 0)                 <span class="comment">/* geopotential height */</span></div>
<div class="line"><span class="lineno"> 5813</span>      sprintf(deftol, <span class="stringliteral">&quot;0.5&quot;</span>);</div>
<div class="line"><span class="lineno"> 5814</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == 1)            <span class="comment">/* temperature */</span></div>
<div class="line"><span class="lineno"> 5815</span>      sprintf(deftol, <span class="stringliteral">&quot;5.0&quot;</span>);</div>
<div class="line"><span class="lineno"> 5816</span>    <span class="keywordflow">else</span>                        <span class="comment">/* other variables */</span></div>
<div class="line"><span class="lineno"> 5817</span>      sprintf(defprec, <span class="stringliteral">&quot;8&quot;</span>);</div>
<div class="line"><span class="lineno"> 5818</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[i] =</div>
<div class="line"><span class="lineno"> 5819</span>      (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_COMP_PREC&quot;</span>, i, defprec, NULL);</div>
<div class="line"><span class="lineno"> 5820</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[i] =</div>
<div class="line"><span class="lineno"> 5821</span>      <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_COMP_TOL&quot;</span>, i, deftol, NULL);</div>
<div class="line"><span class="lineno"> 5822</span>  }</div>
<div class="line"><span class="lineno"> 5823</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab340e5d6eb4be0b66bc60b183182b43e">met_cms_batch</a> =</div>
<div class="line"><span class="lineno"> 5824</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_BATCH&quot;</span>, -1, <span class="stringliteral">&quot;-1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5825</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac789d48daaf3f1df6364fcebfee4d315">met_cms_zstd</a> =</div>
<div class="line"><span class="lineno"> 5826</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_ZSTD&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5827</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5dcfc2a583119a8e54a0780c6ea6dcbf">met_cms_nd0x</a> =</div>
<div class="line"><span class="lineno"> 5828</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_ND0X&quot;</span>, -1, <span class="stringliteral">&quot;48&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5829</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9fff96ce390ca38b2307dc397664f8c3">met_cms_nd0y</a> =</div>
<div class="line"><span class="lineno"> 5830</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_ND0Y&quot;</span>, -1, <span class="stringliteral">&quot;24&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5831</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac7986250a4ebebaf96197571908d6343">met_cms_maxlev</a> =</div>
<div class="line"><span class="lineno"> 5832</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_MAXLEV&quot;</span>, -1, <span class="stringliteral">&quot;6&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5833</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8941dd7fe11401d55bfaf1726c6a7beb">met_cms_eps_z</a> =</div>
<div class="line"><span class="lineno"> 5834</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_Z&quot;</span>, -1, <span class="stringliteral">&quot;1.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5835</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9f8db524ed98c32fe612acfc060c1dd4">met_cms_eps_t</a> =</div>
<div class="line"><span class="lineno"> 5836</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_T&quot;</span>, -1, <span class="stringliteral">&quot;0.05&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5837</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a30faf85e41c30103312372114b43cfd9">met_cms_eps_u</a> =</div>
<div class="line"><span class="lineno"> 5838</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_U&quot;</span>, -1, <span class="stringliteral">&quot;0.05&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5839</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4eca0cacca656d7c8121821859e83a53">met_cms_eps_v</a> =</div>
<div class="line"><span class="lineno"> 5840</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_V&quot;</span>, -1, <span class="stringliteral">&quot;0.05&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5841</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad32a8979c9af7651a932d8e4a38a36ef">met_cms_eps_w</a> =</div>
<div class="line"><span class="lineno"> 5842</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_W&quot;</span>, -1, <span class="stringliteral">&quot;1.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5843</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a18f244fd363b499ed9add07ecba27c51">met_cms_eps_pv</a> =</div>
<div class="line"><span class="lineno"> 5844</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_PV&quot;</span>, -1, <span class="stringliteral">&quot;1.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5845</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26f8ddbe9458a750f9f321bd3eefc665">met_cms_eps_h2o</a> =</div>
<div class="line"><span class="lineno"> 5846</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_H2O&quot;</span>, -1, <span class="stringliteral">&quot;1.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5847</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac782f7d68928f956202175bd44926644">met_cms_eps_o3</a> =</div>
<div class="line"><span class="lineno"> 5848</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_O3&quot;</span>, -1, <span class="stringliteral">&quot;1.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5849</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a880c7b75ded6d605d4fa81a16f9e4c9e">met_cms_eps_lwc</a> =</div>
<div class="line"><span class="lineno"> 5850</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_LWC&quot;</span>, -1, <span class="stringliteral">&quot;1.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5851</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe3f471333cabadb674f7f0eed43d21b">met_cms_eps_rwc</a> =</div>
<div class="line"><span class="lineno"> 5852</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_RWC&quot;</span>, -1, <span class="stringliteral">&quot;1.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5853</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4c6e62f749bbce82b5d29860e5def10a">met_cms_eps_iwc</a> =</div>
<div class="line"><span class="lineno"> 5854</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_IWC&quot;</span>, -1, <span class="stringliteral">&quot;1.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5855</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4d43909ab5875fc1e0e53966272ccc1a">met_cms_eps_swc</a> =</div>
<div class="line"><span class="lineno"> 5856</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_SWC&quot;</span>, -1, <span class="stringliteral">&quot;1.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5857</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a68531957caab05e8575ca3b92046a677">met_cms_eps_cc</a> =</div>
<div class="line"><span class="lineno"> 5858</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CMS_EPS_CC&quot;</span>, -1, <span class="stringliteral">&quot;1.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5859</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6b03cd434f6f12efc60dc4b8d366d6c7">met_dx</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_DX&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5860</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae4da60e71dcd75d1b55f66036867f225">met_dy</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_DY&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5861</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1eb5d7699fd84b8522a1d666d0851fad">met_dp</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_DP&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5862</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6b03cd434f6f12efc60dc4b8d366d6c7">met_dx</a> &lt; 1 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae4da60e71dcd75d1b55f66036867f225">met_dy</a> &lt; 1 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1eb5d7699fd84b8522a1d666d0851fad">met_dp</a> &lt; 1)</div>
<div class="line"><span class="lineno"> 5863</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MET_DX, MET_DY, and MET_DP need to be greater than zero!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5864</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4abb2ec4ff0e29f2648cb5e8b182e5d8">met_sx</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_SX&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5865</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a416820ddede3de831eb41413ed6427c0">met_sy</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_SY&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5866</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab5296a9ff61f1f50c9733462cd294889">met_sp</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_SP&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5867</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4abb2ec4ff0e29f2648cb5e8b182e5d8">met_sx</a> &lt; 1 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a416820ddede3de831eb41413ed6427c0">met_sy</a> &lt; 1 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab5296a9ff61f1f50c9733462cd294889">met_sp</a> &lt; 1)</div>
<div class="line"><span class="lineno"> 5868</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MET_SX, MET_SY, and MET_SP need to be greater than zero!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5869</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9bc04b87ec1a0e2403117d639f6c1416">met_detrend</a> =</div>
<div class="line"><span class="lineno"> 5870</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_DETREND&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5871</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_NP&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5872</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> &gt; <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>)</div>
<div class="line"><span class="lineno"> 5873</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many pressure levels!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5874</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f9887a656e745a4c26dbd7d0730d0fc">met_press_level_def</a> =</div>
<div class="line"><span class="lineno"> 5875</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_PRESS_LEVEL_DEF&quot;</span>, -1, <span class="stringliteral">&quot;-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 5876</span>                   NULL);</div>
<div class="line"><span class="lineno"> 5877</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7f9887a656e745a4c26dbd7d0730d0fc">met_press_level_def</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 5878</span>    <a class="code hl_function" href="mptrac_8c.html#a51f61e053cfec3bdd62fa3a8110e046e">level_definitions</a>(ctl);</div>
<div class="line"><span class="lineno"> 5879</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5880</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 5881</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>; ip++)</div>
<div class="line"><span class="lineno"> 5882</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[ip] =</div>
<div class="line"><span class="lineno"> 5883</span>          <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_P&quot;</span>, ip, <span class="stringliteral">&quot;&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5884</span>    }</div>
<div class="line"><span class="lineno"> 5885</span>  }</div>
<div class="line"><span class="lineno"> 5886</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6024bf55339aa76e34a54e29f357bf6d">met_nlev</a> =</div>
<div class="line"><span class="lineno"> 5887</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_NLEV&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5888</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6024bf55339aa76e34a54e29f357bf6d">met_nlev</a> &gt; <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>)</div>
<div class="line"><span class="lineno"> 5889</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many model levels!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5890</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6024bf55339aa76e34a54e29f357bf6d">met_nlev</a>; ip++)</div>
<div class="line"><span class="lineno"> 5891</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a900048dd4610de834a719004818b920a">met_lev_hyam</a>[ip] =</div>
<div class="line"><span class="lineno"> 5892</span>      <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_LEV_HYAM&quot;</span>, ip, <span class="stringliteral">&quot;&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5893</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6024bf55339aa76e34a54e29f357bf6d">met_nlev</a>; ip++)</div>
<div class="line"><span class="lineno"> 5894</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abb9c4152493385bae3424b8750bfa6c3">met_lev_hybm</a>[ip] =</div>
<div class="line"><span class="lineno"> 5895</span>      <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_LEV_HYBM&quot;</span>, ip, <span class="stringliteral">&quot;&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5896</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a416596b692cca87f14e83f851db35e29">met_geopot_sx</a> =</div>
<div class="line"><span class="lineno"> 5897</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_GEOPOT_SX&quot;</span>, -1, <span class="stringliteral">&quot;-1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5898</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2ec0ba6ad9f46184228f1a1784596218">met_geopot_sy</a> =</div>
<div class="line"><span class="lineno"> 5899</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_GEOPOT_SY&quot;</span>, -1, <span class="stringliteral">&quot;-1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5900</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaa5260e73daff92d01c55e87310ab837">met_relhum</a> =</div>
<div class="line"><span class="lineno"> 5901</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_RELHUM&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5902</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a47ee3960f0b2b25382062fa8dda37ede">met_cape</a> =</div>
<div class="line"><span class="lineno"> 5903</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CAPE&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5904</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a47ee3960f0b2b25382062fa8dda37ede">met_cape</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a47ee3960f0b2b25382062fa8dda37ede">met_cape</a> &gt; 1)</div>
<div class="line"><span class="lineno"> 5905</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set MET_CAPE to 0 or 1!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5906</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a220b71ff77f479684ae659f626b1c5d9">met_pbl</a> =</div>
<div class="line"><span class="lineno"> 5907</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_PBL&quot;</span>, -1, <span class="stringliteral">&quot;3&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5908</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a220b71ff77f479684ae659f626b1c5d9">met_pbl</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a220b71ff77f479684ae659f626b1c5d9">met_pbl</a> &gt; 3)</div>
<div class="line"><span class="lineno"> 5909</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set MET_PBL to 0 ... 3!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5910</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a183f7517467fab1c84b49db0cb236ad0">met_pbl_min</a> =</div>
<div class="line"><span class="lineno"> 5911</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_PBL_MIN&quot;</span>, -1, <span class="stringliteral">&quot;0.1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5912</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6a0360667c5b3cbab3da2a9fb4841970">met_pbl_max</a> =</div>
<div class="line"><span class="lineno"> 5913</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_PBL_MAX&quot;</span>, -1, <span class="stringliteral">&quot;5.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5914</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">met_tropo</a> =</div>
<div class="line"><span class="lineno"> 5915</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_TROPO&quot;</span>, -1, <span class="stringliteral">&quot;3&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5916</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">met_tropo</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">met_tropo</a> &gt; 5)</div>
<div class="line"><span class="lineno"> 5917</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set MET_TROPO to 0 ... 5!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5918</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fa995de108b6beeee9d4e5c4f9f68bb">met_tropo_pv</a> =</div>
<div class="line"><span class="lineno"> 5919</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_TROPO_PV&quot;</span>, -1, <span class="stringliteral">&quot;3.5&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5920</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aec254fc45d24615056f6b07643176171">met_tropo_theta</a> =</div>
<div class="line"><span class="lineno"> 5921</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_TROPO_THETA&quot;</span>, -1, <span class="stringliteral">&quot;380&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5922</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2b8390b7a9e1335c03a0877f93b051af">met_tropo_spline</a> =</div>
<div class="line"><span class="lineno"> 5923</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_TROPO_SPLINE&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5924</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1f07329a9333e6af8f00ff9727d774ce">met_dt_out</a> =</div>
<div class="line"><span class="lineno"> 5925</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_DT_OUT&quot;</span>, -1, <span class="stringliteral">&quot;0.1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5926</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7ae3a516b2b17723a02f5e0627d886c2">met_cache</a> =</div>
<div class="line"><span class="lineno"> 5927</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_CACHE&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5928</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54d668c2751138dd5e6b77876e469206">met_mpi_share</a> =</div>
<div class="line"><span class="lineno"> 5929</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MET_MPI_SHARE&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5930</span> </div>
<div class="line"><span class="lineno"> 5931</span>  <span class="comment">/* Sorting... */</span></div>
<div class="line"><span class="lineno"> 5932</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a126d9eac2687f4aac95ab17fff14dd07">sort_dt</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;SORT_DT&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5933</span> </div>
<div class="line"><span class="lineno"> 5934</span>  <span class="comment">/* Isosurface parameters... */</span></div>
<div class="line"><span class="lineno"> 5935</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> =</div>
<div class="line"><span class="lineno"> 5936</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ISOSURF&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5937</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BALLOON&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1aee054abc8c3fbaa1f6828f78f4e2f5">balloon</a>);</div>
<div class="line"><span class="lineno"> 5938</span> </div>
<div class="line"><span class="lineno"> 5939</span>  <span class="comment">/* Random number generator... */</span></div>
<div class="line"><span class="lineno"> 5940</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a42c9413e93cc78f0e6ad427693a4e796">rng_type</a> =</div>
<div class="line"><span class="lineno"> 5941</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;RNG_TYPE&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5942</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a42c9413e93cc78f0e6ad427693a4e796">rng_type</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a42c9413e93cc78f0e6ad427693a4e796">rng_type</a> &gt; 2)</div>
<div class="line"><span class="lineno"> 5943</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set RNG_TYPE to 0, 1, or 2!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5944</span> </div>
<div class="line"><span class="lineno"> 5945</span>  <span class="comment">/* Advection parameters... */</span></div>
<div class="line"><span class="lineno"> 5946</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ADVECT&quot;</span>, -1, <span class="stringliteral">&quot;2&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5947</span>  <span class="keywordflow">if</span> (!</div>
<div class="line"><span class="lineno"> 5948</span>      (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> == 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> == 1 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> == 2</div>
<div class="line"><span class="lineno"> 5949</span>       || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> == 4))</div>
<div class="line"><span class="lineno"> 5950</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set ADVECT to 0, 1, 2, or 4!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5951</span> </div>
<div class="line"><span class="lineno"> 5952</span>  <span class="comment">/* Diffusion parameters... */</span></div>
<div class="line"><span class="lineno"> 5953</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a727a42a9f7c8b7e01c713d5300767213">diffusion</a></div>
<div class="line"><span class="lineno"> 5954</span>    = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;DIFFUSION&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5955</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a727a42a9f7c8b7e01c713d5300767213">diffusion</a> &lt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a727a42a9f7c8b7e01c713d5300767213">diffusion</a> &gt; 2)</div>
<div class="line"><span class="lineno"> 5956</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set DIFFUSION to 0, 1 or 2!&quot;</span>);</div>
<div class="line"><span class="lineno"> 5957</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad5a979592dd8c284d07bb25698339f04">turb_dx_pbl</a> =</div>
<div class="line"><span class="lineno"> 5958</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;TURB_DX_PBL&quot;</span>, -1, <span class="stringliteral">&quot;50&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5959</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a37abd3e7cbc687a515ba1bbac5ec77f2">turb_dx_trop</a> =</div>
<div class="line"><span class="lineno"> 5960</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;TURB_DX_TROP&quot;</span>, -1, <span class="stringliteral">&quot;50&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5961</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3173408e0e9c39c17c39367aee1c5641">turb_dx_strat</a> =</div>
<div class="line"><span class="lineno"> 5962</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;TURB_DX_STRAT&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5963</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af7af2185257f30f792f903af3fcbc041">turb_dz_pbl</a> =</div>
<div class="line"><span class="lineno"> 5964</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;TURB_DZ_PBL&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5965</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a21f2e759e0c5d8cfae2ba9ed551c768e">turb_dz_trop</a> =</div>
<div class="line"><span class="lineno"> 5966</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;TURB_DZ_TROP&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5967</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae797044bfedbdf7e058c6fb02195e586">turb_dz_strat</a> =</div>
<div class="line"><span class="lineno"> 5968</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;TURB_DZ_STRAT&quot;</span>, -1, <span class="stringliteral">&quot;0.1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5969</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4c410e0dddb3e5a5cad1ca66f99967cd">turb_mesox</a> =</div>
<div class="line"><span class="lineno"> 5970</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;TURB_MESOX&quot;</span>, -1, <span class="stringliteral">&quot;0.16&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5971</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a22edf991ef6c26556d13aa822a65da63">turb_mesoz</a> =</div>
<div class="line"><span class="lineno"> 5972</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;TURB_MESOZ&quot;</span>, -1, <span class="stringliteral">&quot;0.16&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5973</span> </div>
<div class="line"><span class="lineno"> 5974</span>  <span class="comment">/* Convection... */</span></div>
<div class="line"><span class="lineno"> 5975</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9d400510c073db38fb10c9fc2bdff74d">conv_mix_pbl</a></div>
<div class="line"><span class="lineno"> 5976</span>    = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CONV_MIX_PBL&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5977</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9478265650dbad91e098fd4bd95d6ff5">conv_pbl_trans</a></div>
<div class="line"><span class="lineno"> 5978</span>    = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CONV_PBL_TRANS&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5979</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a18c1107433d1e9c7867025e8a0fbe6d2">conv_cape</a></div>
<div class="line"><span class="lineno"> 5980</span>    = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CONV_CAPE&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5981</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad6e15e5c23446b0ac2f5f48f70f575a1">conv_cin</a></div>
<div class="line"><span class="lineno"> 5982</span>    = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CONV_CIN&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5983</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a64cdca0c6817ba378fbde7385b8ee279">conv_dt</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CONV_DT&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5984</span> </div>
<div class="line"><span class="lineno"> 5985</span>  <span class="comment">/* Boundary conditions... */</span></div>
<div class="line"><span class="lineno"> 5986</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a25a01ebb0fcff6040d0003b88b13cdec">bound_mass</a> =</div>
<div class="line"><span class="lineno"> 5987</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_MASS&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5988</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9feaa00a9e7de02f8bd661d735b8b280">bound_mass_trend</a> =</div>
<div class="line"><span class="lineno"> 5989</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_MASS_TREND&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5990</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4f7014dad580e4e745c910187468807c">bound_vmr</a> =</div>
<div class="line"><span class="lineno"> 5991</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_VMR&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5992</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7a4b2ae4a45234a74df45b5adbe513cd">bound_vmr_trend</a> =</div>
<div class="line"><span class="lineno"> 5993</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_VMR_TREND&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5994</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a686563c65fdd2d03d15cfdddf294584c">bound_lat0</a> =</div>
<div class="line"><span class="lineno"> 5995</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_LAT0&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5996</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3488ff97025f12fbe161d85b09ddc33e">bound_lat1</a> =</div>
<div class="line"><span class="lineno"> 5997</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_LAT1&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 5998</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa1419e1cd3c485e89a5166c7e1f19caf">bound_p0</a> =</div>
<div class="line"><span class="lineno"> 5999</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_P0&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6000</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a44cbf78eb4bbb11036922bc40faa2b4b">bound_p1</a> =</div>
<div class="line"><span class="lineno"> 6001</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_P1&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6002</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9e31767a1a873f2829a00cb15c0ae421">bound_dps</a> =</div>
<div class="line"><span class="lineno"> 6003</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_DPS&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6004</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0c09fef6dfe4daa19ad717cd1e1b77ec">bound_dzs</a> =</div>
<div class="line"><span class="lineno"> 6005</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_DZS&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6006</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae7b26fcc7af034afe6144631986213ea">bound_zetas</a> =</div>
<div class="line"><span class="lineno"> 6007</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_ZETAS&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6008</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3e924116d2599fb79a734a74da11e8a2">bound_pbl</a> =</div>
<div class="line"><span class="lineno"> 6009</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;BOUND_PBL&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6010</span> </div>
<div class="line"><span class="lineno"> 6011</span>  <span class="comment">/* Species parameters... */</span></div>
<div class="line"><span class="lineno"> 6012</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;SPECIES&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>);</div>
<div class="line"><span class="lineno"> 6013</span>  <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;CF2Cl2&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6014</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 120.907;</div>
<div class="line"><span class="lineno"> 6015</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 3e-5;</div>
<div class="line"><span class="lineno"> 6016</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 3500.0;</div>
<div class="line"><span class="lineno"> 6017</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;CFCl3&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6018</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 137.359;</div>
<div class="line"><span class="lineno"> 6019</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 1.1e-4;</div>
<div class="line"><span class="lineno"> 6020</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 3300.0;</div>
<div class="line"><span class="lineno"> 6021</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;CH4&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6022</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 16.043;</div>
<div class="line"><span class="lineno"> 6023</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> = 2;</div>
<div class="line"><span class="lineno"> 6024</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[0] = 2.45e-12;</div>
<div class="line"><span class="lineno"> 6025</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[1] = 1775;</div>
<div class="line"><span class="lineno"> 6026</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 1.4e-5;</div>
<div class="line"><span class="lineno"> 6027</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 1600.0;</div>
<div class="line"><span class="lineno"> 6028</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;CO&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6029</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 28.01;</div>
<div class="line"><span class="lineno"> 6030</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> = 3;</div>
<div class="line"><span class="lineno"> 6031</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[0] = 6.9e-33;</div>
<div class="line"><span class="lineno"> 6032</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[1] = 2.1;</div>
<div class="line"><span class="lineno"> 6033</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[2] = 1.1e-12;</div>
<div class="line"><span class="lineno"> 6034</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[3] = -1.3;</div>
<div class="line"><span class="lineno"> 6035</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 9.7e-6;</div>
<div class="line"><span class="lineno"> 6036</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 1300.0;</div>
<div class="line"><span class="lineno"> 6037</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;CO2&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6038</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 44.009;</div>
<div class="line"><span class="lineno"> 6039</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 3.3e-4;</div>
<div class="line"><span class="lineno"> 6040</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 2400.0;</div>
<div class="line"><span class="lineno"> 6041</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;H2O&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6042</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 18.01528;</div>
<div class="line"><span class="lineno"> 6043</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;N2O&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6044</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 44.013;</div>
<div class="line"><span class="lineno"> 6045</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 2.4e-4;</div>
<div class="line"><span class="lineno"> 6046</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 2600.;</div>
<div class="line"><span class="lineno"> 6047</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;NH3&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6048</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 17.031;</div>
<div class="line"><span class="lineno"> 6049</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> = 2;</div>
<div class="line"><span class="lineno"> 6050</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[0] = 1.7e-12;</div>
<div class="line"><span class="lineno"> 6051</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[1] = 710;</div>
<div class="line"><span class="lineno"> 6052</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 5.9e-1;</div>
<div class="line"><span class="lineno"> 6053</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 4200.0;</div>
<div class="line"><span class="lineno"> 6054</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;HNO3&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6055</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 63.012;</div>
<div class="line"><span class="lineno"> 6056</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 2.1e3;</div>
<div class="line"><span class="lineno"> 6057</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 8700.0;</div>
<div class="line"><span class="lineno"> 6058</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;NO&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6059</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 30.006;</div>
<div class="line"><span class="lineno"> 6060</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> = 3;</div>
<div class="line"><span class="lineno"> 6061</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[0] = 7.1e-31;</div>
<div class="line"><span class="lineno"> 6062</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[1] = 2.6;</div>
<div class="line"><span class="lineno"> 6063</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[2] = 3.6e-11;</div>
<div class="line"><span class="lineno"> 6064</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[3] = 0.1;</div>
<div class="line"><span class="lineno"> 6065</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 1.9e-5;</div>
<div class="line"><span class="lineno"> 6066</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 1600.0;</div>
<div class="line"><span class="lineno"> 6067</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;NO2&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6068</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 46.005;</div>
<div class="line"><span class="lineno"> 6069</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> = 3;</div>
<div class="line"><span class="lineno"> 6070</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[0] = 1.8e-30;</div>
<div class="line"><span class="lineno"> 6071</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[1] = 3.0;</div>
<div class="line"><span class="lineno"> 6072</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[2] = 2.8e-11;</div>
<div class="line"><span class="lineno"> 6073</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[3] = 0.0;</div>
<div class="line"><span class="lineno"> 6074</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 1.2e-4;</div>
<div class="line"><span class="lineno"> 6075</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 2400.0;</div>
<div class="line"><span class="lineno"> 6076</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;O3&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6077</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 47.997;</div>
<div class="line"><span class="lineno"> 6078</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> = 2;</div>
<div class="line"><span class="lineno"> 6079</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[0] = 1.7e-12;</div>
<div class="line"><span class="lineno"> 6080</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[1] = 940;</div>
<div class="line"><span class="lineno"> 6081</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 1e-4;</div>
<div class="line"><span class="lineno"> 6082</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 2800.0;</div>
<div class="line"><span class="lineno"> 6083</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;SF6&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6084</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 146.048;</div>
<div class="line"><span class="lineno"> 6085</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 2.4e-6;</div>
<div class="line"><span class="lineno"> 6086</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 3100.0;</div>
<div class="line"><span class="lineno"> 6087</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">species</a>, <span class="stringliteral">&quot;SO2&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno"> 6088</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = 64.066;</div>
<div class="line"><span class="lineno"> 6089</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> = 3;</div>
<div class="line"><span class="lineno"> 6090</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[0] = 2.9e-31;</div>
<div class="line"><span class="lineno"> 6091</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[1] = 4.1;</div>
<div class="line"><span class="lineno"> 6092</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[2] = 1.7e-12;</div>
<div class="line"><span class="lineno"> 6093</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[3] = -0.2;</div>
<div class="line"><span class="lineno"> 6094</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] = 1.3e-2;</div>
<div class="line"><span class="lineno"> 6095</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[1] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[1] = 2900.0;</div>
<div class="line"><span class="lineno"> 6096</span>  }</div>
<div class="line"><span class="lineno"> 6097</span> </div>
<div class="line"><span class="lineno"> 6098</span>  <span class="comment">/* Molar mass... */</span></div>
<div class="line"><span class="lineno"> 6099</span>  <span class="keywordtype">char</span> defstr[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 6100</span>  sprintf(defstr, <span class="stringliteral">&quot;%g&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a>);</div>
<div class="line"><span class="lineno"> 6101</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MOLMASS&quot;</span>, -1, defstr, NULL);</div>
<div class="line"><span class="lineno"> 6102</span> </div>
<div class="line"><span class="lineno"> 6103</span>  <span class="comment">/* OH chemistry... */</span></div>
<div class="line"><span class="lineno"> 6104</span>  sprintf(defstr, <span class="stringliteral">&quot;%d&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a>);</div>
<div class="line"><span class="lineno"> 6105</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> =</div>
<div class="line"><span class="lineno"> 6106</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;OH_CHEM_REACTION&quot;</span>, -1, defstr,</div>
<div class="line"><span class="lineno"> 6107</span>                   NULL);</div>
<div class="line"><span class="lineno"> 6108</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; 4; ip++) {</div>
<div class="line"><span class="lineno"> 6109</span>    sprintf(defstr, <span class="stringliteral">&quot;%g&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[ip]);</div>
<div class="line"><span class="lineno"> 6110</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3a6b353625c774d90aa5286e69f1fc5f">oh_chem</a>[ip] =</div>
<div class="line"><span class="lineno"> 6111</span>      <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;OH_CHEM&quot;</span>, ip, defstr, NULL);</div>
<div class="line"><span class="lineno"> 6112</span>  }</div>
<div class="line"><span class="lineno"> 6113</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a572e117f02cbfced576c216d366d1a89">oh_chem_beta</a> =</div>
<div class="line"><span class="lineno"> 6114</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;OH_CHEM_BETA&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6115</span> </div>
<div class="line"><span class="lineno"> 6116</span>  <span class="comment">/* H2O2 chemistry... */</span></div>
<div class="line"><span class="lineno"> 6117</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abfeedfc5c515f8d03de56c2cd06aa633">h2o2_chem_reaction</a> =</div>
<div class="line"><span class="lineno"> 6118</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;H2O2_CHEM_REACTION&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6119</span> </div>
<div class="line"><span class="lineno"> 6120</span>  <span class="comment">/* KPP chemistry... */</span></div>
<div class="line"><span class="lineno"> 6121</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a92e02214da035478761cdcd7622780b1">kpp_chem</a> =</div>
<div class="line"><span class="lineno"> 6122</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;KPP_CHEM&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6123</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a603d7f5e599d149b57a67fea612ecb04">dt_kpp</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;DT_KPP&quot;</span>, -1, <span class="stringliteral">&quot;1800&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6124</span> </div>
<div class="line"><span class="lineno"> 6125</span>  <span class="comment">/* First order tracer chemistry... */</span></div>
<div class="line"><span class="lineno"> 6126</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7144e94dd5ef6f75941dd35a82eac9bd">tracer_chem</a> =</div>
<div class="line"><span class="lineno"> 6127</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;TRACER_CHEM&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6128</span> </div>
<div class="line"><span class="lineno"> 6129</span>  <span class="comment">/* Wet deposition... */</span></div>
<div class="line"><span class="lineno"> 6130</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; 2; ip++) {</div>
<div class="line"><span class="lineno"> 6131</span>    sprintf(defstr, <span class="stringliteral">&quot;%g&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[ip]);</div>
<div class="line"><span class="lineno"> 6132</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[ip] =</div>
<div class="line"><span class="lineno"> 6133</span>      <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;WET_DEPO_IC_H&quot;</span>, ip, defstr, NULL);</div>
<div class="line"><span class="lineno"> 6134</span>  }</div>
<div class="line"><span class="lineno"> 6135</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; 1; ip++) {</div>
<div class="line"><span class="lineno"> 6136</span>    sprintf(defstr, <span class="stringliteral">&quot;%g&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[ip]);</div>
<div class="line"><span class="lineno"> 6137</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[ip] =</div>
<div class="line"><span class="lineno"> 6138</span>      <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;WET_DEPO_BC_H&quot;</span>, ip, defstr, NULL);</div>
<div class="line"><span class="lineno"> 6139</span>  }</div>
<div class="line"><span class="lineno"> 6140</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5ac7339d5350bb6d64df67a8df70c4b8">wet_depo_so2_ph</a> =</div>
<div class="line"><span class="lineno"> 6141</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;WET_DEPO_SO2_PH&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6142</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a032306df4b235c20af95d5b30edc694a">wet_depo_ic_a</a> =</div>
<div class="line"><span class="lineno"> 6143</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;WET_DEPO_IC_A&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6144</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae48763f1caad155cb48c8bcb536061c0">wet_depo_ic_b</a> =</div>
<div class="line"><span class="lineno"> 6145</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;WET_DEPO_IC_B&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6146</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1550c0159a3a3374a1ebccef46604ad8">wet_depo_bc_a</a> =</div>
<div class="line"><span class="lineno"> 6147</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;WET_DEPO_BC_A&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6148</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae49e5d87420514bf64f3150e75c8b07f">wet_depo_bc_b</a> =</div>
<div class="line"><span class="lineno"> 6149</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;WET_DEPO_BC_B&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6150</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a96e4c97eb8f6a2b81d7ddb7a3ce4ae81">wet_depo_pre</a>[0] =</div>
<div class="line"><span class="lineno"> 6151</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;WET_DEPO_PRE&quot;</span>, 0, <span class="stringliteral">&quot;0.5&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6152</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a96e4c97eb8f6a2b81d7ddb7a3ce4ae81">wet_depo_pre</a>[1] =</div>
<div class="line"><span class="lineno"> 6153</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;WET_DEPO_PRE&quot;</span>, 1, <span class="stringliteral">&quot;0.36&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6154</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adfd76ffde125821097d58b4b3978a355">wet_depo_ic_ret_ratio</a> =</div>
<div class="line"><span class="lineno"> 6155</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;WET_DEPO_IC_RET_RATIO&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6156</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac2b6871df347638e7154410038690871">wet_depo_bc_ret_ratio</a> =</div>
<div class="line"><span class="lineno"> 6157</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;WET_DEPO_BC_RET_RATIO&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6158</span> </div>
<div class="line"><span class="lineno"> 6159</span>  <span class="comment">/* Dry deposition... */</span></div>
<div class="line"><span class="lineno"> 6160</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acadcfbb95971c47b377fbd4443c68723">dry_depo_vdep</a> =</div>
<div class="line"><span class="lineno"> 6161</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;DRY_DEPO_VDEP&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6162</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a60da7ce4a7b610712585fde03773bf7f">dry_depo_dp</a> =</div>
<div class="line"><span class="lineno"> 6163</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;DRY_DEPO_DP&quot;</span>, -1, <span class="stringliteral">&quot;30&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6164</span> </div>
<div class="line"><span class="lineno"> 6165</span>  <span class="comment">/* Climatological data... */</span></div>
<div class="line"><span class="lineno"> 6166</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CLIM_PHOTO&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6167</span>           <span class="stringliteral">&quot;../../data/clams_photolysis_rates.nc&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5a52a92586476c70f20788fd481d98f3">clim_photo</a>);</div>
<div class="line"><span class="lineno"> 6168</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CLIM_HNO3_FILENAME&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6169</span>           <span class="stringliteral">&quot;../../data/gozcards_HNO3.nc&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adcb60205ef46f49695f9f06257dc0346">clim_hno3_filename</a>);</div>
<div class="line"><span class="lineno"> 6170</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CLIM_OH_FILENAME&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6171</span>           <span class="stringliteral">&quot;../../data/clams_radical_species_vmr.nc&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa7ad8811329e690f4a3c4431b16f8d19">clim_oh_filename</a>);</div>
<div class="line"><span class="lineno"> 6172</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CLIM_H2O2_FILENAME&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6173</span>           <span class="stringliteral">&quot;../../data/cams_H2O2.nc&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a711670450c0aa59e4ae6cc7b199ba63e">clim_h2o2_filename</a>);</div>
<div class="line"><span class="lineno"> 6174</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CLIM_HO2_FILENAME&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6175</span>           <span class="stringliteral">&quot;../../data/clams_radical_species_vmr.nc&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2d8c402293e6879df38c55a4241b1ad5">clim_ho2_filename</a>);</div>
<div class="line"><span class="lineno"> 6176</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CLIM_O1D_FILENAME&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6177</span>           <span class="stringliteral">&quot;../../data/clams_radical_species_vmr.nc&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587e33a3eebf5c424f67d94200f598ff">clim_o1d_filename</a>);</div>
<div class="line"><span class="lineno"> 6178</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CLIM_CCL4_TIMESERIES&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6179</span>           <span class="stringliteral">&quot;../../data/noaa_gml_ccl4.tab&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa17140ad321005a763259a2ae7dcd858">clim_ccl4_timeseries</a>);</div>
<div class="line"><span class="lineno"> 6180</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CLIM_CCL3F_TIMESERIES&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6181</span>           <span class="stringliteral">&quot;../../data/noaa_gml_cfc11.tab&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac6e501659bef71188874bf710d510635">clim_ccl3f_timeseries</a>);</div>
<div class="line"><span class="lineno"> 6182</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CLIM_CCL2F2_TIMESERIES&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6183</span>           <span class="stringliteral">&quot;../../data/noaa_gml_cfc12.tab&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad262595cbb226c73adcde30a4b7d3bf9">clim_ccl2f2_timeseries</a>);</div>
<div class="line"><span class="lineno"> 6184</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CLIM_N2O_TIMESERIES&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6185</span>           <span class="stringliteral">&quot;../../data/noaa_gml_n2o.tab&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0bdff7541fde7bd508072c44279519fd">clim_n2o_timeseries</a>);</div>
<div class="line"><span class="lineno"> 6186</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CLIM_SF6_TIMESERIES&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6187</span>           <span class="stringliteral">&quot;../../data/noaa_gml_sf6.tab&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab08651e92983408ef0bebfe875c59851">clim_sf6_timeseries</a>);</div>
<div class="line"><span class="lineno"> 6188</span> </div>
<div class="line"><span class="lineno"> 6189</span>  <span class="comment">/* Mixing... */</span></div>
<div class="line"><span class="lineno"> 6190</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acf37a9e8e3b1a013d6106f83e14aedb3">mixing_dt</a> =</div>
<div class="line"><span class="lineno"> 6191</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_DT&quot;</span>, -1, <span class="stringliteral">&quot;3600.&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6192</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a11a33decd5490249e5251aaec901bd4c">mixing_trop</a> =</div>
<div class="line"><span class="lineno"> 6193</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_TROP&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6194</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54e8203aaa728ca33e8db070896eec5a">mixing_strat</a> =</div>
<div class="line"><span class="lineno"> 6195</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_STRAT&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6196</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5b956c530addc8d909afaf00f5bf9fb4">mixing_z0</a> =</div>
<div class="line"><span class="lineno"> 6197</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_Z0&quot;</span>, -1, <span class="stringliteral">&quot;-5&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6198</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a12d69b44d99afb975f0df6fe5486f896">mixing_z1</a> =</div>
<div class="line"><span class="lineno"> 6199</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_Z1&quot;</span>, -1, <span class="stringliteral">&quot;85&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6200</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa027a38882f39332262de958c1e8880b">mixing_nz</a> =</div>
<div class="line"><span class="lineno"> 6201</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_NZ&quot;</span>, -1, <span class="stringliteral">&quot;90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6202</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa161bb16963a0fb4340b8e6fda492be6">mixing_lon0</a> =</div>
<div class="line"><span class="lineno"> 6203</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_LON0&quot;</span>, -1, <span class="stringliteral">&quot;-180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6204</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbb72c2a4599dd7bc44ef279da5de7ff">mixing_lon1</a> =</div>
<div class="line"><span class="lineno"> 6205</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_LON1&quot;</span>, -1, <span class="stringliteral">&quot;180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6206</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a073b97a29712daaee8212c8a673418bf">mixing_nx</a> =</div>
<div class="line"><span class="lineno"> 6207</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_NX&quot;</span>, -1, <span class="stringliteral">&quot;360&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6208</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8bc3cf78a652568f5e5f04d7c28e82ea">mixing_lat0</a> =</div>
<div class="line"><span class="lineno"> 6209</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_LAT0&quot;</span>, -1, <span class="stringliteral">&quot;-90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6210</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aabd109b7477b116b0542aafeb8056180">mixing_lat1</a> =</div>
<div class="line"><span class="lineno"> 6211</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_LAT1&quot;</span>, -1, <span class="stringliteral">&quot;90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6212</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6cc8f7e22a69a8fec9e11c2cd4a84644">mixing_ny</a> =</div>
<div class="line"><span class="lineno"> 6213</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;MIXING_NY&quot;</span>, -1, <span class="stringliteral">&quot;180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6214</span> </div>
<div class="line"><span class="lineno"> 6215</span>  <span class="comment">/* Chemistry grid... */</span></div>
<div class="line"><span class="lineno"> 6216</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1834cd1e787e3aa2f391cd942a7f37c7">chemgrid_z0</a> =</div>
<div class="line"><span class="lineno"> 6217</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CHEMGRID_Z0&quot;</span>, -1, <span class="stringliteral">&quot;-5&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6218</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a080fa58f76fcfad970b76ca112706154">chemgrid_z1</a> =</div>
<div class="line"><span class="lineno"> 6219</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CHEMGRID_Z1&quot;</span>, -1, <span class="stringliteral">&quot;85&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6220</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9fab7dd94afddfff20c4596605e3f18a">chemgrid_nz</a> =</div>
<div class="line"><span class="lineno"> 6221</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CHEMGRID_NZ&quot;</span>, -1, <span class="stringliteral">&quot;90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6222</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3e1bc34453198d5854a7f0271f503f7c">chemgrid_lon0</a> =</div>
<div class="line"><span class="lineno"> 6223</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CHEMGRID_LON0&quot;</span>, -1, <span class="stringliteral">&quot;-180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6224</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4b601fe8e527664c96b12b9eafee4762">chemgrid_lon1</a> =</div>
<div class="line"><span class="lineno"> 6225</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CHEMGRID_LON1&quot;</span>, -1, <span class="stringliteral">&quot;180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6226</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab7ed13e186108a02ff64f4bccc4ec775">chemgrid_nx</a> =</div>
<div class="line"><span class="lineno"> 6227</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CHEMGRID_NX&quot;</span>, -1, <span class="stringliteral">&quot;360&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6228</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a189dce731fb0c3210161ca328a93a327">chemgrid_lat0</a> =</div>
<div class="line"><span class="lineno"> 6229</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CHEMGRID_LAT0&quot;</span>, -1, <span class="stringliteral">&quot;-90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6230</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2e99a15cc98b378ffc96a6df73fe6048">chemgrid_lat1</a> =</div>
<div class="line"><span class="lineno"> 6231</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CHEMGRID_LAT1&quot;</span>, -1, <span class="stringliteral">&quot;90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6232</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac43809de3c73cb9793c567813452cfca">chemgrid_ny</a> =</div>
<div class="line"><span class="lineno"> 6233</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CHEMGRID_NY&quot;</span>, -1, <span class="stringliteral">&quot;180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6234</span> </div>
<div class="line"><span class="lineno"> 6235</span>  <span class="comment">/* Exponential decay... */</span></div>
<div class="line"><span class="lineno"> 6236</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af276258494c92c24ab0de0b54759e9a9">tdec_trop</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;TDEC_TROP&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6237</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a86977d0f97ee8db6974efc896822a7db">tdec_strat</a> =</div>
<div class="line"><span class="lineno"> 6238</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;TDEC_STRAT&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6239</span> </div>
<div class="line"><span class="lineno"> 6240</span>  <span class="comment">/* PSC analysis... */</span></div>
<div class="line"><span class="lineno"> 6241</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab4ab5f332a54f86eda5e850ac7380334">psc_h2o</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PSC_H2O&quot;</span>, -1, <span class="stringliteral">&quot;4e-6&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6242</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abd6693699cf561e2628e46805ac9591b">psc_hno3</a> =</div>
<div class="line"><span class="lineno"> 6243</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PSC_HNO3&quot;</span>, -1, <span class="stringliteral">&quot;9e-9&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6244</span> </div>
<div class="line"><span class="lineno"> 6245</span>  <span class="comment">/* Output of atmospheric data... */</span></div>
<div class="line"><span class="lineno"> 6246</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ATM_BASENAME&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8b2706a512ce6a279091d8ff1b192346">atm_basename</a>);</div>
<div class="line"><span class="lineno"> 6247</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ATM_GPFILE&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a06975fa14d8c7f7813bf83fa4166f819">atm_gpfile</a>);</div>
<div class="line"><span class="lineno"> 6248</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aad4b256a00136fe4181077c2b02b0f45">atm_dt_out</a> =</div>
<div class="line"><span class="lineno"> 6249</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ATM_DT_OUT&quot;</span>, -1, <span class="stringliteral">&quot;86400&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6250</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9279f2a56adc9780721e00e35bed2b3d">atm_filter</a> =</div>
<div class="line"><span class="lineno"> 6251</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ATM_FILTER&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6252</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa98efec197e5a7bf0abd5f30ba44de72">atm_stride</a> =</div>
<div class="line"><span class="lineno"> 6253</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ATM_STRIDE&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6254</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2509f56c50085b3d0f47c495da91b248">atm_type</a> =</div>
<div class="line"><span class="lineno"> 6255</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ATM_TYPE&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6256</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">atm_type_out</a> =</div>
<div class="line"><span class="lineno"> 6257</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ATM_TYPE_OUT&quot;</span>, -1, <span class="stringliteral">&quot;-1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6258</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">atm_type_out</a> == -1)</div>
<div class="line"><span class="lineno"> 6259</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">atm_type_out</a> = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2509f56c50085b3d0f47c495da91b248">atm_type</a>;</div>
<div class="line"><span class="lineno"> 6260</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a> =</div>
<div class="line"><span class="lineno"> 6261</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ATM_NC_LEVEL&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6262</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno"> 6263</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac13bb67666a0310b0f8b591e1d2a29bb">atm_nc_quant</a>[iq] =</div>
<div class="line"><span class="lineno"> 6264</span>      (<span class="keywordtype">int</span>) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ATM_NC_QUANT&quot;</span>, iq, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6265</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a874cf53d903cea2e96423bacd2fafdab">obs_type</a> =</div>
<div class="line"><span class="lineno"> 6266</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;OBS_TYPE&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6267</span> </div>
<div class="line"><span class="lineno"> 6268</span>  <span class="comment">/* Output of CSI data... */</span></div>
<div class="line"><span class="lineno"> 6269</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_BASENAME&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a605a1904f8ff49d178ac462f8fbecc3a">csi_basename</a>);</div>
<div class="line"><span class="lineno"> 6270</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_KERNEL&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a378603f0fe74b4236f45f78bf4bc02dc">csi_kernel</a>);</div>
<div class="line"><span class="lineno"> 6271</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a466eb100ca9ab4f5f605e14a27a61f1d">csi_dt_out</a> =</div>
<div class="line"><span class="lineno"> 6272</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_DT_OUT&quot;</span>, -1, <span class="stringliteral">&quot;86400&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6273</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_OBSFILE&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a01ea628e12cf0025aa0731f52d13da10">csi_obsfile</a>);</div>
<div class="line"><span class="lineno"> 6274</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0a450754f8661100135aa790ea26df16">csi_obsmin</a> =</div>
<div class="line"><span class="lineno"> 6275</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_OBSMIN&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6276</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4aa05c61a9c0c1d0f3737f2190b1ebdc">csi_modmin</a> =</div>
<div class="line"><span class="lineno"> 6277</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_MODMIN&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6278</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a98aa14528bd795eaf31eae63a33c630f">csi_z0</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_Z0&quot;</span>, -1, <span class="stringliteral">&quot;-5&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6279</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a55a1915a7e8ef2a91a2553a8393b4329">csi_z1</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_Z1&quot;</span>, -1, <span class="stringliteral">&quot;85&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6280</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0409a87481145b01eb3fd61042f35abc">csi_nz</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_NZ&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6281</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a396d8bbb52aaf8408e90c207aa7f7312">csi_lon0</a> =</div>
<div class="line"><span class="lineno"> 6282</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_LON0&quot;</span>, -1, <span class="stringliteral">&quot;-180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6283</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0cd8031f829953cb90912d9eecfe67b3">csi_lon1</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_LON1&quot;</span>, -1, <span class="stringliteral">&quot;180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6284</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a21159a48d018215b1bb5af62214b9063">csi_nx</a> =</div>
<div class="line"><span class="lineno"> 6285</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_NX&quot;</span>, -1, <span class="stringliteral">&quot;360&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6286</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a219b7e2f9f53597e84a87d349e32bcb5">csi_lat0</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_LAT0&quot;</span>, -1, <span class="stringliteral">&quot;-90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6287</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a015b2de1c61e25a2e8abb0fba4a05c24">csi_lat1</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_LAT1&quot;</span>, -1, <span class="stringliteral">&quot;90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6288</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">csi_ny</a> =</div>
<div class="line"><span class="lineno"> 6289</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;CSI_NY&quot;</span>, -1, <span class="stringliteral">&quot;180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6290</span> </div>
<div class="line"><span class="lineno"> 6291</span>  <span class="comment">/* Output of ensemble data... */</span></div>
<div class="line"><span class="lineno"> 6292</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">nens</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;NENS&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6293</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ENS_BASENAME&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a94b0a51a5281e718f4fbd38bf5b4d340">ens_basename</a>);</div>
<div class="line"><span class="lineno"> 6294</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa943823dbd2a4b5fa38e7d0cf8f9ccb0">ens_dt_out</a> =</div>
<div class="line"><span class="lineno"> 6295</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;ENS_DT_OUT&quot;</span>, -1, <span class="stringliteral">&quot;86400&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6296</span> </div>
<div class="line"><span class="lineno"> 6297</span>  <span class="comment">/* Output of grid data... */</span></div>
<div class="line"><span class="lineno"> 6298</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_BASENAME&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>,</div>
<div class="line"><span class="lineno"> 6299</span>           ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a65f18a2f1aa44522f78fc364a0ffaf68">grid_basename</a>);</div>
<div class="line"><span class="lineno"> 6300</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_KERNEL&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4dc20e7eacf1e45a61ed1910e0e88d1b">grid_kernel</a>);</div>
<div class="line"><span class="lineno"> 6301</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_GPFILE&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a30f012c96cb05d5a99004d9ce032277c">grid_gpfile</a>);</div>
<div class="line"><span class="lineno"> 6302</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afe05b16d3cfa511feb4673706f6606ff">grid_dt_out</a> =</div>
<div class="line"><span class="lineno"> 6303</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_DT_OUT&quot;</span>, -1, <span class="stringliteral">&quot;86400&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6304</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac7a96c566e02c9e88a73e53248a89cb5">grid_sparse</a> =</div>
<div class="line"><span class="lineno"> 6305</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_SPARSE&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6306</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a231a88993a5cba0a0838de7b34d6d621">grid_nc_level</a> =</div>
<div class="line"><span class="lineno"> 6307</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_NC_LEVEL&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6308</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno"> 6309</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a87ac3308dd3334c5614855d437383139">grid_nc_quant</a>[iq] =</div>
<div class="line"><span class="lineno"> 6310</span>      (<span class="keywordtype">int</span>) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_NC_QUANT&quot;</span>, iq, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6311</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3b10e6157d7ccde448863065a4df9558">grid_stddev</a> =</div>
<div class="line"><span class="lineno"> 6312</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_STDDEV&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6313</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0060ec5c97cb80d4721c3970c68012f5">grid_z0</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_Z0&quot;</span>, -1, <span class="stringliteral">&quot;-5&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6314</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a5460bac04c277c0e66efc9f2f85810">grid_z1</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_Z1&quot;</span>, -1, <span class="stringliteral">&quot;85&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6315</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a> =</div>
<div class="line"><span class="lineno"> 6316</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_NZ&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6317</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2b398376ae2ebe6e02a34465367943de">grid_lon0</a> =</div>
<div class="line"><span class="lineno"> 6318</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_LON0&quot;</span>, -1, <span class="stringliteral">&quot;-180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6319</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a895d5f67cd12ab54481ebfa36f359b77">grid_lon1</a> =</div>
<div class="line"><span class="lineno"> 6320</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_LON1&quot;</span>, -1, <span class="stringliteral">&quot;180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6321</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a> =</div>
<div class="line"><span class="lineno"> 6322</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_NX&quot;</span>, -1, <span class="stringliteral">&quot;360&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6323</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a25bb036fcbb73ed2452d42212cd3c09f">grid_lat0</a> =</div>
<div class="line"><span class="lineno"> 6324</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_LAT0&quot;</span>, -1, <span class="stringliteral">&quot;-90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6325</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af89d6bfcdbc4250e2d30dd7e453b3048">grid_lat1</a> =</div>
<div class="line"><span class="lineno"> 6326</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_LAT1&quot;</span>, -1, <span class="stringliteral">&quot;90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6327</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a> =</div>
<div class="line"><span class="lineno"> 6328</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_NY&quot;</span>, -1, <span class="stringliteral">&quot;180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6329</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a37c580065a63c21f5421ee78e3c4b3d9">grid_type</a> =</div>
<div class="line"><span class="lineno"> 6330</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;GRID_TYPE&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6331</span> </div>
<div class="line"><span class="lineno"> 6332</span>  <span class="comment">/* Output of profile data... */</span></div>
<div class="line"><span class="lineno"> 6333</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PROF_BASENAME&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>,</div>
<div class="line"><span class="lineno"> 6334</span>           ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a4c8aa3a46d5a54c6ef2ca4eefdf3a1">prof_basename</a>);</div>
<div class="line"><span class="lineno"> 6335</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PROF_OBSFILE&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a42d536f7e68997de273a245cff2af30b">prof_obsfile</a>);</div>
<div class="line"><span class="lineno"> 6336</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4ef0c20dc2cdc73b2a3272e40a82efd4">prof_z0</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PROF_Z0&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6337</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8fcaa080d02f579e45b99cd7e6a5a36e">prof_z1</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PROF_Z1&quot;</span>, -1, <span class="stringliteral">&quot;60&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6338</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a> =</div>
<div class="line"><span class="lineno"> 6339</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PROF_NZ&quot;</span>, -1, <span class="stringliteral">&quot;60&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6340</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab5c52ba42d486204818e2bade09005c1">prof_lon0</a> =</div>
<div class="line"><span class="lineno"> 6341</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PROF_LON0&quot;</span>, -1, <span class="stringliteral">&quot;-180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6342</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abdbbc3e42fcbcf71714a8b86dd5b3729">prof_lon1</a> =</div>
<div class="line"><span class="lineno"> 6343</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PROF_LON1&quot;</span>, -1, <span class="stringliteral">&quot;180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6344</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fe06eb4b9baabf93694ed62d2956046">prof_nx</a> =</div>
<div class="line"><span class="lineno"> 6345</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PROF_NX&quot;</span>, -1, <span class="stringliteral">&quot;360&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6346</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abbea8b15d0f5ea43ddd48ebb6a248916">prof_lat0</a> =</div>
<div class="line"><span class="lineno"> 6347</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PROF_LAT0&quot;</span>, -1, <span class="stringliteral">&quot;-90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6348</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab227d1f7a9235210bd3ba4e159398bfc">prof_lat1</a> =</div>
<div class="line"><span class="lineno"> 6349</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PROF_LAT1&quot;</span>, -1, <span class="stringliteral">&quot;90&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6350</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a> =</div>
<div class="line"><span class="lineno"> 6351</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;PROF_NY&quot;</span>, -1, <span class="stringliteral">&quot;180&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6352</span> </div>
<div class="line"><span class="lineno"> 6353</span>  <span class="comment">/* Output of sample data... */</span></div>
<div class="line"><span class="lineno"> 6354</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;SAMPLE_BASENAME&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>,</div>
<div class="line"><span class="lineno"> 6355</span>           ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa974f483b6ccf931730d2d929eee2b51">sample_basename</a>);</div>
<div class="line"><span class="lineno"> 6356</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;SAMPLE_KERNEL&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>,</div>
<div class="line"><span class="lineno"> 6357</span>           ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2c08850b82591f935ab0c498217b3d65">sample_kernel</a>);</div>
<div class="line"><span class="lineno"> 6358</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;SAMPLE_OBSFILE&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>,</div>
<div class="line"><span class="lineno"> 6359</span>           ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a64cde624042ea4b8d6b841660ff28546">sample_obsfile</a>);</div>
<div class="line"><span class="lineno"> 6360</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af5696aca68db24fedc7bd265d4eb6d52">sample_dx</a> =</div>
<div class="line"><span class="lineno"> 6361</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;SAMPLE_DX&quot;</span>, -1, <span class="stringliteral">&quot;50&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6362</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a857fdeffae577ddb41500ef0c875020e">sample_dz</a> =</div>
<div class="line"><span class="lineno"> 6363</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;SAMPLE_DZ&quot;</span>, -1, <span class="stringliteral">&quot;-999&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6364</span> </div>
<div class="line"><span class="lineno"> 6365</span>  <span class="comment">/* Output of station data... */</span></div>
<div class="line"><span class="lineno"> 6366</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;STAT_BASENAME&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>,</div>
<div class="line"><span class="lineno"> 6367</span>           ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af784e18ace4cd191ae100a7df4955b6b">stat_basename</a>);</div>
<div class="line"><span class="lineno"> 6368</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0fafec241b4112fa64cb69fe09403ea8">stat_lon</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;STAT_LON&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6369</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a995505c06bd35ecba593f807c1eda591">stat_lat</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;STAT_LAT&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6370</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a149be614c5eafb380c3c9f3ad6599971">stat_r</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;STAT_R&quot;</span>, -1, <span class="stringliteral">&quot;50&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6371</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5721f8afc611b607db92678bb063f42d">stat_t0</a> =</div>
<div class="line"><span class="lineno"> 6372</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;STAT_T0&quot;</span>, -1, <span class="stringliteral">&quot;-1e100&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6373</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a370c0a527e721ea64cd67685abd7bc42">stat_t1</a> = <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;STAT_T1&quot;</span>, -1, <span class="stringliteral">&quot;1e100&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6374</span> </div>
<div class="line"><span class="lineno"> 6375</span>  <span class="comment">/* Output of VTK data... */</span></div>
<div class="line"><span class="lineno"> 6376</span>  <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;VTK_BASENAME&quot;</span>, -1, <span class="stringliteral">&quot;-&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac98ba3f8bc8b26ca6499ac79603de8db">vtk_basename</a>);</div>
<div class="line"><span class="lineno"> 6377</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a64262df06556e7055245b9f96d317f92">vtk_dt_out</a> =</div>
<div class="line"><span class="lineno"> 6378</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;VTK_DT_OUT&quot;</span>, -1, <span class="stringliteral">&quot;86400&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6379</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af662f58ab4cdf46b8e28945ca541a9c1">vtk_stride</a> =</div>
<div class="line"><span class="lineno"> 6380</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;VTK_STRIDE&quot;</span>, -1, <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6381</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad1c66733dc34e0eb4bff6dea1ad9aefe">vtk_scale</a> =</div>
<div class="line"><span class="lineno"> 6382</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;VTK_SCALE&quot;</span>, -1, <span class="stringliteral">&quot;1.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6383</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a78c2f172f67203ddfc2dfb9db913f51d">vtk_offset</a> =</div>
<div class="line"><span class="lineno"> 6384</span>    <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;VTK_OFFSET&quot;</span>, -1, <span class="stringliteral">&quot;0.0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6385</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17e569920568025af14e66d706651a18">vtk_sphere</a> =</div>
<div class="line"><span class="lineno"> 6386</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;VTK_SPHERE&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6387</span> </div>
<div class="line"><span class="lineno"> 6388</span>  <span class="comment">/* Domain decomposition... */</span></div>
<div class="line"><span class="lineno"> 6389</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587663283cba9a4470dd7b753b5a1690">dd</a> = (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;DD&quot;</span>, -1, <span class="stringliteral">&quot;0&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6390</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a> =</div>
<div class="line"><span class="lineno"> 6391</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;DD_SUBDOMAINS_MERIDIONAL&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6392</span>                   (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587663283cba9a4470dd7b753b5a1690">dd</a> == 1) ? <span class="stringliteral">&quot;2&quot;</span> : <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6393</span>  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aea21f5b459b5068ca0ec982074cb4dc2">dd_subdomains_zonal</a> =</div>
<div class="line"><span class="lineno"> 6394</span>    (int) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, <span class="stringliteral">&quot;DD_SUBDOMAINS_ZONAL&quot;</span>, -1,</div>
<div class="line"><span class="lineno"> 6395</span>                   (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587663283cba9a4470dd7b753b5a1690">dd</a> == 1) ? <span class="stringliteral">&quot;2&quot;</span> : <span class="stringliteral">&quot;1&quot;</span>, NULL);</div>
<div class="line"><span class="lineno"> 6396</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aea21f5b459b5068ca0ec982074cb4dc2">dd_subdomains_zonal</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a> &gt; 1)</div>
<div class="line"><span class="lineno"> 6397</span>    ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587663283cba9a4470dd7b753b5a1690">dd</a> = 1;</div>
<div class="line"><span class="lineno"> 6398</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587663283cba9a4470dd7b753b5a1690">dd</a> == 1)</div>
<div class="line"><span class="lineno"> 6399</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Please provide zonal and meridional subdomain numbers!&quot;</span>)</div>
<div class="line"><span class="lineno"> 6400</span>      ctl-&gt;dd_nbr_neighbours =</div>
<div class="line"><span class="lineno"> 6401</span>      (<span class="keywordtype">int</span>) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, &quot;DD_NBR_NEIGHBOURS&quot;, -1, &quot;8&quot;,</div>
<div class="line"><span class="lineno"> 6402</span>                     NULL);</div>
<div class="line"><span class="lineno"> 6403</span>  ctl-&gt;dd_halos_size =</div>
<div class="line"><span class="lineno"> 6404</span>    (<span class="keywordtype">int</span>) <a class="code hl_function" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a>(filename, argc, argv, &quot;DD_HALOS_SIZE&quot;, -1, &quot;1&quot;, NULL);</div>
<div class="line"><span class="lineno"> 6405</span>}</div>
<div class="ttc" id="amptrac_8c_html_a51f61e053cfec3bdd62fa3a8110e046e"><div class="ttname"><a href="mptrac_8c.html#a51f61e053cfec3bdd62fa3a8110e046e">level_definitions</a></div><div class="ttdeci">void level_definitions(ctl_t *ctl)</div><div class="ttdoc">Defines pressure levels for meteorological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02659">mptrac.c:2659</a></div></div>
<div class="ttc" id="amptrac_8c_html_a7d07c7baed461e240ff50585ddeed80a"><div class="ttname"><a href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a">scan_ctl</a></div><div class="ttdeci">double scan_ctl(const char *filename, int argc, char *argv[], const char *varname, const int arridx, const char *defvalue, char *value)</div><div class="ttdoc">Scans a control file or command-line arguments for a specified variable.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l10951">mptrac.c:10951</a></div></div>
<div class="ttc" id="amptrac_8h_html_a1d2af32106d1fe82729714d3aa28a1c4"><div class="ttname"><a href="mptrac_8h.html#a1d2af32106d1fe82729714d3aa28a1c4">METVAR</a></div><div class="ttdeci">#define METVAR</div><div class="ttdoc">Number of 3-D meteorological variables.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00303">mptrac.h:303</a></div></div>
<div class="ttc" id="amptrac_8h_html_a68c2775fc4d7385df9c7bb96d23b482b"><div class="ttname"><a href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a></div><div class="ttdeci">#define NQ</div><div class="ttdoc">Maximum number of quantities per data point.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00313">mptrac.h:313</a></div></div>
<div class="ttc" id="amptrac_8h_html_a83e28faf41ab5f04f2f81ea7008565ea"><div class="ttname"><a href="mptrac_8h.html#a83e28faf41ab5f04f2f81ea7008565ea">SET_QNT</a></div><div class="ttdeci">#define SET_QNT(qnt, name, longname, unit)</div><div class="ttdoc">Set atmospheric quantity index.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01662">mptrac.h:1662</a></div></div>
<div class="ttc" id="astructctl__t_html_a0060ec5c97cb80d4721c3970c68012f5"><div class="ttname"><a href="structctl__t.html#a0060ec5c97cb80d4721c3970c68012f5">ctl_t::grid_z0</a></div><div class="ttdeci">double grid_z0</div><div class="ttdoc">Lower altitude of gridded data [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03025">mptrac.h:3025</a></div></div>
<div class="ttc" id="astructctl__t_html_a013bc90afda842d7312647bfd0364232"><div class="ttname"><a href="structctl__t.html#a013bc90afda842d7312647bfd0364232">ctl_t::qnt_o3</a></div><div class="ttdeci">int qnt_o3</div><div class="ttdoc">Quantity array index for ozone volume mixing ratio.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02243">mptrac.h:2243</a></div></div>
<div class="ttc" id="astructctl__t_html_a015b2de1c61e25a2e8abb0fba4a05c24"><div class="ttname"><a href="structctl__t.html#a015b2de1c61e25a2e8abb0fba4a05c24">ctl_t::csi_lat1</a></div><div class="ttdeci">double csi_lat1</div><div class="ttdoc">Upper latitude of gridded CSI data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02986">mptrac.h:2986</a></div></div>
<div class="ttc" id="astructctl__t_html_a01ea628e12cf0025aa0731f52d13da10"><div class="ttname"><a href="structctl__t.html#a01ea628e12cf0025aa0731f52d13da10">ctl_t::csi_obsfile</a></div><div class="ttdeci">char csi_obsfile[LEN]</div><div class="ttdoc">Observation data file for CSI analysis.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02953">mptrac.h:2953</a></div></div>
<div class="ttc" id="astructctl__t_html_a034e61c3566760c5ebe4e16f3f3c3021"><div class="ttname"><a href="structctl__t.html#a034e61c3566760c5ebe4e16f3f3c3021">ctl_t::met_nc_scale</a></div><div class="ttdeci">int met_nc_scale</div><div class="ttdoc">Check netCDF scaling factors (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02477">mptrac.h:2477</a></div></div>
<div class="ttc" id="astructctl__t_html_a0350a3e6ada50d40416094ba8d079e4e"><div class="ttname"><a href="structctl__t.html#a0350a3e6ada50d40416094ba8d079e4e">ctl_t::qnt_pel</a></div><div class="ttdeci">int qnt_pel</div><div class="ttdoc">Quantity array index for pressure at equilibrium level (EL).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02276">mptrac.h:2276</a></div></div>
<div class="ttc" id="astructctl__t_html_a0409a87481145b01eb3fd61042f35abc"><div class="ttname"><a href="structctl__t.html#a0409a87481145b01eb3fd61042f35abc">ctl_t::csi_nz</a></div><div class="ttdeci">int csi_nz</div><div class="ttdoc">Number of altitudes of gridded CSI data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02962">mptrac.h:2962</a></div></div>
<div class="ttc" id="astructctl__t_html_a0545623fc0f39bea920d00bfc88c4d11"><div class="ttname"><a href="structctl__t.html#a0545623fc0f39bea920d00bfc88c4d11">ctl_t::qnt_p</a></div><div class="ttdeci">int qnt_p</div><div class="ttdoc">Quantity array index for pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02222">mptrac.h:2222</a></div></div>
<div class="ttc" id="astructctl__t_html_a06975fa14d8c7f7813bf83fa4166f819"><div class="ttname"><a href="structctl__t.html#a06975fa14d8c7f7813bf83fa4166f819">ctl_t::atm_gpfile</a></div><div class="ttdeci">char atm_gpfile[LEN]</div><div class="ttdoc">Gnuplot file for atmospheric data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02914">mptrac.h:2914</a></div></div>
<div class="ttc" id="astructctl__t_html_a09d4500bded056b92a7b3750d1af5ff1"><div class="ttname"><a href="structctl__t.html#a09d4500bded056b92a7b3750d1af5ff1">ctl_t::qnt_swc</a></div><div class="ttdeci">int qnt_swc</div><div class="ttdoc">Quantity array index for cloud snow water content.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02255">mptrac.h:2255</a></div></div>
<div class="ttc" id="astructctl__t_html_a0a450754f8661100135aa790ea26df16"><div class="ttname"><a href="structctl__t.html#a0a450754f8661100135aa790ea26df16">ctl_t::csi_obsmin</a></div><div class="ttdeci">double csi_obsmin</div><div class="ttdoc">Minimum observation index to trigger detection.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02956">mptrac.h:2956</a></div></div>
<div class="ttc" id="astructctl__t_html_a0bdd43744dd2b92d5aa40627d028d42e"><div class="ttname"><a href="structctl__t.html#a0bdd43744dd2b92d5aa40627d028d42e">ctl_t::qnt_pcb</a></div><div class="ttdeci">int qnt_pcb</div><div class="ttdoc">Quantity array index for cloud bottom pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02264">mptrac.h:2264</a></div></div>
<div class="ttc" id="astructctl__t_html_a0cd8031f829953cb90912d9eecfe67b3"><div class="ttname"><a href="structctl__t.html#a0cd8031f829953cb90912d9eecfe67b3">ctl_t::csi_lon1</a></div><div class="ttdeci">double csi_lon1</div><div class="ttdoc">Upper longitude of gridded CSI data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02977">mptrac.h:2977</a></div></div>
<div class="ttc" id="astructctl__t_html_a0f4b7179eb39bf6a1679f46e8826e1de"><div class="ttname"><a href="structctl__t.html#a0f4b7179eb39bf6a1679f46e8826e1de">ctl_t::qnt_u</a></div><div class="ttdeci">int qnt_u</div><div class="ttdoc">Quantity array index for zonal wind.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02231">mptrac.h:2231</a></div></div>
<div class="ttc" id="astructctl__t_html_a0fafec241b4112fa64cb69fe09403ea8"><div class="ttname"><a href="structctl__t.html#a0fafec241b4112fa64cb69fe09403ea8">ctl_t::stat_lon</a></div><div class="ttdeci">double stat_lon</div><div class="ttdoc">Longitude of station [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03103">mptrac.h:3103</a></div></div>
<div class="ttc" id="astructctl__t_html_a126d9eac2687f4aac95ab17fff14dd07"><div class="ttname"><a href="structctl__t.html#a126d9eac2687f4aac95ab17fff14dd07">ctl_t::sort_dt</a></div><div class="ttdeci">double sort_dt</div><div class="ttdoc">Time step for sorting of particle data [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02635">mptrac.h:2635</a></div></div>
<div class="ttc" id="astructctl__t_html_a149be614c5eafb380c3c9f3ad6599971"><div class="ttname"><a href="structctl__t.html#a149be614c5eafb380c3c9f3ad6599971">ctl_t::stat_r</a></div><div class="ttdeci">double stat_r</div><div class="ttdoc">Search radius around station [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03109">mptrac.h:3109</a></div></div>
<div class="ttc" id="astructctl__t_html_a1601f7c2d8e163790e3a81cc647b7756"><div class="ttname"><a href="structctl__t.html#a1601f7c2d8e163790e3a81cc647b7756">ctl_t::met_zstd_level</a></div><div class="ttdeci">int met_zstd_level</div><div class="ttdoc">ZSTD compression level (from -5 to 22).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02486">mptrac.h:2486</a></div></div>
<div class="ttc" id="astructctl__t_html_a17759fe1c0d11bb19777559e24808d40"><div class="ttname"><a href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">ctl_t::csi_ny</a></div><div class="ttdeci">int csi_ny</div><div class="ttdoc">Number of latitudes of gridded CSI data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02980">mptrac.h:2980</a></div></div>
<div class="ttc" id="astructctl__t_html_a17e569920568025af14e66d706651a18"><div class="ttname"><a href="structctl__t.html#a17e569920568025af14e66d706651a18">ctl_t::vtk_sphere</a></div><div class="ttdeci">int vtk_sphere</div><div class="ttdoc">Spherical projection for VTK data (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03133">mptrac.h:3133</a></div></div>
<div class="ttc" id="astructctl__t_html_a183f7517467fab1c84b49db0cb236ad0"><div class="ttname"><a href="structctl__t.html#a183f7517467fab1c84b49db0cb236ad0">ctl_t::met_pbl_min</a></div><div class="ttdeci">double met_pbl_min</div><div class="ttdoc">Minimum depth of planetary boundary layer [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02603">mptrac.h:2603</a></div></div>
<div class="ttc" id="astructctl__t_html_a18974d6fa7e5e9e14a56338d638e730a"><div class="ttname"><a href="structctl__t.html#a18974d6fa7e5e9e14a56338d638e730a">ctl_t::qnt_iwc</a></div><div class="ttdeci">int qnt_iwc</div><div class="ttdoc">Quantity array index for cloud ice water content.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02252">mptrac.h:2252</a></div></div>
<div class="ttc" id="astructctl__t_html_a18f244fd363b499ed9add07ecba27c51"><div class="ttname"><a href="structctl__t.html#a18f244fd363b499ed9add07ecba27c51">ctl_t::met_cms_eps_pv</a></div><div class="ttdeci">double met_cms_eps_pv</div><div class="ttdoc">cmultiscale compression epsilon for potential vorticity.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02525">mptrac.h:2525</a></div></div>
<div class="ttc" id="astructctl__t_html_a19e02cd4b17e850b32bfd5d68d73d5a0"><div class="ttname"><a href="structctl__t.html#a19e02cd4b17e850b32bfd5d68d73d5a0">ctl_t::qnt_pw</a></div><div class="ttdeci">int qnt_pw</div><div class="ttdoc">Quantity array index for partial water vapor pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02330">mptrac.h:2330</a></div></div>
<div class="ttc" id="astructctl__t_html_a1a4c8aa3a46d5a54c6ef2ca4eefdf3a1"><div class="ttname"><a href="structctl__t.html#a1a4c8aa3a46d5a54c6ef2ca4eefdf3a1">ctl_t::prof_basename</a></div><div class="ttdeci">char prof_basename[LEN]</div><div class="ttdoc">Basename for profile output file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03052">mptrac.h:3052</a></div></div>
<div class="ttc" id="astructctl__t_html_a1a5460bac04c277c0e66efc9f2f85810"><div class="ttname"><a href="structctl__t.html#a1a5460bac04c277c0e66efc9f2f85810">ctl_t::grid_z1</a></div><div class="ttdeci">double grid_z1</div><div class="ttdoc">Upper altitude of gridded data [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03028">mptrac.h:3028</a></div></div>
<div class="ttc" id="astructctl__t_html_a1eb5d7699fd84b8522a1d666d0851fad"><div class="ttname"><a href="structctl__t.html#a1eb5d7699fd84b8522a1d666d0851fad">ctl_t::met_dp</a></div><div class="ttdeci">int met_dp</div><div class="ttdoc">Stride for pressure levels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02555">mptrac.h:2555</a></div></div>
<div class="ttc" id="astructctl__t_html_a1f07329a9333e6af8f00ff9727d774ce"><div class="ttname"><a href="structctl__t.html#a1f07329a9333e6af8f00ff9727d774ce">ctl_t::met_dt_out</a></div><div class="ttdeci">double met_dt_out</div><div class="ttdoc">Time step for sampling of meteo data along trajectories [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02622">mptrac.h:2622</a></div></div>
<div class="ttc" id="astructctl__t_html_a200b52904d3a14e04984a130528be5a0"><div class="ttname"><a href="structctl__t.html#a200b52904d3a14e04984a130528be5a0">ctl_t::qnt_h2o2</a></div><div class="ttdeci">int qnt_h2o2</div><div class="ttdoc">Quantity array index for H2O2 volume mixing ratio (climatology).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02294">mptrac.h:2294</a></div></div>
<div class="ttc" id="astructctl__t_html_a20196705d4eebddaeff4005ad88a20d2"><div class="ttname"><a href="structctl__t.html#a20196705d4eebddaeff4005ad88a20d2">ctl_t::qnt_vh</a></div><div class="ttdeci">int qnt_vh</div><div class="ttdoc">Quantity array index for horizontal wind.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02366">mptrac.h:2366</a></div></div>
<div class="ttc" id="astructctl__t_html_a20f21cdf4fea1cfc948fc1bcc1f0a520"><div class="ttname"><a href="structctl__t.html#a20f21cdf4fea1cfc948fc1bcc1f0a520">ctl_t::species</a></div><div class="ttdeci">char species[LEN]</div><div class="ttdoc">Species.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02733">mptrac.h:2733</a></div></div>
<div class="ttc" id="astructctl__t_html_a21159a48d018215b1bb5af62214b9063"><div class="ttname"><a href="structctl__t.html#a21159a48d018215b1bb5af62214b9063">ctl_t::csi_nx</a></div><div class="ttdeci">int csi_nx</div><div class="ttdoc">Number of longitudes of gridded CSI data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02971">mptrac.h:2971</a></div></div>
<div class="ttc" id="astructctl__t_html_a219b7e2f9f53597e84a87d349e32bcb5"><div class="ttname"><a href="structctl__t.html#a219b7e2f9f53597e84a87d349e32bcb5">ctl_t::csi_lat0</a></div><div class="ttdeci">double csi_lat0</div><div class="ttdoc">Lower latitude of gridded CSI data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02983">mptrac.h:2983</a></div></div>
<div class="ttc" id="astructctl__t_html_a220b71ff77f479684ae659f626b1c5d9"><div class="ttname"><a href="structctl__t.html#a220b71ff77f479684ae659f626b1c5d9">ctl_t::met_pbl</a></div><div class="ttdeci">int met_pbl</div><div class="ttdoc">Planetary boundary layer data (0=file, 1=z2p, 2=Richardson, 3=theta).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02600">mptrac.h:2600</a></div></div>
<div class="ttc" id="astructctl__t_html_a2239f6bc182dca64b8cf50f23dff3940"><div class="ttname"><a href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">ctl_t::met_comp_tol</a></div><div class="ttdeci">double met_comp_tol[METVAR]</div><div class="ttdoc">Compression tolerance for SZ3 or ZFP.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02492">mptrac.h:2492</a></div></div>
<div class="ttc" id="astructctl__t_html_a22b2ba380a3c30089e5978c4a03311de"><div class="ttname"><a href="structctl__t.html#a22b2ba380a3c30089e5978c4a03311de">ctl_t::qnt_lwc</a></div><div class="ttdeci">int qnt_lwc</div><div class="ttdoc">Quantity array index for cloud liquid water content.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02246">mptrac.h:2246</a></div></div>
<div class="ttc" id="astructctl__t_html_a231a88993a5cba0a0838de7b34d6d621"><div class="ttname"><a href="structctl__t.html#a231a88993a5cba0a0838de7b34d6d621">ctl_t::grid_nc_level</a></div><div class="ttdeci">int grid_nc_level</div><div class="ttdoc">zlib compression level of netCDF grid data files (0=off).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03013">mptrac.h:3013</a></div></div>
<div class="ttc" id="astructctl__t_html_a235ea5cb832f13023339bafe9eeffd20"><div class="ttname"><a href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">ctl_t::grid_nx</a></div><div class="ttdeci">int grid_nx</div><div class="ttdoc">Number of longitudes of gridded data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03031">mptrac.h:3031</a></div></div>
<div class="ttc" id="astructctl__t_html_a25bb036fcbb73ed2452d42212cd3c09f"><div class="ttname"><a href="structctl__t.html#a25bb036fcbb73ed2452d42212cd3c09f">ctl_t::grid_lat0</a></div><div class="ttdeci">double grid_lat0</div><div class="ttdoc">Lower latitude of gridded data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03043">mptrac.h:3043</a></div></div>
<div class="ttc" id="astructctl__t_html_a262aa775e7fe82b123a62633d1c3d8b3"><div class="ttname"><a href="structctl__t.html#a262aa775e7fe82b123a62633d1c3d8b3">ctl_t::qnt_ts</a></div><div class="ttdeci">int qnt_ts</div><div class="ttdoc">Quantity array index for surface temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02177">mptrac.h:2177</a></div></div>
<div class="ttc" id="astructctl__t_html_a26f8ddbe9458a750f9f321bd3eefc665"><div class="ttname"><a href="structctl__t.html#a26f8ddbe9458a750f9f321bd3eefc665">ctl_t::met_cms_eps_h2o</a></div><div class="ttdeci">double met_cms_eps_h2o</div><div class="ttdoc">cmultiscale compression epsilon for water vapor.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02528">mptrac.h:2528</a></div></div>
<div class="ttc" id="astructctl__t_html_a274f366df1c6e8dff7b16fc4cf2e1c0a"><div class="ttname"><a href="structctl__t.html#a274f366df1c6e8dff7b16fc4cf2e1c0a">ctl_t::qnt_plfc</a></div><div class="ttdeci">int qnt_plfc</div><div class="ttdoc">Quantity array index for pressure at level of free convection (LCF).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02273">mptrac.h:2273</a></div></div>
<div class="ttc" id="astructctl__t_html_a2b398376ae2ebe6e02a34465367943de"><div class="ttname"><a href="structctl__t.html#a2b398376ae2ebe6e02a34465367943de">ctl_t::grid_lon0</a></div><div class="ttdeci">double grid_lon0</div><div class="ttdoc">Lower longitude of gridded data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03034">mptrac.h:3034</a></div></div>
<div class="ttc" id="astructctl__t_html_a2b485dd5916e7c0b346190afc5d2b437"><div class="ttname"><a href="structctl__t.html#a2b485dd5916e7c0b346190afc5d2b437">ctl_t::qnt_o1d</a></div><div class="ttdeci">int qnt_o1d</div><div class="ttdoc">Quantity array index for O(1D) volume mixing ratio (climatology).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02300">mptrac.h:2300</a></div></div>
<div class="ttc" id="astructctl__t_html_a2b8390b7a9e1335c03a0877f93b051af"><div class="ttname"><a href="structctl__t.html#a2b8390b7a9e1335c03a0877f93b051af">ctl_t::met_tropo_spline</a></div><div class="ttdeci">int met_tropo_spline</div><div class="ttdoc">Tropopause interpolation method (0=linear, 1=spline).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02619">mptrac.h:2619</a></div></div>
<div class="ttc" id="astructctl__t_html_a2c08850b82591f935ab0c498217b3d65"><div class="ttname"><a href="structctl__t.html#a2c08850b82591f935ab0c498217b3d65">ctl_t::sample_kernel</a></div><div class="ttdeci">char sample_kernel[LEN]</div><div class="ttdoc">Kernel data file for sample output.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03088">mptrac.h:3088</a></div></div>
<div class="ttc" id="astructctl__t_html_a2d0be917be3aba29baf2ed7f626bfa83"><div class="ttname"><a href="structctl__t.html#a2d0be917be3aba29baf2ed7f626bfa83">ctl_t::qnt_tvirt</a></div><div class="ttdeci">int qnt_tvirt</div><div class="ttdoc">Quantity array index for virtual temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02360">mptrac.h:2360</a></div></div>
<div class="ttc" id="astructctl__t_html_a2ec0ba6ad9f46184228f1a1784596218"><div class="ttname"><a href="structctl__t.html#a2ec0ba6ad9f46184228f1a1784596218">ctl_t::met_geopot_sy</a></div><div class="ttdeci">int met_geopot_sy</div><div class="ttdoc">Latitudinal smoothing of geopotential heights.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02591">mptrac.h:2591</a></div></div>
<div class="ttc" id="astructctl__t_html_a30f012c96cb05d5a99004d9ce032277c"><div class="ttname"><a href="structctl__t.html#a30f012c96cb05d5a99004d9ce032277c">ctl_t::grid_gpfile</a></div><div class="ttdeci">char grid_gpfile[LEN]</div><div class="ttdoc">Gnuplot file for gridded data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03004">mptrac.h:3004</a></div></div>
<div class="ttc" id="astructctl__t_html_a30faf85e41c30103312372114b43cfd9"><div class="ttname"><a href="structctl__t.html#a30faf85e41c30103312372114b43cfd9">ctl_t::met_cms_eps_u</a></div><div class="ttdeci">double met_cms_eps_u</div><div class="ttdoc">cmultiscale compression epsilon for zonal wind.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02516">mptrac.h:2516</a></div></div>
<div class="ttc" id="astructctl__t_html_a3256dff5d8ff24754dfc04af56ae49d2"><div class="ttname"><a href="structctl__t.html#a3256dff5d8ff24754dfc04af56ae49d2">ctl_t::qnt_lsm</a></div><div class="ttdeci">int qnt_lsm</div><div class="ttdoc">Quantity array index for land-sea mask.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02198">mptrac.h:2198</a></div></div>
<div class="ttc" id="astructctl__t_html_a33a185ae0cb5badcd525d961875d3b2c"><div class="ttname"><a href="structctl__t.html#a33a185ae0cb5badcd525d961875d3b2c">ctl_t::qnt_theta</a></div><div class="ttdeci">int qnt_theta</div><div class="ttdoc">Quantity array index for potential temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02342">mptrac.h:2342</a></div></div>
<div class="ttc" id="astructctl__t_html_a370c0a527e721ea64cd67685abd7bc42"><div class="ttname"><a href="structctl__t.html#a370c0a527e721ea64cd67685abd7bc42">ctl_t::stat_t1</a></div><div class="ttdeci">double stat_t1</div><div class="ttdoc">Stop time for station output [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03115">mptrac.h:3115</a></div></div>
<div class="ttc" id="astructctl__t_html_a378603f0fe74b4236f45f78bf4bc02dc"><div class="ttname"><a href="structctl__t.html#a378603f0fe74b4236f45f78bf4bc02dc">ctl_t::csi_kernel</a></div><div class="ttdeci">char csi_kernel[LEN]</div><div class="ttdoc">Kernel data file for CSI output.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02947">mptrac.h:2947</a></div></div>
<div class="ttc" id="astructctl__t_html_a37c580065a63c21f5421ee78e3c4b3d9"><div class="ttname"><a href="structctl__t.html#a37c580065a63c21f5421ee78e3c4b3d9">ctl_t::grid_type</a></div><div class="ttdeci">int grid_type</div><div class="ttdoc">Type of grid data files (0=ASCII, 1=netCDF).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03049">mptrac.h:3049</a></div></div>
<div class="ttc" id="astructctl__t_html_a396d8bbb52aaf8408e90c207aa7f7312"><div class="ttname"><a href="structctl__t.html#a396d8bbb52aaf8408e90c207aa7f7312">ctl_t::csi_lon0</a></div><div class="ttdeci">double csi_lon0</div><div class="ttdoc">Lower longitude of gridded CSI data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02974">mptrac.h:2974</a></div></div>
<div class="ttc" id="astructctl__t_html_a39d8a732f074ea0275ecb84832f60d59"><div class="ttname"><a href="structctl__t.html#a39d8a732f074ea0275ecb84832f60d59">ctl_t::qnt_pbl</a></div><div class="ttdeci">int qnt_pbl</div><div class="ttdoc">Quantity array index for boundary layer pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02204">mptrac.h:2204</a></div></div>
<div class="ttc" id="astructctl__t_html_a3b10e6157d7ccde448863065a4df9558"><div class="ttname"><a href="structctl__t.html#a3b10e6157d7ccde448863065a4df9558">ctl_t::grid_stddev</a></div><div class="ttdeci">int grid_stddev</div><div class="ttdoc">Include standard deviations in grid output (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03019">mptrac.h:3019</a></div></div>
<div class="ttc" id="astructctl__t_html_a3d8b0a7cd91c255170233ef509a24a84"><div class="ttname"><a href="structctl__t.html#a3d8b0a7cd91c255170233ef509a24a84">ctl_t::qnt_psice</a></div><div class="ttdeci">int qnt_psice</div><div class="ttdoc">Quantity array index for saturation pressure over ice.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02327">mptrac.h:2327</a></div></div>
<div class="ttc" id="astructctl__t_html_a416596b692cca87f14e83f851db35e29"><div class="ttname"><a href="structctl__t.html#a416596b692cca87f14e83f851db35e29">ctl_t::met_geopot_sx</a></div><div class="ttdeci">int met_geopot_sx</div><div class="ttdoc">Longitudinal smoothing of geopotential heights.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02588">mptrac.h:2588</a></div></div>
<div class="ttc" id="astructctl__t_html_a416820ddede3de831eb41413ed6427c0"><div class="ttname"><a href="structctl__t.html#a416820ddede3de831eb41413ed6427c0">ctl_t::met_sy</a></div><div class="ttdeci">int met_sy</div><div class="ttdoc">Smoothing for latitudes.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02561">mptrac.h:2561</a></div></div>
<div class="ttc" id="astructctl__t_html_a4217d6043a9429aa2c47517680d44453"><div class="ttname"><a href="structctl__t.html#a4217d6043a9429aa2c47517680d44453">ctl_t::qnt_ps</a></div><div class="ttdeci">int qnt_ps</div><div class="ttdoc">Quantity array index for surface pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02174">mptrac.h:2174</a></div></div>
<div class="ttc" id="astructctl__t_html_a42d536f7e68997de273a245cff2af30b"><div class="ttname"><a href="structctl__t.html#a42d536f7e68997de273a245cff2af30b">ctl_t::prof_obsfile</a></div><div class="ttdeci">char prof_obsfile[LEN]</div><div class="ttdoc">Observation data file for profile output.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03055">mptrac.h:3055</a></div></div>
<div class="ttc" id="astructctl__t_html_a458f7cdd42fb5e2d9531e7d48038b730"><div class="ttname"><a href="structctl__t.html#a458f7cdd42fb5e2d9531e7d48038b730">ctl_t::qnt_zs</a></div><div class="ttdeci">int qnt_zs</div><div class="ttdoc">Quantity array index for surface geopotential height.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02180">mptrac.h:2180</a></div></div>
<div class="ttc" id="astructctl__t_html_a45940a490a88de1eee54ce2701db84aa"><div class="ttname"><a href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">ctl_t::prof_nz</a></div><div class="ttdeci">int prof_nz</div><div class="ttdoc">Number of altitudes of gridded profile data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03058">mptrac.h:3058</a></div></div>
<div class="ttc" id="astructctl__t_html_a466eb100ca9ab4f5f605e14a27a61f1d"><div class="ttname"><a href="structctl__t.html#a466eb100ca9ab4f5f605e14a27a61f1d">ctl_t::csi_dt_out</a></div><div class="ttdeci">double csi_dt_out</div><div class="ttdoc">Time step for CSI output [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02950">mptrac.h:2950</a></div></div>
<div class="ttc" id="astructctl__t_html_a47ee3960f0b2b25382062fa8dda37ede"><div class="ttname"><a href="structctl__t.html#a47ee3960f0b2b25382062fa8dda37ede">ctl_t::met_cape</a></div><div class="ttdeci">int met_cape</div><div class="ttdoc">Convective available potential energy data (0=file, 1=calculate).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02597">mptrac.h:2597</a></div></div>
<div class="ttc" id="astructctl__t_html_a4aa05c61a9c0c1d0f3737f2190b1ebdc"><div class="ttname"><a href="structctl__t.html#a4aa05c61a9c0c1d0f3737f2190b1ebdc">ctl_t::csi_modmin</a></div><div class="ttdeci">double csi_modmin</div><div class="ttdoc">Minimum column density to trigger detection [kg/m^2].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02959">mptrac.h:2959</a></div></div>
<div class="ttc" id="astructctl__t_html_a4abb2ec4ff0e29f2648cb5e8b182e5d8"><div class="ttname"><a href="structctl__t.html#a4abb2ec4ff0e29f2648cb5e8b182e5d8">ctl_t::met_sx</a></div><div class="ttdeci">int met_sx</div><div class="ttdoc">Smoothing for longitudes.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02558">mptrac.h:2558</a></div></div>
<div class="ttc" id="astructctl__t_html_a4c6e62f749bbce82b5d29860e5def10a"><div class="ttname"><a href="structctl__t.html#a4c6e62f749bbce82b5d29860e5def10a">ctl_t::met_cms_eps_iwc</a></div><div class="ttdeci">double met_cms_eps_iwc</div><div class="ttdoc">cmultiscale compression epsilon for cloud ice water content.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02540">mptrac.h:2540</a></div></div>
<div class="ttc" id="astructctl__t_html_a4d43909ab5875fc1e0e53966272ccc1a"><div class="ttname"><a href="structctl__t.html#a4d43909ab5875fc1e0e53966272ccc1a">ctl_t::met_cms_eps_swc</a></div><div class="ttdeci">double met_cms_eps_swc</div><div class="ttdoc">cmultiscale compression epsilon for cloud snow water content.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02543">mptrac.h:2543</a></div></div>
<div class="ttc" id="astructctl__t_html_a4dc20e7eacf1e45a61ed1910e0e88d1b"><div class="ttname"><a href="structctl__t.html#a4dc20e7eacf1e45a61ed1910e0e88d1b">ctl_t::grid_kernel</a></div><div class="ttdeci">char grid_kernel[LEN]</div><div class="ttdoc">Kernel data file for grid output.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03001">mptrac.h:3001</a></div></div>
<div class="ttc" id="astructctl__t_html_a4eca0cacca656d7c8121821859e83a53"><div class="ttname"><a href="structctl__t.html#a4eca0cacca656d7c8121821859e83a53">ctl_t::met_cms_eps_v</a></div><div class="ttdeci">double met_cms_eps_v</div><div class="ttdoc">cmultiscale compression epsilon for meridional wind.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02519">mptrac.h:2519</a></div></div>
<div class="ttc" id="astructctl__t_html_a4ef0c20dc2cdc73b2a3272e40a82efd4"><div class="ttname"><a href="structctl__t.html#a4ef0c20dc2cdc73b2a3272e40a82efd4">ctl_t::prof_z0</a></div><div class="ttdeci">double prof_z0</div><div class="ttdoc">Lower altitude of gridded profile data [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03061">mptrac.h:3061</a></div></div>
<div class="ttc" id="astructctl__t_html_a4eff0a4676fbb4bb8a4b832900e16e48"><div class="ttname"><a href="structctl__t.html#a4eff0a4676fbb4bb8a4b832900e16e48">ctl_t::qnt_w</a></div><div class="ttdeci">int qnt_w</div><div class="ttdoc">Quantity array index for vertical velocity.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02237">mptrac.h:2237</a></div></div>
<div class="ttc" id="astructctl__t_html_a4fa995de108b6beeee9d4e5c4f9f68bb"><div class="ttname"><a href="structctl__t.html#a4fa995de108b6beeee9d4e5c4f9f68bb">ctl_t::met_tropo_pv</a></div><div class="ttdeci">double met_tropo_pv</div><div class="ttdoc">Dynamical tropopause potential vorticity threshold [PVU].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02613">mptrac.h:2613</a></div></div>
<div class="ttc" id="astructctl__t_html_a4fe06eb4b9baabf93694ed62d2956046"><div class="ttname"><a href="structctl__t.html#a4fe06eb4b9baabf93694ed62d2956046">ctl_t::prof_nx</a></div><div class="ttdeci">int prof_nx</div><div class="ttdoc">Number of longitudes of gridded profile data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03067">mptrac.h:3067</a></div></div>
<div class="ttc" id="astructctl__t_html_a508aa1f5e4ba701e86557f114999b314"><div class="ttname"><a href="structctl__t.html#a508aa1f5e4ba701e86557f114999b314">ctl_t::qnt_stat</a></div><div class="ttdeci">int qnt_stat</div><div class="ttdoc">Quantity array index for station flag.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02159">mptrac.h:2159</a></div></div>
<div class="ttc" id="astructctl__t_html_a54d668c2751138dd5e6b77876e469206"><div class="ttname"><a href="structctl__t.html#a54d668c2751138dd5e6b77876e469206">ctl_t::met_mpi_share</a></div><div class="ttdeci">int met_mpi_share</div><div class="ttdoc">Use MPI to share meteo (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02628">mptrac.h:2628</a></div></div>
<div class="ttc" id="astructctl__t_html_a55330859df8034626ba300905e35bb04"><div class="ttname"><a href="structctl__t.html#a55330859df8034626ba300905e35bb04">ctl_t::qnt_vz</a></div><div class="ttdeci">int qnt_vz</div><div class="ttdoc">Quantity array index for vertical velocity.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02369">mptrac.h:2369</a></div></div>
<div class="ttc" id="astructctl__t_html_a554a6ad70e586d7aa1ac342cadb8c41e"><div class="ttname"><a href="structctl__t.html#a554a6ad70e586d7aa1ac342cadb8c41e">ctl_t::qnt_ho2</a></div><div class="ttdeci">int qnt_ho2</div><div class="ttdoc">Quantity array index for HO2 volume mixing ratio (climatology).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02297">mptrac.h:2297</a></div></div>
<div class="ttc" id="astructctl__t_html_a55a1915a7e8ef2a91a2553a8393b4329"><div class="ttname"><a href="structctl__t.html#a55a1915a7e8ef2a91a2553a8393b4329">ctl_t::csi_z1</a></div><div class="ttdeci">double csi_z1</div><div class="ttdoc">Upper altitude of gridded CSI data [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02968">mptrac.h:2968</a></div></div>
<div class="ttc" id="astructctl__t_html_a5721f8afc611b607db92678bb063f42d"><div class="ttname"><a href="structctl__t.html#a5721f8afc611b607db92678bb063f42d">ctl_t::stat_t0</a></div><div class="ttdeci">double stat_t0</div><div class="ttdoc">Start time for station output [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03112">mptrac.h:3112</a></div></div>
<div class="ttc" id="astructctl__t_html_a587663283cba9a4470dd7b753b5a1690"><div class="ttname"><a href="structctl__t.html#a587663283cba9a4470dd7b753b5a1690">ctl_t::dd</a></div><div class="ttdeci">int dd</div><div class="ttdoc">Domain decomposition (0=no, 1=yes, with 2x2 if not specified).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03140">mptrac.h:3140</a></div></div>
<div class="ttc" id="astructctl__t_html_a5d5c0f111d122cfcc4e3de57bc1731cd"><div class="ttname"><a href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">ctl_t::atm_type_out</a></div><div class="ttdeci">int atm_type_out</div><div class="ttdoc">Type of atmospheric data files for output (-1=same as ATM_TYPE, 0=ASCII, 1=binary,...</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02932">mptrac.h:2932</a></div></div>
<div class="ttc" id="astructctl__t_html_a5dcfc2a583119a8e54a0780c6ea6dcbf"><div class="ttname"><a href="structctl__t.html#a5dcfc2a583119a8e54a0780c6ea6dcbf">ctl_t::met_cms_nd0x</a></div><div class="ttdeci">int met_cms_nd0x</div><div class="ttdoc">cmultiscale number of cells of coarsest grid in x-direction.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02501">mptrac.h:2501</a></div></div>
<div class="ttc" id="astructctl__t_html_a6024bf55339aa76e34a54e29f357bf6d"><div class="ttname"><a href="structctl__t.html#a6024bf55339aa76e34a54e29f357bf6d">ctl_t::met_nlev</a></div><div class="ttdeci">int met_nlev</div><div class="ttdoc">Number of meteo data model levels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02579">mptrac.h:2579</a></div></div>
<div class="ttc" id="astructctl__t_html_a603d7f5e599d149b57a67fea612ecb04"><div class="ttname"><a href="structctl__t.html#a603d7f5e599d149b57a67fea612ecb04">ctl_t::dt_kpp</a></div><div class="ttdeci">double dt_kpp</div><div class="ttdoc">Time step for KPP chemistry [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02859">mptrac.h:2859</a></div></div>
<div class="ttc" id="astructctl__t_html_a605a1904f8ff49d178ac462f8fbecc3a"><div class="ttname"><a href="structctl__t.html#a605a1904f8ff49d178ac462f8fbecc3a">ctl_t::csi_basename</a></div><div class="ttdeci">char csi_basename[LEN]</div><div class="ttdoc">Basename of CSI data files.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02944">mptrac.h:2944</a></div></div>
<div class="ttc" id="astructctl__t_html_a614d6716edf50ef61ab09759c5c636eb"><div class="ttname"><a href="structctl__t.html#a614d6716edf50ef61ab09759c5c636eb">ctl_t::qnt_shf</a></div><div class="ttdeci">int qnt_shf</div><div class="ttdoc">Quantity array index for surface sensible heat flux.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02195">mptrac.h:2195</a></div></div>
<div class="ttc" id="astructctl__t_html_a62b169930644e817a7275df51d40b51c"><div class="ttname"><a href="structctl__t.html#a62b169930644e817a7275df51d40b51c">ctl_t::qnt_vs</a></div><div class="ttdeci">int qnt_vs</div><div class="ttdoc">Quantity array index for surface meridional wind.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02186">mptrac.h:2186</a></div></div>
<div class="ttc" id="astructctl__t_html_a64262df06556e7055245b9f96d317f92"><div class="ttname"><a href="structctl__t.html#a64262df06556e7055245b9f96d317f92">ctl_t::vtk_dt_out</a></div><div class="ttdeci">double vtk_dt_out</div><div class="ttdoc">Time step for VTK data output [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03121">mptrac.h:3121</a></div></div>
<div class="ttc" id="astructctl__t_html_a64cdca0c6817ba378fbde7385b8ee279"><div class="ttname"><a href="structctl__t.html#a64cdca0c6817ba378fbde7385b8ee279">ctl_t::conv_dt</a></div><div class="ttdeci">double conv_dt</div><div class="ttdoc">Time interval for convection module [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02694">mptrac.h:2694</a></div></div>
<div class="ttc" id="astructctl__t_html_a64cde624042ea4b8d6b841660ff28546"><div class="ttname"><a href="structctl__t.html#a64cde624042ea4b8d6b841660ff28546">ctl_t::sample_obsfile</a></div><div class="ttdeci">char sample_obsfile[LEN]</div><div class="ttdoc">Observation data file for sample output.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03091">mptrac.h:3091</a></div></div>
<div class="ttc" id="astructctl__t_html_a65efacd05321fc6c808732e77dc87c84"><div class="ttname"><a href="structctl__t.html#a65efacd05321fc6c808732e77dc87c84">ctl_t::qnt_hno3</a></div><div class="ttdeci">int qnt_hno3</div><div class="ttdoc">Quantity array index for HNO3 volume mixing ratio (climatology).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02288">mptrac.h:2288</a></div></div>
<div class="ttc" id="astructctl__t_html_a65f18a2f1aa44522f78fc364a0ffaf68"><div class="ttname"><a href="structctl__t.html#a65f18a2f1aa44522f78fc364a0ffaf68">ctl_t::grid_basename</a></div><div class="ttdeci">char grid_basename[LEN]</div><div class="ttdoc">Basename of grid data files.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02998">mptrac.h:2998</a></div></div>
<div class="ttc" id="astructctl__t_html_a6662fe4a16e40dd370963936f5f1a833"><div class="ttname"><a href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">ctl_t::met_comp_prec</a></div><div class="ttdeci">int met_comp_prec[METVAR]</div><div class="ttdoc">Compression precision for SZ3 or ZFP.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02489">mptrac.h:2489</a></div></div>
<div class="ttc" id="astructctl__t_html_a6755ea47ddbf456c114fe69d85e0424d"><div class="ttname"><a href="structctl__t.html#a6755ea47ddbf456c114fe69d85e0424d">ctl_t::qnt_h2ot</a></div><div class="ttdeci">int qnt_h2ot</div><div class="ttdoc">Quantity array index for tropopause water vapor volume mixing ratio.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02216">mptrac.h:2216</a></div></div>
<div class="ttc" id="astructctl__t_html_a682a2a90d1df78dd2a6cfb4fa77773cb"><div class="ttname"><a href="structctl__t.html#a682a2a90d1df78dd2a6cfb4fa77773cb">ctl_t::qnt_rh</a></div><div class="ttdeci">int qnt_rh</div><div class="ttdoc">Quantity array index for relative humidity over water.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02336">mptrac.h:2336</a></div></div>
<div class="ttc" id="astructctl__t_html_a68531957caab05e8575ca3b92046a677"><div class="ttname"><a href="structctl__t.html#a68531957caab05e8575ca3b92046a677">ctl_t::met_cms_eps_cc</a></div><div class="ttdeci">double met_cms_eps_cc</div><div class="ttdoc">cmultiscale compression epsilon for cloud cover.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02546">mptrac.h:2546</a></div></div>
<div class="ttc" id="astructctl__t_html_a6a0360667c5b3cbab3da2a9fb4841970"><div class="ttname"><a href="structctl__t.html#a6a0360667c5b3cbab3da2a9fb4841970">ctl_t::met_pbl_max</a></div><div class="ttdeci">double met_pbl_max</div><div class="ttdoc">Maximum depth of planetary boundary layer [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02606">mptrac.h:2606</a></div></div>
<div class="ttc" id="astructctl__t_html_a6b03cd434f6f12efc60dc4b8d366d6c7"><div class="ttname"><a href="structctl__t.html#a6b03cd434f6f12efc60dc4b8d366d6c7">ctl_t::met_dx</a></div><div class="ttdeci">int met_dx</div><div class="ttdoc">Stride for longitudes.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02549">mptrac.h:2549</a></div></div>
<div class="ttc" id="astructctl__t_html_a6b51b58d1fa0b7d78d7a7c6ce949cf35"><div class="ttname"><a href="structctl__t.html#a6b51b58d1fa0b7d78d7a7c6ce949cf35">ctl_t::qnt_destination</a></div><div class="ttdeci">int qnt_destination</div><div class="ttdoc">Quantity array index for destination subdomain in domain decomposition.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02438">mptrac.h:2438</a></div></div>
<div class="ttc" id="astructctl__t_html_a6d866e961e374a254d7dc52ea52cb3db"><div class="ttname"><a href="structctl__t.html#a6d866e961e374a254d7dc52ea52cb3db">ctl_t::met_convention</a></div><div class="ttdeci">int met_convention</div><div class="ttdoc">Meteo data layout (0=[lev, lat, lon], 1=[lon, lat, lev]).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02463">mptrac.h:2463</a></div></div>
<div class="ttc" id="astructctl__t_html_a6dcfd67edca4a35aeca78f6bfbd04487"><div class="ttname"><a href="structctl__t.html#a6dcfd67edca4a35aeca78f6bfbd04487">ctl_t::qnt_zeta_d</a></div><div class="ttdeci">int qnt_zeta_d</div><div class="ttdoc">Quantity array index for diagnosed zeta vertical coordinate.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02348">mptrac.h:2348</a></div></div>
<div class="ttc" id="astructctl__t_html_a7144e94dd5ef6f75941dd35a82eac9bd"><div class="ttname"><a href="structctl__t.html#a7144e94dd5ef6f75941dd35a82eac9bd">ctl_t::tracer_chem</a></div><div class="ttdeci">int tracer_chem</div><div class="ttdoc">Switch for first order tracer chemistry module (0=off, 1=on).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02862">mptrac.h:2862</a></div></div>
<div class="ttc" id="astructctl__t_html_a727a42a9f7c8b7e01c713d5300767213"><div class="ttname"><a href="structctl__t.html#a727a42a9f7c8b7e01c713d5300767213">ctl_t::diffusion</a></div><div class="ttdeci">int diffusion</div><div class="ttdoc">Diffusion scheme (0=off, 1=fixed-K, 2=PBL).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02655">mptrac.h:2655</a></div></div>
<div class="ttc" id="astructctl__t_html_a7851aa93977a71a120361d75034a1808"><div class="ttname"><a href="structctl__t.html#a7851aa93977a71a120361d75034a1808">ctl_t::qnt_zg</a></div><div class="ttdeci">int qnt_zg</div><div class="ttdoc">Quantity array index for geopotential height.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02219">mptrac.h:2219</a></div></div>
<div class="ttc" id="astructctl__t_html_a78c2f172f67203ddfc2dfb9db913f51d"><div class="ttname"><a href="structctl__t.html#a78c2f172f67203ddfc2dfb9db913f51d">ctl_t::vtk_offset</a></div><div class="ttdeci">double vtk_offset</div><div class="ttdoc">Vertical offset for VTK data [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03130">mptrac.h:3130</a></div></div>
<div class="ttc" id="astructctl__t_html_a78f8fa92da366751d4fe71f85661f9f3"><div class="ttname"><a href="structctl__t.html#a78f8fa92da366751d4fe71f85661f9f3">ctl_t::qnt_v</a></div><div class="ttdeci">int qnt_v</div><div class="ttdoc">Quantity array index for meridional wind.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02234">mptrac.h:2234</a></div></div>
<div class="ttc" id="astructctl__t_html_a7c05d49d4f806a0f94c86ef932478cff"><div class="ttname"><a href="structctl__t.html#a7c05d49d4f806a0f94c86ef932478cff">ctl_t::qnt_oh</a></div><div class="ttdeci">int qnt_oh</div><div class="ttdoc">Quantity array index for OH volume mixing ratio (climatology).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02291">mptrac.h:2291</a></div></div>
<div class="ttc" id="astructctl__t_html_a82e92a79bb65a2febe234d63f86fc91b"><div class="ttname"><a href="structctl__t.html#a82e92a79bb65a2febe234d63f86fc91b">ctl_t::qnt_h2o</a></div><div class="ttdeci">int qnt_h2o</div><div class="ttdoc">Quantity array index for water vapor volume mixing ratio.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02240">mptrac.h:2240</a></div></div>
<div class="ttc" id="astructctl__t_html_a83da7c4b38e4b6044636bfcab0a0f8c2"><div class="ttname"><a href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">ctl_t::prof_ny</a></div><div class="ttdeci">int prof_ny</div><div class="ttdoc">Number of latitudes of gridded profile data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03076">mptrac.h:3076</a></div></div>
<div class="ttc" id="astructctl__t_html_a8462c6531b8eba2bf01230b01a4b8a04"><div class="ttname"><a href="structctl__t.html#a8462c6531b8eba2bf01230b01a4b8a04">ctl_t::qnt_rhice</a></div><div class="ttdeci">int qnt_rhice</div><div class="ttdoc">Quantity array index for relative humidity over ice.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02339">mptrac.h:2339</a></div></div>
<div class="ttc" id="astructctl__t_html_a850b57e663a4a8cde2952ecdad2c905f"><div class="ttname"><a href="structctl__t.html#a850b57e663a4a8cde2952ecdad2c905f">ctl_t::qnt_rho</a></div><div class="ttdeci">int qnt_rho</div><div class="ttdoc">Quantity array index for density of air.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02228">mptrac.h:2228</a></div></div>
<div class="ttc" id="astructctl__t_html_a857fdeffae577ddb41500ef0c875020e"><div class="ttname"><a href="structctl__t.html#a857fdeffae577ddb41500ef0c875020e">ctl_t::sample_dz</a></div><div class="ttdeci">double sample_dz</div><div class="ttdoc">Layer depth for sample output [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03097">mptrac.h:3097</a></div></div>
<div class="ttc" id="astructctl__t_html_a874cf53d903cea2e96423bacd2fafdab"><div class="ttname"><a href="structctl__t.html#a874cf53d903cea2e96423bacd2fafdab">ctl_t::obs_type</a></div><div class="ttdeci">int obs_type</div><div class="ttdoc">Type of observation data files (0=ASCII, 1=netCDF).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02941">mptrac.h:2941</a></div></div>
<div class="ttc" id="astructctl__t_html_a87ac3308dd3334c5614855d437383139"><div class="ttname"><a href="structctl__t.html#a87ac3308dd3334c5614855d437383139">ctl_t::grid_nc_quant</a></div><div class="ttdeci">int grid_nc_quant[NQ]</div><div class="ttdoc">Number of digits for quantization of netCDF grid data files (0=off).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03016">mptrac.h:3016</a></div></div>
<div class="ttc" id="astructctl__t_html_a880c7b75ded6d605d4fa81a16f9e4c9e"><div class="ttname"><a href="structctl__t.html#a880c7b75ded6d605d4fa81a16f9e4c9e">ctl_t::met_cms_eps_lwc</a></div><div class="ttdeci">double met_cms_eps_lwc</div><div class="ttdoc">cmultiscale compression epsilon for cloud liquid water content.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02534">mptrac.h:2534</a></div></div>
<div class="ttc" id="astructctl__t_html_a88eb2c811b2a0c5482a020e41d26c270"><div class="ttname"><a href="structctl__t.html#a88eb2c811b2a0c5482a020e41d26c270">ctl_t::qnt_us</a></div><div class="ttdeci">int qnt_us</div><div class="ttdoc">Quantity array index for surface zonal wind.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02183">mptrac.h:2183</a></div></div>
<div class="ttc" id="astructctl__t_html_a8941dd7fe11401d55bfaf1726c6a7beb"><div class="ttname"><a href="structctl__t.html#a8941dd7fe11401d55bfaf1726c6a7beb">ctl_t::met_cms_eps_z</a></div><div class="ttdeci">double met_cms_eps_z</div><div class="ttdoc">cmultiscale compression epsilon for geopotential height.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02510">mptrac.h:2510</a></div></div>
<div class="ttc" id="astructctl__t_html_a895d5f67cd12ab54481ebfa36f359b77"><div class="ttname"><a href="structctl__t.html#a895d5f67cd12ab54481ebfa36f359b77">ctl_t::grid_lon1</a></div><div class="ttdeci">double grid_lon1</div><div class="ttdoc">Upper longitude of gridded data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03037">mptrac.h:3037</a></div></div>
<div class="ttc" id="astructctl__t_html_a8b2706a512ce6a279091d8ff1b192346"><div class="ttname"><a href="structctl__t.html#a8b2706a512ce6a279091d8ff1b192346">ctl_t::atm_basename</a></div><div class="ttdeci">char atm_basename[LEN]</div><div class="ttdoc">Basename of atmospheric data files.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02911">mptrac.h:2911</a></div></div>
<div class="ttc" id="astructctl__t_html_a8cd31f8b17d847f8012e472c89dbe164"><div class="ttname"><a href="structctl__t.html#a8cd31f8b17d847f8012e472c89dbe164">ctl_t::qnt_pt</a></div><div class="ttdeci">int qnt_pt</div><div class="ttdoc">Quantity array index for tropopause pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02207">mptrac.h:2207</a></div></div>
<div class="ttc" id="astructctl__t_html_a8dfbfb0242aca3ec0fa72564e8ceca6d"><div class="ttname"><a href="structctl__t.html#a8dfbfb0242aca3ec0fa72564e8ceca6d">ctl_t::qnt_cl</a></div><div class="ttdeci">int qnt_cl</div><div class="ttdoc">Quantity array index for total column cloud water.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02267">mptrac.h:2267</a></div></div>
<div class="ttc" id="astructctl__t_html_a8fcaa080d02f579e45b99cd7e6a5a36e"><div class="ttname"><a href="structctl__t.html#a8fcaa080d02f579e45b99cd7e6a5a36e">ctl_t::prof_z1</a></div><div class="ttdeci">double prof_z1</div><div class="ttdoc">Upper altitude of gridded profile data [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03064">mptrac.h:3064</a></div></div>
<div class="ttc" id="astructctl__t_html_a900048dd4610de834a719004818b920a"><div class="ttname"><a href="structctl__t.html#a900048dd4610de834a719004818b920a">ctl_t::met_lev_hyam</a></div><div class="ttdeci">double met_lev_hyam[EP]</div><div class="ttdoc">Meteo data model level a coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02582">mptrac.h:2582</a></div></div>
<div class="ttc" id="astructctl__t_html_a91a6844a93bff2ff957aaf8bf31c1f3b"><div class="ttname"><a href="structctl__t.html#a91a6844a93bff2ff957aaf8bf31c1f3b">ctl_t::qnt_t</a></div><div class="ttdeci">int qnt_t</div><div class="ttdoc">Quantity array index for temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02225">mptrac.h:2225</a></div></div>
<div class="ttc" id="astructctl__t_html_a9279f2a56adc9780721e00e35bed2b3d"><div class="ttname"><a href="structctl__t.html#a9279f2a56adc9780721e00e35bed2b3d">ctl_t::atm_filter</a></div><div class="ttdeci">int atm_filter</div><div class="ttdoc">Time filter for atmospheric data output (0=none, 1=missval, 2=remove).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02920">mptrac.h:2920</a></div></div>
<div class="ttc" id="astructctl__t_html_a92e02214da035478761cdcd7622780b1"><div class="ttname"><a href="structctl__t.html#a92e02214da035478761cdcd7622780b1">ctl_t::kpp_chem</a></div><div class="ttdeci">int kpp_chem</div><div class="ttdoc">Switch for KPP chemistry module (0=off, 1=on).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02856">mptrac.h:2856</a></div></div>
<div class="ttc" id="astructctl__t_html_a94b0a51a5281e718f4fbd38bf5b4d340"><div class="ttname"><a href="structctl__t.html#a94b0a51a5281e718f4fbd38bf5b4d340">ctl_t::ens_basename</a></div><div class="ttdeci">char ens_basename[LEN]</div><div class="ttdoc">Basename of ensemble data file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02992">mptrac.h:2992</a></div></div>
<div class="ttc" id="astructctl__t_html_a97ad8d93c5cc5fd25e9528eb5cc0144a"><div class="ttname"><a href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">ctl_t::met_vert_coord</a></div><div class="ttdeci">int met_vert_coord</div><div class="ttdoc">Vertical coordinate of input meteo data (0=plev, 1=mlev_p_file, 2=mlev_ab_file, 3=mlev_ab_full,...</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02467">mptrac.h:2467</a></div></div>
<div class="ttc" id="astructctl__t_html_a98aa14528bd795eaf31eae63a33c630f"><div class="ttname"><a href="structctl__t.html#a98aa14528bd795eaf31eae63a33c630f">ctl_t::csi_z0</a></div><div class="ttdeci">double csi_z0</div><div class="ttdoc">Lower altitude of gridded CSI data [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02965">mptrac.h:2965</a></div></div>
<div class="ttc" id="astructctl__t_html_a98ccf2cdccb18924d50cdcda383580ba"><div class="ttname"><a href="structctl__t.html#a98ccf2cdccb18924d50cdcda383580ba">ctl_t::qnt_lapse</a></div><div class="ttdeci">int qnt_lapse</div><div class="ttdoc">Quantity array index for lapse rate.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02363">mptrac.h:2363</a></div></div>
<div class="ttc" id="astructctl__t_html_a995505c06bd35ecba593f807c1eda591"><div class="ttname"><a href="structctl__t.html#a995505c06bd35ecba593f807c1eda591">ctl_t::stat_lat</a></div><div class="ttdeci">double stat_lat</div><div class="ttdoc">Latitude of station [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03106">mptrac.h:3106</a></div></div>
<div class="ttc" id="astructctl__t_html_a9a533d295b5533e6a4ca9197694186c5"><div class="ttname"><a href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">ctl_t::grid_ny</a></div><div class="ttdeci">int grid_ny</div><div class="ttdoc">Number of latitudes of gridded data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03040">mptrac.h:3040</a></div></div>
<div class="ttc" id="astructctl__t_html_a9bc04b87ec1a0e2403117d639f6c1416"><div class="ttname"><a href="structctl__t.html#a9bc04b87ec1a0e2403117d639f6c1416">ctl_t::met_detrend</a></div><div class="ttdeci">double met_detrend</div><div class="ttdoc">FWHM of horizontal Gaussian used for detrending [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02567">mptrac.h:2567</a></div></div>
<div class="ttc" id="astructctl__t_html_a9f8db524ed98c32fe612acfc060c1dd4"><div class="ttname"><a href="structctl__t.html#a9f8db524ed98c32fe612acfc060c1dd4">ctl_t::met_cms_eps_t</a></div><div class="ttdeci">double met_cms_eps_t</div><div class="ttdoc">cmultiscale compression epsilon for temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02513">mptrac.h:2513</a></div></div>
<div class="ttc" id="astructctl__t_html_a9fce7d27388ac2b2a5fd8a0702243891"><div class="ttname"><a href="structctl__t.html#a9fce7d27388ac2b2a5fd8a0702243891">ctl_t::qnt_cape</a></div><div class="ttdeci">int qnt_cape</div><div class="ttdoc">Quantity array index for convective available potential energy (CAPE).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02279">mptrac.h:2279</a></div></div>
<div class="ttc" id="astructctl__t_html_a9fff96ce390ca38b2307dc397664f8c3"><div class="ttname"><a href="structctl__t.html#a9fff96ce390ca38b2307dc397664f8c3">ctl_t::met_cms_nd0y</a></div><div class="ttdeci">int met_cms_nd0y</div><div class="ttdoc">cmultiscale number of cells of coarsest grid in y-direction.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02504">mptrac.h:2504</a></div></div>
<div class="ttc" id="astructctl__t_html_aa13722c873f7ec0c828c320546940528"><div class="ttname"><a href="structctl__t.html#aa13722c873f7ec0c828c320546940528">ctl_t::qnt_o3c</a></div><div class="ttdeci">int qnt_o3c</div><div class="ttdoc">Quantity array index for total column ozone.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02285">mptrac.h:2285</a></div></div>
<div class="ttc" id="astructctl__t_html_aa315cd84c43255d483d552a0d2c6d18f"><div class="ttname"><a href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">ctl_t::grid_nz</a></div><div class="ttdeci">int grid_nz</div><div class="ttdoc">Number of altitudes of gridded data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03022">mptrac.h:3022</a></div></div>
<div class="ttc" id="astructctl__t_html_aa8b0200a50b9f5530218ffa034865b74"><div class="ttname"><a href="structctl__t.html#aa8b0200a50b9f5530218ffa034865b74">ctl_t::qnt_nss</a></div><div class="ttdeci">int qnt_nss</div><div class="ttdoc">Quantity array index for northward turbulent surface stress.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02192">mptrac.h:2192</a></div></div>
<div class="ttc" id="astructctl__t_html_aa943823dbd2a4b5fa38e7d0cf8f9ccb0"><div class="ttname"><a href="structctl__t.html#aa943823dbd2a4b5fa38e7d0cf8f9ccb0">ctl_t::ens_dt_out</a></div><div class="ttdeci">double ens_dt_out</div><div class="ttdoc">Time step for ensemble output [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02995">mptrac.h:2995</a></div></div>
<div class="ttc" id="astructctl__t_html_aa974f483b6ccf931730d2d929eee2b51"><div class="ttname"><a href="structctl__t.html#aa974f483b6ccf931730d2d929eee2b51">ctl_t::sample_basename</a></div><div class="ttdeci">char sample_basename[LEN]</div><div class="ttdoc">Basename of sample data file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03085">mptrac.h:3085</a></div></div>
<div class="ttc" id="astructctl__t_html_aa98efec197e5a7bf0abd5f30ba44de72"><div class="ttname"><a href="structctl__t.html#aa98efec197e5a7bf0abd5f30ba44de72">ctl_t::atm_stride</a></div><div class="ttdeci">int atm_stride</div><div class="ttdoc">Particle index stride for atmospheric data files.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02923">mptrac.h:2923</a></div></div>
<div class="ttc" id="astructctl__t_html_aaa5260e73daff92d01c55e87310ab837"><div class="ttname"><a href="structctl__t.html#aaa5260e73daff92d01c55e87310ab837">ctl_t::met_relhum</a></div><div class="ttdeci">int met_relhum</div><div class="ttdoc">Try to read relative humidity (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02594">mptrac.h:2594</a></div></div>
<div class="ttc" id="astructctl__t_html_aad4b256a00136fe4181077c2b02b0f45"><div class="ttname"><a href="structctl__t.html#aad4b256a00136fe4181077c2b02b0f45">ctl_t::atm_dt_out</a></div><div class="ttdeci">double atm_dt_out</div><div class="ttdoc">Time step for atmospheric data output [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02917">mptrac.h:2917</a></div></div>
<div class="ttc" id="astructctl__t_html_ab227d1f7a9235210bd3ba4e159398bfc"><div class="ttname"><a href="structctl__t.html#ab227d1f7a9235210bd3ba4e159398bfc">ctl_t::prof_lat1</a></div><div class="ttdeci">double prof_lat1</div><div class="ttdoc">Upper latitude of gridded profile data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03082">mptrac.h:3082</a></div></div>
<div class="ttc" id="astructctl__t_html_ab340e5d6eb4be0b66bc60b183182b43e"><div class="ttname"><a href="structctl__t.html#ab340e5d6eb4be0b66bc60b183182b43e">ctl_t::met_cms_batch</a></div><div class="ttdeci">int met_cms_batch</div><div class="ttdoc">cmultiscale batch size.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02495">mptrac.h:2495</a></div></div>
<div class="ttc" id="astructctl__t_html_ab4ab5f332a54f86eda5e850ac7380334"><div class="ttname"><a href="structctl__t.html#ab4ab5f332a54f86eda5e850ac7380334">ctl_t::psc_h2o</a></div><div class="ttdeci">double psc_h2o</div><div class="ttdoc">H2O volume mixing ratio for PSC analysis.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02901">mptrac.h:2901</a></div></div>
<div class="ttc" id="astructctl__t_html_ab5296a9ff61f1f50c9733462cd294889"><div class="ttname"><a href="structctl__t.html#ab5296a9ff61f1f50c9733462cd294889">ctl_t::met_sp</a></div><div class="ttdeci">int met_sp</div><div class="ttdoc">Smoothing for pressure levels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02564">mptrac.h:2564</a></div></div>
<div class="ttc" id="astructctl__t_html_ab5c52ba42d486204818e2bade09005c1"><div class="ttname"><a href="structctl__t.html#ab5c52ba42d486204818e2bade09005c1">ctl_t::prof_lon0</a></div><div class="ttdeci">double prof_lon0</div><div class="ttdoc">Lower longitude of gridded profile data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03070">mptrac.h:3070</a></div></div>
<div class="ttc" id="astructctl__t_html_ab7fd7495b74e0656e5a4c0a1e814899c"><div class="ttname"><a href="structctl__t.html#ab7fd7495b74e0656e5a4c0a1e814899c">ctl_t::qnt_pct</a></div><div class="ttdeci">int qnt_pct</div><div class="ttdoc">Quantity array index for cloud top pressure.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02261">mptrac.h:2261</a></div></div>
<div class="ttc" id="astructctl__t_html_ab8311e3b058164056666a4d284722545"><div class="ttname"><a href="structctl__t.html#ab8311e3b058164056666a4d284722545">ctl_t::qnt_mloss_kpp</a></div><div class="ttdeci">int qnt_mloss_kpp</div><div class="ttdoc">Quantity array index for total mass loss due to KPP chemistry.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02309">mptrac.h:2309</a></div></div>
<div class="ttc" id="astructctl__t_html_ab97b0cbae44a95ee03f10236380964ab"><div class="ttname"><a href="structctl__t.html#ab97b0cbae44a95ee03f10236380964ab">ctl_t::qnt_psat</a></div><div class="ttdeci">int qnt_psat</div><div class="ttdoc">Quantity array index for saturation pressure over water.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02324">mptrac.h:2324</a></div></div>
<div class="ttc" id="astructctl__t_html_abb9c4152493385bae3424b8750bfa6c3"><div class="ttname"><a href="structctl__t.html#abb9c4152493385bae3424b8750bfa6c3">ctl_t::met_lev_hybm</a></div><div class="ttdeci">double met_lev_hybm[EP]</div><div class="ttdoc">Meteo data model level b coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02585">mptrac.h:2585</a></div></div>
<div class="ttc" id="astructctl__t_html_abbea8b15d0f5ea43ddd48ebb6a248916"><div class="ttname"><a href="structctl__t.html#abbea8b15d0f5ea43ddd48ebb6a248916">ctl_t::prof_lat0</a></div><div class="ttdeci">double prof_lat0</div><div class="ttdoc">Lower latitude of gridded profile data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03079">mptrac.h:3079</a></div></div>
<div class="ttc" id="astructctl__t_html_abc63595c9161b9fd44ea2420514cb4cd"><div class="ttname"><a href="structctl__t.html#abc63595c9161b9fd44ea2420514cb4cd">ctl_t::qnt_cin</a></div><div class="ttdeci">int qnt_cin</div><div class="ttdoc">Quantity array index for convective inhibition (CIN).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02282">mptrac.h:2282</a></div></div>
<div class="ttc" id="astructctl__t_html_abd6693699cf561e2628e46805ac9591b"><div class="ttname"><a href="structctl__t.html#abd6693699cf561e2628e46805ac9591b">ctl_t::psc_hno3</a></div><div class="ttdeci">double psc_hno3</div><div class="ttdoc">HNO3 volume mixing ratio for PSC analysis.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02904">mptrac.h:2904</a></div></div>
<div class="ttc" id="astructctl__t_html_abdbbc3e42fcbcf71714a8b86dd5b3729"><div class="ttname"><a href="structctl__t.html#abdbbc3e42fcbcf71714a8b86dd5b3729">ctl_t::prof_lon1</a></div><div class="ttdeci">double prof_lon1</div><div class="ttdoc">Upper longitude of gridded profile data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03073">mptrac.h:3073</a></div></div>
<div class="ttc" id="astructctl__t_html_abe3f471333cabadb674f7f0eed43d21b"><div class="ttname"><a href="structctl__t.html#abe3f471333cabadb674f7f0eed43d21b">ctl_t::met_cms_eps_rwc</a></div><div class="ttdeci">double met_cms_eps_rwc</div><div class="ttdoc">cmultiscale compression epsilon for cloud rain water content.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02537">mptrac.h:2537</a></div></div>
<div class="ttc" id="astructctl__t_html_abe51e81e7cc30fa279a6d87e2e405bec"><div class="ttname"><a href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">ctl_t::met_nc_quant</a></div><div class="ttdeci">int met_nc_quant</div><div class="ttdoc">Number of digits for quantization of netCDF meteo files (0=off).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02483">mptrac.h:2483</a></div></div>
<div class="ttc" id="astructctl__t_html_abfeedfc5c515f8d03de56c2cd06aa633"><div class="ttname"><a href="structctl__t.html#abfeedfc5c515f8d03de56c2cd06aa633">ctl_t::h2o2_chem_reaction</a></div><div class="ttdeci">int h2o2_chem_reaction</div><div class="ttdoc">Reaction type for H2O2 chemistry (0=none, 1=SO2).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02853">mptrac.h:2853</a></div></div>
<div class="ttc" id="astructctl__t_html_ac13bb67666a0310b0f8b591e1d2a29bb"><div class="ttname"><a href="structctl__t.html#ac13bb67666a0310b0f8b591e1d2a29bb">ctl_t::atm_nc_quant</a></div><div class="ttdeci">int atm_nc_quant[NQ]</div><div class="ttdoc">Number of digits for quantization of netCDF atmospheric data files (0=off).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02938">mptrac.h:2938</a></div></div>
<div class="ttc" id="astructctl__t_html_ac782f7d68928f956202175bd44926644"><div class="ttname"><a href="structctl__t.html#ac782f7d68928f956202175bd44926644">ctl_t::met_cms_eps_o3</a></div><div class="ttdeci">double met_cms_eps_o3</div><div class="ttdoc">cmultiscale compression epsilon for ozone.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02531">mptrac.h:2531</a></div></div>
<div class="ttc" id="astructctl__t_html_ac789d48daaf3f1df6364fcebfee4d315"><div class="ttname"><a href="structctl__t.html#ac789d48daaf3f1df6364fcebfee4d315">ctl_t::met_cms_zstd</a></div><div class="ttdeci">int met_cms_zstd</div><div class="ttdoc">cmultiscale ZSTD compression (0=off, 1=on).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02498">mptrac.h:2498</a></div></div>
<div class="ttc" id="astructctl__t_html_ac7986250a4ebebaf96197571908d6343"><div class="ttname"><a href="structctl__t.html#ac7986250a4ebebaf96197571908d6343">ctl_t::met_cms_maxlev</a></div><div class="ttdeci">int met_cms_maxlev</div><div class="ttdoc">cmultiscale maximum refinement level.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02507">mptrac.h:2507</a></div></div>
<div class="ttc" id="astructctl__t_html_ac7a96c566e02c9e88a73e53248a89cb5"><div class="ttname"><a href="structctl__t.html#ac7a96c566e02c9e88a73e53248a89cb5">ctl_t::grid_sparse</a></div><div class="ttdeci">int grid_sparse</div><div class="ttdoc">Sparse output in grid data files (0=no, 1=yes).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03010">mptrac.h:3010</a></div></div>
<div class="ttc" id="astructctl__t_html_ac98ba3f8bc8b26ca6499ac79603de8db"><div class="ttname"><a href="structctl__t.html#ac98ba3f8bc8b26ca6499ac79603de8db">ctl_t::vtk_basename</a></div><div class="ttdeci">char vtk_basename[LEN]</div><div class="ttdoc">Basename of VTK data files.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03118">mptrac.h:3118</a></div></div>
<div class="ttc" id="astructctl__t_html_acc25e4fc819f75115dc6ae202437022d"><div class="ttname"><a href="structctl__t.html#acc25e4fc819f75115dc6ae202437022d">ctl_t::qnt_tt</a></div><div class="ttdeci">int qnt_tt</div><div class="ttdoc">Quantity array index for tropopause temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02210">mptrac.h:2210</a></div></div>
<div class="ttc" id="astructctl__t_html_ace79737fafa3d437976cddc48dc6f1d3"><div class="ttname"><a href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">ctl_t::met_nc_level</a></div><div class="ttdeci">int met_nc_level</div><div class="ttdoc">zlib compression level of netCDF meteo files (0=off).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02480">mptrac.h:2480</a></div></div>
<div class="ttc" id="astructctl__t_html_acf37a9e8e3b1a013d6106f83e14aedb3"><div class="ttname"><a href="structctl__t.html#acf37a9e8e3b1a013d6106f83e14aedb3">ctl_t::mixing_dt</a></div><div class="ttdeci">double mixing_dt</div><div class="ttdoc">Time interval for mixing [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02781">mptrac.h:2781</a></div></div>
<div class="ttc" id="astructctl__t_html_ad1c66733dc34e0eb4bff6dea1ad9aefe"><div class="ttname"><a href="structctl__t.html#ad1c66733dc34e0eb4bff6dea1ad9aefe">ctl_t::vtk_scale</a></div><div class="ttdeci">double vtk_scale</div><div class="ttdoc">Vertical scaling factor for VTK data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03127">mptrac.h:3127</a></div></div>
<div class="ttc" id="astructctl__t_html_ad32a8979c9af7651a932d8e4a38a36ef"><div class="ttname"><a href="structctl__t.html#ad32a8979c9af7651a932d8e4a38a36ef">ctl_t::met_cms_eps_w</a></div><div class="ttdeci">double met_cms_eps_w</div><div class="ttdoc">cmultiscale compression epsilon for vertical velocity.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02522">mptrac.h:2522</a></div></div>
<div class="ttc" id="astructctl__t_html_ad7e229a971d4aafe08bb607b7189b09f"><div class="ttname"><a href="structctl__t.html#ad7e229a971d4aafe08bb607b7189b09f">ctl_t::qnt_pv</a></div><div class="ttdeci">int qnt_pv</div><div class="ttdoc">Quantity array index for potential vorticity.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02372">mptrac.h:2372</a></div></div>
<div class="ttc" id="astructctl__t_html_adb52d9a2f17944de5ed1b245ae0eb6b6"><div class="ttname"><a href="structctl__t.html#adb52d9a2f17944de5ed1b245ae0eb6b6">ctl_t::qnt_sst</a></div><div class="ttdeci">int qnt_sst</div><div class="ttdoc">Quantity array index for sea surface temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02201">mptrac.h:2201</a></div></div>
<div class="ttc" id="astructctl__t_html_adbebe57221067b42b5f3186a40d06128"><div class="ttname"><a href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">ctl_t::atm_nc_level</a></div><div class="ttdeci">int atm_nc_level</div><div class="ttdoc">zlib compression level of netCDF atmospheric data files (0=off).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02935">mptrac.h:2935</a></div></div>
<div class="ttc" id="astructctl__t_html_ae251e537db20eb4e1696488c89245d1b"><div class="ttname"><a href="structctl__t.html#ae251e537db20eb4e1696488c89245d1b">ctl_t::qnt_sh</a></div><div class="ttdeci">int qnt_sh</div><div class="ttdoc">Quantity array index for specific humidity.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02333">mptrac.h:2333</a></div></div>
<div class="ttc" id="astructctl__t_html_ae35e7cd824ea4b89ad435c45103f2758"><div class="ttname"><a href="structctl__t.html#ae35e7cd824ea4b89ad435c45103f2758">ctl_t::qnt_ess</a></div><div class="ttdeci">int qnt_ess</div><div class="ttdoc">Quantity array index for eastward turbulent surface stress.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02189">mptrac.h:2189</a></div></div>
<div class="ttc" id="astructctl__t_html_ae4da60e71dcd75d1b55f66036867f225"><div class="ttname"><a href="structctl__t.html#ae4da60e71dcd75d1b55f66036867f225">ctl_t::met_dy</a></div><div class="ttdeci">int met_dy</div><div class="ttdoc">Stride for latitudes.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02552">mptrac.h:2552</a></div></div>
<div class="ttc" id="astructctl__t_html_aea21f5b459b5068ca0ec982074cb4dc2"><div class="ttname"><a href="structctl__t.html#aea21f5b459b5068ca0ec982074cb4dc2">ctl_t::dd_subdomains_zonal</a></div><div class="ttdeci">int dd_subdomains_zonal</div><div class="ttdoc">Domain decomposition zonal subdomain number.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03143">mptrac.h:3143</a></div></div>
<div class="ttc" id="astructctl__t_html_aeac7515d696805592f6ae25bf38b7ada"><div class="ttname"><a href="structctl__t.html#aeac7515d696805592f6ae25bf38b7ada">ctl_t::qnt_idx</a></div><div class="ttdeci">int qnt_idx</div><div class="ttdoc">Quantity array index for air parcel IDs.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02153">mptrac.h:2153</a></div></div>
<div class="ttc" id="astructctl__t_html_aec254fc45d24615056f6b07643176171"><div class="ttname"><a href="structctl__t.html#aec254fc45d24615056f6b07643176171">ctl_t::met_tropo_theta</a></div><div class="ttdeci">double met_tropo_theta</div><div class="ttdoc">Dynamical tropopause potential temperature threshold [K].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02616">mptrac.h:2616</a></div></div>
<div class="ttc" id="astructctl__t_html_aedc44f2c1176820bd510219a03d3db53"><div class="ttname"><a href="structctl__t.html#aedc44f2c1176820bd510219a03d3db53">ctl_t::qnt_rwc</a></div><div class="ttdeci">int qnt_rwc</div><div class="ttdoc">Quantity array index for cloud rain water content.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02249">mptrac.h:2249</a></div></div>
<div class="ttc" id="astructctl__t_html_aef44654a72cbb96ba47c6284bd5f2316"><div class="ttname"><a href="structctl__t.html#aef44654a72cbb96ba47c6284bd5f2316">ctl_t::qnt_longname</a></div><div class="ttdeci">char qnt_longname[NQ][LEN]</div><div class="ttdoc">Quantity long names.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02144">mptrac.h:2144</a></div></div>
<div class="ttc" id="astructctl__t_html_af5696aca68db24fedc7bd265d4eb6d52"><div class="ttname"><a href="structctl__t.html#af5696aca68db24fedc7bd265d4eb6d52">ctl_t::sample_dx</a></div><div class="ttdeci">double sample_dx</div><div class="ttdoc">Horizontal radius for sample output [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03094">mptrac.h:3094</a></div></div>
<div class="ttc" id="astructctl__t_html_af662f58ab4cdf46b8e28945ca541a9c1"><div class="ttname"><a href="structctl__t.html#af662f58ab4cdf46b8e28945ca541a9c1">ctl_t::vtk_stride</a></div><div class="ttdeci">int vtk_stride</div><div class="ttdoc">Particle index stride for VTK data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03124">mptrac.h:3124</a></div></div>
<div class="ttc" id="astructctl__t_html_af784e18ace4cd191ae100a7df4955b6b"><div class="ttname"><a href="structctl__t.html#af784e18ace4cd191ae100a7df4955b6b">ctl_t::stat_basename</a></div><div class="ttdeci">char stat_basename[LEN]</div><div class="ttdoc">Basename of station data file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03100">mptrac.h:3100</a></div></div>
<div class="ttc" id="astructctl__t_html_af89d6bfcdbc4250e2d30dd7e453b3048"><div class="ttname"><a href="structctl__t.html#af89d6bfcdbc4250e2d30dd7e453b3048">ctl_t::grid_lat1</a></div><div class="ttdeci">double grid_lat1</div><div class="ttdoc">Upper latitude of gridded data [deg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03046">mptrac.h:3046</a></div></div>
<div class="ttc" id="astructctl__t_html_afb2ac81596bfa49f6f53da327bdac0bd"><div class="ttname"><a href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">ctl_t::dd_subdomains_meridional</a></div><div class="ttdeci">int dd_subdomains_meridional</div><div class="ttdoc">Domain decomposition meridional subdomain number.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03146">mptrac.h:3146</a></div></div>
<div class="ttc" id="astructctl__t_html_afb9a716d40713cd9550a4a2d38389da0"><div class="ttname"><a href="structctl__t.html#afb9a716d40713cd9550a4a2d38389da0">ctl_t::qnt_zt</a></div><div class="ttdeci">int qnt_zt</div><div class="ttdoc">Quantity array index for tropopause geopotential height.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02213">mptrac.h:2213</a></div></div>
<div class="ttc" id="astructctl__t_html_afc9fd7f2b1a29910d6c37c9cb3bcee0d"><div class="ttname"><a href="structctl__t.html#afc9fd7f2b1a29910d6c37c9cb3bcee0d">ctl_t::qnt_cc</a></div><div class="ttdeci">int qnt_cc</div><div class="ttdoc">Quantity array index for cloud cover.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02258">mptrac.h:2258</a></div></div>
<div class="ttc" id="astructctl__t_html_afcd6307f3bcbd275ba14b572c6337dfa"><div class="ttname"><a href="structctl__t.html#afcd6307f3bcbd275ba14b572c6337dfa">ctl_t::qnt_plcl</a></div><div class="ttdeci">int qnt_plcl</div><div class="ttdoc">Quantity array index for pressure at lifted condensation level (LCL).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02270">mptrac.h:2270</a></div></div>
<div class="ttc" id="astructctl__t_html_afe05b16d3cfa511feb4673706f6606ff"><div class="ttname"><a href="structctl__t.html#afe05b16d3cfa511feb4673706f6606ff">ctl_t::grid_dt_out</a></div><div class="ttdeci">double grid_dt_out</div><div class="ttdoc">Time step for gridded data output [s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03007">mptrac.h:3007</a></div></div>
<div class="ttc" id="astructctl__t_html_affb8cb3c42f1f312990d97d7d49617e5"><div class="ttname"><a href="structctl__t.html#affb8cb3c42f1f312990d97d7d49617e5">ctl_t::qnt_tdew</a></div><div class="ttdeci">int qnt_tdew</div><div class="ttdoc">Quantity array index for dew point temperature.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02375">mptrac.h:2375</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_adb6e87e9f904fe4ad238e5a99ec9fbc6_cgraph.png" border="0" usemap="#amptrac_8h_adb6e87e9f904fe4ad238e5a99ec9fbc6_cgraph" alt=""/></div>
<map name="amptrac_8h_adb6e87e9f904fe4ad238e5a99ec9fbc6_cgraph" id="amptrac_8h_adb6e87e9f904fe4ad238e5a99ec9fbc6_cgraph">
<area shape="rect" title="Reads control parameters from a configuration file and populates the given structure." alt="" coords="5,31,120,57"/>
<area shape="rect" href="mptrac_8c.html#a51f61e053cfec3bdd62fa3a8110e046e" title="Defines pressure levels for meteorological data." alt="" coords="168,5,283,32"/>
<area shape="rect" href="mptrac_8c.html#a7d07c7baed461e240ff50585ddeed80a" title="Scans a control file or command&#45;line arguments for a specified variable." alt="" coords="190,56,261,83"/>
</map>
</div>

</div>
</div>
<a id="ad761ca965e59ad9246ab5825a3730058" name="ad761ca965e59ad9246ab5825a3730058"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad761ca965e59ad9246ab5825a3730058">&#9670;&nbsp;</a></span>mptrac_read_met()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mptrac_read_met </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads meteorological data from a file, supporting multiple formats and MPI broadcasting. </p>
<p >This function reads meteorological data from a file specified by the <code>filename</code> parameter. It supports both NetCDF and binary formats based on the <code>met_type</code> field in the <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure. The function can also handle parallel processing with MPI, broadcasting the data across ranks if required by the configuration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A constant character pointer representing the name of the file to read the meteorological data from. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure, which holds control parameters including the type of meteorological data, MPI sharing flags, and configuration details. </td></tr>
    <tr><td class="paramname">clim</td><td>A pointer to a <code><a class="el" href="structclim__t.html" title="Climatological data.">clim_t</a></code> structure, which contains climatological data to be used in the process, if applicable. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure that will store the meteorological data read from the file. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information, including rank and neighbours.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns an integer, where 1 indicates success.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function logs the action of reading meteorological data, including the file name.</li>
<li>It supports MPI parallelization and will share the data across multiple processes if the <code>met_mpi_share</code> flag is set in the control structure.</li>
<li>If <code>ctl-&gt;met_type</code> is 0, the data is read from a NetCDF file using the <code>read_met_nc</code> function.</li>
<li>If <code>ctl-&gt;met_type</code> is between 1 and 5 or 7, the data is read from a binary file using the <code>read_met_bin</code> function.</li>
<li>If <code>ctl-&gt;met_type</code> is 6, the data is read from grib files using the <code>read_met_grib</code> function.</li>
<li>If the <code>met_type</code> is not recognized, an error message is generated.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l06409">6409</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6414</span>            {</div>
<div class="line"><span class="lineno"> 6415</span> </div>
<div class="line"><span class="lineno"> 6416</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 6417</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read meteo data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 6418</span> </div>
<div class="line"><span class="lineno"> 6419</span>  <span class="comment">/* Set rank... */</span></div>
<div class="line"><span class="lineno"> 6420</span>  <span class="keywordtype">int</span> rank = 0;</div>
<div class="line"><span class="lineno"> 6421</span><span class="preprocessor">#ifdef MPI</span></div>
<div class="line"><span class="lineno"> 6422</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54d668c2751138dd5e6b77876e469206">met_mpi_share</a>)</div>
<div class="line"><span class="lineno"> 6423</span>    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);</div>
<div class="line"><span class="lineno"> 6424</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6425</span> </div>
<div class="line"><span class="lineno"> 6426</span>  <span class="comment">/* Check rank... */</span></div>
<div class="line"><span class="lineno"> 6427</span>  <span class="keywordflow">if</span> (!ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54d668c2751138dd5e6b77876e469206">met_mpi_share</a> || rank == 0) {</div>
<div class="line"><span class="lineno"> 6428</span> </div>
<div class="line"><span class="lineno"> 6429</span>    <span class="comment">/* Read netCDF data... */</span></div>
<div class="line"><span class="lineno"> 6430</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 0) {</div>
<div class="line"><span class="lineno"> 6431</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mptrac_8c.html#a6d5d9f14125739740b23f1ff88baf835">read_met_nc</a>(filename, ctl, met, dd) != 1)</div>
<div class="line"><span class="lineno"> 6432</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 6433</span>    }</div>
<div class="line"><span class="lineno"> 6434</span> </div>
<div class="line"><span class="lineno"> 6435</span>    <span class="comment">/* Read binary data... */</span></div>
<div class="line"><span class="lineno"> 6436</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> &gt;= 1 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> &lt;= 5) || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 7) {</div>
<div class="line"><span class="lineno"> 6437</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mptrac_8c.html#acc520c5d948ea75f0acb9b351a6b8b75">read_met_bin</a>(filename, ctl, met) != 1)</div>
<div class="line"><span class="lineno"> 6438</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 6439</span>    }</div>
<div class="line"><span class="lineno"> 6440</span> </div>
<div class="line"><span class="lineno"> 6441</span><span class="preprocessor">#ifdef ECCODES</span></div>
<div class="line"><span class="lineno"> 6442</span>    <span class="comment">/* Read grib data... */</span></div>
<div class="line"><span class="lineno"> 6443</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 6) {</div>
<div class="line"><span class="lineno"> 6444</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mptrac_8h.html#a82c358b6cc1f736e2f186c8aef4d6a79">read_met_grib</a>(filename, ctl, met) != 1)</div>
<div class="line"><span class="lineno"> 6445</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 6446</span>    }</div>
<div class="line"><span class="lineno"> 6447</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6448</span> </div>
<div class="line"><span class="lineno"> 6449</span>    <span class="comment">/* Not implemented... */</span></div>
<div class="line"><span class="lineno"> 6450</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6451</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MET_TYPE not implemented!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6452</span> </div>
<div class="line"><span class="lineno"> 6453</span>    <span class="comment">/* Preprocessing for netCDF and grib files... */</span></div>
<div class="line"><span class="lineno"> 6454</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 6) {</div>
<div class="line"><span class="lineno"> 6455</span> </div>
<div class="line"><span class="lineno"> 6456</span>      <span class="comment">/* Extrapolate data for lower boundary... */</span></div>
<div class="line"><span class="lineno"> 6457</span>      <a class="code hl_function" href="mptrac_8c.html#a089d9c0099e3fc6944c2a48667362ca0">read_met_extrapolate</a>(met);</div>
<div class="line"><span class="lineno"> 6458</span> </div>
<div class="line"><span class="lineno"> 6459</span>      <span class="comment">/* Fix polar winds... */</span></div>
<div class="line"><span class="lineno"> 6460</span>      <a class="code hl_function" href="mptrac_8c.html#adea1a286e6ec2a763b560997203fd5b7">read_met_polar_winds</a>(met);</div>
<div class="line"><span class="lineno"> 6461</span> </div>
<div class="line"><span class="lineno"> 6462</span>      <span class="comment">/* Create periodic boundary conditions... */</span></div>
<div class="line"><span class="lineno"> 6463</span><span class="preprocessor">#ifndef DD</span></div>
<div class="line"><span class="lineno"> 6464</span>      <a class="code hl_function" href="mptrac_8c.html#a38f91765df8eb0a66fb3a6408dca0600">read_met_periodic</a>(met);</div>
<div class="line"><span class="lineno"> 6465</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6466</span> </div>
<div class="line"><span class="lineno"> 6467</span>      <span class="comment">/* Downsampling... */</span></div>
<div class="line"><span class="lineno"> 6468</span>      <a class="code hl_function" href="mptrac_8c.html#a0e6ef467d264f7b13436a460c753ed8a">read_met_sample</a>(ctl, met);</div>
<div class="line"><span class="lineno"> 6469</span> </div>
<div class="line"><span class="lineno"> 6470</span>      <span class="comment">/* Calculate geopotential heights... */</span></div>
<div class="line"><span class="lineno"> 6471</span>      <a class="code hl_function" href="mptrac_8c.html#a01594c9f21549808fcf2f2f8be781e79">read_met_geopot</a>(ctl, met);</div>
<div class="line"><span class="lineno"> 6472</span> </div>
<div class="line"><span class="lineno"> 6473</span>      <span class="comment">/* Calculate potential vorticity... */</span></div>
<div class="line"><span class="lineno"> 6474</span>      <a class="code hl_function" href="mptrac_8c.html#ac2c90884cb02bf90f095ff36f41e020a">read_met_pv</a>(met);</div>
<div class="line"><span class="lineno"> 6475</span> </div>
<div class="line"><span class="lineno"> 6476</span>      <span class="comment">/* Calculate boundary layer data... */</span></div>
<div class="line"><span class="lineno"> 6477</span>      <a class="code hl_function" href="mptrac_8c.html#a2723705c94110a3ddfc84f2f0c8ddc71">read_met_pbl</a>(ctl, met);</div>
<div class="line"><span class="lineno"> 6478</span> </div>
<div class="line"><span class="lineno"> 6479</span>      <span class="comment">/* Calculate tropopause data... */</span></div>
<div class="line"><span class="lineno"> 6480</span>      <a class="code hl_function" href="mptrac_8c.html#a29701c07d5dded042b2031e09e11d679">read_met_tropo</a>(ctl, clim, met);</div>
<div class="line"><span class="lineno"> 6481</span> </div>
<div class="line"><span class="lineno"> 6482</span>      <span class="comment">/* Calculate cloud properties... */</span></div>
<div class="line"><span class="lineno"> 6483</span>      <a class="code hl_function" href="mptrac_8c.html#a1b20694a5f995be231b64a5121eab7a9">read_met_cloud</a>(met);</div>
<div class="line"><span class="lineno"> 6484</span> </div>
<div class="line"><span class="lineno"> 6485</span>      <span class="comment">/* Calculate convective available potential energy... */</span></div>
<div class="line"><span class="lineno"> 6486</span>      <a class="code hl_function" href="mptrac_8c.html#af61accbe7a6587652bb15ea68d6aee03">read_met_cape</a>(ctl, clim, met);</div>
<div class="line"><span class="lineno"> 6487</span> </div>
<div class="line"><span class="lineno"> 6488</span>      <span class="comment">/* Calculate total column ozone... */</span></div>
<div class="line"><span class="lineno"> 6489</span>      <a class="code hl_function" href="mptrac_8c.html#a9ee63e8a6c82ac0dc569255455a50da2">read_met_ozone</a>(met);</div>
<div class="line"><span class="lineno"> 6490</span> </div>
<div class="line"><span class="lineno"> 6491</span>      <span class="comment">/* Detrending... */</span></div>
<div class="line"><span class="lineno"> 6492</span>      <a class="code hl_function" href="mptrac_8c.html#a2776502fa762ba5034c0759d7645d1e1">read_met_detrend</a>(ctl, met);</div>
<div class="line"><span class="lineno"> 6493</span> </div>
<div class="line"><span class="lineno"> 6494</span>      <span class="comment">/* Check meteo data and smooth zeta profiles ... */</span></div>
<div class="line"><span class="lineno"> 6495</span>      <a class="code hl_function" href="mptrac_8c.html#a305d8ee431236c52e0fd21d26f23a695">read_met_monotonize</a>(ctl, met);</div>
<div class="line"><span class="lineno"> 6496</span>    }</div>
<div class="line"><span class="lineno"> 6497</span>  }</div>
<div class="line"><span class="lineno"> 6498</span> </div>
<div class="line"><span class="lineno"> 6499</span>  <span class="comment">/* Broadcast data via MPI... */</span></div>
<div class="line"><span class="lineno"> 6500</span><span class="preprocessor">#ifdef MPI</span></div>
<div class="line"><span class="lineno"> 6501</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54d668c2751138dd5e6b77876e469206">met_mpi_share</a>) {</div>
<div class="line"><span class="lineno"> 6502</span> </div>
<div class="line"><span class="lineno"> 6503</span>    <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 6504</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_MPI_BCAST&quot;</span>, <span class="stringliteral">&quot;COMM&quot;</span>);</div>
<div class="line"><span class="lineno"> 6505</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Broadcast data on rank %d...&quot;</span>, rank);</div>
<div class="line"><span class="lineno"> 6506</span> </div>
<div class="line"><span class="lineno"> 6507</span>    <span class="comment">/* Broadcast... */</span></div>
<div class="line"><span class="lineno"> 6508</span>    <a class="code hl_function" href="mptrac_8h.html#aa4b5f89a098befae2a864decab80f133">broadcast_large_data</a>(met, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structmet__t.html">met_t</a>));</div>
<div class="line"><span class="lineno"> 6509</span>  }</div>
<div class="line"><span class="lineno"> 6510</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6511</span> </div>
<div class="line"><span class="lineno"> 6512</span>  <span class="comment">/* Return success... */</span></div>
<div class="line"><span class="lineno"> 6513</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 6514</span>}</div>
<div class="ttc" id="amptrac_8c_html_a01594c9f21549808fcf2f2f8be781e79"><div class="ttname"><a href="mptrac_8c.html#a01594c9f21549808fcf2f2f8be781e79">read_met_geopot</a></div><div class="ttdeci">void read_met_geopot(const ctl_t *ctl, met_t *met)</div><div class="ttdoc">Calculates geopotential heights from meteorological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l08122">mptrac.c:8122</a></div></div>
<div class="ttc" id="amptrac_8c_html_a089d9c0099e3fc6944c2a48667362ca0"><div class="ttname"><a href="mptrac_8c.html#a089d9c0099e3fc6944c2a48667362ca0">read_met_extrapolate</a></div><div class="ttdeci">void read_met_extrapolate(met_t *met)</div><div class="ttdoc">Extrapolates meteorological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l08082">mptrac.c:8082</a></div></div>
<div class="ttc" id="amptrac_8c_html_a0e6ef467d264f7b13436a460c753ed8a"><div class="ttname"><a href="mptrac_8c.html#a0e6ef467d264f7b13436a460c753ed8a">read_met_sample</a></div><div class="ttdeci">void read_met_sample(const ctl_t *ctl, met_t *met)</div><div class="ttdoc">Downsamples meteorological data based on specified parameters.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l10505">mptrac.c:10505</a></div></div>
<div class="ttc" id="amptrac_8c_html_a1b20694a5f995be231b64a5121eab7a9"><div class="ttname"><a href="mptrac_8c.html#a1b20694a5f995be231b64a5121eab7a9">read_met_cloud</a></div><div class="ttdeci">void read_met_cloud(met_t *met)</div><div class="ttdoc">Calculates cloud-related variables for each grid point.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07921">mptrac.c:7921</a></div></div>
<div class="ttc" id="amptrac_8c_html_a2723705c94110a3ddfc84f2f0c8ddc71"><div class="ttname"><a href="mptrac_8c.html#a2723705c94110a3ddfc84f2f0c8ddc71">read_met_pbl</a></div><div class="ttdeci">void read_met_pbl(const ctl_t *ctl, met_t *met)</div><div class="ttdoc">Computes the planetary boundary layer (PBL) pressure based on meteorological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l10113">mptrac.c:10113</a></div></div>
<div class="ttc" id="amptrac_8c_html_a2776502fa762ba5034c0759d7645d1e1"><div class="ttname"><a href="mptrac_8c.html#a2776502fa762ba5034c0759d7645d1e1">read_met_detrend</a></div><div class="ttdeci">void read_met_detrend(const ctl_t *ctl, met_t *met)</div><div class="ttdoc">Detrends meteorological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07978">mptrac.c:7978</a></div></div>
<div class="ttc" id="amptrac_8c_html_a305d8ee431236c52e0fd21d26f23a695"><div class="ttname"><a href="mptrac_8c.html#a305d8ee431236c52e0fd21d26f23a695">read_met_monotonize</a></div><div class="ttdeci">void read_met_monotonize(const ctl_t *ctl, met_t *met)</div><div class="ttdoc">Makes zeta and pressure profiles monotone.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l09748">mptrac.c:9748</a></div></div>
<div class="ttc" id="amptrac_8c_html_a38f91765df8eb0a66fb3a6408dca0600"><div class="ttname"><a href="mptrac_8c.html#a38f91765df8eb0a66fb3a6408dca0600">read_met_periodic</a></div><div class="ttdeci">void read_met_periodic(met_t *met)</div><div class="ttdoc">Applies periodic boundary conditions to meteorological data along longitudinal axis.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l10250">mptrac.c:10250</a></div></div>
<div class="ttc" id="amptrac_8c_html_a6d5d9f14125739740b23f1ff88baf835"><div class="ttname"><a href="mptrac_8c.html#a6d5d9f14125739740b23f1ff88baf835">read_met_nc</a></div><div class="ttdeci">int read_met_nc(const char *filename, const ctl_t *ctl, met_t *met, dd_t *dd)</div><div class="ttdoc">Reads meteorological data from a NetCDF file and processes it.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l09833">mptrac.c:9833</a></div></div>
<div class="ttc" id="amptrac_8c_html_a9ee63e8a6c82ac0dc569255455a50da2"><div class="ttname"><a href="mptrac_8c.html#a9ee63e8a6c82ac0dc569255455a50da2">read_met_ozone</a></div><div class="ttdeci">void read_met_ozone(met_t *met)</div><div class="ttdoc">Calculates the total column ozone from meteorological ozone data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l10476">mptrac.c:10476</a></div></div>
<div class="ttc" id="amptrac_8c_html_ac2c90884cb02bf90f095ff36f41e020a"><div class="ttname"><a href="mptrac_8c.html#ac2c90884cb02bf90f095ff36f41e020a">read_met_pv</a></div><div class="ttdeci">void read_met_pv(met_t *met)</div><div class="ttdoc">Calculates potential vorticity (PV) from meteorological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l10370">mptrac.c:10370</a></div></div>
<div class="ttc" id="amptrac_8c_html_acc520c5d948ea75f0acb9b351a6b8b75"><div class="ttname"><a href="mptrac_8c.html#acc520c5d948ea75f0acb9b351a6b8b75">read_met_bin</a></div><div class="ttdeci">int read_met_bin(const char *filename, const ctl_t *ctl, met_t *met)</div><div class="ttdoc">Reads meteorological data from a binary file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07523">mptrac.c:7523</a></div></div>
<div class="ttc" id="amptrac_8c_html_adea1a286e6ec2a763b560997203fd5b7"><div class="ttname"><a href="mptrac_8c.html#adea1a286e6ec2a763b560997203fd5b7">read_met_polar_winds</a></div><div class="ttdeci">void read_met_polar_winds(met_t *met)</div><div class="ttdoc">Applies a fix for polar winds in meteorological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l10311">mptrac.c:10311</a></div></div>
<div class="ttc" id="amptrac_8c_html_af61accbe7a6587652bb15ea68d6aee03"><div class="ttname"><a href="mptrac_8c.html#af61accbe7a6587652bb15ea68d6aee03">read_met_cape</a></div><div class="ttdeci">void read_met_cape(const ctl_t *ctl, const clim_t *clim, met_t *met)</div><div class="ttdoc">Calculates Convective Available Potential Energy (CAPE) for each grid point.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07806">mptrac.c:7806</a></div></div>
<div class="ttc" id="amptrac_8h_html_a82c358b6cc1f736e2f186c8aef4d6a79"><div class="ttname"><a href="mptrac_8h.html#a82c358b6cc1f736e2f186c8aef4d6a79">read_met_grib</a></div><div class="ttdeci">int read_met_grib(const char *filename, const ctl_t *ctl, met_t *met)</div><div class="ttdoc">Reads meteorological data from a grib file and processes it.</div></div>
<div class="ttc" id="amptrac_8h_html_aa4b5f89a098befae2a864decab80f133"><div class="ttname"><a href="mptrac_8h.html#aa4b5f89a098befae2a864decab80f133">broadcast_large_data</a></div><div class="ttdeci">void broadcast_large_data(void *data, size_t N)</div><div class="ttdoc">Broadcasts large data across all processes in an MPI communicator.</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_ad761ca965e59ad9246ab5825a3730058_cgraph.png" border="0" usemap="#amptrac_8h_ad761ca965e59ad9246ab5825a3730058_cgraph" alt=""/></div>
<map name="amptrac_8h_ad761ca965e59ad9246ab5825a3730058_cgraph" id="amptrac_8h_ad761ca965e59ad9246ab5825a3730058_cgraph">
<area shape="rect" title="Reads meteorological data from a file, supporting multiple formats and MPI broadcasting." alt="" coords="5,672,128,699"/>
<area shape="rect" href="mptrac_8h.html#aa4b5f89a098befae2a864decab80f133" title="Broadcasts large data across all processes in an MPI communicator." alt="" coords="179,267,325,293"/>
<area shape="rect" href="mptrac_8c.html#acc520c5d948ea75f0acb9b351a6b8b75" title="Reads meteorological data from a binary file." alt="" coords="202,469,302,496"/>
<area shape="rect" href="mptrac_8c.html#af61accbe7a6587652bb15ea68d6aee03" title="Calculates Convective Available Potential Energy (CAPE) for each grid point." alt="" coords="394,69,505,96"/>
<area shape="rect" href="mptrac_8c.html#a1b20694a5f995be231b64a5121eab7a9" title="Calculates cloud&#45;related variables for each grid point." alt="" coords="195,571,309,597"/>
<area shape="rect" href="mptrac_8c.html#a2776502fa762ba5034c0759d7645d1e1" title="Detrends meteorological data." alt="" coords="189,621,315,648"/>
<area shape="rect" href="mptrac_8c.html#a089d9c0099e3fc6944c2a48667362ca0" title="Extrapolates meteorological data." alt="" coords="179,672,325,699"/>
<area shape="rect" href="mptrac_8c.html#a01594c9f21549808fcf2f2f8be781e79" title="Calculates geopotential heights from meteorological data." alt="" coords="388,259,511,285"/>
<area shape="rect" href="mptrac_8h.html#a82c358b6cc1f736e2f186c8aef4d6a79" title="Reads meteorological data from a grib file and processes it." alt="" coords="200,723,304,749"/>
<area shape="rect" href="mptrac_8c.html#a305d8ee431236c52e0fd21d26f23a695" title="Makes zeta and pressure profiles monotone." alt="" coords="177,773,327,800"/>
<area shape="rect" href="mptrac_8c.html#a6d5d9f14125739740b23f1ff88baf835" title="Reads meteorological data from a NetCDF file and processes it." alt="" coords="203,520,301,547"/>
<area shape="rect" href="mptrac_8c.html#a9ee63e8a6c82ac0dc569255455a50da2" title="Calculates the total column ozone from meteorological ozone data." alt="" coords="193,824,311,851"/>
<area shape="rect" href="mptrac_8c.html#a2723705c94110a3ddfc84f2f0c8ddc71" title="Computes the planetary boundary layer (PBL) pressure based on meteorological data." alt="" coords="202,875,302,901"/>
<area shape="rect" href="mptrac_8c.html#a38f91765df8eb0a66fb3a6408dca0600" title="Applies periodic boundary conditions to meteorological data along longitudinal axis." alt="" coords="188,925,316,952"/>
<area shape="rect" href="mptrac_8c.html#adea1a286e6ec2a763b560997203fd5b7" title="Applies a fix for polar winds in meteorological data." alt="" coords="176,976,328,1003"/>
<area shape="rect" href="mptrac_8c.html#ac2c90884cb02bf90f095ff36f41e020a" title="Calculates potential vorticity (PV) from meteorological data." alt="" coords="203,1027,301,1053"/>
<area shape="rect" href="mptrac_8c.html#a0e6ef467d264f7b13436a460c753ed8a" title="Downsamples meteorological data based on specified parameters." alt="" coords="189,1077,315,1104"/>
<area shape="rect" href="mptrac_8c.html#a29701c07d5dded042b2031e09e11d679" title="Calculates the tropopause and related meteorological variables based on various methods and stores th..." alt="" coords="393,145,505,172"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="605,512,683,539"/>
<area shape="rect" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286" title="Reads a 2&#45;dimensional meteorological variable from a binary file and stores it in the provided array." alt="" coords="389,360,510,387"/>
<area shape="rect" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558" title="Reads 3D meteorological data from a binary file, potentially using different compression methods." alt="" coords="389,411,510,437"/>
<area shape="rect" href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14" title="Compresses or decompresses a 3&#45;D meteorological field using cmultiscale." alt="" coords="589,411,699,437"/>
<area shape="rect" href="mptrac_8c.html#a61bbe35a4ff7b797fdb64f9797a3ffd1" title="Compresses or decompresses a 3D array of floats." alt="" coords="591,461,697,488"/>
<area shape="rect" href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3" title="Compresses or decompresses a 3&#45;D float array using the SZ3 library." alt="" coords="591,259,697,285"/>
<area shape="rect" href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72" title="Compresses or decompresses a 3D array of floats using the ZFP library." alt="" coords="593,309,695,336"/>
<area shape="rect" href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c" title="Compresses or decompresses a float array using Zstandard (ZSTD)." alt="" coords="589,360,699,387"/>
<area shape="rect" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692" title="Calculates the tropopause pressure based on climatological data." alt="" coords="603,107,685,133"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="571,56,717,83"/>
<area shape="rect" href="mptrac_8c.html#afa485eb277a5ced6dac0ed77665c976c" title="Calculates the moist adiabatic lapse rate in Kelvin per kilometer." alt="" coords="603,5,685,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="798,157,873,184"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="794,107,877,133"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="765,56,905,83"/>
<area shape="rect" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="413,807,485,833"/>
<area shape="rect" href="mptrac_8c.html#ae4562461a2883609e1768b1c3671eec4" title="Reads meteorological grid data from NetCDF files with domain decomposition." alt="" coords="387,571,512,597"/>
<area shape="rect" href="mptrac_8c.html#a2ee3cac435af17ad5aaf885cc2dc3262" title="Reads and processes meteorological level data from NetCDF files with domain decomposition." alt="" coords="380,680,519,707"/>
<area shape="rect" href="mptrac_8c.html#aa86499774fc9def653b04f95e56b4052" title="Reads and processes surface meteorological data from NetCDF files with domain decomposition." alt="" coords="376,756,523,783"/>
<area shape="rect" href="mptrac_8c.html#a6c6041039047d277d4836da1bb119e3d" title="Read meteorological grid data from a NetCDF file and set up subdomain decomposition with halos." alt="" coords="571,563,717,605"/>
<area shape="rect" href="mptrac_8c.html#a578e7ebaa62304182de8fe7ddf144b8f" title="Converts time components to seconds since January 1, 2000, 12:00:00 UTC." alt="" coords="796,680,875,707"/>
<area shape="rect" href="mptrac_8c.html#a8c5064804f7b46a4130b5411374a771d" title="Extracts and converts a timestamp from a filename to Julian seconds." alt="" coords="577,629,711,656"/>
<area shape="rect" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b" title="Interpolates meteorological data to specified pressure levels." alt="" coords="587,680,701,707"/>
<area shape="rect" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3" title="Reads a 3&#45;dimensional meteorological variable from a NetCDF file." alt="" coords="585,781,703,808"/>
<area shape="rect" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed" title="Reads a 2&#45;dimensional meteorological variable from a NetCDF file." alt="" coords="585,832,703,859"/>
<area shape="rect" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861" title="Locate the index of the interval containing a given value in an irregularly spaced array." alt="" coords="396,875,503,901"/>
<area shape="rect" href="mptrac_8c.html#a62786d005ed312f3c9ba2fac7cd544fc" title="Performs spline interpolation or linear interpolation." alt="" coords="616,157,672,184"/>
</map>
</div>

</div>
</div>
<a id="a3d7054e72e7ad37c35592d7469664f0a" name="a3d7054e72e7ad37c35592d7469664f0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d7054e72e7ad37c35592d7469664f0a">&#9670;&nbsp;</a></span>mptrac_run_timestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_run_timestep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> **&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> **&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes a single timestep of the MPTRAC model simulation. </p>
<p >This function performs all operations required to advance the model simulation by one timestep. It includes updating air parcel positions, applying advection, diffusion, convection, and other processes such as sedimentation, chemistry, and deposition. Each process is conditionally executed based on the control settings provided in the <code>ctl</code> structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing model parameters and settings. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the cache structure used for intermediate calculations. </td></tr>
    <tr><td class="paramname">clim</td><td>Pointer to the climatology structure containing climatological data. </td></tr>
    <tr><td class="paramname">met0</td><td>Pointer to the current meteorological data structure. </td></tr>
    <tr><td class="paramname">met1</td><td>Pointer to the next meteorological data structure. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmosphere structure containing air parcel data. </td></tr>
    <tr><td class="paramname">t</td><td>Current simulation time in seconds. </td></tr>
    <tr><td class="paramname">dd</td><td>MPI information required for the domain decomposition.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l06518">6518</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6526</span>            {</div>
<div class="line"><span class="lineno"> 6527</span> </div>
<div class="line"><span class="lineno"> 6528</span>  <span class="comment">/* Initialize modules... */</span></div>
<div class="line"><span class="lineno"> 6529</span>  <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a>) {</div>
<div class="line"><span class="lineno"> 6530</span> </div>
<div class="line"><span class="lineno"> 6531</span>    <span class="comment">/* Initialize isosurface data... */</span></div>
<div class="line"><span class="lineno"> 6532</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> &gt;= 1 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> &lt;= 4)</div>
<div class="line"><span class="lineno"> 6533</span>      <a class="code hl_function" href="mptrac_8c.html#a51093927ceae5630067278cee548797f">module_isosurf_init</a>(ctl, cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6534</span> </div>
<div class="line"><span class="lineno"> 6535</span>    <span class="comment">/* Initialize advection... */</span></div>
<div class="line"><span class="lineno"> 6536</span>    <a class="code hl_function" href="mptrac_8c.html#a7f61eec2b48a2250ca25ff4657fa858d">module_advect_init</a>(ctl, cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6537</span> </div>
<div class="line"><span class="lineno"> 6538</span>    <span class="comment">/* Initialize chemistry... */</span></div>
<div class="line"><span class="lineno"> 6539</span>    <a class="code hl_function" href="mptrac_8c.html#a2a04fee6c403d3d912d89d9666c0fd7b">module_chem_init</a>(ctl, cache, clim, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6540</span>  }</div>
<div class="line"><span class="lineno"> 6541</span> </div>
<div class="line"><span class="lineno"> 6542</span>  <span class="comment">/* Set time steps of air parcels... */</span></div>
<div class="line"><span class="lineno"> 6543</span>  <a class="code hl_function" href="mptrac_8c.html#a186195c8bbbd5cac5c1f52eed531804c">module_timesteps</a>(ctl, cache, *met0, atm, t);</div>
<div class="line"><span class="lineno"> 6544</span> </div>
<div class="line"><span class="lineno"> 6545</span>  <span class="comment">/* Sort particles... */</span></div>
<div class="line"><span class="lineno"> 6546</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a126d9eac2687f4aac95ab17fff14dd07">sort_dt</a> &gt; 0 &amp;&amp; fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a126d9eac2687f4aac95ab17fff14dd07">sort_dt</a>) == 0)</div>
<div class="line"><span class="lineno"> 6547</span>    <a class="code hl_function" href="mptrac_8c.html#ac9a4606b5ab8abb85a6f4b833e9f13f2">module_sort</a>(ctl, *met0, atm);</div>
<div class="line"><span class="lineno"> 6548</span> </div>
<div class="line"><span class="lineno"> 6549</span> </div>
<div class="line"><span class="lineno"> 6550</span>  <span class="comment">/* Check positions (initial)... */</span></div>
<div class="line"><span class="lineno"> 6551</span>  <a class="code hl_function" href="mptrac_8c.html#ab8f2e9219b39e8eb46e7d5c9d8398e53">module_position</a>(cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6552</span> </div>
<div class="line"><span class="lineno"> 6553</span>  <span class="comment">/* Advection... */</span></div>
<div class="line"><span class="lineno"> 6554</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8eb0ca94791f79405c3b49da924f386d">advect</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 6555</span>    <a class="code hl_function" href="mptrac_8c.html#a16101092a4f867b18cf1d4feb3189d1d">module_advect</a>(ctl, cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6556</span> </div>
<div class="line"><span class="lineno"> 6557</span>  <span class="comment">/* Turbulent diffusion... */</span></div>
<div class="line"><span class="lineno"> 6558</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a727a42a9f7c8b7e01c713d5300767213">diffusion</a> == 1</div>
<div class="line"><span class="lineno"> 6559</span>      &amp;&amp; (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad5a979592dd8c284d07bb25698339f04">turb_dx_pbl</a> &gt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af7af2185257f30f792f903af3fcbc041">turb_dz_pbl</a> &gt; 0</div>
<div class="line"><span class="lineno"> 6560</span>          || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a37abd3e7cbc687a515ba1bbac5ec77f2">turb_dx_trop</a> &gt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a21f2e759e0c5d8cfae2ba9ed551c768e">turb_dz_trop</a> &gt; 0</div>
<div class="line"><span class="lineno"> 6561</span>          || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3173408e0e9c39c17c39367aee1c5641">turb_dx_strat</a> &gt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae797044bfedbdf7e058c6fb02195e586">turb_dz_strat</a> &gt; 0))</div>
<div class="line"><span class="lineno"> 6562</span>    <a class="code hl_function" href="mptrac_8c.html#ad3e7ae644cd3068669c3f7c7669f4a02">module_diff_turb</a>(ctl, cache, clim, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6563</span> </div>
<div class="line"><span class="lineno"> 6564</span>  <span class="comment">/* Mesoscale diffusion... */</span></div>
<div class="line"><span class="lineno"> 6565</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a727a42a9f7c8b7e01c713d5300767213">diffusion</a> == 1 &amp;&amp; (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4c410e0dddb3e5a5cad1ca66f99967cd">turb_mesox</a> &gt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a22edf991ef6c26556d13aa822a65da63">turb_mesoz</a> &gt; 0))</div>
<div class="line"><span class="lineno"> 6566</span>    <a class="code hl_function" href="mptrac_8c.html#ac7d1bdf49d0da3ca1911eebe2a96a2ac">module_diff_meso</a>(ctl, cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6567</span> </div>
<div class="line"><span class="lineno"> 6568</span>  <span class="comment">/* Diffusion... */</span></div>
<div class="line"><span class="lineno"> 6569</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a727a42a9f7c8b7e01c713d5300767213">diffusion</a> == 2)</div>
<div class="line"><span class="lineno"> 6570</span>    <a class="code hl_function" href="mptrac_8c.html#ae102581d80f5817f4c5ef356bde43184">module_diff_pbl</a>(ctl, cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6571</span> </div>
<div class="line"><span class="lineno"> 6572</span>  <span class="comment">/* Convection... */</span></div>
<div class="line"><span class="lineno"> 6573</span>  <span class="keywordflow">if</span> ((ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9d400510c073db38fb10c9fc2bdff74d">conv_mix_pbl</a> || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a18c1107433d1e9c7867025e8a0fbe6d2">conv_cape</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 6574</span>      &amp;&amp; (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a64cdca0c6817ba378fbde7385b8ee279">conv_dt</a> &lt;= 0 || fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a64cdca0c6817ba378fbde7385b8ee279">conv_dt</a>) == 0))</div>
<div class="line"><span class="lineno"> 6575</span>    <a class="code hl_function" href="mptrac_8c.html#a799ef256c15dc112842d1dbc5afc787c">module_convection</a>(ctl, cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6576</span> </div>
<div class="line"><span class="lineno"> 6577</span>  <span class="comment">/* Sedimentation... */</span></div>
<div class="line"><span class="lineno"> 6578</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54a37ca01ed5643d41ee63768e5ad941">qnt_rp</a> &gt;= 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a08ad320f9953658f5346a123ba03ad86">qnt_rhop</a> &gt;= 0)</div>
<div class="line"><span class="lineno"> 6579</span>    <a class="code hl_function" href="mptrac_8c.html#a6cdd8f72190aa0901f08f48afc240ee1">module_sedi</a>(ctl, cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6580</span> </div>
<div class="line"><span class="lineno"> 6581</span>  <span class="comment">/* Isosurface... */</span></div>
<div class="line"><span class="lineno"> 6582</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> &gt;= 1 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4438b70bfa3ff0fe6cc36f3d0086e301">isosurf</a> &lt;= 4)</div>
<div class="line"><span class="lineno"> 6583</span>    <a class="code hl_function" href="mptrac_8c.html#ae194c1be6a486d2bd92f5794637d53e2">module_isosurf</a>(ctl, cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6584</span> </div>
<div class="line"><span class="lineno"> 6585</span>  <span class="comment">/* Check positions (final)... */</span></div>
<div class="line"><span class="lineno"> 6586</span>  <a class="code hl_function" href="mptrac_8c.html#ab8f2e9219b39e8eb46e7d5c9d8398e53">module_position</a>(cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6587</span> </div>
<div class="line"><span class="lineno"> 6588</span>  <span class="comment">/* Interpolate meteo data... */</span></div>
<div class="line"><span class="lineno"> 6589</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1f07329a9333e6af8f00ff9727d774ce">met_dt_out</a> &gt; 0</div>
<div class="line"><span class="lineno"> 6590</span>      &amp;&amp; (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1f07329a9333e6af8f00ff9727d774ce">met_dt_out</a> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a> || fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1f07329a9333e6af8f00ff9727d774ce">met_dt_out</a>) == 0))</div>
<div class="line"><span class="lineno"> 6591</span>    <a class="code hl_function" href="mptrac_8c.html#a1a15f897588f202b09b4eea27b89f734">module_meteo</a>(ctl, cache, clim, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6592</span> </div>
<div class="line"><span class="lineno"> 6593</span>  <span class="comment">/* Check boundary conditions (initial)... */</span></div>
<div class="line"><span class="lineno"> 6594</span>  <span class="keywordflow">if</span> ((ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a686563c65fdd2d03d15cfdddf294584c">bound_lat0</a> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3488ff97025f12fbe161d85b09ddc33e">bound_lat1</a>)</div>
<div class="line"><span class="lineno"> 6595</span>      &amp;&amp; (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa1419e1cd3c485e89a5166c7e1f19caf">bound_p0</a> &gt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a44cbf78eb4bbb11036922bc40faa2b4b">bound_p1</a>))</div>
<div class="line"><span class="lineno"> 6596</span>    <a class="code hl_function" href="mptrac_8c.html#a7c775417ba44bae7a915616cc9df4615">module_bound_cond</a>(ctl, cache, clim, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6597</span> </div>
<div class="line"><span class="lineno"> 6598</span>  <span class="comment">/* Initialize quantity of total loss rate... */</span></div>
<div class="line"><span class="lineno"> 6599</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 6600</span>    <a class="code hl_define" href="mptrac_8h.html#a11241b8a58cfbbe8cc92e1db4aff45ab">PARTICLE_LOOP</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <span class="stringliteral">&quot;acc data present(ctl,atm)&quot;</span>) {</div>
<div class="line"><span class="lineno"> 6601</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a26c2f638a10b553ee8b07f1cc5907c86">qnt_loss_rate</a>][ip] = 0;</div>
<div class="line"><span class="lineno"> 6602</span>    }</div>
<div class="line"><span class="lineno"> 6603</span>  }</div>
<div class="line"><span class="lineno"> 6604</span> </div>
<div class="line"><span class="lineno"> 6605</span>  <span class="comment">/* Decay of particle mass... */</span></div>
<div class="line"><span class="lineno"> 6606</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af276258494c92c24ab0de0b54759e9a9">tdec_trop</a> &gt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a86977d0f97ee8db6974efc896822a7db">tdec_strat</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 6607</span>    <a class="code hl_function" href="mptrac_8c.html#a1b4a2c668aae5a7ae522eab2489a464c">module_decay</a>(ctl, cache, clim, atm);</div>
<div class="line"><span class="lineno"> 6608</span> </div>
<div class="line"><span class="lineno"> 6609</span>  <span class="comment">/* Interparcel mixing... */</span></div>
<div class="line"><span class="lineno"> 6610</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a11a33decd5490249e5251aaec901bd4c">mixing_trop</a> &gt;= 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a54e8203aaa728ca33e8db070896eec5a">mixing_strat</a> &gt;= 0</div>
<div class="line"><span class="lineno"> 6611</span>      &amp;&amp; (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acf37a9e8e3b1a013d6106f83e14aedb3">mixing_dt</a> &lt;= 0 || fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acf37a9e8e3b1a013d6106f83e14aedb3">mixing_dt</a>) == 0))</div>
<div class="line"><span class="lineno"> 6612</span>    <a class="code hl_function" href="mptrac_8c.html#a40777319fe0947dcf920f10de9d55085">module_mixing</a>(ctl, clim, atm, t);</div>
<div class="line"><span class="lineno"> 6613</span> </div>
<div class="line"><span class="lineno"> 6614</span>  <span class="comment">/* Calculate the tracer vmr in the chemistry grid... */</span></div>
<div class="line"><span class="lineno"> 6615</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> != 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abfeedfc5c515f8d03de56c2cd06aa633">h2o2_chem_reaction</a> != 0</div>
<div class="line"><span class="lineno"> 6616</span>      || (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a92e02214da035478761cdcd7622780b1">kpp_chem</a> &amp;&amp; fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a603d7f5e599d149b57a67fea612ecb04">dt_kpp</a>) == 0))</div>
<div class="line"><span class="lineno"> 6617</span>    <a class="code hl_function" href="mptrac_8c.html#a6882c1e1af3a10c5f53662d353c8c1d8">module_chem_grid</a>(ctl, *met0, *met1, atm, t);</div>
<div class="line"><span class="lineno"> 6618</span> </div>
<div class="line"><span class="lineno"> 6619</span>  <span class="comment">/* OH chemistry... */</span></div>
<div class="line"><span class="lineno"> 6620</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a81cc25ede9c434e2ac0d7e341f3113e1">oh_chem_reaction</a> != 0)</div>
<div class="line"><span class="lineno"> 6621</span>    <a class="code hl_function" href="mptrac_8c.html#ae27eb9636b812ae9155ac23c86856d1b">module_oh_chem</a>(ctl, cache, clim, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6622</span> </div>
<div class="line"><span class="lineno"> 6623</span>  <span class="comment">/* H2O2 chemistry (for SO2 aqueous phase oxidation)... */</span></div>
<div class="line"><span class="lineno"> 6624</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abfeedfc5c515f8d03de56c2cd06aa633">h2o2_chem_reaction</a> != 0)</div>
<div class="line"><span class="lineno"> 6625</span>    <a class="code hl_function" href="mptrac_8c.html#adeecfbf32977d527d934a778edd84f38">module_h2o2_chem</a>(ctl, cache, clim, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6626</span> </div>
<div class="line"><span class="lineno"> 6627</span>  <span class="comment">/* First-order tracer chemistry... */</span></div>
<div class="line"><span class="lineno"> 6628</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7144e94dd5ef6f75941dd35a82eac9bd">tracer_chem</a>)</div>
<div class="line"><span class="lineno"> 6629</span>    <a class="code hl_function" href="mptrac_8c.html#adb66834f81688452a86c1a574bafca03">module_tracer_chem</a>(ctl, cache, clim, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6630</span> </div>
<div class="line"><span class="lineno"> 6631</span>  <span class="comment">/* Domain decomposition... */</span></div>
<div class="line"><span class="lineno"> 6632</span>  <span class="keywordflow">if</span> (dd-&gt;<a class="code hl_variable" href="structdd__t.html#a6b3f46164e3e50d121dd10ee5bd8f2c8">init</a>) {</div>
<div class="line"><span class="lineno"> 6633</span><span class="preprocessor">#ifdef DD</span></div>
<div class="line"><span class="lineno"> 6634</span>    <a class="code hl_function" href="mptrac_8h.html#ac7dbcc9e4768175409c30a110dcd8308">module_dd</a>(ctl, atm, cache, dd, met0);</div>
<div class="line"><span class="lineno"> 6635</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 6636</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;DD initialized, but model is compiled without DD.&quot;</span>)</div>
<div class="line"><span class="lineno"> 6637</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6638</span>  }</div>
<div class="line"><span class="lineno"> 6639</span> </div>
<div class="line"><span class="lineno"> 6640</span>  <span class="comment">/* KPP chemistry... */</span></div>
<div class="line"><span class="lineno"> 6641</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a92e02214da035478761cdcd7622780b1">kpp_chem</a> &amp;&amp; fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a603d7f5e599d149b57a67fea612ecb04">dt_kpp</a>) == 0) {</div>
<div class="line"><span class="lineno"> 6642</span><span class="preprocessor">#ifdef KPP</span></div>
<div class="line"><span class="lineno"> 6643</span>    <a class="code hl_function" href="mptrac_8h.html#ae1de15701f752a97b1d2858125e851fc">module_kpp_chem</a>(ctl, cache, clim, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6644</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 6645</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Code was compiled without KPP!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6646</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6647</span>  }</div>
<div class="line"><span class="lineno"> 6648</span> </div>
<div class="line"><span class="lineno"> 6649</span>  <span class="comment">/* Wet deposition... */</span></div>
<div class="line"><span class="lineno"> 6650</span>  <span class="keywordflow">if</span> ((ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a032306df4b235c20af95d5b30edc694a">wet_depo_ic_a</a> &gt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad33a970fead17226fb2b208975bee8a2">wet_depo_ic_h</a>[0] &gt; 0)</div>
<div class="line"><span class="lineno"> 6651</span>      &amp;&amp; (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1550c0159a3a3374a1ebccef46604ad8">wet_depo_bc_a</a> &gt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a0cd464bdd8eac81b99b88a93e21536">wet_depo_bc_h</a>[0] &gt; 0))</div>
<div class="line"><span class="lineno"> 6652</span>    <a class="code hl_function" href="mptrac_8c.html#a5e35405aee5829cf062bd3cab20b0425">module_wet_depo</a>(ctl, cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6653</span> </div>
<div class="line"><span class="lineno"> 6654</span>  <span class="comment">/* Dry deposition... */</span></div>
<div class="line"><span class="lineno"> 6655</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acadcfbb95971c47b377fbd4443c68723">dry_depo_vdep</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 6656</span>    <a class="code hl_function" href="mptrac_8c.html#af237449d9c3c8fec9e5f062cdc579105">module_dry_depo</a>(ctl, cache, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6657</span> </div>
<div class="line"><span class="lineno"> 6658</span>  <span class="comment">/* Check boundary conditions (final)... */</span></div>
<div class="line"><span class="lineno"> 6659</span>  <span class="keywordflow">if</span> ((ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a686563c65fdd2d03d15cfdddf294584c">bound_lat0</a> &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3488ff97025f12fbe161d85b09ddc33e">bound_lat1</a>)</div>
<div class="line"><span class="lineno"> 6660</span>      &amp;&amp; (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa1419e1cd3c485e89a5166c7e1f19caf">bound_p0</a> &gt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a44cbf78eb4bbb11036922bc40faa2b4b">bound_p1</a>))</div>
<div class="line"><span class="lineno"> 6661</span>    <a class="code hl_function" href="mptrac_8c.html#a7c775417ba44bae7a915616cc9df4615">module_bound_cond</a>(ctl, cache, clim, *met0, *met1, atm);</div>
<div class="line"><span class="lineno"> 6662</span>}</div>
<div class="ttc" id="amptrac_8c_html_a16101092a4f867b18cf1d4feb3189d1d"><div class="ttname"><a href="mptrac_8c.html#a16101092a4f867b18cf1d4feb3189d1d">module_advect</a></div><div class="ttdeci">void module_advect(const ctl_t *ctl, const cache_t *cache, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Advances particle positions using different advection schemes.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02972">mptrac.c:2972</a></div></div>
<div class="ttc" id="amptrac_8c_html_a186195c8bbbd5cac5c1f52eed531804c"><div class="ttname"><a href="mptrac_8c.html#a186195c8bbbd5cac5c1f52eed531804c">module_timesteps</a></div><div class="ttdeci">void module_timesteps(const ctl_t *ctl, cache_t *cache, met_t *met0, atm_t *atm, const double t)</div><div class="ttdoc">Calculate time steps for air parcels based on specified conditions.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04872">mptrac.c:4872</a></div></div>
<div class="ttc" id="amptrac_8c_html_a1a15f897588f202b09b4eea27b89f734"><div class="ttname"><a href="mptrac_8c.html#a1a15f897588f202b09b4eea27b89f734">module_meteo</a></div><div class="ttdeci">void module_meteo(const ctl_t *ctl, const cache_t *cache, const clim_t *clim, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Update atmospheric properties using meteorological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04189">mptrac.c:4189</a></div></div>
<div class="ttc" id="amptrac_8c_html_a1b4a2c668aae5a7ae522eab2489a464c"><div class="ttname"><a href="mptrac_8c.html#a1b4a2c668aae5a7ae522eab2489a464c">module_decay</a></div><div class="ttdeci">void module_decay(const ctl_t *ctl, const cache_t *cache, const clim_t *clim, atm_t *atm)</div><div class="ttdoc">Simulate exponential decay processes for atmospheric particles.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l03575">mptrac.c:3575</a></div></div>
<div class="ttc" id="amptrac_8c_html_a2a04fee6c403d3d912d89d9666c0fd7b"><div class="ttname"><a href="mptrac_8c.html#a2a04fee6c403d3d912d89d9666c0fd7b">module_chem_init</a></div><div class="ttdeci">void module_chem_init(const ctl_t *ctl, const cache_t *cache, const clim_t *clim, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Initializes the chemistry modules by setting atmospheric composition.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l03420">mptrac.c:3420</a></div></div>
<div class="ttc" id="amptrac_8c_html_a40777319fe0947dcf920f10de9d55085"><div class="ttname"><a href="mptrac_8c.html#a40777319fe0947dcf920f10de9d55085">module_mixing</a></div><div class="ttdeci">void module_mixing(const ctl_t *ctl, const clim_t *clim, atm_t *atm, const double t)</div><div class="ttdoc">Update atmospheric properties through interparcel mixing.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04296">mptrac.c:4296</a></div></div>
<div class="ttc" id="amptrac_8c_html_a51093927ceae5630067278cee548797f"><div class="ttname"><a href="mptrac_8c.html#a51093927ceae5630067278cee548797f">module_isosurf_init</a></div><div class="ttdeci">void module_isosurf_init(const ctl_t *ctl, cache_t *cache, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Initialize the isosurface module based on atmospheric data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04013">mptrac.c:4013</a></div></div>
<div class="ttc" id="amptrac_8c_html_a5e35405aee5829cf062bd3cab20b0425"><div class="ttname"><a href="mptrac_8c.html#a5e35405aee5829cf062bd3cab20b0425">module_wet_depo</a></div><div class="ttdeci">void module_wet_depo(const ctl_t *ctl, const cache_t *cache, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Perform wet deposition calculations for air parcels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l05021">mptrac.c:5021</a></div></div>
<div class="ttc" id="amptrac_8c_html_a6882c1e1af3a10c5f53662d353c8c1d8"><div class="ttname"><a href="mptrac_8c.html#a6882c1e1af3a10c5f53662d353c8c1d8">module_chem_grid</a></div><div class="ttdeci">void module_chem_grid(const ctl_t *ctl, met_t *met0, met_t *met1, atm_t *atm, const double tt)</div><div class="ttdoc">Computes gridded chemical tracer concentrations (volume mixing ratio) from individual air parcel mass...</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l03258">mptrac.c:3258</a></div></div>
<div class="ttc" id="amptrac_8c_html_a6cdd8f72190aa0901f08f48afc240ee1"><div class="ttname"><a href="mptrac_8c.html#a6cdd8f72190aa0901f08f48afc240ee1">module_sedi</a></div><div class="ttdeci">void module_sedi(const ctl_t *ctl, const cache_t *cache, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Simulate sedimentation of particles in the atmosphere.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04740">mptrac.c:4740</a></div></div>
<div class="ttc" id="amptrac_8c_html_a799ef256c15dc112842d1dbc5afc787c"><div class="ttname"><a href="mptrac_8c.html#a799ef256c15dc112842d1dbc5afc787c">module_convection</a></div><div class="ttdeci">void module_convection(const ctl_t *ctl, cache_t *cache, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Performs convective mixing of atmospheric particles.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l03462">mptrac.c:3462</a></div></div>
<div class="ttc" id="amptrac_8c_html_a7c775417ba44bae7a915616cc9df4615"><div class="ttname"><a href="mptrac_8c.html#a7c775417ba44bae7a915616cc9df4615">module_bound_cond</a></div><div class="ttdeci">void module_bound_cond(const ctl_t *ctl, const cache_t *cache, const clim_t *clim, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Apply boundary conditions to particles based on meteorological and climatological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l03162">mptrac.c:3162</a></div></div>
<div class="ttc" id="amptrac_8c_html_a7f61eec2b48a2250ca25ff4657fa858d"><div class="ttname"><a href="mptrac_8c.html#a7f61eec2b48a2250ca25ff4657fa858d">module_advect_init</a></div><div class="ttdeci">void module_advect_init(const ctl_t *ctl, const cache_t *cache, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Initializes the advection module by setting up pressure fields.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l03135">mptrac.c:3135</a></div></div>
<div class="ttc" id="amptrac_8c_html_ab8f2e9219b39e8eb46e7d5c9d8398e53"><div class="ttname"><a href="mptrac_8c.html#ab8f2e9219b39e8eb46e7d5c9d8398e53">module_position</a></div><div class="ttdeci">void module_position(const cache_t *cache, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Update the positions and pressure levels of atmospheric particles.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04553">mptrac.c:4553</a></div></div>
<div class="ttc" id="amptrac_8c_html_ac7d1bdf49d0da3ca1911eebe2a96a2ac"><div class="ttname"><a href="mptrac_8c.html#ac7d1bdf49d0da3ca1911eebe2a96a2ac">module_diff_meso</a></div><div class="ttdeci">void module_diff_meso(const ctl_t *ctl, cache_t *cache, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Simulate mesoscale diffusion for atmospheric particles.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l03614">mptrac.c:3614</a></div></div>
<div class="ttc" id="amptrac_8c_html_ac9a4606b5ab8abb85a6f4b833e9f13f2"><div class="ttname"><a href="mptrac_8c.html#ac9a4606b5ab8abb85a6f4b833e9f13f2">module_sort</a></div><div class="ttdeci">void module_sort(const ctl_t *ctl, met_t *met0, atm_t *atm)</div><div class="ttdoc">Sort particles according to box index.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04769">mptrac.c:4769</a></div></div>
<div class="ttc" id="amptrac_8c_html_ad3e7ae644cd3068669c3f7c7669f4a02"><div class="ttname"><a href="mptrac_8c.html#ad3e7ae644cd3068669c3f7c7669f4a02">module_diff_turb</a></div><div class="ttdeci">void module_diff_turb(const ctl_t *ctl, cache_t *cache, const clim_t *clim, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Applies turbulent diffusion processes to atmospheric particles.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l03816">mptrac.c:3816</a></div></div>
<div class="ttc" id="amptrac_8c_html_adb66834f81688452a86c1a574bafca03"><div class="ttname"><a href="mptrac_8c.html#adb66834f81688452a86c1a574bafca03">module_tracer_chem</a></div><div class="ttdeci">void module_tracer_chem(const ctl_t *ctl, const cache_t *cache, const clim_t *clim, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Simulate chemical reactions involving long-lived atmospheric tracers.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04950">mptrac.c:4950</a></div></div>
<div class="ttc" id="amptrac_8c_html_adeecfbf32977d527d934a778edd84f38"><div class="ttname"><a href="mptrac_8c.html#adeecfbf32977d527d934a778edd84f38">module_h2o2_chem</a></div><div class="ttdeci">void module_h2o2_chem(const ctl_t *ctl, const cache_t *cache, const clim_t *clim, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Perform chemical reactions involving H2O2 within cloud particles.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l03931">mptrac.c:3931</a></div></div>
<div class="ttc" id="amptrac_8c_html_ae102581d80f5817f4c5ef356bde43184"><div class="ttname"><a href="mptrac_8c.html#ae102581d80f5817f4c5ef356bde43184">module_diff_pbl</a></div><div class="ttdeci">void module_diff_pbl(const ctl_t *ctl, cache_t *cache, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Computes particle diffusion within the planetary boundary layer (PBL).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l03691">mptrac.c:3691</a></div></div>
<div class="ttc" id="amptrac_8c_html_ae194c1be6a486d2bd92f5794637d53e2"><div class="ttname"><a href="mptrac_8c.html#ae194c1be6a486d2bd92f5794637d53e2">module_isosurf</a></div><div class="ttdeci">void module_isosurf(const ctl_t *ctl, const cache_t *cache, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Apply the isosurface module to adjust atmospheric properties.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04083">mptrac.c:4083</a></div></div>
<div class="ttc" id="amptrac_8c_html_ae27eb9636b812ae9155ac23c86856d1b"><div class="ttname"><a href="mptrac_8c.html#ae27eb9636b812ae9155ac23c86856d1b">module_oh_chem</a></div><div class="ttdeci">void module_oh_chem(const ctl_t *ctl, const cache_t *cache, const clim_t *clim, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Perform hydroxyl chemistry calculations for atmospheric particles.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l04469">mptrac.c:4469</a></div></div>
<div class="ttc" id="amptrac_8c_html_af237449d9c3c8fec9e5f062cdc579105"><div class="ttname"><a href="mptrac_8c.html#af237449d9c3c8fec9e5f062cdc579105">module_dry_depo</a></div><div class="ttdeci">void module_dry_depo(const ctl_t *ctl, const cache_t *cache, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">Simulate dry deposition of atmospheric particles.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l03868">mptrac.c:3868</a></div></div>
<div class="ttc" id="amptrac_8h_html_ac7dbcc9e4768175409c30a110dcd8308"><div class="ttname"><a href="mptrac_8h.html#ac7dbcc9e4768175409c30a110dcd8308">module_dd</a></div><div class="ttdeci">void module_dd(ctl_t *ctl, atm_t *atm, cache_t *cache, dd_t *dd, met_t **met)</div><div class="ttdoc">Manages domain decomposition and particle communication in parallel processing.</div></div>
<div class="ttc" id="amptrac_8h_html_ae1de15701f752a97b1d2858125e851fc"><div class="ttname"><a href="mptrac_8h.html#ae1de15701f752a97b1d2858125e851fc">module_kpp_chem</a></div><div class="ttdeci">void module_kpp_chem(ctl_t *ctl, cache_t *cache, clim_t *clim, met_t *met0, met_t *met1, atm_t *atm)</div><div class="ttdoc">KPP chemistry module.</div></div>
<div class="ttc" id="astructdd__t_html_a6b3f46164e3e50d121dd10ee5bd8f2c8"><div class="ttname"><a href="structdd__t.html#a6b3f46164e3e50d121dd10ee5bd8f2c8">dd_t::init</a></div><div class="ttdeci">int init</div><div class="ttdoc">Shows if domain decomposition was initialized.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03651">mptrac.h:3651</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a3d7054e72e7ad37c35592d7469664f0a_cgraph.png" border="0" usemap="#amptrac_8h_a3d7054e72e7ad37c35592d7469664f0a_cgraph" alt=""/></div>
<map name="amptrac_8h_a3d7054e72e7ad37c35592d7469664f0a_cgraph" id="amptrac_8h_a3d7054e72e7ad37c35592d7469664f0a_cgraph">
<area shape="rect" title="Executes a single timestep of the MPTRAC model simulation." alt="" coords="5,636,149,663"/>
<area shape="rect" href="mptrac_8c.html#a16101092a4f867b18cf1d4feb3189d1d" title="Advances particle positions using different advection schemes." alt="" coords="213,79,323,106"/>
<area shape="rect" href="mptrac_8c.html#a7f61eec2b48a2250ca25ff4657fa858d" title="Initializes the advection module by setting up pressure fields." alt="" coords="588,42,723,68"/>
<area shape="rect" href="mptrac_8c.html#a7c775417ba44bae7a915616cc9df4615" title="Apply boundary conditions to particles based on meteorological and climatological data." alt="" coords="197,180,339,207"/>
<area shape="rect" href="mptrac_8c.html#a6882c1e1af3a10c5f53662d353c8c1d8" title="Computes gridded chemical tracer concentrations (volume mixing ratio) from individual air parcel mass..." alt="" coords="203,130,333,156"/>
<area shape="rect" href="mptrac_8c.html#a2a04fee6c403d3d912d89d9666c0fd7b" title="Initializes the chemistry modules by setting atmospheric composition." alt="" coords="205,636,331,663"/>
<area shape="rect" href="mptrac_8c.html#a799ef256c15dc112842d1dbc5afc787c" title="Performs convective mixing of atmospheric particles." alt="" coords="201,231,335,258"/>
<area shape="rect" href="mptrac_8h.html#ac7dbcc9e4768175409c30a110dcd8308" title="Manages domain decomposition and particle communication in parallel processing." alt="" coords="225,332,311,359"/>
<area shape="rect" href="mptrac_8c.html#a1b4a2c668aae5a7ae522eab2489a464c" title="Simulate exponential decay processes for atmospheric particles." alt="" coords="411,991,516,1018"/>
<area shape="rect" href="mptrac_8c.html#ac7d1bdf49d0da3ca1911eebe2a96a2ac" title="Simulate mesoscale diffusion for atmospheric particles." alt="" coords="205,383,331,410"/>
<area shape="rect" href="mptrac_8c.html#ae102581d80f5817f4c5ef356bde43184" title="Computes particle diffusion within the planetary boundary layer (PBL)." alt="" coords="212,434,324,460"/>
<area shape="rect" href="mptrac_8c.html#ad3e7ae644cd3068669c3f7c7669f4a02" title="Applies turbulent diffusion processes to atmospheric particles." alt="" coords="209,586,327,612"/>
<area shape="rect" href="mptrac_8c.html#af237449d9c3c8fec9e5f062cdc579105" title="Simulate dry deposition of atmospheric particles." alt="" coords="207,940,329,967"/>
<area shape="rect" href="mptrac_8c.html#adeecfbf32977d527d934a778edd84f38" title="Perform chemical reactions involving H2O2 within cloud particles." alt="" coords="394,535,533,562"/>
<area shape="rect" href="mptrac_8c.html#ae194c1be6a486d2bd92f5794637d53e2" title="Apply the isosurface module to adjust atmospheric properties." alt="" coords="600,282,711,308"/>
<area shape="rect" href="mptrac_8c.html#a51093927ceae5630067278cee548797f" title="Initialize the isosurface module based on atmospheric data." alt="" coords="201,738,335,764"/>
<area shape="rect" href="mptrac_8h.html#ae1de15701f752a97b1d2858125e851fc" title="KPP chemistry module." alt="" coords="203,788,333,815"/>
<area shape="rect" href="mptrac_8c.html#a1a15f897588f202b09b4eea27b89f734" title="Update atmospheric properties using meteorological data." alt="" coords="215,839,321,866"/>
<area shape="rect" href="mptrac_8c.html#a40777319fe0947dcf920f10de9d55085" title="Update atmospheric properties through interparcel mixing." alt="" coords="214,1092,322,1119"/>
<area shape="rect" href="mptrac_8c.html#ae27eb9636b812ae9155ac23c86856d1b" title="Perform hydroxyl chemistry calculations for atmospheric particles." alt="" coords="206,687,330,714"/>
<area shape="rect" href="mptrac_8c.html#ab8f2e9219b39e8eb46e7d5c9d8398e53" title="Update the positions and pressure levels of atmospheric particles." alt="" coords="210,991,326,1018"/>
<area shape="rect" href="mptrac_8c.html#a6cdd8f72190aa0901f08f48afc240ee1" title="Simulate sedimentation of particles in the atmosphere." alt="" coords="221,1042,315,1068"/>
<area shape="rect" href="mptrac_8c.html#ac9a4606b5ab8abb85a6f4b833e9f13f2" title="Sort particles according to box index." alt="" coords="797,636,890,663"/>
<area shape="rect" href="mptrac_8c.html#a186195c8bbbd5cac5c1f52eed531804c" title="Calculate time steps for air parcels based on specified conditions." alt="" coords="204,1143,332,1170"/>
<area shape="rect" href="mptrac_8c.html#adb66834f81688452a86c1a574bafca03" title="Simulate chemical reactions involving long&#45;lived atmospheric tracers." alt="" coords="392,484,535,511"/>
<area shape="rect" href="mptrac_8c.html#a5e35405aee5829cf062bd3cab20b0425" title="Perform wet deposition calculations for air parcels." alt="" coords="205,1244,331,1271"/>
<area shape="rect" href="mptrac_8c.html#ab5b4d31bdb9e487738d576ced596d190" title="Interpolates meteorological variables to a given position and time." alt="" coords="776,130,911,156"/>
<area shape="rect" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6" title="Interpolates meteorological data in 3D space and time." alt="" coords="396,180,531,207"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="964,180,1104,207"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="997,332,1071,359"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="993,434,1075,460"/>
<area shape="rect" href="mptrac_8c.html#abd6bde703e5eec60bf68820afcdd5edc" title="Locate the four vertical indizes of a box for a given height value." alt="" coords="991,130,1077,156"/>
<area shape="rect" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861" title="Locate the index of the interval containing a given value in an irregularly spaced array." alt="" coords="1152,130,1259,156"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="771,180,916,207"/>
<area shape="rect" href="mptrac_8c.html#acbf877af94269d0aa1c94b7c50121df8" title="Interpolates a time series of climatological variables." alt="" coords="623,231,687,258"/>
<area shape="rect" href="mptrac_8c.html#a9ba00889eeb600010467d8b62de94a36" title="Calculates the hydroxyl radical (OH) concentration from climatology data, with an optional diurnal co..." alt="" coords="430,738,497,764"/>
<area shape="rect" href="mptrac_8c.html#a41f5ab8ff7acad400fe7332b6b53288a" title="Interpolates monthly mean zonal mean climatological variables." alt="" coords="620,535,691,562"/>
<area shape="rect" href="mptrac_8c.html#a1c8c72b0bc66d214b4575c13a7a0eb6b" title="Calculates the cosine of the solar zenith angle." alt="" coords="620,484,691,511"/>
<area shape="rect" href="mptrac_8c.html#aab313e4929e7379aca2aee1ee36873d9" title="Generate random numbers using various methods and distributions." alt="" coords="419,434,508,460"/>
<area shape="rect" href="mptrac_8c.html#a90bdbbffe8b8633d84a48d2ddd311180" title="Computes a weighting factor based on tropopause pressure." alt="" coords="607,814,703,840"/>
<area shape="rect" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692" title="Calculates the tropopause pressure based on climatological data." alt="" coords="802,586,885,612"/>
<area shape="rect" href="mptrac_8c.html#ae0ce53cb5230060c17ee4766ca910e79" title="Computes a weighting factor based on planetary boundary layer pressure." alt="" coords="421,586,505,612"/>
<area shape="rect" href="mptrac_8c.html#a1b580107362b559d90f6766d340cc370" title="Calculates the sedimentation velocity of a particle in air." alt="" coords="440,1042,487,1068"/>
<area shape="rect" href="mptrac_8c.html#a55562b13a38a124b0abc09ce8511dde9" title="Updates device memory for specified data structures." alt="" coords="387,788,540,815"/>
<area shape="rect" href="mptrac_8c.html#afa485eb277a5ced6dac0ed77665c976c" title="Calculates the moist adiabatic lapse rate in Kelvin per kilometer." alt="" coords="422,839,505,866"/>
<area shape="rect" href="mptrac_8c.html#a623b433e01381315e5d49fc4c2bc3548" title="Calculates the nitric acid trihydrate (NAT) temperature." alt="" coords="405,940,521,967"/>
<area shape="rect" href="mptrac_8c.html#a433c00a5ba68e33cc6ac08ee2217a76f" title="Perform subgrid&#45;scale interparcel mixing of a given quantity." alt="" coords="394,1092,533,1119"/>
<area shape="rect" href="mptrac_8c.html#a8540fc571513e0d8f82e268b80c6bd3b" title="Reorder an array based on a given permutation." alt="" coords="972,636,1096,663"/>
<area shape="rect" href="mptrac_8c.html#a69a55a5bcd0af800ddc35cbe3b16cd15" title="Calculates the photolysis rate for a given set of atmospheric conditions." alt="" coords="801,434,886,460"/>
</map>
</div>

</div>
</div>
<a id="a07d1a762eeeef6c54d4dd68ac2477f9d" name="a07d1a762eeeef6c54d4dd68ac2477f9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07d1a762eeeef6c54d4dd68ac2477f9d">&#9670;&nbsp;</a></span>mptrac_write_atm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_write_atm </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes air parcel data to a file in various formats. </p>
<p >The <code>mptrac_write_atm</code> function writes the air parcel data stored in the <code>atm</code> structure to a file specified by <code>filename</code>. The format of the output file is determined by the <code>atm_type_out</code> field in the <code>ctl</code> control structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the name of the file to write the data to. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data. </td></tr>
    <tr><td class="paramname">t</td><td>The current time, used for certain output formats.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets a timer for the write operation using the <code>SELECT_TIMER</code> macro.</li>
<li>Logs the beginning of the write operation with the specified filename.</li>
<li>Depending on the <code>atm_type_out</code> value in the <code>ctl</code> structure, writes the data in one of the following formats:<ul>
<li>ASCII (<code>atm_type_out == 0</code>): Calls <code>write_atm_asc</code>.</li>
<li>Binary (<code>atm_type_out == 1</code>): Calls <code>write_atm_bin</code>.</li>
<li>netCDF (<code>atm_type_out == 2</code>): Calls <code>write_atm_nc</code>.</li>
<li>CLaMS trajectory data (<code>atm_type_out == 3</code>): Calls <code>write_atm_clams_traj</code>.</li>
<li>CLaMS position data (<code>atm_type_out == 4</code>): Calls <code>write_atm_clams</code>.</li>
</ul>
</li>
<li>If the <code>atm_type_out</code> value is not supported, triggers an error message.</li>
<li>Logs various statistics about the atmospheric data, including the number of particles, time range, altitude range, pressure range, longitude range, and latitude range.</li>
<li>Logs the range for each quantity specified in the <code>ctl</code> structure.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l06778">6778</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6782</span>                  {</div>
<div class="line"><span class="lineno"> 6783</span> </div>
<div class="line"><span class="lineno"> 6784</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 6785</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;WRITE_ATM&quot;</span>, <span class="stringliteral">&quot;OUTPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 6786</span> </div>
<div class="line"><span class="lineno"> 6787</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 6788</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write atmospheric data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 6789</span> </div>
<div class="line"><span class="lineno"> 6790</span>  <span class="comment">/* Write ASCII data... */</span></div>
<div class="line"><span class="lineno"> 6791</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">atm_type_out</a> == 0)</div>
<div class="line"><span class="lineno"> 6792</span>    <a class="code hl_function" href="mptrac_8c.html#a70603265840ed0c76957a2df53dabc5a">write_atm_asc</a>(filename, ctl, atm, t);</div>
<div class="line"><span class="lineno"> 6793</span> </div>
<div class="line"><span class="lineno"> 6794</span>  <span class="comment">/* Write binary data... */</span></div>
<div class="line"><span class="lineno"> 6795</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">atm_type_out</a> == 1)</div>
<div class="line"><span class="lineno"> 6796</span>    <a class="code hl_function" href="mptrac_8c.html#af40f268fa1f23a997abbebc49d4c88d2">write_atm_bin</a>(filename, ctl, atm);</div>
<div class="line"><span class="lineno"> 6797</span> </div>
<div class="line"><span class="lineno"> 6798</span>  <span class="comment">/* Write netCDF data... */</span></div>
<div class="line"><span class="lineno"> 6799</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">atm_type_out</a> == 2)</div>
<div class="line"><span class="lineno"> 6800</span>    <a class="code hl_function" href="mptrac_8c.html#aff66d76a0f9415997955f47edeff5b99">write_atm_nc</a>(filename, ctl, atm);</div>
<div class="line"><span class="lineno"> 6801</span> </div>
<div class="line"><span class="lineno"> 6802</span>  <span class="comment">/* Write CLaMS trajectory data... */</span></div>
<div class="line"><span class="lineno"> 6803</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">atm_type_out</a> == 3)</div>
<div class="line"><span class="lineno"> 6804</span>    <a class="code hl_function" href="mptrac_8c.html#a094daf77749905feec48a3e69fb779e1">write_atm_clams_traj</a>(filename, ctl, atm, t);</div>
<div class="line"><span class="lineno"> 6805</span> </div>
<div class="line"><span class="lineno"> 6806</span>  <span class="comment">/* Write CLaMS pos data... */</span></div>
<div class="line"><span class="lineno"> 6807</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">atm_type_out</a> == 4)</div>
<div class="line"><span class="lineno"> 6808</span>    <a class="code hl_function" href="mptrac_8c.html#acdc1746c0cf47f3116b471f66f6a3e0c">write_atm_clams</a>(filename, ctl, atm);</div>
<div class="line"><span class="lineno"> 6809</span> </div>
<div class="line"><span class="lineno"> 6810</span>  <span class="comment">/* Error... */</span></div>
<div class="line"><span class="lineno"> 6811</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6812</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Atmospheric data type not supported!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6813</span> </div>
<div class="line"><span class="lineno"> 6814</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 6815</span>  <span class="keywordtype">double</span> mini, maxi;</div>
<div class="line"><span class="lineno"> 6816</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of particles: %d&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6817</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6818</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time range: %.2f ... %.2f s&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 6819</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6820</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Altitude range: %g ... %g km&quot;</span>, <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(maxi), <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(mini));</div>
<div class="line"><span class="lineno"> 6821</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Pressure range: %g ... %g hPa&quot;</span>, maxi, mini);</div>
<div class="line"><span class="lineno"> 6822</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6823</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Longitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 6824</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6825</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Latitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno"> 6826</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno"> 6827</span>    <span class="keywordtype">char</span> msg[5 * <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 6828</span>    sprintf(msg, <span class="stringliteral">&quot;Quantity %s range: %s ... %s %s&quot;</span>,</div>
<div class="line"><span class="lineno"> 6829</span>            ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq],</div>
<div class="line"><span class="lineno"> 6830</span>            ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq]);</div>
<div class="line"><span class="lineno"> 6831</span>    gsl_stats_minmax(&amp;mini, &amp;maxi, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq], 1, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno"> 6832</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, msg, mini, maxi);</div>
<div class="line"><span class="lineno"> 6833</span>  }</div>
<div class="line"><span class="lineno"> 6834</span>}</div>
<div class="ttc" id="amptrac_8c_html_a094daf77749905feec48a3e69fb779e1"><div class="ttname"><a href="mptrac_8c.html#a094daf77749905feec48a3e69fb779e1">write_atm_clams_traj</a></div><div class="ttdeci">void write_atm_clams_traj(const char *dirname, const ctl_t *ctl, const atm_t *atm, const double t)</div><div class="ttdoc">Writes CLaMS trajectory data to a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11466">mptrac.c:11466</a></div></div>
<div class="ttc" id="amptrac_8c_html_a70603265840ed0c76957a2df53dabc5a"><div class="ttname"><a href="mptrac_8c.html#a70603265840ed0c76957a2df53dabc5a">write_atm_asc</a></div><div class="ttdeci">void write_atm_asc(const char *filename, const ctl_t *ctl, const atm_t *atm, const double t)</div><div class="ttdoc">Writes air parcel data to an ASCII file or gnuplot.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11281">mptrac.c:11281</a></div></div>
<div class="ttc" id="amptrac_8c_html_acdc1746c0cf47f3116b471f66f6a3e0c"><div class="ttname"><a href="mptrac_8c.html#acdc1746c0cf47f3116b471f66f6a3e0c">write_atm_clams</a></div><div class="ttdeci">void write_atm_clams(const char *filename, const ctl_t *ctl, const atm_t *atm)</div><div class="ttdoc">Writes air parcel data to a NetCDF file in the CLaMS format.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11413">mptrac.c:11413</a></div></div>
<div class="ttc" id="amptrac_8c_html_af40f268fa1f23a997abbebc49d4c88d2"><div class="ttname"><a href="mptrac_8c.html#af40f268fa1f23a997abbebc49d4c88d2">write_atm_bin</a></div><div class="ttdeci">void write_atm_bin(const char *filename, const ctl_t *ctl, const atm_t *atm)</div><div class="ttdoc">Writes air parcel data to a binary file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11363">mptrac.c:11363</a></div></div>
<div class="ttc" id="amptrac_8c_html_aff66d76a0f9415997955f47edeff5b99"><div class="ttname"><a href="mptrac_8c.html#aff66d76a0f9415997955f47edeff5b99">write_atm_nc</a></div><div class="ttdeci">void write_atm_nc(const char *filename, const ctl_t *ctl, const atm_t *atm)</div><div class="ttdoc">Writes air parcel data to a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11624">mptrac.c:11624</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a07d1a762eeeef6c54d4dd68ac2477f9d_cgraph.png" border="0" usemap="#amptrac_8h_a07d1a762eeeef6c54d4dd68ac2477f9d_cgraph" alt=""/></div>
<map name="amptrac_8h_a07d1a762eeeef6c54d4dd68ac2477f9d_cgraph" id="amptrac_8h_a07d1a762eeeef6c54d4dd68ac2477f9d_cgraph">
<area shape="rect" title="Writes air parcel data to a file in various formats." alt="" coords="5,107,132,133"/>
<area shape="rect" href="mptrac_8c.html#a70603265840ed0c76957a2df53dabc5a" title="Writes air parcel data to an ASCII file or gnuplot." alt="" coords="200,5,307,32"/>
<area shape="rect" href="mptrac_8c.html#af40f268fa1f23a997abbebc49d4c88d2" title="Writes air parcel data to a binary file." alt="" coords="202,56,305,83"/>
<area shape="rect" href="mptrac_8c.html#acdc1746c0cf47f3116b471f66f6a3e0c" title="Writes air parcel data to a NetCDF file in the CLaMS format." alt="" coords="193,107,314,133"/>
<area shape="rect" href="mptrac_8c.html#a094daf77749905feec48a3e69fb779e1" title="Writes CLaMS trajectory data to a NetCDF file." alt="" coords="180,157,327,184"/>
<area shape="rect" href="mptrac_8c.html#aff66d76a0f9415997955f47edeff5b99" title="Writes air parcel data to a NetCDF file." alt="" coords="203,208,303,235"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="375,81,453,108"/>
</map>
</div>

</div>
</div>
<a id="af6582c1a228e229994f56b7e1a3ad7a4" name="af6582c1a228e229994f56b7e1a3ad7a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6582c1a228e229994f56b7e1a3ad7a4">&#9670;&nbsp;</a></span>mptrac_write_met()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_write_met </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes meteorological data to a file, supporting multiple formats and compression options. </p>
<p >This function handles writing meteorological data based on the specified control (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) and meteorological data (<code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code>) structures. The file format and compression type are determined by the <code>met_type</code> in the control structure. The function supports netCDF, binary output, and various compression methods (ZFP, ZSTD, CMS), while providing error handling for unsupported configurations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A constant character pointer representing the name of the file to write the meteorological data to. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure, which holds the configuration and control parameters for the output, including the type of meteorological data and compression method. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure that holds the meteorological data to be written to the file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function selects a timer for performance profiling or debugging.</li>
<li>It logs the action of writing meteorological data, including the file name.</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>If <code>ctl-&gt;met_type</code> is 3, ZFP compression is required, and the function will generate an error if compiled without ZFP support.</li>
<li>If <code>ctl-&gt;met_type</code> is 4, ZSTD compression is required, and the function will generate an error if compiled without ZSTD support.</li>
<li>If <code>ctl-&gt;met_type</code> is 5, CMS compression is required, and the function will generate an error if compiled without CMS support.</li>
<li>If <code>ctl-&gt;met_type</code> is 7, SZ3 compression is required, and the function will generate an error if compiled without SZ3 support.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>If <code>ctl-&gt;met_type</code> is 0, the function writes data in netCDF format via <code>write_met_nc</code>.</li>
<li>If <code>ctl-&gt;met_type</code> is between 1 and 5 or 7, the function writes data in binary format via <code>write_met_bin</code>.</li>
<li>If <code>ctl-&gt;met_type</code> is not recognized, an error message is generated.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l06838">6838</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6841</span>              {</div>
<div class="line"><span class="lineno"> 6842</span> </div>
<div class="line"><span class="lineno"> 6843</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 6844</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;WRITE_MET&quot;</span>, <span class="stringliteral">&quot;OUTPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 6845</span> </div>
<div class="line"><span class="lineno"> 6846</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 6847</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write meteo data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 6848</span> </div>
<div class="line"><span class="lineno"> 6849</span>  <span class="comment">/* Check compression flags... */</span></div>
<div class="line"><span class="lineno"> 6850</span><span class="preprocessor">#ifndef ZFP</span></div>
<div class="line"><span class="lineno"> 6851</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 3)</div>
<div class="line"><span class="lineno"> 6852</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MPTRAC was compiled without ZFP compression!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6853</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6854</span><span class="preprocessor">#ifndef ZSTD</span></div>
<div class="line"><span class="lineno"> 6855</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 4)</div>
<div class="line"><span class="lineno"> 6856</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MPTRAC was compiled without ZSTD compression!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6857</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6858</span><span class="preprocessor">#ifndef CMS</span></div>
<div class="line"><span class="lineno"> 6859</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 5)</div>
<div class="line"><span class="lineno"> 6860</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MPTRAC was compiled without cmultiscale compression!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6861</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6862</span><span class="preprocessor">#ifndef SZ3</span></div>
<div class="line"><span class="lineno"> 6863</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 7)</div>
<div class="line"><span class="lineno"> 6864</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MPTRAC was compiled without SZ3 compression!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6865</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6866</span> </div>
<div class="line"><span class="lineno"> 6867</span>  <span class="comment">/* Write netCDF data... */</span></div>
<div class="line"><span class="lineno"> 6868</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 0)</div>
<div class="line"><span class="lineno"> 6869</span>    <a class="code hl_function" href="mptrac_8c.html#a92ad405ee98c55d656f4b9fcb4957503">write_met_nc</a>(filename, ctl, met);</div>
<div class="line"><span class="lineno"> 6870</span> </div>
<div class="line"><span class="lineno"> 6871</span>  <span class="comment">/* Write binary data... */</span></div>
<div class="line"><span class="lineno"> 6872</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> &gt;= 1 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> &lt;= 7)</div>
<div class="line"><span class="lineno"> 6873</span>    <a class="code hl_function" href="mptrac_8c.html#af330c627ed04b0ae7098b89e2577e733">write_met_bin</a>(filename, ctl, met);</div>
<div class="line"><span class="lineno"> 6874</span> </div>
<div class="line"><span class="lineno"> 6875</span>  <span class="comment">/* Not implemented... */</span></div>
<div class="line"><span class="lineno"> 6876</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6877</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MET_TYPE not implemented!&quot;</span>);</div>
<div class="line"><span class="lineno"> 6878</span>}</div>
<div class="ttc" id="amptrac_8c_html_a92ad405ee98c55d656f4b9fcb4957503"><div class="ttname"><a href="mptrac_8c.html#a92ad405ee98c55d656f4b9fcb4957503">write_met_nc</a></div><div class="ttdeci">void write_met_nc(const char *filename, const ctl_t *ctl, met_t *met)</div><div class="ttdoc">Writes meteorological data to a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l12701">mptrac.c:12701</a></div></div>
<div class="ttc" id="amptrac_8c_html_af330c627ed04b0ae7098b89e2577e733"><div class="ttname"><a href="mptrac_8c.html#af330c627ed04b0ae7098b89e2577e733">write_met_bin</a></div><div class="ttdeci">void write_met_bin(const char *filename, const ctl_t *ctl, met_t *met)</div><div class="ttdoc">Writes meteorological data in binary format to a specified file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l12470">mptrac.c:12470</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_af6582c1a228e229994f56b7e1a3ad7a4_cgraph.png" border="0" usemap="#amptrac_8h_af6582c1a228e229994f56b7e1a3ad7a4_cgraph" alt=""/></div>
<map name="amptrac_8h_af6582c1a228e229994f56b7e1a3ad7a4_cgraph" id="amptrac_8h_af6582c1a228e229994f56b7e1a3ad7a4_cgraph">
<area shape="rect" title="Writes meteorological data to a file, supporting multiple formats and compression options." alt="" coords="5,132,132,159"/>
<area shape="rect" href="mptrac_8c.html#af330c627ed04b0ae7098b89e2577e733" title="Writes meteorological data in binary format to a specified file." alt="" coords="180,107,283,133"/>
<area shape="rect" href="mptrac_8c.html#a92ad405ee98c55d656f4b9fcb4957503" title="Writes meteorological data to a NetCDF file." alt="" coords="181,157,281,184"/>
<area shape="rect" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669" title="Writes a 2&#45;dimensional meteorological variable to a binary file." alt="" coords="331,56,455,83"/>
<area shape="rect" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567" title="Writes a 3&#45;dimensional meteorological variable to a binary file." alt="" coords="331,107,455,133"/>
<area shape="rect" href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14" title="Compresses or decompresses a 3&#45;D meteorological field using cmultiscale." alt="" coords="503,5,613,32"/>
<area shape="rect" href="mptrac_8c.html#a61bbe35a4ff7b797fdb64f9797a3ffd1" title="Compresses or decompresses a 3D array of floats." alt="" coords="505,56,611,83"/>
<area shape="rect" href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3" title="Compresses or decompresses a 3&#45;D float array using the SZ3 library." alt="" coords="505,107,611,133"/>
<area shape="rect" href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72" title="Compresses or decompresses a 3D array of floats using the ZFP library." alt="" coords="507,157,609,184"/>
<area shape="rect" href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c" title="Compresses or decompresses a float array using Zstandard (ZSTD)." alt="" coords="503,208,613,235"/>
<area shape="rect" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a" title="Writes a 2D meteorological variable to a NetCDF file." alt="" coords="332,157,453,184"/>
<area shape="rect" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7" title="Writes a 3D meteorological variable to a NetCDF file." alt="" coords="332,208,453,235"/>
</map>
</div>

</div>
</div>
<a id="a9abd7a8f35bf3b0c211d8212675d09b1" name="a9abd7a8f35bf3b0c211d8212675d09b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9abd7a8f35bf3b0c211d8212675d09b1">&#9670;&nbsp;</a></span>mptrac_write_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_write_output </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes various types of output data to files in a specified directory. </p>
<p >The <code>mptrac_write_output</code> function writes various types of output data to files in the directory specified by the <code>dirname</code> parameter. The function takes control parameters (<code>ctl</code>), two meteorological data structures (<code>met0</code> and <code>met1</code>), an atmospheric data structure (<code>atm</code>), and a time value (<code>t</code>) as input.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dirname</td><td>A string representing the directory path where output files will be written. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">met0</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure representing the first set of meteorological data. </td></tr>
    <tr><td class="paramname">met1</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure representing the second set of meteorological data. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure representing atmospheric data. </td></tr>
    <tr><td class="paramname">t</td><td>A double value representing the time at which the output is being written.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Parses the input time (<code>t</code>) to extract year, month, day, hour, minute, and second.</li>
<li>Updates host memory if necessary based on control parameters.</li>
<li>Writes atmospheric data to files if specified by control parameters.</li>
<li>Writes gridded data to files if specified by control parameters.</li>
<li>Writes CSI (Critical Success Index) data to files if specified by control parameters.</li>
<li>Writes ensemble data to files if specified by control parameters.</li>
<li>Writes profile data to files if specified by control parameters.</li>
<li>Writes sample data to files if specified by control parameters.</li>
<li>Writes station data to files if specified by control parameters.</li>
<li>Writes VTK (Visualization Toolkit) data to files if specified by control parameters.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function orchestrates the writing of various types of output data to files based on control parameters and the current simulation time.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l06882">6882</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6888</span>                  {</div>
<div class="line"><span class="lineno"> 6889</span> </div>
<div class="line"><span class="lineno"> 6890</span>  <span class="keywordtype">char</span> ext[10], filename[2 * <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 6891</span> </div>
<div class="line"><span class="lineno"> 6892</span>  <span class="keywordtype">double</span> r;</div>
<div class="line"><span class="lineno"> 6893</span> </div>
<div class="line"><span class="lineno"> 6894</span>  <span class="keywordtype">int</span> year, mon, day, hour, min, sec;</div>
<div class="line"><span class="lineno"> 6895</span> </div>
<div class="line"><span class="lineno"> 6896</span>  <span class="comment">/* Get time... */</span></div>
<div class="line"><span class="lineno"> 6897</span>  <a class="code hl_function" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a>(t, &amp;year, &amp;mon, &amp;day, &amp;hour, &amp;min, &amp;sec, &amp;r);</div>
<div class="line"><span class="lineno"> 6898</span> </div>
<div class="line"><span class="lineno"> 6899</span>  <span class="comment">/* Update host... */</span></div>
<div class="line"><span class="lineno"> 6900</span>  <span class="keywordflow">if</span> ((ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8b2706a512ce6a279091d8ff1b192346">atm_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span> &amp;&amp; fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aad4b256a00136fe4181077c2b02b0f45">atm_dt_out</a>) == 0)</div>
<div class="line"><span class="lineno"> 6901</span>      || (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a65f18a2f1aa44522f78fc364a0ffaf68">grid_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span> &amp;&amp; fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afe05b16d3cfa511feb4673706f6606ff">grid_dt_out</a>) == 0)</div>
<div class="line"><span class="lineno"> 6902</span>      || (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a94b0a51a5281e718f4fbd38bf5b4d340">ens_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span> &amp;&amp; fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa943823dbd2a4b5fa38e7d0cf8f9ccb0">ens_dt_out</a>) == 0)</div>
<div class="line"><span class="lineno"> 6903</span>      || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a605a1904f8ff49d178ac462f8fbecc3a">csi_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span> || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a4c8aa3a46d5a54c6ef2ca4eefdf3a1">prof_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span></div>
<div class="line"><span class="lineno"> 6904</span>      || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa974f483b6ccf931730d2d929eee2b51">sample_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span> || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af784e18ace4cd191ae100a7df4955b6b">stat_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span></div>
<div class="line"><span class="lineno"> 6905</span>      || (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac98ba3f8bc8b26ca6499ac79603de8db">vtk_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span> &amp;&amp; fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a64262df06556e7055245b9f96d317f92">vtk_dt_out</a>) == 0))</div>
<div class="line"><span class="lineno"> 6906</span>    <a class="code hl_function" href="mptrac_8c.html#a98dff5c679aa16aa2506b2f9aaea1f66">mptrac_update_host</a>(NULL, NULL, NULL, NULL, NULL, atm);</div>
<div class="line"><span class="lineno"> 6907</span> </div>
<div class="line"><span class="lineno"> 6908</span>  <span class="comment">/* Write atmospheric data... */</span></div>
<div class="line"><span class="lineno"> 6909</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8b2706a512ce6a279091d8ff1b192346">atm_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span> &amp;&amp;</div>
<div class="line"><span class="lineno"> 6910</span>      (fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aad4b256a00136fe4181077c2b02b0f45">atm_dt_out</a>) == 0 || t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a>)) {</div>
<div class="line"><span class="lineno"> 6911</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">atm_type_out</a> == 0)</div>
<div class="line"><span class="lineno"> 6912</span>      sprintf(ext, <span class="stringliteral">&quot;tab&quot;</span>);</div>
<div class="line"><span class="lineno"> 6913</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">atm_type_out</a> == 1)</div>
<div class="line"><span class="lineno"> 6914</span>      sprintf(ext, <span class="stringliteral">&quot;bin&quot;</span>);</div>
<div class="line"><span class="lineno"> 6915</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5d5c0f111d122cfcc4e3de57bc1731cd">atm_type_out</a> == 2)</div>
<div class="line"><span class="lineno"> 6916</span>      sprintf(ext, <span class="stringliteral">&quot;nc&quot;</span>);</div>
<div class="line"><span class="lineno"> 6917</span>    sprintf(filename, <span class="stringliteral">&quot;%s/%s_%04d_%02d_%02d_%02d_%02d.%s&quot;</span>,</div>
<div class="line"><span class="lineno"> 6918</span>            dirname, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8b2706a512ce6a279091d8ff1b192346">atm_basename</a>, year, mon, day, hour, min, ext);</div>
<div class="line"><span class="lineno"> 6919</span>    <a class="code hl_function" href="mptrac_8c.html#a07d1a762eeeef6c54d4dd68ac2477f9d">mptrac_write_atm</a>(filename, ctl, atm, t);</div>
<div class="line"><span class="lineno"> 6920</span>  }</div>
<div class="line"><span class="lineno"> 6921</span> </div>
<div class="line"><span class="lineno"> 6922</span>  <span class="comment">/* Write gridded data... */</span></div>
<div class="line"><span class="lineno"> 6923</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a65f18a2f1aa44522f78fc364a0ffaf68">grid_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span> &amp;&amp; fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afe05b16d3cfa511feb4673706f6606ff">grid_dt_out</a>) == 0) {</div>
<div class="line"><span class="lineno"> 6924</span>    sprintf(filename, <span class="stringliteral">&quot;%s/%s_%04d_%02d_%02d_%02d_%02d.%s&quot;</span>,</div>
<div class="line"><span class="lineno"> 6925</span>            dirname, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a65f18a2f1aa44522f78fc364a0ffaf68">grid_basename</a>, year, mon, day, hour, min,</div>
<div class="line"><span class="lineno"> 6926</span>            ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a37c580065a63c21f5421ee78e3c4b3d9">grid_type</a> == 0 ? <span class="stringliteral">&quot;tab&quot;</span> : <span class="stringliteral">&quot;nc&quot;</span>);</div>
<div class="line"><span class="lineno"> 6927</span>    <a class="code hl_function" href="mptrac_8c.html#af185d3a188bc2279135c58c8d5f24795">write_grid</a>(filename, ctl, met0, met1, atm, t);</div>
<div class="line"><span class="lineno"> 6928</span>  }</div>
<div class="line"><span class="lineno"> 6929</span> </div>
<div class="line"><span class="lineno"> 6930</span>  <span class="comment">/* Write CSI data... */</span></div>
<div class="line"><span class="lineno"> 6931</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a605a1904f8ff49d178ac462f8fbecc3a">csi_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span>) {</div>
<div class="line"><span class="lineno"> 6932</span>    sprintf(filename, <span class="stringliteral">&quot;%s/%s.tab&quot;</span>, dirname, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a605a1904f8ff49d178ac462f8fbecc3a">csi_basename</a>);</div>
<div class="line"><span class="lineno"> 6933</span>    <a class="code hl_function" href="mptrac_8c.html#afe2f86cb96a4de47d262cf7776164d46">write_csi</a>(filename, ctl, atm, t);</div>
<div class="line"><span class="lineno"> 6934</span>  }</div>
<div class="line"><span class="lineno"> 6935</span> </div>
<div class="line"><span class="lineno"> 6936</span>  <span class="comment">/* Write ensemble data... */</span></div>
<div class="line"><span class="lineno"> 6937</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a94b0a51a5281e718f4fbd38bf5b4d340">ens_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span> &amp;&amp; fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa943823dbd2a4b5fa38e7d0cf8f9ccb0">ens_dt_out</a>) == 0) {</div>
<div class="line"><span class="lineno"> 6938</span>    sprintf(filename, <span class="stringliteral">&quot;%s/%s_%04d_%02d_%02d_%02d_%02d.tab&quot;</span>,</div>
<div class="line"><span class="lineno"> 6939</span>            dirname, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a94b0a51a5281e718f4fbd38bf5b4d340">ens_basename</a>, year, mon, day, hour, min);</div>
<div class="line"><span class="lineno"> 6940</span>    <a class="code hl_function" href="mptrac_8c.html#a4036654b5bb8eaf257500214c2f0407d">write_ens</a>(filename, ctl, atm, t);</div>
<div class="line"><span class="lineno"> 6941</span>  }</div>
<div class="line"><span class="lineno"> 6942</span> </div>
<div class="line"><span class="lineno"> 6943</span>  <span class="comment">/* Write profile data... */</span></div>
<div class="line"><span class="lineno"> 6944</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a4c8aa3a46d5a54c6ef2ca4eefdf3a1">prof_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span>) {</div>
<div class="line"><span class="lineno"> 6945</span>    sprintf(filename, <span class="stringliteral">&quot;%s/%s.tab&quot;</span>, dirname, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a4c8aa3a46d5a54c6ef2ca4eefdf3a1">prof_basename</a>);</div>
<div class="line"><span class="lineno"> 6946</span>    <a class="code hl_function" href="mptrac_8c.html#a8d5476c104eaa958ba0564597bee9c3b">write_prof</a>(filename, ctl, met0, met1, atm, t);</div>
<div class="line"><span class="lineno"> 6947</span>  }</div>
<div class="line"><span class="lineno"> 6948</span> </div>
<div class="line"><span class="lineno"> 6949</span>  <span class="comment">/* Write sample data... */</span></div>
<div class="line"><span class="lineno"> 6950</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa974f483b6ccf931730d2d929eee2b51">sample_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span>) {</div>
<div class="line"><span class="lineno"> 6951</span>    sprintf(filename, <span class="stringliteral">&quot;%s/%s.tab&quot;</span>, dirname, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa974f483b6ccf931730d2d929eee2b51">sample_basename</a>);</div>
<div class="line"><span class="lineno"> 6952</span>    <a class="code hl_function" href="mptrac_8c.html#af0cd0b75f7269ad20dc88ce4114ab5f1">write_sample</a>(filename, ctl, met0, met1, atm, t);</div>
<div class="line"><span class="lineno"> 6953</span>  }</div>
<div class="line"><span class="lineno"> 6954</span> </div>
<div class="line"><span class="lineno"> 6955</span>  <span class="comment">/* Write station data... */</span></div>
<div class="line"><span class="lineno"> 6956</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af784e18ace4cd191ae100a7df4955b6b">stat_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span>) {</div>
<div class="line"><span class="lineno"> 6957</span>    sprintf(filename, <span class="stringliteral">&quot;%s/%s.tab&quot;</span>, dirname, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af784e18ace4cd191ae100a7df4955b6b">stat_basename</a>);</div>
<div class="line"><span class="lineno"> 6958</span>    <a class="code hl_function" href="mptrac_8c.html#aaf952d2078d652006af74cc8ac4cd913">write_station</a>(filename, ctl, atm, t);</div>
<div class="line"><span class="lineno"> 6959</span>  }</div>
<div class="line"><span class="lineno"> 6960</span> </div>
<div class="line"><span class="lineno"> 6961</span>  <span class="comment">/* Write VTK data... */</span></div>
<div class="line"><span class="lineno"> 6962</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac98ba3f8bc8b26ca6499ac79603de8db">vtk_basename</a>[0] != <span class="charliteral">&#39;-&#39;</span> &amp;&amp; fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a64262df06556e7055245b9f96d317f92">vtk_dt_out</a>) == 0) {</div>
<div class="line"><span class="lineno"> 6963</span>    <span class="keyword">static</span> <span class="keywordtype">int</span> nvtk;</div>
<div class="line"><span class="lineno"> 6964</span>    <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a>)</div>
<div class="line"><span class="lineno"> 6965</span>      nvtk = 0;</div>
<div class="line"><span class="lineno"> 6966</span>    sprintf(filename, <span class="stringliteral">&quot;%s/%s_%05d.vtk&quot;</span>, dirname, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac98ba3f8bc8b26ca6499ac79603de8db">vtk_basename</a>, ++nvtk);</div>
<div class="line"><span class="lineno"> 6967</span>    <a class="code hl_function" href="mptrac_8c.html#ad9cf70f782a54ee8eb8fa87c80f936d2">write_vtk</a>(filename, ctl, atm, t);</div>
<div class="line"><span class="lineno"> 6968</span>  }</div>
<div class="line"><span class="lineno"> 6969</span>}</div>
<div class="ttc" id="amptrac_8c_html_a07d1a762eeeef6c54d4dd68ac2477f9d"><div class="ttname"><a href="mptrac_8c.html#a07d1a762eeeef6c54d4dd68ac2477f9d">mptrac_write_atm</a></div><div class="ttdeci">void mptrac_write_atm(const char *filename, const ctl_t *ctl, const atm_t *atm, const double t)</div><div class="ttdoc">Writes air parcel data to a file in various formats.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l06778">mptrac.c:6778</a></div></div>
<div class="ttc" id="amptrac_8c_html_a4036654b5bb8eaf257500214c2f0407d"><div class="ttname"><a href="mptrac_8c.html#a4036654b5bb8eaf257500214c2f0407d">write_ens</a></div><div class="ttdeci">void write_ens(const char *filename, const ctl_t *ctl, const atm_t *atm, const double t)</div><div class="ttdoc">Writes ensemble data to a file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11948">mptrac.c:11948</a></div></div>
<div class="ttc" id="amptrac_8c_html_a8d5476c104eaa958ba0564597bee9c3b"><div class="ttname"><a href="mptrac_8c.html#a8d5476c104eaa958ba0564597bee9c3b">write_prof</a></div><div class="ttdeci">void write_prof(const char *filename, const ctl_t *ctl, met_t *met0, met_t *met1, const atm_t *atm, const double t)</div><div class="ttdoc">Writes profile data to a specified file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l12924">mptrac.c:12924</a></div></div>
<div class="ttc" id="amptrac_8c_html_a98dff5c679aa16aa2506b2f9aaea1f66"><div class="ttname"><a href="mptrac_8c.html#a98dff5c679aa16aa2506b2f9aaea1f66">mptrac_update_host</a></div><div class="ttdeci">void mptrac_update_host(const ctl_t *ctl, const cache_t *cache, const clim_t *clim, met_t **met0, met_t **met1, const atm_t *atm)</div><div class="ttdoc">Updates host memory for specified data structures.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l06722">mptrac.c:6722</a></div></div>
<div class="ttc" id="amptrac_8c_html_aaf952d2078d652006af74cc8ac4cd913"><div class="ttname"><a href="mptrac_8c.html#aaf952d2078d652006af74cc8ac4cd913">write_station</a></div><div class="ttdeci">void write_station(const char *filename, const ctl_t *ctl, atm_t *atm, const double t)</div><div class="ttdoc">Writes station data to a specified file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l13313">mptrac.c:13313</a></div></div>
<div class="ttc" id="amptrac_8c_html_ad9cf70f782a54ee8eb8fa87c80f936d2"><div class="ttname"><a href="mptrac_8c.html#ad9cf70f782a54ee8eb8fa87c80f936d2">write_vtk</a></div><div class="ttdeci">void write_vtk(const char *filename, const ctl_t *ctl, const atm_t *atm, const double t)</div><div class="ttdoc">Writes VTK (Visualization Toolkit) data to a specified file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l13399">mptrac.c:13399</a></div></div>
<div class="ttc" id="amptrac_8c_html_af0cd0b75f7269ad20dc88ce4114ab5f1"><div class="ttname"><a href="mptrac_8c.html#af0cd0b75f7269ad20dc88ce4114ab5f1">write_sample</a></div><div class="ttdeci">void write_sample(const char *filename, const ctl_t *ctl, met_t *met0, met_t *met1, const atm_t *atm, const double t)</div><div class="ttdoc">Writes sample data to a specified file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l13151">mptrac.c:13151</a></div></div>
<div class="ttc" id="amptrac_8c_html_af185d3a188bc2279135c58c8d5f24795"><div class="ttname"><a href="mptrac_8c.html#af185d3a188bc2279135c58c8d5f24795">write_grid</a></div><div class="ttdeci">void write_grid(const char *filename, const ctl_t *ctl, met_t *met0, met_t *met1, const atm_t *atm, const double t)</div><div class="ttdoc">Writes grid data to a file in ASCII or netCDF format.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l12045">mptrac.c:12045</a></div></div>
<div class="ttc" id="amptrac_8c_html_afe2f86cb96a4de47d262cf7776164d46"><div class="ttname"><a href="mptrac_8c.html#afe2f86cb96a4de47d262cf7776164d46">write_csi</a></div><div class="ttdeci">void write_csi(const char *filename, const ctl_t *ctl, const atm_t *atm, const double t)</div><div class="ttdoc">Writes Critical Success Index (CSI) data to a file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11673">mptrac.c:11673</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a9abd7a8f35bf3b0c211d8212675d09b1_cgraph.png" border="0" usemap="#amptrac_8h_a9abd7a8f35bf3b0c211d8212675d09b1_cgraph" alt=""/></div>
<map name="amptrac_8h_a9abd7a8f35bf3b0c211d8212675d09b1_cgraph" id="amptrac_8h_a9abd7a8f35bf3b0c211d8212675d09b1_cgraph">
<area shape="rect" title="Writes various types of output data to files in a specified directory." alt="" coords="5,519,145,545"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="609,215,688,241"/>
<area shape="rect" href="mptrac_8c.html#a98dff5c679aa16aa2506b2f9aaea1f66" title="Updates host memory for specified data structures." alt="" coords="193,696,333,723"/>
<area shape="rect" href="mptrac_8c.html#a07d1a762eeeef6c54d4dd68ac2477f9d" title="Writes air parcel data to a file in various formats." alt="" coords="200,164,327,191"/>
<area shape="rect" href="mptrac_8c.html#afe2f86cb96a4de47d262cf7776164d46" title="Writes Critical Success Index (CSI) data to a file." alt="" coords="226,443,301,469"/>
<area shape="rect" href="mptrac_8c.html#a4036654b5bb8eaf257500214c2f0407d" title="Writes ensemble data to a file." alt="" coords="224,645,303,672"/>
<area shape="rect" href="mptrac_8c.html#af185d3a188bc2279135c58c8d5f24795" title="Writes grid data to a file in ASCII or netCDF format." alt="" coords="224,392,303,419"/>
<area shape="rect" href="mptrac_8c.html#a8d5476c104eaa958ba0564597bee9c3b" title="Writes profile data to a specified file." alt="" coords="224,544,303,571"/>
<area shape="rect" href="mptrac_8c.html#af0cd0b75f7269ad20dc88ce4114ab5f1" title="Writes sample data to a specified file." alt="" coords="214,493,313,520"/>
<area shape="rect" href="mptrac_8c.html#aaf952d2078d652006af74cc8ac4cd913" title="Writes station data to a specified file." alt="" coords="215,595,311,621"/>
<area shape="rect" href="mptrac_8c.html#ad9cf70f782a54ee8eb8fa87c80f936d2" title="Writes VTK (Visualization Toolkit) data to a specified file." alt="" coords="226,747,301,773"/>
<area shape="rect" href="mptrac_8c.html#a70603265840ed0c76957a2df53dabc5a" title="Writes air parcel data to an ASCII file or gnuplot." alt="" coords="401,240,508,267"/>
<area shape="rect" href="mptrac_8c.html#af40f268fa1f23a997abbebc49d4c88d2" title="Writes air parcel data to a binary file." alt="" coords="403,139,506,165"/>
<area shape="rect" href="mptrac_8c.html#acdc1746c0cf47f3116b471f66f6a3e0c" title="Writes air parcel data to a NetCDF file in the CLaMS format." alt="" coords="394,37,515,64"/>
<area shape="rect" href="mptrac_8c.html#a094daf77749905feec48a3e69fb779e1" title="Writes CLaMS trajectory data to a NetCDF file." alt="" coords="381,189,528,216"/>
<area shape="rect" href="mptrac_8c.html#aff66d76a0f9415997955f47edeff5b99" title="Writes air parcel data to a NetCDF file." alt="" coords="405,88,505,115"/>
<area shape="rect" href="mptrac_8c.html#ae61cf973263fcc45574daa27d0dec8cd" title="Calculates the kernel weight based on altitude and given kernel data." alt="" coords="403,392,506,419"/>
<area shape="rect" href="mptrac_8c.html#a7a3277ab872141360b876c25b5643ba6" title="Reads kernel function data from a file and populates the provided arrays." alt="" coords="410,443,499,469"/>
<area shape="rect" href="mptrac_8c.html#a1365b8fd93db0fc3fe4c467107710d03" title="Reads observation data from a file and stores it in arrays." alt="" coords="417,544,492,571"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="802,424,877,451"/>
<area shape="rect" href="mptrac_8c.html#a29da9a205ad3577ba3890f3e1e4350c3" title="Reads observation data from an ASCII file." alt="" coords="597,588,700,615"/>
<area shape="rect" href="mptrac_8c.html#a4536a82b3dc62081d26114c1250b1427" title="Reads observation data from a NetCDF file." alt="" coords="601,537,697,564"/>
<area shape="rect" href="mptrac_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4" title="State variables of cuRAND random number generator." alt="" coords="419,645,491,672"/>
<area shape="rect" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="419,595,491,621"/>
<area shape="rect" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6" title="Interpolates meteorological data in 3D space and time." alt="" coords="387,493,522,520"/>
<area shape="rect" href="mptrac_8c.html#a543c818eac1224703400c9554104d643" title="Writes grid data to an ASCII file." alt="" coords="401,291,508,317"/>
<area shape="rect" href="mptrac_8c.html#ae0a8f7561c1902f48e3ba8e9731eba9f" title="Writes grid data to a NetCDF file." alt="" coords="405,341,504,368"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="576,475,721,501"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="769,525,909,552"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="798,475,881,501"/>
</map>
</div>

</div>
</div>
<a id="a55562b13a38a124b0abc09ce8511dde9" name="a55562b13a38a124b0abc09ce8511dde9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55562b13a38a124b0abc09ce8511dde9">&#9670;&nbsp;</a></span>mptrac_update_device()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_update_device </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> **&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> **&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates device memory for specified data structures. </p>
<p >This function updates the GPU memory with the data from the provided host data structures (<code>ctl</code>, <code>cache</code>, <code>clim</code>, <code>atm</code>) using OpenACC directives. It ensures that the host data is transferred to the device for further computation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure. If not <code>NULL</code>, the corresponding device memory for <code>ctl</code> is updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cache</td><td>Pointer to the <code><a class="el" href="structcache__t.html" title="Cache data structure.">cache_t</a></code> structure. If not <code>NULL</code>, the corresponding device memory for <code>cache</code> is updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clim</td><td>Pointer to the <code><a class="el" href="structclim__t.html" title="Climatological data.">clim_t</a></code> structure. If not <code>NULL</code>, the corresponding device memory for <code>clim</code> is updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met0</td><td>Pointer to the first <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure. If not <code>NULL</code>, the corresponding device memory for <code>met0</code> is updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met1</td><td>Pointer to the second <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure. If not <code>NULL</code>, the corresponding device memory for <code>met1</code> is updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Pointer to the <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure. If not <code>NULL</code>, the corresponding device memory for <code>atm</code> is updated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function assumes that OpenACC is enabled and uses the <code>#pragma acc update</code> directive for device memory synchronization. Each update operation is wrapped with a timer labeled as "UPDATE_DEVICE" for performance tracking.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure that the pointers passed to this function are valid and properly initialized before calling this function. Passing invalid or uninitialized pointers may lead to undefined behavior.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l06666">6666</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6672</span>                    {</div>
<div class="line"><span class="lineno"> 6673</span> </div>
<div class="line"><span class="lineno"> 6674</span>  <span class="comment">/* Update GPU... */</span></div>
<div class="line"><span class="lineno"> 6675</span>  <span class="keywordflow">if</span> (ctl != NULL) {</div>
<div class="line"><span class="lineno"> 6676</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6677</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_DEVICE&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6678</span><span class="preprocessor">#pragma acc update device(ctl[:1])</span></div>
<div class="line"><span class="lineno"> 6679</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6680</span>  }</div>
<div class="line"><span class="lineno"> 6681</span> </div>
<div class="line"><span class="lineno"> 6682</span>  <span class="keywordflow">if</span> (cache != NULL) {</div>
<div class="line"><span class="lineno"> 6683</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6684</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_DEVICE&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6685</span><span class="preprocessor">#pragma acc update device(cache[:1])</span></div>
<div class="line"><span class="lineno"> 6686</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6687</span>  }</div>
<div class="line"><span class="lineno"> 6688</span> </div>
<div class="line"><span class="lineno"> 6689</span>  <span class="keywordflow">if</span> (clim != NULL) {</div>
<div class="line"><span class="lineno"> 6690</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6691</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_DEVICE&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6692</span><span class="preprocessor">#pragma acc update device(clim[:1])</span></div>
<div class="line"><span class="lineno"> 6693</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6694</span>  }</div>
<div class="line"><span class="lineno"> 6695</span> </div>
<div class="line"><span class="lineno"> 6696</span>  <span class="keywordflow">if</span> (met0 != NULL) {</div>
<div class="line"><span class="lineno"> 6697</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6698</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_DEVICE&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6699</span>    <a class="code hl_struct" href="structmet__t.html">met_t</a> *met0up = *met0;</div>
<div class="line"><span class="lineno"> 6700</span><span class="preprocessor">#pragma acc update device(met0up[:1])</span></div>
<div class="line"><span class="lineno"> 6701</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6702</span>  }</div>
<div class="line"><span class="lineno"> 6703</span> </div>
<div class="line"><span class="lineno"> 6704</span>  <span class="keywordflow">if</span> (met1 != NULL) {</div>
<div class="line"><span class="lineno"> 6705</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6706</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_DEVICE&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6707</span>    <a class="code hl_struct" href="structmet__t.html">met_t</a> *met1up = *met1;</div>
<div class="line"><span class="lineno"> 6708</span><span class="preprocessor">#pragma acc update device(met1up[:1])</span></div>
<div class="line"><span class="lineno"> 6709</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6710</span>  }</div>
<div class="line"><span class="lineno"> 6711</span> </div>
<div class="line"><span class="lineno"> 6712</span>  <span class="keywordflow">if</span> (atm != NULL) {</div>
<div class="line"><span class="lineno"> 6713</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6714</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_DEVICE&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6715</span><span class="preprocessor">#pragma acc update device(atm[:1])</span></div>
<div class="line"><span class="lineno"> 6716</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6717</span>  }</div>
<div class="line"><span class="lineno"> 6718</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a98dff5c679aa16aa2506b2f9aaea1f66" name="a98dff5c679aa16aa2506b2f9aaea1f66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98dff5c679aa16aa2506b2f9aaea1f66">&#9670;&nbsp;</a></span>mptrac_update_host()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mptrac_update_host </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcache__t.html">cache_t</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> **&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> **&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates host memory for specified data structures. </p>
<p >This function transfers data from the device (GPU) memory back to the host memory for the provided data structures (<code>ctl</code>, <code>cache</code>, <code>clim</code>, <code>atm</code>) using OpenACC directives. It ensures that the latest data from the device is synchronized with the host.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure. If not <code>NULL</code>, the corresponding host memory for <code>ctl</code> is updated from the device. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cache</td><td>Pointer to the <code><a class="el" href="structcache__t.html" title="Cache data structure.">cache_t</a></code> structure. If not <code>NULL</code>, the corresponding host memory for <code>cache</code> is updated from the device. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clim</td><td>Pointer to the <code><a class="el" href="structclim__t.html" title="Climatological data.">clim_t</a></code> structure. If not <code>NULL</code>, the corresponding host memory for <code>clim</code> is updated from the device. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met0</td><td>Pointer to the first <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure. If not <code>NULL</code>, the corresponding host memory for <code>met0</code> is updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met1</td><td>Pointer to the second <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure. If not <code>NULL</code>, the corresponding host memory for <code>met1</code> is updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Pointer to the <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure. If not <code>NULL</code>, the corresponding host memory for <code>atm</code> is updated from the device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function assumes that OpenACC is enabled and uses the <code>#pragma acc update</code> directive for host memory synchronization. Each update operation is wrapped with a timer labeled as "UPDATE_HOST" for performance tracking.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure that the pointers passed to this function are valid and properly initialized before calling this function</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l06722">6722</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6728</span>                    {</div>
<div class="line"><span class="lineno"> 6729</span> </div>
<div class="line"><span class="lineno"> 6730</span>  <span class="comment">/* Update GPU... */</span></div>
<div class="line"><span class="lineno"> 6731</span>  <span class="keywordflow">if</span> (ctl != NULL) {</div>
<div class="line"><span class="lineno"> 6732</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6733</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_HOST&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6734</span><span class="preprocessor">#pragma acc update host(ctl[:1])</span></div>
<div class="line"><span class="lineno"> 6735</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6736</span>  }</div>
<div class="line"><span class="lineno"> 6737</span> </div>
<div class="line"><span class="lineno"> 6738</span>  <span class="keywordflow">if</span> (cache != NULL) {</div>
<div class="line"><span class="lineno"> 6739</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6740</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_HOST&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6741</span><span class="preprocessor">#pragma acc update host(cache[:1])</span></div>
<div class="line"><span class="lineno"> 6742</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6743</span>  }</div>
<div class="line"><span class="lineno"> 6744</span> </div>
<div class="line"><span class="lineno"> 6745</span>  <span class="keywordflow">if</span> (clim != NULL) {</div>
<div class="line"><span class="lineno"> 6746</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6747</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_HOST&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6748</span><span class="preprocessor">#pragma acc update host(clim[:1])</span></div>
<div class="line"><span class="lineno"> 6749</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6750</span>  }</div>
<div class="line"><span class="lineno"> 6751</span> </div>
<div class="line"><span class="lineno"> 6752</span>  <span class="keywordflow">if</span> (met0 != NULL) {</div>
<div class="line"><span class="lineno"> 6753</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6754</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_DEVICE&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6755</span>    <a class="code hl_struct" href="structmet__t.html">met_t</a> *met0up = *met0;</div>
<div class="line"><span class="lineno"> 6756</span><span class="preprocessor">#pragma acc update host(met0up[:1])</span></div>
<div class="line"><span class="lineno"> 6757</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6758</span>  }</div>
<div class="line"><span class="lineno"> 6759</span> </div>
<div class="line"><span class="lineno"> 6760</span>  <span class="keywordflow">if</span> (met1 != NULL) {</div>
<div class="line"><span class="lineno"> 6761</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6762</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_DEVICE&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6763</span>    <a class="code hl_struct" href="structmet__t.html">met_t</a> *met1up = *met1;</div>
<div class="line"><span class="lineno"> 6764</span><span class="preprocessor">#pragma acc update host(met1up[:1])</span></div>
<div class="line"><span class="lineno"> 6765</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6766</span>  }</div>
<div class="line"><span class="lineno"> 6767</span> </div>
<div class="line"><span class="lineno"> 6768</span>  <span class="keywordflow">if</span> (atm != NULL) {</div>
<div class="line"><span class="lineno"> 6769</span><span class="preprocessor">#ifdef _OPENACC</span></div>
<div class="line"><span class="lineno"> 6770</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;UPDATE_HOST&quot;</span>, <span class="stringliteral">&quot;MEMORY&quot;</span>);</div>
<div class="line"><span class="lineno"> 6771</span><span class="preprocessor">#pragma acc update host(atm[:1])</span></div>
<div class="line"><span class="lineno"> 6772</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 6773</span>  }</div>
<div class="line"><span class="lineno"> 6774</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a623b433e01381315e5d49fc4c2bc3548" name="a623b433e01381315e5d49fc4c2bc3548"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a623b433e01381315e5d49fc4c2bc3548">&#9670;&nbsp;</a></span>nat_temperature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nat_temperature </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>h2o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>hno3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the nitric acid trihydrate (NAT) temperature. </p>
<p >This function computes the temperature at which nitric acid trihydrate (NAT) can form given the partial pressures of water vapor and nitric acid in the atmosphere.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The total atmospheric pressure (in hPa). </td></tr>
    <tr><td class="paramname">h2o</td><td>The volume mixing ratio of water vapor (H2O). </td></tr>
    <tr><td class="paramname">hno3</td><td>The volume mixing ratio of nitric acid (HNO3). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The NAT temperature (in Kelvin).</dd></dl>
<p>This function follows these steps:</p><ul>
<li>Ensures the water vapor volume mixing ratio is above a minimum threshold.</li>
<li>Converts the volume mixing ratios of H2O and HNO3 to partial pressures.</li>
<li>Uses these partial pressures to compute coefficients for the quadratic equation that determines the NAT temperature.</li>
<li>Solves the quadratic equation to find the NAT temperature.</li>
</ul>
<p >The calculations are based on empirical relationships involving logarithms of the partial pressures of H2O and HNO3.</p>
<dl class="section note"><dt>Note</dt><dd>The constants and formulae used are specific to the context of atmospheric chemistry and the formation of NAT.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l06973">6973</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6976</span>                     {</div>
<div class="line"><span class="lineno"> 6977</span> </div>
<div class="line"><span class="lineno"> 6978</span>  <span class="comment">/* Check water vapor volume mixing ratio... */</span></div>
<div class="line"><span class="lineno"> 6979</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> h2o_help = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(h2o, 0.1e-6);</div>
<div class="line"><span class="lineno"> 6980</span> </div>
<div class="line"><span class="lineno"> 6981</span>  <span class="comment">/* Calculate T_NAT... */</span></div>
<div class="line"><span class="lineno"> 6982</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> p_hno3 = hno3 * p / 1.333224;</div>
<div class="line"><span class="lineno"> 6983</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> p_h2o = h2o_help * p / 1.333224;</div>
<div class="line"><span class="lineno"> 6984</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> a = 0.009179 - 0.00088 * log10(p_h2o);</div>
<div class="line"><span class="lineno"> 6985</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> b = (38.9855 - log10(p_hno3) - 2.7836 * log10(p_h2o)) / a;</div>
<div class="line"><span class="lineno"> 6986</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> c = -11397.0 / a;</div>
<div class="line"><span class="lineno"> 6987</span>  <span class="keywordtype">double</span> tnat = (-b + sqrt(b * b - 4. * c)) / 2.;</div>
<div class="line"><span class="lineno"> 6988</span>  <span class="keywordtype">double</span> x2 = (-b - sqrt(b * b - 4. * c)) / 2.;</div>
<div class="line"><span class="lineno"> 6989</span>  <span class="keywordflow">if</span> (x2 &gt; 0)</div>
<div class="line"><span class="lineno"> 6990</span>    tnat = x2;</div>
<div class="line"><span class="lineno"> 6991</span> </div>
<div class="line"><span class="lineno"> 6992</span>  <span class="keywordflow">return</span> tnat;</div>
<div class="line"><span class="lineno"> 6993</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0ce53cb5230060c17ee4766ca910e79" name="ae0ce53cb5230060c17ee4766ca910e79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0ce53cb5230060c17ee4766ca910e79">&#9670;&nbsp;</a></span>pbl_weight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double pbl_weight </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>pbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>ps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes a weighting factor based on planetary boundary layer pressure. </p>
<p >This function calculates a weighting factor that determines the contribution of a pressure level to processes within the planetary boundary layer. The factor is based on the relative position of the pressure within a linear transition range defined by <code>pbl</code> and <code>ps</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure containing configuration parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>Pointer to the atmospheric data structure containing pressure levels. </td></tr>
    <tr><td class="paramname">ip</td><td>Index of the pressure level in the atmospheric data array. </td></tr>
    <tr><td class="paramname">pbl</td><td>Pressure at the planetary boundary layer. </td></tr>
    <tr><td class="paramname">ps</td><td>Surface pressure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Weighting factor for the specified pressure level:<ul>
<li>Returns 1.0 if the pressure is above the upper boundary (<code>p0</code>).</li>
<li>Returns 0.0 if the pressure is below the lower boundary (<code>p1</code>).</li>
<li>Returns a linearly interpolated value between 1.0 and 0.0 for pressures within the transition range.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l06997">6997</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7002</span>                   {</div>
<div class="line"><span class="lineno"> 7003</span> </div>
<div class="line"><span class="lineno"> 7004</span>  <span class="comment">/* Get pressure range... */</span></div>
<div class="line"><span class="lineno"> 7005</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> p1 = pbl - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9478265650dbad91e098fd4bd95d6ff5">conv_pbl_trans</a> * (ps - pbl);</div>
<div class="line"><span class="lineno"> 7006</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> p0 = pbl;</div>
<div class="line"><span class="lineno"> 7007</span> </div>
<div class="line"><span class="lineno"> 7008</span>  <span class="comment">/* Get weighting factor... */</span></div>
<div class="line"><span class="lineno"> 7009</span>  <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &gt; p0)</div>
<div class="line"><span class="lineno"> 7010</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 7011</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &lt; p1)</div>
<div class="line"><span class="lineno"> 7012</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7013</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 7014</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(p0, 1.0, p1, 0.0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]);</div>
<div class="line"><span class="lineno"> 7015</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af0092541e8eb2c51fc9a3fcd98043f3f" name="af0092541e8eb2c51fc9a3fcd98043f3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0092541e8eb2c51fc9a3fcd98043f3f">&#9670;&nbsp;</a></span>read_atm_asc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_atm_asc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads air parcel data from an ASCII file and populates the given atmospheric structure. </p>
<p >This function reads air parcel data from an ASCII file and stores the data in the provided <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure. It reads each line of the file, extracts the necessary data fields, and converts the altitude to pressure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The name of the ASCII file containing the atmospheric data. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to the control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) that specifies the number of quantities. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to the atmospheric structure (<code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code>) that will be populated with the data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 on success, and 0 on failure.</dd></dl>
<p>This function performs the following steps:</p><ul>
<li>Attempts to open the specified file for reading.</li>
<li>Logs a warning and returns 0 if the file cannot be opened.</li>
<li>Reads each line of the file and extracts data values for time, altitude, longitude, latitude, and other specified quantities.</li>
<li>Converts the altitude to pressure.</li>
<li>Increments the data point counter.</li>
<li>Checks if the number of data points exceeds the maximum allowed (<code>NP</code>) and logs an error message if so.</li>
<li>Closes the file after reading all data.</li>
<li>Returns 1 to indicate successful data reading.</li>
</ul>
<p >The function utilizes several macros and helper functions:</p><ul>
<li><code>WARN</code> for logging warnings.</li>
<li><code>ERRMSG</code> for handling error messages.</li>
<li><code>TOK</code> for tokenizing and reading values from the line.</li>
<li><code>P</code> for converting altitude to pressure.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07019">7019</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7022</span>              {</div>
<div class="line"><span class="lineno"> 7023</span> </div>
<div class="line"><span class="lineno"> 7024</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 7025</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 7026</span>  <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>))) {</div>
<div class="line"><span class="lineno"> 7027</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7028</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7029</span>  }</div>
<div class="line"><span class="lineno"> 7030</span> </div>
<div class="line"><span class="lineno"> 7031</span>  <span class="comment">/* Read line... */</span></div>
<div class="line"><span class="lineno"> 7032</span>  <span class="keywordtype">char</span> line[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 7033</span>  <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in)) {</div>
<div class="line"><span class="lineno"> 7034</span> </div>
<div class="line"><span class="lineno"> 7035</span>    <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 7036</span>    <span class="keywordtype">char</span> *tok;</div>
<div class="line"><span class="lineno"> 7037</span>    <a class="code hl_define" href="mptrac_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(line, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 7038</span>    <a class="code hl_define" href="mptrac_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 7039</span>    <a class="code hl_define" href="mptrac_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 7040</span>    <a class="code hl_define" href="mptrac_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 7041</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno"> 7042</span>      <a class="code hl_define" href="mptrac_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a>(NULL, tok, <span class="stringliteral">&quot;%lg&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq][atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 7043</span> </div>
<div class="line"><span class="lineno"> 7044</span>    <span class="comment">/* Convert altitude to pressure... */</span></div>
<div class="line"><span class="lineno"> 7045</span>    atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>] = <a class="code hl_define" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>]);</div>
<div class="line"><span class="lineno"> 7046</span> </div>
<div class="line"><span class="lineno"> 7047</span>    <span class="comment">/* Increment data point counter... */</span></div>
<div class="line"><span class="lineno"> 7048</span>    <span class="keywordflow">if</span> ((++atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>) &gt; <a class="code hl_define" href="mptrac_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a>)</div>
<div class="line"><span class="lineno"> 7049</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many data points!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7050</span>  }</div>
<div class="line"><span class="lineno"> 7051</span> </div>
<div class="line"><span class="lineno"> 7052</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7053</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 7054</span> </div>
<div class="line"><span class="lineno"> 7055</span>  <span class="comment">/* Return success... */</span></div>
<div class="line"><span class="lineno"> 7056</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 7057</span>}</div>
<div class="ttc" id="amptrac_8h_html_a8b61d1304377b77925b2802459ddae98"><div class="ttname"><a href="mptrac_8h.html#a8b61d1304377b77925b2802459ddae98">TOK</a></div><div class="ttdeci">#define TOK(line, tok, format, var)</div><div class="ttdoc">Get string tokens.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01833">mptrac.h:1833</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac51355e97453a01a70446623d0c382e5" name="ac51355e97453a01a70446623d0c382e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac51355e97453a01a70446623d0c382e5">&#9670;&nbsp;</a></span>read_atm_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_atm_bin </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads air parcel data from a binary file and populates the given atmospheric structure. </p>
<p >This function reads air parcel data from a binary file and stores the data in the provided <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure. It checks the version of the binary data, reads the data values, and verifies the integrity of the data read.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The name of the binary file containing the atmospheric data. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to the control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) that specifies the number of quantities. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to the atmospheric structure (<code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code>) that will be populated with the data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 on success, and 0 on failure.</dd></dl>
<p>This function performs the following steps:</p><ul>
<li>Attempts to open the specified file for reading.</li>
<li>Returns 0 if the file cannot be opened.</li>
<li>Checks the version of the binary data and logs an error message if the version is incorrect.</li>
<li>Reads the number of data points (<code>np</code>).</li>
<li>Reads the data arrays for time, pressure, longitude, latitude, and other specified quantities.</li>
<li>Checks a final flag to ensure the data was read correctly.</li>
<li>Logs an error message if the final flag is incorrect.</li>
<li>Closes the file after reading all data.</li>
<li>Returns 1 to indicate successful data reading.</li>
</ul>
<p >The function utilizes several macros and helper functions:</p><ul>
<li><code>ERRMSG</code> for handling error messages.</li>
<li><code>FREAD</code> for reading data from the binary file.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07061">7061</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7064</span>              {</div>
<div class="line"><span class="lineno"> 7065</span> </div>
<div class="line"><span class="lineno"> 7066</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 7067</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 7068</span>  <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno"> 7069</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7070</span> </div>
<div class="line"><span class="lineno"> 7071</span>  <span class="comment">/* Check version of binary data... */</span></div>
<div class="line"><span class="lineno"> 7072</span>  <span class="keywordtype">int</span> version;</div>
<div class="line"><span class="lineno"> 7073</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;version, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7074</span>        1,</div>
<div class="line"><span class="lineno"> 7075</span>        in);</div>
<div class="line"><span class="lineno"> 7076</span>  <span class="keywordflow">if</span> (version != 100)</div>
<div class="line"><span class="lineno"> 7077</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Wrong version of binary data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7078</span> </div>
<div class="line"><span class="lineno"> 7079</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 7080</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7081</span>        1,</div>
<div class="line"><span class="lineno"> 7082</span>        in);</div>
<div class="line"><span class="lineno"> 7083</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7084</span>          (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>,</div>
<div class="line"><span class="lineno"> 7085</span>        in);</div>
<div class="line"><span class="lineno"> 7086</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7087</span>          (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>,</div>
<div class="line"><span class="lineno"> 7088</span>        in);</div>
<div class="line"><span class="lineno"> 7089</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7090</span>          (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>,</div>
<div class="line"><span class="lineno"> 7091</span>        in);</div>
<div class="line"><span class="lineno"> 7092</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7093</span>          (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>,</div>
<div class="line"><span class="lineno"> 7094</span>        in);</div>
<div class="line"><span class="lineno"> 7095</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno"> 7096</span>    <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7097</span>            (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>,</div>
<div class="line"><span class="lineno"> 7098</span>          in);</div>
<div class="line"><span class="lineno"> 7099</span> </div>
<div class="line"><span class="lineno"> 7100</span>  <span class="comment">/* Read final flag... */</span></div>
<div class="line"><span class="lineno"> 7101</span>  <span class="keywordtype">int</span> <span class="keyword">final</span>;</div>
<div class="line"><span class="lineno"> 7102</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;<span class="keyword">final</span>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7103</span>        1,</div>
<div class="line"><span class="lineno"> 7104</span>        in);</div>
<div class="line"><span class="lineno"> 7105</span>  <span class="keywordflow">if</span> (<span class="keyword">final</span> != 999)</div>
<div class="line"><span class="lineno"> 7106</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Error while reading binary data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7107</span> </div>
<div class="line"><span class="lineno"> 7108</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7109</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 7110</span> </div>
<div class="line"><span class="lineno"> 7111</span>  <span class="comment">/* Return success... */</span></div>
<div class="line"><span class="lineno"> 7112</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 7113</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad55d18eefcfa90b7c40d4a37dbb8fbf0" name="ad55d18eefcfa90b7c40d4a37dbb8fbf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad55d18eefcfa90b7c40d4a37dbb8fbf0">&#9670;&nbsp;</a></span>read_atm_clams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_atm_clams </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads atmospheric data from a CLAMS NetCDF file. </p>
<p >This function opens a NetCDF file, reads various atmospheric parameters, and stores them in the provided <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure. It handles both zeta and pressure coordinate systems depending on the control settings.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Path to the NetCDF file containing atmospheric data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the control structure containing configuration settings. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">atm</td><td>Pointer to the atmospheric data structure where the data will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 on success, 0 on failure.</dd></dl>
<ul>
<li>Opens the NetCDF file in read-only mode.</li>
<li>Retrieves the number of particles (<code>NPARTS</code>).</li>
<li>Reads initial time (<code>TIME_INIT</code>) or falls back to <code>time</code> if unavailable.</li>
<li>Depending on <code>ctl-&gt;advect_vert_coord</code>, reads <code>ZETA</code> and optionally <code>PRESS</code>, or reads <code>PRESS_INIT</code> with fallback to <code>PRESS</code>.</li>
<li>Reads longitude (<code>LON</code>) and latitude (<code>LAT</code>).</li>
<li>Closes the NetCDF file before returning.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07117">7117</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7120</span>              {</div>
<div class="line"><span class="lineno"> 7121</span> </div>
<div class="line"><span class="lineno"> 7122</span>  <span class="keywordtype">int</span> ncid, varid;</div>
<div class="line"><span class="lineno"> 7123</span> </div>
<div class="line"><span class="lineno"> 7124</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 7125</span>  <span class="keywordflow">if</span> (nc_open(filename, NC_NOWRITE, &amp;ncid) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 7126</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7127</span> </div>
<div class="line"><span class="lineno"> 7128</span>  <span class="comment">/* Get dimensions... */</span></div>
<div class="line"><span class="lineno"> 7129</span>  <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;NPARTS&quot;</span>, &amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <a class="code hl_define" href="mptrac_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a>, 1);</div>
<div class="line"><span class="lineno"> 7130</span> </div>
<div class="line"><span class="lineno"> 7131</span>  <span class="comment">/* Get time... */</span></div>
<div class="line"><span class="lineno"> 7132</span>  <span class="keywordflow">if</span> (nc_inq_varid(ncid, <span class="stringliteral">&quot;TIME_INIT&quot;</span>, &amp;varid) == NC_NOERR) {</div>
<div class="line"><span class="lineno"> 7133</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_var_double(ncid, varid, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>));</div>
<div class="line"><span class="lineno"> 7134</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7135</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;TIME_INIT not found use time instead!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7136</span>    <span class="keywordtype">double</span> time_init;</div>
<div class="line"><span class="lineno"> 7137</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;time&quot;</span>, &amp;time_init, 1);</div>
<div class="line"><span class="lineno"> 7138</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 7139</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] = time_init;</div>
<div class="line"><span class="lineno"> 7140</span>    }</div>
<div class="line"><span class="lineno"> 7141</span>  }</div>
<div class="line"><span class="lineno"> 7142</span> </div>
<div class="line"><span class="lineno"> 7143</span>  <span class="comment">/* Read zeta coordinate, pressure is optional... */</span></div>
<div class="line"><span class="lineno"> 7144</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 1) {</div>
<div class="line"><span class="lineno"> 7145</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;ZETA&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9382d9e9b29e10eeee582e1e10ff365a">qnt_zeta</a>], 1);</div>
<div class="line"><span class="lineno"> 7146</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;PRESS&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, 0);</div>
<div class="line"><span class="lineno"> 7147</span>  }</div>
<div class="line"><span class="lineno"> 7148</span> </div>
<div class="line"><span class="lineno"> 7149</span>  <span class="comment">/* Read pressure, zeta coordinate is optional... */</span></div>
<div class="line"><span class="lineno"> 7150</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7151</span>    <span class="keywordflow">if</span> (nc_inq_varid(ncid, <span class="stringliteral">&quot;PRESS_INIT&quot;</span>, &amp;varid) == NC_NOERR) {</div>
<div class="line"><span class="lineno"> 7152</span>      <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_var_double(ncid, varid, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>));</div>
<div class="line"><span class="lineno"> 7153</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7154</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;PRESS_INIT not found use PRESS instead!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7155</span>      nc_inq_varid(ncid, <span class="stringliteral">&quot;PRESS&quot;</span>, &amp;varid);</div>
<div class="line"><span class="lineno"> 7156</span>      <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_var_double(ncid, varid, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>));</div>
<div class="line"><span class="lineno"> 7157</span>    }</div>
<div class="line"><span class="lineno"> 7158</span>  }</div>
<div class="line"><span class="lineno"> 7159</span> </div>
<div class="line"><span class="lineno"> 7160</span>  <span class="comment">/* Read further quantities if requested... */</span></div>
<div class="line"><span class="lineno"> 7161</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno"> 7162</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq], 0);</div>
<div class="line"><span class="lineno"> 7163</span> </div>
<div class="line"><span class="lineno"> 7164</span>  <span class="comment">/* Read longitude and latitude... */</span></div>
<div class="line"><span class="lineno"> 7165</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;LON&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, 1);</div>
<div class="line"><span class="lineno"> 7166</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;LAT&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, 1);</div>
<div class="line"><span class="lineno"> 7167</span> </div>
<div class="line"><span class="lineno"> 7168</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7169</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno"> 7170</span> </div>
<div class="line"><span class="lineno"> 7171</span>  <span class="comment">/* Return success... */</span></div>
<div class="line"><span class="lineno"> 7172</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 7173</span>}</div>
<div class="ttc" id="amptrac_8h_html_a2678db26e1acda0cccd79553b9cc9b51"><div class="ttname"><a href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a></div><div class="ttdeci">#define NC(cmd)</div><div class="ttdoc">Execute a NetCDF command and check for errors.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01167">mptrac.h:1167</a></div></div>
<div class="ttc" id="amptrac_8h_html_ad7d3c9758dc177ab607539de4625d6ca"><div class="ttname"><a href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a></div><div class="ttdeci">#define NC_GET_DOUBLE(varname, ptr, force)</div><div class="ttdoc">Retrieve a double-precision variable from a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01226">mptrac.h:1226</a></div></div>
<div class="ttc" id="amptrac_8h_html_af2af2081610570f29a5d50b3864b4f9c"><div class="ttname"><a href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a></div><div class="ttdeci">#define NC_INQ_DIM(dimname, ptr, min, max, check)</div><div class="ttdoc">Inquire the length of a dimension in a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01256">mptrac.h:1256</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2569c3ce3d8d46ce8aa186d42685494c" name="a2569c3ce3d8d46ce8aa186d42685494c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2569c3ce3d8d46ce8aa186d42685494c">&#9670;&nbsp;</a></span>read_atm_nc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_atm_nc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads air parcel data from a generic netCDF file and populates the given atmospheric structure. </p>
<p >This function reads air parcel data from a netCDF file and stores the data in the provided <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure. It retrieves the dimensions, geolocations (time, pressure, longitude, latitude), and specified variables from the file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The name of the netCDF file containing the atmospheric data. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to the control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>) that specifies the number of quantities and their names. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to the atmospheric structure (<code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code>) that will be populated with the data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 on success, and 0 on failure.</dd></dl>
<p>This function performs the following steps:</p><ul>
<li>Attempts to open the specified netCDF file for reading.</li>
<li>Returns 0 if the file cannot be opened.</li>
<li>Retrieves the number of observations (<code>np</code>) from the "obs" dimension.</li>
<li>Reads the geolocation data arrays for time, pressure, longitude, and latitude.</li>
<li>Reads the specified variables into the corresponding arrays in the <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure.</li>
<li>Closes the netCDF file after reading all data.</li>
<li>Returns 1 to indicate successful data reading.</li>
</ul>
<p >The function utilizes several macros and helper functions:</p><ul>
<li><code>NC_INQ_DIM</code> for inquiring about dimensions in the netCDF file.</li>
<li><code>NC_GET_DOUBLE</code> for reading double values from the netCDF file.</li>
<li><code>NC</code> for checking netCDF function return values.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07177">7177</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7180</span>              {</div>
<div class="line"><span class="lineno"> 7181</span> </div>
<div class="line"><span class="lineno"> 7182</span>  <span class="keywordtype">int</span> ncid, varid;</div>
<div class="line"><span class="lineno"> 7183</span> </div>
<div class="line"><span class="lineno"> 7184</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 7185</span>  <span class="keywordflow">if</span> (nc_open(filename, NC_NOWRITE, &amp;ncid) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 7186</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7187</span> </div>
<div class="line"><span class="lineno"> 7188</span>  <span class="comment">/* Get dimensions... */</span></div>
<div class="line"><span class="lineno"> 7189</span>  <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;obs&quot;</span>, &amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, 1, <a class="code hl_define" href="mptrac_8h.html#ab04c88bedc6b2be8ddfe7aa8d3e93f06">NP</a>, 1);</div>
<div class="line"><span class="lineno"> 7190</span> </div>
<div class="line"><span class="lineno"> 7191</span>  <span class="comment">/* Read geolocations... */</span></div>
<div class="line"><span class="lineno"> 7192</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;time&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 1);</div>
<div class="line"><span class="lineno"> 7193</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;press&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, 1);</div>
<div class="line"><span class="lineno"> 7194</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;lon&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, 1);</div>
<div class="line"><span class="lineno"> 7195</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;lat&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, 1);</div>
<div class="line"><span class="lineno"> 7196</span> </div>
<div class="line"><span class="lineno"> 7197</span>  <span class="comment">/* Read variables... */</span></div>
<div class="line"><span class="lineno"> 7198</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno"> 7199</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq], 0);</div>
<div class="line"><span class="lineno"> 7200</span> </div>
<div class="line"><span class="lineno"> 7201</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7202</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno"> 7203</span> </div>
<div class="line"><span class="lineno"> 7204</span>  <span class="comment">/* Return success... */</span></div>
<div class="line"><span class="lineno"> 7205</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 7206</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a501ec43c01f1d742a133a7a3289d59" name="a1a501ec43c01f1d742a133a7a3289d59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a501ec43c01f1d742a133a7a3289d59">&#9670;&nbsp;</a></span>read_clim_photo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_clim_photo </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__photo__t.html">clim_photo_t</a> *&#160;</td>
          <td class="paramname"><em>photo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads photolysis rates from a NetCDF file and populates the given photolysis structure. </p>
<p >This function opens a NetCDF file specified by the filename, reads various dimensions and data related to photolysis rates, and stores this data in the provided <code><a class="el" href="structclim__photo__t.html" title="Climatological data in the form of photolysis rates.">clim_photo_t</a></code> structure. It includes checks for data consistency and logs detailed information about the loaded data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string containing the path to the NetCDF file containing photolysis rate data. </td></tr>
    <tr><td class="paramname">photo</td><td>A pointer to the photolysis structure (<code><a class="el" href="structclim__photo__t.html" title="Climatological data in the form of photolysis rates.">clim_photo_t</a></code>) that will be populated with the data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Logs the initiation of reading photolysis rates.</li>
<li>Opens the NetCDF file in read-only mode.</li>
<li>Reads pressure data and checks for descending order.</li>
<li>Reads total column ozone data and checks for ascending order.</li>
<li>Reads solar zenith angle data and checks for ascending order.</li>
<li>Allocates memory for temporary arrays to hold the data.</li>
<li>Reads various photolysis rates (e.g., J_N2O, J_CCl4, J_CFC-11, J_CFC-12, J_O2, J_O3b, J_O3a, J_H2O2, J_H2O) and stores them in the <code><a class="el" href="structclim__photo__t.html" title="Climatological data in the form of photolysis rates.">clim_photo_t</a></code> structure.</li>
<li>Frees the allocated memory for temporary arrays.</li>
<li>Closes the NetCDF file.</li>
<li>Logs detailed information about the loaded data, including pressure levels, solar zenith angles, and photolysis rates.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07210">7210</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7212</span>                       {</div>
<div class="line"><span class="lineno"> 7213</span> </div>
<div class="line"><span class="lineno"> 7214</span>  <span class="keywordtype">int</span> ncid, varid;</div>
<div class="line"><span class="lineno"> 7215</span> </div>
<div class="line"><span class="lineno"> 7216</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7217</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read photolysis rates: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 7218</span> </div>
<div class="line"><span class="lineno"> 7219</span>  <span class="comment">/* Open netCDF file... */</span></div>
<div class="line"><span class="lineno"> 7220</span>  <span class="keywordflow">if</span> (nc_open(filename, NC_NOWRITE, &amp;ncid) != NC_NOERR) {</div>
<div class="line"><span class="lineno"> 7221</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Photolysis rate data are missing!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7222</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 7223</span>  }</div>
<div class="line"><span class="lineno"> 7224</span> </div>
<div class="line"><span class="lineno"> 7225</span>  <span class="comment">/* Read pressure data... */</span></div>
<div class="line"><span class="lineno"> 7226</span>  <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;press&quot;</span>, &amp;photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a>, 2, <a class="code hl_define" href="mptrac_8h.html#a6594e57d1fff186da0a254a3742dcff7">CP</a>, 1);</div>
<div class="line"><span class="lineno"> 7227</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;press&quot;</span>, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>, 1);</div>
<div class="line"><span class="lineno"> 7228</span>  <span class="keywordflow">if</span> (photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[0] &lt; photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[1])</div>
<div class="line"><span class="lineno"> 7229</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Pressure data are not descending!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7230</span> </div>
<div class="line"><span class="lineno"> 7231</span>  <span class="comment">/* Read total column ozone data... */</span></div>
<div class="line"><span class="lineno"> 7232</span>  <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;total_o3col&quot;</span>, &amp;photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a>, 2, <a class="code hl_define" href="mptrac_8h.html#ae27556d9109b33480031038071c8b4b0">CO3</a>, 1);</div>
<div class="line"><span class="lineno"> 7233</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;total_o3col&quot;</span>, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>, 1);</div>
<div class="line"><span class="lineno"> 7234</span>  <span class="keywordflow">if</span> (photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[0] &gt; photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[1])</div>
<div class="line"><span class="lineno"> 7235</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Total column ozone data are not ascending!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7236</span> </div>
<div class="line"><span class="lineno"> 7237</span>  <span class="comment">/* Read solar zenith angle data... */</span></div>
<div class="line"><span class="lineno"> 7238</span>  <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;sza&quot;</span>, &amp;photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a>, 2, <a class="code hl_define" href="mptrac_8h.html#af7d97769fe58e5913e640ffed1d36fbf">CSZA</a>, 1);</div>
<div class="line"><span class="lineno"> 7239</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;sza&quot;</span>, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>, 1);</div>
<div class="line"><span class="lineno"> 7240</span>  <span class="keywordflow">if</span> (photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>[0] &gt; photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>[1])</div>
<div class="line"><span class="lineno"> 7241</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Solar zenith angle data are not ascending!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7242</span> </div>
<div class="line"><span class="lineno"> 7243</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 7244</span>  <a class="code hl_function" href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d">read_clim_photo_help</a>(ncid, <span class="stringliteral">&quot;J_N2O&quot;</span>, photo, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a6ce3ae3dcee69c935d6db4a040d655bc">n2o</a>);</div>
<div class="line"><span class="lineno"> 7245</span>  <a class="code hl_function" href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d">read_clim_photo_help</a>(ncid, <span class="stringliteral">&quot;J_CCl4&quot;</span>, photo, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ab827be0252e456de341c167ab5e15bab">ccl4</a>);</div>
<div class="line"><span class="lineno"> 7246</span>  <a class="code hl_function" href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d">read_clim_photo_help</a>(ncid, <span class="stringliteral">&quot;J_CFC-11&quot;</span>, photo, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a6b698126dd4714ceb22e8d8c3dfdcf8e">ccl3f</a>);</div>
<div class="line"><span class="lineno"> 7247</span>  <a class="code hl_function" href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d">read_clim_photo_help</a>(ncid, <span class="stringliteral">&quot;J_CFC-12&quot;</span>, photo, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a33f019b0c8014e92822dd8e25481284a">ccl2f2</a>);</div>
<div class="line"><span class="lineno"> 7248</span>  <a class="code hl_function" href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d">read_clim_photo_help</a>(ncid, <span class="stringliteral">&quot;J_O2&quot;</span>, photo, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a517ac04a5fef45c6562e9b4e3de2c41e">o2</a>);</div>
<div class="line"><span class="lineno"> 7249</span>  <a class="code hl_function" href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d">read_clim_photo_help</a>(ncid, <span class="stringliteral">&quot;J_O3b&quot;</span>, photo, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0a15b9cf6e988e941224f2b7037c75ef">o3_1</a>);</div>
<div class="line"><span class="lineno"> 7250</span>  <a class="code hl_function" href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d">read_clim_photo_help</a>(ncid, <span class="stringliteral">&quot;J_O3a&quot;</span>, photo, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ab95f9b3414775d1436ddbc7cb7d2ea8a">o3_2</a>);</div>
<div class="line"><span class="lineno"> 7251</span>  <a class="code hl_function" href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d">read_clim_photo_help</a>(ncid, <span class="stringliteral">&quot;J_H2O2&quot;</span>, photo, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a99f80dc1408865a6c931b47610238e03">h2o2</a>);</div>
<div class="line"><span class="lineno"> 7252</span>  <a class="code hl_function" href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d">read_clim_photo_help</a>(ncid, <span class="stringliteral">&quot;J_H2O&quot;</span>, photo, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a9fa1455abe22aeb4f7b7b5cf89552e96">h2o</a>);</div>
<div class="line"><span class="lineno"> 7253</span> </div>
<div class="line"><span class="lineno"> 7254</span>  <span class="comment">/* Close netCDF file... */</span></div>
<div class="line"><span class="lineno"> 7255</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno"> 7256</span> </div>
<div class="line"><span class="lineno"> 7257</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7258</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of pressure levels: %d&quot;</span>, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a>);</div>
<div class="line"><span class="lineno"> 7259</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Altitude levels: %g, %g ... %g km&quot;</span>,</div>
<div class="line"><span class="lineno"> 7260</span>      <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[0]), <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[1]), <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1]));</div>
<div class="line"><span class="lineno"> 7261</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Pressure levels: %g, %g ... %g hPa&quot;</span>,</div>
<div class="line"><span class="lineno"> 7262</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[0], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[1], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a29e3ba531fc98c377540862e80cdbaab">p</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1]);</div>
<div class="line"><span class="lineno"> 7263</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of solar zenith angles: %d&quot;</span>, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a>);</div>
<div class="line"><span class="lineno"> 7264</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Solar zenith angles: %g, %g ... %g deg&quot;</span>,</div>
<div class="line"><span class="lineno"> 7265</span>      <a class="code hl_define" href="mptrac_8h.html#aacc958134b53425ec947541bb72ac8b1">RAD2DEG</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>[0]), <a class="code hl_define" href="mptrac_8h.html#aacc958134b53425ec947541bb72ac8b1">RAD2DEG</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>[1]),</div>
<div class="line"><span class="lineno"> 7266</span>      <a class="code hl_define" href="mptrac_8h.html#aacc958134b53425ec947541bb72ac8b1">RAD2DEG</a>(photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0954705edbe1ca70559f1adeb231a685">sza</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1]));</div>
<div class="line"><span class="lineno"> 7267</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of total column ozone values: %d&quot;</span>, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a>);</div>
<div class="line"><span class="lineno"> 7268</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Total column ozone: %g, %g ... %g DU&quot;</span>,</div>
<div class="line"><span class="lineno"> 7269</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[0], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[1], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac0271c879928d27622665e275d535bc1">o3c</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1]);</div>
<div class="line"><span class="lineno"> 7270</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;N2O photolysis rate: %g, %g ... %g s**-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 7271</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a6ce3ae3dcee69c935d6db4a040d655bc">n2o</a>[0][0][0], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a6ce3ae3dcee69c935d6db4a040d655bc">n2o</a>[1][0][0],</div>
<div class="line"><span class="lineno"> 7272</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a6ce3ae3dcee69c935d6db4a040d655bc">n2o</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1]);</div>
<div class="line"><span class="lineno"> 7273</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;CCl4 photolysis rate: %g, %g ... %g s**-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 7274</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ab827be0252e456de341c167ab5e15bab">ccl4</a>[0][0][0], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ab827be0252e456de341c167ab5e15bab">ccl4</a>[1][0][0],</div>
<div class="line"><span class="lineno"> 7275</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ab827be0252e456de341c167ab5e15bab">ccl4</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1]);</div>
<div class="line"><span class="lineno"> 7276</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;CFC-11 photolysis rate: %g, %g ... %g s**-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 7277</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a6b698126dd4714ceb22e8d8c3dfdcf8e">ccl3f</a>[0][0][0], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a6b698126dd4714ceb22e8d8c3dfdcf8e">ccl3f</a>[1][0][0],</div>
<div class="line"><span class="lineno"> 7278</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a6b698126dd4714ceb22e8d8c3dfdcf8e">ccl3f</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1]);</div>
<div class="line"><span class="lineno"> 7279</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;CFC-12 photolysis rate: %g, %g ... %g s**-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 7280</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a33f019b0c8014e92822dd8e25481284a">ccl2f2</a>[0][0][0], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a33f019b0c8014e92822dd8e25481284a">ccl2f2</a>[1][0][0],</div>
<div class="line"><span class="lineno"> 7281</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a33f019b0c8014e92822dd8e25481284a">ccl2f2</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1]);</div>
<div class="line"><span class="lineno"> 7282</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;O2 photolysis rate: %g, %g ... %g s**-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 7283</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a517ac04a5fef45c6562e9b4e3de2c41e">o2</a>[0][0][0], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a517ac04a5fef45c6562e9b4e3de2c41e">o2</a>[1][0][0],</div>
<div class="line"><span class="lineno"> 7284</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a517ac04a5fef45c6562e9b4e3de2c41e">o2</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1]);</div>
<div class="line"><span class="lineno"> 7285</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;O3 -&gt; O(1D) photolysis rate: %g, %g ... %g s**-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 7286</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0a15b9cf6e988e941224f2b7037c75ef">o3_1</a>[0][0][0], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0a15b9cf6e988e941224f2b7037c75ef">o3_1</a>[1][0][0],</div>
<div class="line"><span class="lineno"> 7287</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0a15b9cf6e988e941224f2b7037c75ef">o3_1</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1]);</div>
<div class="line"><span class="lineno"> 7288</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;O3 -&gt; O(3P) photolysis rate: %g, %g ... %g s**-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 7289</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ab95f9b3414775d1436ddbc7cb7d2ea8a">o3_2</a>[0][0][0], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ab95f9b3414775d1436ddbc7cb7d2ea8a">o3_2</a>[1][0][0],</div>
<div class="line"><span class="lineno"> 7290</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ab95f9b3414775d1436ddbc7cb7d2ea8a">o3_2</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1]);</div>
<div class="line"><span class="lineno"> 7291</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;H2O2 photolysis rate: %g, %g ... %g s**-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 7292</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a99f80dc1408865a6c931b47610238e03">h2o2</a>[0][0][0], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a99f80dc1408865a6c931b47610238e03">h2o2</a>[1][0][0],</div>
<div class="line"><span class="lineno"> 7293</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a99f80dc1408865a6c931b47610238e03">h2o2</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1]);</div>
<div class="line"><span class="lineno"> 7294</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;H2O photolysis rate: %g, %g ... %g s**-1&quot;</span>,</div>
<div class="line"><span class="lineno"> 7295</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a9fa1455abe22aeb4f7b7b5cf89552e96">h2o</a>[0][0][0], photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a9fa1455abe22aeb4f7b7b5cf89552e96">h2o</a>[1][0][0],</div>
<div class="line"><span class="lineno"> 7296</span>      photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a9fa1455abe22aeb4f7b7b5cf89552e96">h2o</a>[photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> - 1][photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a> - 1]);</div>
<div class="line"><span class="lineno"> 7297</span>}</div>
<div class="ttc" id="amptrac_8c_html_a4392a0ab24a984ac30ed1ef85a89257d"><div class="ttname"><a href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d">read_clim_photo_help</a></div><div class="ttdeci">void read_clim_photo_help(const int ncid, const char *varname, const clim_photo_t *photo, double var[CP][CSZA][CO3])</div><div class="ttdoc">Reads a 3D climatological photochemistry variable from a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07301">mptrac.c:7301</a></div></div>
<div class="ttc" id="amptrac_8h_html_a6594e57d1fff186da0a254a3742dcff7"><div class="ttname"><a href="mptrac_8h.html#a6594e57d1fff186da0a254a3742dcff7">CP</a></div><div class="ttdeci">#define CP</div><div class="ttdoc">Maximum number of pressure levels for climatological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00348">mptrac.h:348</a></div></div>
<div class="ttc" id="amptrac_8h_html_ae27556d9109b33480031038071c8b4b0"><div class="ttname"><a href="mptrac_8h.html#ae27556d9109b33480031038071c8b4b0">CO3</a></div><div class="ttdeci">#define CO3</div><div class="ttdoc">Maximum number of total column ozone data for climatological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00343">mptrac.h:343</a></div></div>
<div class="ttc" id="amptrac_8h_html_af7d97769fe58e5913e640ffed1d36fbf"><div class="ttname"><a href="mptrac_8h.html#af7d97769fe58e5913e640ffed1d36fbf">CSZA</a></div><div class="ttdeci">#define CSZA</div><div class="ttdoc">Maximum number of solar zenith angles for climatological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00353">mptrac.h:353</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_a0a15b9cf6e988e941224f2b7037c75ef"><div class="ttname"><a href="structclim__photo__t.html#a0a15b9cf6e988e941224f2b7037c75ef">clim_photo_t::o3_1</a></div><div class="ttdeci">double o3_1[CP][CSZA][CO3]</div><div class="ttdoc">O3 photolysis rate (O3 + hv = O1d + O2) [1/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03287">mptrac.h:3287</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_a517ac04a5fef45c6562e9b4e3de2c41e"><div class="ttname"><a href="structclim__photo__t.html#a517ac04a5fef45c6562e9b4e3de2c41e">clim_photo_t::o2</a></div><div class="ttdeci">double o2[CP][CSZA][CO3]</div><div class="ttdoc">O2 photolysis rate [1/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03284">mptrac.h:3284</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_a99f80dc1408865a6c931b47610238e03"><div class="ttname"><a href="structclim__photo__t.html#a99f80dc1408865a6c931b47610238e03">clim_photo_t::h2o2</a></div><div class="ttdeci">double h2o2[CP][CSZA][CO3]</div><div class="ttdoc">H2O2 photolysis rate [1/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03293">mptrac.h:3293</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_a9fa1455abe22aeb4f7b7b5cf89552e96"><div class="ttname"><a href="structclim__photo__t.html#a9fa1455abe22aeb4f7b7b5cf89552e96">clim_photo_t::h2o</a></div><div class="ttdeci">double h2o[CP][CSZA][CO3]</div><div class="ttdoc">H2O photolysis rate [1/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03296">mptrac.h:3296</a></div></div>
<div class="ttc" id="astructclim__photo__t_html_ab95f9b3414775d1436ddbc7cb7d2ea8a"><div class="ttname"><a href="structclim__photo__t.html#ab95f9b3414775d1436ddbc7cb7d2ea8a">clim_photo_t::o3_2</a></div><div class="ttdeci">double o3_2[CP][CSZA][CO3]</div><div class="ttdoc">O3 photolysis rate (O3 + hv = O3p + O2) [1/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03290">mptrac.h:3290</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a1a501ec43c01f1d742a133a7a3289d59_cgraph.png" border="0" usemap="#amptrac_8h_a1a501ec43c01f1d742a133a7a3289d59_cgraph" alt=""/></div>
<map name="amptrac_8h_a1a501ec43c01f1d742a133a7a3289d59_cgraph" id="amptrac_8h_a1a501ec43c01f1d742a133a7a3289d59_cgraph">
<area shape="rect" title="Reads photolysis rates from a NetCDF file and populates the given photolysis structure." alt="" coords="5,5,123,32"/>
<area shape="rect" href="mptrac_8c.html#a4392a0ab24a984ac30ed1ef85a89257d" title="Reads a 3D climatological photochemistry variable from a NetCDF file." alt="" coords="171,5,319,32"/>
</map>
</div>

</div>
</div>
<a id="a4392a0ab24a984ac30ed1ef85a89257d" name="a4392a0ab24a984ac30ed1ef85a89257d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4392a0ab24a984ac30ed1ef85a89257d">&#9670;&nbsp;</a></span>read_clim_photo_help()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_clim_photo_help </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__photo__t.html">clim_photo_t</a> *&#160;</td>
          <td class="paramname"><em>photo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>var</em>[CP][CSZA][CO3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads a 3D climatological photochemistry variable from a NetCDF file. </p>
<p >This function reads a variable from a NetCDF file into a 3D array based on the dimensions provided by the <code><a class="el" href="structclim__photo__t.html" title="Climatological data in the form of photolysis rates.">clim_photo_t</a></code> structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ncid</td><td>NetCDF file ID. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">varname</td><td>Name of the variable to read from the NetCDF file. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">photo</td><td>Pointer to a structure defining the data dimensions (np, nsza, no3c). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">var</td><td>3D array to store the read data, with dimensions [CP][CSZA][CO3].</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Allocates temporary memory for reading and copies data into the provided array. The memory is freed after the data is copied.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07301">7301</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7305</span>                             {</div>
<div class="line"><span class="lineno"> 7306</span> </div>
<div class="line"><span class="lineno"> 7307</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 7308</span>  <span class="keywordtype">double</span> *help;</div>
<div class="line"><span class="lineno"> 7309</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7310</span>        photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a> * photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a> * photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a>);</div>
<div class="line"><span class="lineno"> 7311</span> </div>
<div class="line"><span class="lineno"> 7312</span>  <span class="comment">/* Read varible... */</span></div>
<div class="line"><span class="lineno"> 7313</span>  <span class="keywordtype">int</span> varid;</div>
<div class="line"><span class="lineno"> 7314</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(varname, help, 1);</div>
<div class="line"><span class="lineno"> 7315</span> </div>
<div class="line"><span class="lineno"> 7316</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno"> 7317</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#ac8e36bf703a6431948567de9cb94c1e0">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 7318</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a>; is++)</div>
<div class="line"><span class="lineno"> 7319</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> io = 0; io &lt; photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a>; io++)</div>
<div class="line"><span class="lineno"> 7320</span>        var[ip][is][io] =</div>
<div class="line"><span class="lineno"> 7321</span>          help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ip, is, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#a0049cb269d4506812a7f4d3e83338f9a">nsza</a>, io, photo-&gt;<a class="code hl_variable" href="structclim__photo__t.html#acce113364acbbf45c8d77ff60a743b3c">no3c</a>)];</div>
<div class="line"><span class="lineno"> 7322</span> </div>
<div class="line"><span class="lineno"> 7323</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 7324</span>  free(help);</div>
<div class="line"><span class="lineno"> 7325</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3510fe56a6a6e589b5c2474495af03e2" name="a3510fe56a6a6e589b5c2474495af03e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3510fe56a6a6e589b5c2474495af03e2">&#9670;&nbsp;</a></span>read_clim_ts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_clim_ts </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__ts__t.html">clim_ts_t</a> *&#160;</td>
          <td class="paramname"><em>ts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads a climatological time series from a file and populates the given time series structure. </p>
<p >This function reads time and volume mixing ratio (VMR) data from a specified file, processes the data, and stores it in the provided <code><a class="el" href="structclim__ts__t.html" title="Climatological data in the form of time series.">clim_ts_t</a></code> structure. It also includes checks for data consistency and logs detailed information about the loaded data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string containing the path to the file containing the climatological time series data. </td></tr>
    <tr><td class="paramname">ts</td><td>A pointer to the time series structure (<code><a class="el" href="structclim__ts__t.html" title="Climatological data in the form of time series.">clim_ts_t</a></code>) that will be populated with the data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 on success, and 0 on failure (e.g., if the file cannot be opened or data is invalid).</dd></dl>
<p>The function performs the following steps:</p><ul>
<li>Logs the initiation of reading the climatological time series.</li>
<li>Opens the file for reading.</li>
<li>Reads time and VMR data from the file, converting years to seconds.</li>
<li>Checks for ascending order of time data and ensures the number of data points does not exceed the limit.</li>
<li>Closes the file after reading.</li>
<li>Checks if there are enough data points.</li>
<li>Logs detailed information about the loaded data, including the number of time steps and the range of VMR values.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07329">7329</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7331</span>                 {</div>
<div class="line"><span class="lineno"> 7332</span> </div>
<div class="line"><span class="lineno"> 7333</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7334</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read climatological time series: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 7335</span> </div>
<div class="line"><span class="lineno"> 7336</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 7337</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 7338</span>  <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>))) {</div>
<div class="line"><span class="lineno"> 7339</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7340</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7341</span>  }</div>
<div class="line"><span class="lineno"> 7342</span> </div>
<div class="line"><span class="lineno"> 7343</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 7344</span>  <span class="keywordtype">char</span> line[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 7345</span>  <span class="keywordtype">int</span> nh = 0;</div>
<div class="line"><span class="lineno"> 7346</span>  <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in))</div>
<div class="line"><span class="lineno"> 7347</span>    <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%lg %lg&quot;</span>, &amp;ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>[nh], &amp;ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a0a87d48606ea13114cea09194ea0ddd4">vmr</a>[nh]) == 2) {</div>
<div class="line"><span class="lineno"> 7348</span> </div>
<div class="line"><span class="lineno"> 7349</span>      <span class="comment">/* Convert years to seconds... */</span></div>
<div class="line"><span class="lineno"> 7350</span>      ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>[nh] = (ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>[nh] - 2000.0) * 365.25 * 86400.;</div>
<div class="line"><span class="lineno"> 7351</span> </div>
<div class="line"><span class="lineno"> 7352</span>      <span class="comment">/* Check data... */</span></div>
<div class="line"><span class="lineno"> 7353</span>      <span class="keywordflow">if</span> (nh &gt; 0 &amp;&amp; ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>[nh] &lt;= ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>[nh - 1])</div>
<div class="line"><span class="lineno"> 7354</span>        <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Time series must be ascending!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7355</span> </div>
<div class="line"><span class="lineno"> 7356</span>      <span class="comment">/* Count time steps... */</span></div>
<div class="line"><span class="lineno"> 7357</span>      <span class="keywordflow">if</span> ((++nh) &gt;= <a class="code hl_define" href="mptrac_8h.html#a9d9ce8cebc572a42e7b4ab9e92c3a350">CTS</a>)</div>
<div class="line"><span class="lineno"> 7358</span>        <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many data points!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7359</span>    }</div>
<div class="line"><span class="lineno"> 7360</span> </div>
<div class="line"><span class="lineno"> 7361</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7362</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 7363</span> </div>
<div class="line"><span class="lineno"> 7364</span>  <span class="comment">/* Check number of data points... */</span></div>
<div class="line"><span class="lineno"> 7365</span>  ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a5933a10768e95f718d876cddcaad9c04">ntime</a> = nh;</div>
<div class="line"><span class="lineno"> 7366</span>  <span class="keywordflow">if</span> (nh &lt; 2)</div>
<div class="line"><span class="lineno"> 7367</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Not enough data points!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7368</span> </div>
<div class="line"><span class="lineno"> 7369</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7370</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of time steps: %d&quot;</span>, ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a5933a10768e95f718d876cddcaad9c04">ntime</a>);</div>
<div class="line"><span class="lineno"> 7371</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time steps: %.2f, %.2f ... %.2f s&quot;</span>, ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>[0], ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>[1],</div>
<div class="line"><span class="lineno"> 7372</span>      ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a213272025e3c95dfe779d2e8abf0bcf2">time</a>[nh - 1]);</div>
<div class="line"><span class="lineno"> 7373</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Volume mixing ratio range: %g ... %g ppv&quot;</span>,</div>
<div class="line"><span class="lineno"> 7374</span>      gsl_stats_min(ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a0a87d48606ea13114cea09194ea0ddd4">vmr</a>, 1, (<span class="keywordtype">size_t</span>) nh), gsl_stats_max(ts-&gt;<a class="code hl_variable" href="structclim__ts__t.html#a0a87d48606ea13114cea09194ea0ddd4">vmr</a>, 1,</div>
<div class="line"><span class="lineno"> 7375</span>                                                            (<span class="keywordtype">size_t</span>) nh));</div>
<div class="line"><span class="lineno"> 7376</span> </div>
<div class="line"><span class="lineno"> 7377</span>  <span class="comment">/* Exit success... */</span></div>
<div class="line"><span class="lineno"> 7378</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 7379</span>}</div>
<div class="ttc" id="amptrac_8h_html_a9d9ce8cebc572a42e7b4ab9e92c3a350"><div class="ttname"><a href="mptrac_8h.html#a9d9ce8cebc572a42e7b4ab9e92c3a350">CTS</a></div><div class="ttdeci">#define CTS</div><div class="ttdoc">Maximum number of data points of climatological time series.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00363">mptrac.h:363</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6af2603c773b4d11bf7e187ccb123ba2" name="a6af2603c773b4d11bf7e187ccb123ba2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6af2603c773b4d11bf7e187ccb123ba2">&#9670;&nbsp;</a></span>read_clim_zm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_clim_zm </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclim__zm__t.html">clim_zm_t</a> *&#160;</td>
          <td class="paramname"><em>zm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads zonally averaged climatological data from a netCDF file and populates the given structure. </p>
<p >This function reads data from a specified netCDF file, including pressure levels, latitudes, and volume mixing ratios (VMR) for a specified variable. It performs necessary checks and logs detailed information about the loaded data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string containing the path to the netCDF file. </td></tr>
    <tr><td class="paramname">varname</td><td>A string containing the name of the variable to be read from the netCDF file. </td></tr>
    <tr><td class="paramname">zm</td><td>A pointer to the structure (<code><a class="el" href="structclim__zm__t.html" title="Climatological data in the form of zonal means.">clim_zm_t</a></code>) that will be populated with the data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Logs the initiation of reading the specified data.</li>
<li>Opens the netCDF file for reading.</li>
<li>Reads pressure level data and checks for descending order.</li>
<li>Reads latitude data and checks for ascending order.</li>
<li>Sets the time data for monthly means.</li>
<li>Checks the number of time steps.</li>
<li>Reads the specified variable data from the file.</li>
<li>Fixes any gaps in the data by interpolating from valid values.</li>
<li>Logs detailed information about the loaded data, including the number of time steps, pressure levels, latitude values, and the range of the variable's volume mixing ratios.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07383">7383</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7386</span>                 {</div>
<div class="line"><span class="lineno"> 7387</span> </div>
<div class="line"><span class="lineno"> 7388</span>  <span class="keywordtype">int</span> ncid, varid, it, iy, iz, iz2, nt;</div>
<div class="line"><span class="lineno"> 7389</span> </div>
<div class="line"><span class="lineno"> 7390</span>  <span class="keywordtype">double</span> *help, varmin = 1e99, varmax = -1e99;</div>
<div class="line"><span class="lineno"> 7391</span> </div>
<div class="line"><span class="lineno"> 7392</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7393</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read %s data: %s&quot;</span>, varname, filename);</div>
<div class="line"><span class="lineno"> 7394</span> </div>
<div class="line"><span class="lineno"> 7395</span>  <span class="comment">/* Open netCDF file... */</span></div>
<div class="line"><span class="lineno"> 7396</span>  <span class="keywordflow">if</span> (nc_open(filename, NC_NOWRITE, &amp;ncid) != NC_NOERR) {</div>
<div class="line"><span class="lineno"> 7397</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;%s climatology data are missing!&quot;</span>, varname);</div>
<div class="line"><span class="lineno"> 7398</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 7399</span>  }</div>
<div class="line"><span class="lineno"> 7400</span> </div>
<div class="line"><span class="lineno"> 7401</span>  <span class="comment">/* Read pressure data... */</span></div>
<div class="line"><span class="lineno"> 7402</span>  <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;press&quot;</span>, &amp;zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a>, 2, <a class="code hl_define" href="mptrac_8h.html#a6594e57d1fff186da0a254a3742dcff7">CP</a>, 1);</div>
<div class="line"><span class="lineno"> 7403</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;press&quot;</span>, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>, 1);</div>
<div class="line"><span class="lineno"> 7404</span>  <span class="keywordflow">if</span> (zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[0] &lt; zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[1])</div>
<div class="line"><span class="lineno"> 7405</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Pressure data are not descending!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7406</span> </div>
<div class="line"><span class="lineno"> 7407</span>  <span class="comment">/* Read latitudes... */</span></div>
<div class="line"><span class="lineno"> 7408</span>  <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;lat&quot;</span>, &amp;zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">nlat</a>, 2, <a class="code hl_define" href="mptrac_8h.html#ac5bc792e372b15e7a1d3efe6daac9aec">CY</a>, 1);</div>
<div class="line"><span class="lineno"> 7409</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;lat&quot;</span>, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>, 1);</div>
<div class="line"><span class="lineno"> 7410</span>  <span class="keywordflow">if</span> (zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[0] &gt; zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[1])</div>
<div class="line"><span class="lineno"> 7411</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Latitude data are not ascending!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7412</span> </div>
<div class="line"><span class="lineno"> 7413</span>  <span class="comment">/* Set time data (for monthly means)... */</span></div>
<div class="line"><span class="lineno"> 7414</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aa852df9602b1dfd0cbf453159dbf0e41">ntime</a> = 12;</div>
<div class="line"><span class="lineno"> 7415</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[0] = 1209600.00;</div>
<div class="line"><span class="lineno"> 7416</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[1] = 3888000.00;</div>
<div class="line"><span class="lineno"> 7417</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[2] = 6393600.00;</div>
<div class="line"><span class="lineno"> 7418</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[3] = 9072000.00;</div>
<div class="line"><span class="lineno"> 7419</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[4] = 11664000.00;</div>
<div class="line"><span class="lineno"> 7420</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[5] = 14342400.00;</div>
<div class="line"><span class="lineno"> 7421</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[6] = 16934400.00;</div>
<div class="line"><span class="lineno"> 7422</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[7] = 19612800.00;</div>
<div class="line"><span class="lineno"> 7423</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[8] = 22291200.00;</div>
<div class="line"><span class="lineno"> 7424</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[9] = 24883200.00;</div>
<div class="line"><span class="lineno"> 7425</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[10] = 27561600.00;</div>
<div class="line"><span class="lineno"> 7426</span>  zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[11] = 30153600.00;</div>
<div class="line"><span class="lineno"> 7427</span> </div>
<div class="line"><span class="lineno"> 7428</span>  <span class="comment">/* Check number of timesteps... */</span></div>
<div class="line"><span class="lineno"> 7429</span>  <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;time&quot;</span>, &amp;nt, 12, 12, 1);</div>
<div class="line"><span class="lineno"> 7430</span> </div>
<div class="line"><span class="lineno"> 7431</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 7432</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7433</span>        zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">nlat</a> * zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a> * zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aa852df9602b1dfd0cbf453159dbf0e41">ntime</a>);</div>
<div class="line"><span class="lineno"> 7434</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(varname, help, 1);</div>
<div class="line"><span class="lineno"> 7435</span>  <span class="keywordflow">for</span> (it = 0; it &lt; zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aa852df9602b1dfd0cbf453159dbf0e41">ntime</a>; it++)</div>
<div class="line"><span class="lineno"> 7436</span>    <span class="keywordflow">for</span> (iz = 0; iz &lt; zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a>; iz++)</div>
<div class="line"><span class="lineno"> 7437</span>      <span class="keywordflow">for</span> (iy = 0; iy &lt; zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">nlat</a>; iy++)</div>
<div class="line"><span class="lineno"> 7438</span>        zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[it][iz][iy] = help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(it, iz, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a>, iy, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">nlat</a>)];</div>
<div class="line"><span class="lineno"> 7439</span>  free(help);</div>
<div class="line"><span class="lineno"> 7440</span> </div>
<div class="line"><span class="lineno"> 7441</span>  <span class="comment">/* Fix data gaps... */</span></div>
<div class="line"><span class="lineno"> 7442</span>  <span class="keywordflow">for</span> (it = 0; it &lt; zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aa852df9602b1dfd0cbf453159dbf0e41">ntime</a>; it++)</div>
<div class="line"><span class="lineno"> 7443</span>    <span class="keywordflow">for</span> (iy = 0; iy &lt; zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">nlat</a>; iy++)</div>
<div class="line"><span class="lineno"> 7444</span>      <span class="keywordflow">for</span> (iz = 0; iz &lt; zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a>; iz++) {</div>
<div class="line"><span class="lineno"> 7445</span>        <span class="keywordflow">if</span> (zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[it][iz][iy] &lt; 0) {</div>
<div class="line"><span class="lineno"> 7446</span>          <span class="keywordflow">for</span> (iz2 = 0; iz2 &lt; zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a>; iz2++)</div>
<div class="line"><span class="lineno"> 7447</span>            <span class="keywordflow">if</span> (zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[it][iz2][iy] &gt;= 0) {</div>
<div class="line"><span class="lineno"> 7448</span>              zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[it][iz][iy] = zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[it][iz2][iy];</div>
<div class="line"><span class="lineno"> 7449</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7450</span>            }</div>
<div class="line"><span class="lineno"> 7451</span>          <span class="keywordflow">for</span> (iz2 = zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a> - 1; iz2 &gt;= 0; iz2--)</div>
<div class="line"><span class="lineno"> 7452</span>            <span class="keywordflow">if</span> (zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[it][iz2][iy] &gt;= 0) {</div>
<div class="line"><span class="lineno"> 7453</span>              zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[it][iz][iy] = zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[it][iz2][iy];</div>
<div class="line"><span class="lineno"> 7454</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7455</span>            }</div>
<div class="line"><span class="lineno"> 7456</span>        }</div>
<div class="line"><span class="lineno"> 7457</span>        varmin = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(varmin, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[it][iz][iy]);</div>
<div class="line"><span class="lineno"> 7458</span>        varmax = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(varmax, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a893d077ed8733dc568f87950ce40f5c6">vmr</a>[it][iz][iy]);</div>
<div class="line"><span class="lineno"> 7459</span>      }</div>
<div class="line"><span class="lineno"> 7460</span> </div>
<div class="line"><span class="lineno"> 7461</span>  <span class="comment">/* Close netCDF file... */</span></div>
<div class="line"><span class="lineno"> 7462</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno"> 7463</span> </div>
<div class="line"><span class="lineno"> 7464</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7465</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of time steps: %d&quot;</span>, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aa852df9602b1dfd0cbf453159dbf0e41">ntime</a>);</div>
<div class="line"><span class="lineno"> 7466</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time steps: %.2f, %.2f ... %.2f s&quot;</span>,</div>
<div class="line"><span class="lineno"> 7467</span>      zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[0], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[1], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a06e634b21e38187593b011c715afa57a">time</a>[zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aa852df9602b1dfd0cbf453159dbf0e41">ntime</a> - 1]);</div>
<div class="line"><span class="lineno"> 7468</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of pressure levels: %d&quot;</span>, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a>);</div>
<div class="line"><span class="lineno"> 7469</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Altitude levels: %g, %g ... %g km&quot;</span>,</div>
<div class="line"><span class="lineno"> 7470</span>      <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[0]), <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[1]), <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a> - 1]));</div>
<div class="line"><span class="lineno"> 7471</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Pressure levels: %g, %g ... %g hPa&quot;</span>, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[0],</div>
<div class="line"><span class="lineno"> 7472</span>      zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[1], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a680339d53df354552c42829876d1271f">p</a>[zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#a3c0b1227fc300563dc460fef7b4b249a">np</a> - 1]);</div>
<div class="line"><span class="lineno"> 7473</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of latitudes: %d&quot;</span>, zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">nlat</a>);</div>
<div class="line"><span class="lineno"> 7474</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Latitudes: %g, %g ... %g deg&quot;</span>,</div>
<div class="line"><span class="lineno"> 7475</span>      zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[0], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[1], zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#aff242585ab3f0df6832c7417d90d8f2f">lat</a>[zm-&gt;<a class="code hl_variable" href="structclim__zm__t.html#ab3d452abf93ad1d5f39c2c20fc6403e9">nlat</a> - 1]);</div>
<div class="line"><span class="lineno"> 7476</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;%s volume mixing ratio range: %g ... %g ppv&quot;</span>, varname, varmin,</div>
<div class="line"><span class="lineno"> 7477</span>      varmax);</div>
<div class="line"><span class="lineno"> 7478</span>}</div>
<div class="ttc" id="amptrac_8h_html_ac5bc792e372b15e7a1d3efe6daac9aec"><div class="ttname"><a href="mptrac_8h.html#ac5bc792e372b15e7a1d3efe6daac9aec">CY</a></div><div class="ttdeci">#define CY</div><div class="ttdoc">Maximum number of latitudes for climatological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00338">mptrac.h:338</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a3277ab872141360b876c25b5643ba6" name="a7a3277ab872141360b876c25b5643ba6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a3277ab872141360b876c25b5643ba6">&#9670;&nbsp;</a></span>read_kernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_kernel </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kz</em>[EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kw</em>[EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads kernel function data from a file and populates the provided arrays. </p>
<p >This function reads kernel function data from a specified file, populating the provided arrays <code>kz</code> and <code>kw</code> with the parsed data. It also updates the variable pointed to by <code>nk</code> with the number of data points read. The function ensures that the height levels are in ascending order and performs checks for the number of height levels read.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string containing the path to the file containing kernel function data. </td></tr>
    <tr><td class="paramname">kz</td><td>A double array to store the height levels of the kernel function. </td></tr>
    <tr><td class="paramname">kw</td><td>A double array to store the weights corresponding to the height levels. </td></tr>
    <tr><td class="paramname">nk</td><td>A pointer to an integer variable representing the number of data points read.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Logs information indicating the kernel function file being read.</li>
<li>Attempts to open the specified file for reading.</li>
<li>Reads data from the file line by line, parsing height levels and weights.</li>
<li>Checks that the height levels are in ascending order and that the number of data points does not exceed the defined maximum.</li>
<li>Closes the file after reading.</li>
<li>Updates the value of <code>nk</code> with the number of data points read.</li>
<li>Normalizes the kernel function weights by dividing each weight by the maximum weight.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07482">7482</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7486</span>           {</div>
<div class="line"><span class="lineno"> 7487</span> </div>
<div class="line"><span class="lineno"> 7488</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 7489</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read kernel function: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno"> 7490</span> </div>
<div class="line"><span class="lineno"> 7491</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 7492</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 7493</span>  <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno"> 7494</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7495</span> </div>
<div class="line"><span class="lineno"> 7496</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 7497</span>  <span class="keywordtype">char</span> line[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 7498</span>  <span class="keywordtype">int</span> n = 0;</div>
<div class="line"><span class="lineno"> 7499</span>  <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in))</div>
<div class="line"><span class="lineno"> 7500</span>    <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%lg %lg&quot;</span>, &amp;kz[n], &amp;kw[n]) == 2) {</div>
<div class="line"><span class="lineno"> 7501</span>      <span class="keywordflow">if</span> (n &gt; 0 &amp;&amp; kz[n] &lt; kz[n - 1])</div>
<div class="line"><span class="lineno"> 7502</span>        <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Height levels must be ascending!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7503</span>      <span class="keywordflow">if</span> ((++n) &gt;= <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>)</div>
<div class="line"><span class="lineno"> 7504</span>        <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many height levels!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7505</span>    }</div>
<div class="line"><span class="lineno"> 7506</span> </div>
<div class="line"><span class="lineno"> 7507</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7508</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 7509</span> </div>
<div class="line"><span class="lineno"> 7510</span>  <span class="comment">/* Check number of data points... */</span></div>
<div class="line"><span class="lineno"> 7511</span>  *nk = n;</div>
<div class="line"><span class="lineno"> 7512</span>  <span class="keywordflow">if</span> (n &lt; 2)</div>
<div class="line"><span class="lineno"> 7513</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Not enough height levels!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7514</span> </div>
<div class="line"><span class="lineno"> 7515</span>  <span class="comment">/* Normalize kernel function... */</span></div>
<div class="line"><span class="lineno"> 7516</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> kmax = gsl_stats_max(kw, 1, (<span class="keywordtype">size_t</span>) n);</div>
<div class="line"><span class="lineno"> 7517</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; n; iz++)</div>
<div class="line"><span class="lineno"> 7518</span>    kw[iz] /= kmax;</div>
<div class="line"><span class="lineno"> 7519</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acc520c5d948ea75f0acb9b351a6b8b75" name="acc520c5d948ea75f0acb9b351a6b8b75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc520c5d948ea75f0acb9b351a6b8b75">&#9670;&nbsp;</a></span>read_met_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_met_bin </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads meteorological data from a binary file. </p>
<p >This function reads meteorological data from a binary file and populates the provided <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure with the data. It checks the binary file's format version and <code>met_type</code>, ensuring compatibility with the control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>). The function reads time, grid, surface data, and multi-level data, and supports different binary file versions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A constant character pointer representing the name of the binary file to read the meteorological data from. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure that holds control parameters such as the expected <code>met_type</code> and other configuration options. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure that will store the meteorological data read from the binary file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function logs the progress and details of the read operation, such as time, number of longitudes, latitudes, levels, and various meteorological variables.</li>
<li>It uses the <code>FREAD</code> macro for safe binary reading operations, which checks the integrity of the read operation.</li>
<li>The function reads and verifies the <code>met_type</code> and binary file version to ensure compatibility.</li>
<li>Supported binary file versions include 100, 101, and 102, each of which may include additional variables (e.g., <code>LSM</code>, <code>SST</code>, <code>RWC</code>, <code>SWC</code>, and <code>CC</code>).</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>The function will raise an error if the <code>met_type</code> in the file does not match the <code>ctl-&gt;met_type</code>.</li>
<li>It will raise an error if the binary file version is not supported.</li>
<li>If the dimensions of the data (e.g., number of longitudes, latitudes, or levels) are outside the expected range, an error will be raised.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07523">7523</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7526</span>              {</div>
<div class="line"><span class="lineno"> 7527</span> </div>
<div class="line"><span class="lineno"> 7528</span>  FILE *in;</div>
<div class="line"><span class="lineno"> 7529</span> </div>
<div class="line"><span class="lineno"> 7530</span>  <span class="keywordtype">double</span> r;</div>
<div class="line"><span class="lineno"> 7531</span> </div>
<div class="line"><span class="lineno"> 7532</span>  <span class="keywordtype">int</span> year, mon, day, hour, min, sec;</div>
<div class="line"><span class="lineno"> 7533</span> </div>
<div class="line"><span class="lineno"> 7534</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 7535</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_BIN&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 7536</span> </div>
<div class="line"><span class="lineno"> 7537</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 7538</span>  <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>))) {</div>
<div class="line"><span class="lineno"> 7539</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7540</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7541</span>  }</div>
<div class="line"><span class="lineno"> 7542</span> </div>
<div class="line"><span class="lineno"> 7543</span>  <span class="comment">/* Check type of binary data... */</span></div>
<div class="line"><span class="lineno"> 7544</span>  <span class="keywordtype">int</span> met_type;</div>
<div class="line"><span class="lineno"> 7545</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;met_type, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7546</span>        1,</div>
<div class="line"><span class="lineno"> 7547</span>        in);</div>
<div class="line"><span class="lineno"> 7548</span>  <span class="keywordflow">if</span> (met_type != ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a>)</div>
<div class="line"><span class="lineno"> 7549</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Wrong MET_TYPE of binary data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7550</span> </div>
<div class="line"><span class="lineno"> 7551</span>  <span class="comment">/* Check version of binary data... */</span></div>
<div class="line"><span class="lineno"> 7552</span>  <span class="keywordtype">int</span> version;</div>
<div class="line"><span class="lineno"> 7553</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;version, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7554</span>        1,</div>
<div class="line"><span class="lineno"> 7555</span>        in);</div>
<div class="line"><span class="lineno"> 7556</span>  <span class="keywordflow">if</span> (version != 103)</div>
<div class="line"><span class="lineno"> 7557</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Wrong version of binary data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7558</span> </div>
<div class="line"><span class="lineno"> 7559</span>  <span class="comment">/* Read time... */</span></div>
<div class="line"><span class="lineno"> 7560</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7561</span>        1,</div>
<div class="line"><span class="lineno"> 7562</span>        in);</div>
<div class="line"><span class="lineno"> 7563</span>  <a class="code hl_function" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>, &amp;year, &amp;mon, &amp;day, &amp;hour, &amp;min, &amp;sec, &amp;r);</div>
<div class="line"><span class="lineno"> 7564</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time: %.2f (%d-%02d-%02d, %02d:%02d UTC)&quot;</span>,</div>
<div class="line"><span class="lineno"> 7565</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>, year, mon, day, hour, min);</div>
<div class="line"><span class="lineno"> 7566</span>  <span class="keywordflow">if</span> (year &lt; 1900 || year &gt; 2100 || mon &lt; 1 || mon &gt; 12</div>
<div class="line"><span class="lineno"> 7567</span>      || day &lt; 1 || day &gt; 31 || hour &lt; 0 || hour &gt; 23)</div>
<div class="line"><span class="lineno"> 7568</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Error while reading time!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7569</span> </div>
<div class="line"><span class="lineno"> 7570</span>  <span class="comment">/* Read dimensions... */</span></div>
<div class="line"><span class="lineno"> 7571</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7572</span>        1,</div>
<div class="line"><span class="lineno"> 7573</span>        in);</div>
<div class="line"><span class="lineno"> 7574</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of longitudes: %d&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>);</div>
<div class="line"><span class="lineno"> 7575</span>  <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> &lt; 2 || met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> &gt; <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>)</div>
<div class="line"><span class="lineno"> 7576</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Number of longitudes out of range!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7577</span> </div>
<div class="line"><span class="lineno"> 7578</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7579</span>        1,</div>
<div class="line"><span class="lineno"> 7580</span>        in);</div>
<div class="line"><span class="lineno"> 7581</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of latitudes: %d&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>);</div>
<div class="line"><span class="lineno"> 7582</span>  <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> &lt; 2 || met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> &gt; <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>)</div>
<div class="line"><span class="lineno"> 7583</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Number of latitudes out of range!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7584</span> </div>
<div class="line"><span class="lineno"> 7585</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7586</span>        1,</div>
<div class="line"><span class="lineno"> 7587</span>        in);</div>
<div class="line"><span class="lineno"> 7588</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of levels: %d&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>);</div>
<div class="line"><span class="lineno"> 7589</span>  <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> &lt; 2 || met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> &gt; <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>)</div>
<div class="line"><span class="lineno"> 7590</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Number of levels out of range!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7591</span> </div>
<div class="line"><span class="lineno"> 7592</span>  <span class="comment">/* Read grid... */</span></div>
<div class="line"><span class="lineno"> 7593</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7594</span>          (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>,</div>
<div class="line"><span class="lineno"> 7595</span>        in);</div>
<div class="line"><span class="lineno"> 7596</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Longitudes: %g, %g ... %g deg&quot;</span>,</div>
<div class="line"><span class="lineno"> 7597</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[0], met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[1], met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1]);</div>
<div class="line"><span class="lineno"> 7598</span> </div>
<div class="line"><span class="lineno"> 7599</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7600</span>          (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>,</div>
<div class="line"><span class="lineno"> 7601</span>        in);</div>
<div class="line"><span class="lineno"> 7602</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Latitudes: %g, %g ... %g deg&quot;</span>,</div>
<div class="line"><span class="lineno"> 7603</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[0], met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[1], met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 1]);</div>
<div class="line"><span class="lineno"> 7604</span> </div>
<div class="line"><span class="lineno"> 7605</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7606</span>          (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>,</div>
<div class="line"><span class="lineno"> 7607</span>        in);</div>
<div class="line"><span class="lineno"> 7608</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Altitude levels: %g, %g ... %g km&quot;</span>,</div>
<div class="line"><span class="lineno"> 7609</span>      <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[0]), <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[1]), <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1]));</div>
<div class="line"><span class="lineno"> 7610</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Pressure levels: %g, %g ... %g hPa&quot;</span>,</div>
<div class="line"><span class="lineno"> 7611</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[0], met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[1], met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1]);</div>
<div class="line"><span class="lineno"> 7612</span> </div>
<div class="line"><span class="lineno"> 7613</span>  <span class="comment">/* Read surface data... */</span></div>
<div class="line"><span class="lineno"> 7614</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>, <span class="stringliteral">&quot;PS&quot;</span>);</div>
<div class="line"><span class="lineno"> 7615</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>, <span class="stringliteral">&quot;TS&quot;</span>);</div>
<div class="line"><span class="lineno"> 7616</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>, <span class="stringliteral">&quot;ZS&quot;</span>);</div>
<div class="line"><span class="lineno"> 7617</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>, <span class="stringliteral">&quot;US&quot;</span>);</div>
<div class="line"><span class="lineno"> 7618</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>, <span class="stringliteral">&quot;VS&quot;</span>);</div>
<div class="line"><span class="lineno"> 7619</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>, <span class="stringliteral">&quot;ESS&quot;</span>);</div>
<div class="line"><span class="lineno"> 7620</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>, <span class="stringliteral">&quot;NSS&quot;</span>);</div>
<div class="line"><span class="lineno"> 7621</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>, <span class="stringliteral">&quot;SHF&quot;</span>);</div>
<div class="line"><span class="lineno"> 7622</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>, <span class="stringliteral">&quot;LSM&quot;</span>);</div>
<div class="line"><span class="lineno"> 7623</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>, <span class="stringliteral">&quot;SST&quot;</span>);</div>
<div class="line"><span class="lineno"> 7624</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>, <span class="stringliteral">&quot;PBL&quot;</span>);</div>
<div class="line"><span class="lineno"> 7625</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>, <span class="stringliteral">&quot;PT&quot;</span>);</div>
<div class="line"><span class="lineno"> 7626</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a9677a606f7850c8143f698e9fb15273f">tt</a>, <span class="stringliteral">&quot;TT&quot;</span>);</div>
<div class="line"><span class="lineno"> 7627</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a043690c89804f40d4a8940b7d3393707">zt</a>, <span class="stringliteral">&quot;ZT&quot;</span>);</div>
<div class="line"><span class="lineno"> 7628</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#ac87fdccf57a65247062baccf2c2e85e8">h2ot</a>, <span class="stringliteral">&quot;H2OT&quot;</span>);</div>
<div class="line"><span class="lineno"> 7629</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a29d404429eb9f4e95bf8fa1132455fdd">pct</a>, <span class="stringliteral">&quot;PCT&quot;</span>);</div>
<div class="line"><span class="lineno"> 7630</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a7c44ec7c0c9f471ca8ca700adb3596c3">pcb</a>, <span class="stringliteral">&quot;PCB&quot;</span>);</div>
<div class="line"><span class="lineno"> 7631</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#ae45079d4c0137fa4416dd42ca1f117cd">cl</a>, <span class="stringliteral">&quot;CL&quot;</span>);</div>
<div class="line"><span class="lineno"> 7632</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">plcl</a>, <span class="stringliteral">&quot;PLCL&quot;</span>);</div>
<div class="line"><span class="lineno"> 7633</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#af2f85f717aa775b52d4791c97c3ae142">plfc</a>, <span class="stringliteral">&quot;PLFC&quot;</span>);</div>
<div class="line"><span class="lineno"> 7634</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a7d6776fe9ed1966d6024567d423f0b96">pel</a>, <span class="stringliteral">&quot;PEL&quot;</span>);</div>
<div class="line"><span class="lineno"> 7635</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>, <span class="stringliteral">&quot;CAPE&quot;</span>);</div>
<div class="line"><span class="lineno"> 7636</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>, <span class="stringliteral">&quot;CIN&quot;</span>);</div>
<div class="line"><span class="lineno"> 7637</span>  <a class="code hl_function" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a>(in, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a0ab0cfbc1e5fe1a5c9ce3412cc4400a8">o3c</a>, <span class="stringliteral">&quot;O3C&quot;</span>);</div>
<div class="line"><span class="lineno"> 7638</span> </div>
<div class="line"><span class="lineno"> 7639</span>  <span class="comment">/* Read level data... */</span></div>
<div class="line"><span class="lineno"> 7640</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>, <span class="stringliteral">&quot;Z&quot;</span>, -1e34f, 1e34f);</div>
<div class="line"><span class="lineno"> 7641</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, <span class="stringliteral">&quot;T&quot;</span>, 0, 1e34f);</div>
<div class="line"><span class="lineno"> 7642</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>, <span class="stringliteral">&quot;U&quot;</span>, -1e34f, 1e34f);</div>
<div class="line"><span class="lineno"> 7643</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>, <span class="stringliteral">&quot;V&quot;</span>, -1e34f, 1e34f);</div>
<div class="line"><span class="lineno"> 7644</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>, <span class="stringliteral">&quot;W&quot;</span>, -1e34f, 1e34f);</div>
<div class="line"><span class="lineno"> 7645</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#ac8e46cfdfc9fc8cfef4e2b801834a61c">pv</a>, <span class="stringliteral">&quot;PV&quot;</span>, -1e34f, 1e34f);</div>
<div class="line"><span class="lineno"> 7646</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>, <span class="stringliteral">&quot;H2O&quot;</span>, 0, 1e34f);</div>
<div class="line"><span class="lineno"> 7647</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>, <span class="stringliteral">&quot;O3&quot;</span>, 0, 1e34f);</div>
<div class="line"><span class="lineno"> 7648</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>, <span class="stringliteral">&quot;LWC&quot;</span>, 0, 1e34f);</div>
<div class="line"><span class="lineno"> 7649</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>, <span class="stringliteral">&quot;RWC&quot;</span>, 0, 1e34f);</div>
<div class="line"><span class="lineno"> 7650</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>, <span class="stringliteral">&quot;IWC&quot;</span>, 0, 1e34f);</div>
<div class="line"><span class="lineno"> 7651</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>, <span class="stringliteral">&quot;SWC&quot;</span>, 0, 1e34f);</div>
<div class="line"><span class="lineno"> 7652</span>  <a class="code hl_function" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a>(in, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>, <span class="stringliteral">&quot;CC&quot;</span>, 0, 1);</div>
<div class="line"><span class="lineno"> 7653</span> </div>
<div class="line"><span class="lineno"> 7654</span>  <span class="comment">/* Read final flag... */</span></div>
<div class="line"><span class="lineno"> 7655</span>  <span class="keywordtype">int</span> <span class="keyword">final</span>;</div>
<div class="line"><span class="lineno"> 7656</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;<span class="keyword">final</span>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7657</span>        1,</div>
<div class="line"><span class="lineno"> 7658</span>        in);</div>
<div class="line"><span class="lineno"> 7659</span>  <span class="keywordflow">if</span> (<span class="keyword">final</span> != 999)</div>
<div class="line"><span class="lineno"> 7660</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Error while reading binary data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7661</span> </div>
<div class="line"><span class="lineno"> 7662</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 7663</span>  fclose(in);</div>
<div class="line"><span class="lineno"> 7664</span> </div>
<div class="line"><span class="lineno"> 7665</span>  <span class="comment">/* Return success... */</span></div>
<div class="line"><span class="lineno"> 7666</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 7667</span>}</div>
<div class="ttc" id="amptrac_8c_html_a4b9aea19f1f7b7461d49a90bef54d286"><div class="ttname"><a href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286">read_met_bin_2d</a></div><div class="ttdeci">void read_met_bin_2d(FILE *in, const met_t *met, float var[EX][EY], const char *varname)</div><div class="ttdoc">Reads a 2-dimensional meteorological variable from a binary file and stores it in the provided array.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07671">mptrac.c:7671</a></div></div>
<div class="ttc" id="amptrac_8c_html_a8acf2c312916a07fa0856aa6d4948558"><div class="ttname"><a href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558">read_met_bin_3d</a></div><div class="ttdeci">void read_met_bin_3d(FILE *in, const ctl_t *ctl, const met_t *met, float var[EX][EY][EP], const char *varname, const float bound_min, const float bound_max)</div><div class="ttdoc">Reads 3D meteorological data from a binary file, potentially using different compression methods.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07700">mptrac.c:7700</a></div></div>
<div class="ttc" id="amptrac_8h_html_a423a96c51fa2ea8a6406113803acbbc1"><div class="ttname"><a href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a></div><div class="ttdeci">#define EY</div><div class="ttdoc">Maximum number of latitudes for meteo data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00293">mptrac.h:293</a></div></div>
<div class="ttc" id="astructmet__t_html_a043690c89804f40d4a8940b7d3393707"><div class="ttname"><a href="structmet__t.html#a043690c89804f40d4a8940b7d3393707">met_t::zt</a></div><div class="ttdeci">float zt[EX][EY]</div><div class="ttdoc">Tropopause geopotential height [km].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03496">mptrac.h:3496</a></div></div>
<div class="ttc" id="astructmet__t_html_a04c8115782b3dc6697111fdeb7c8f860"><div class="ttname"><a href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">met_t::sst</a></div><div class="ttdeci">float sst[EX][EY]</div><div class="ttdoc">Sea surface temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03484">mptrac.h:3484</a></div></div>
<div class="ttc" id="astructmet__t_html_a05425967991c53f965f2551eb12321d8"><div class="ttname"><a href="structmet__t.html#a05425967991c53f965f2551eb12321d8">met_t::rwc</a></div><div class="ttdeci">float rwc[EX][EY][EP]</div><div class="ttdoc">Cloud rain water content [kg/kg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03556">mptrac.h:3556</a></div></div>
<div class="ttc" id="astructmet__t_html_a0ab0cfbc1e5fe1a5c9ce3412cc4400a8"><div class="ttname"><a href="structmet__t.html#a0ab0cfbc1e5fe1a5c9ce3412cc4400a8">met_t::o3c</a></div><div class="ttdeci">float o3c[EX][EY]</div><div class="ttdoc">Total column ozone [DU].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03526">mptrac.h:3526</a></div></div>
<div class="ttc" id="astructmet__t_html_a1db66ae86edf896a545c0332dfeabb0f"><div class="ttname"><a href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">met_t::cape</a></div><div class="ttdeci">float cape[EX][EY]</div><div class="ttdoc">Convective available potential energy [J/kg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03520">mptrac.h:3520</a></div></div>
<div class="ttc" id="astructmet__t_html_a29d404429eb9f4e95bf8fa1132455fdd"><div class="ttname"><a href="structmet__t.html#a29d404429eb9f4e95bf8fa1132455fdd">met_t::pct</a></div><div class="ttdeci">float pct[EX][EY]</div><div class="ttdoc">Cloud top pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03502">mptrac.h:3502</a></div></div>
<div class="ttc" id="astructmet__t_html_a3bc7785b3dea585270d402d925c02425"><div class="ttname"><a href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">met_t::shf</a></div><div class="ttdeci">float shf[EX][EY]</div><div class="ttdoc">Surface sensible heat flux [W/m^2].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03478">mptrac.h:3478</a></div></div>
<div class="ttc" id="astructmet__t_html_a40590e0c0c66a5a1f6903a474de87ee0"><div class="ttname"><a href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">met_t::lwc</a></div><div class="ttdeci">float lwc[EX][EY][EP]</div><div class="ttdoc">Cloud liquid water content [kg/kg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03553">mptrac.h:3553</a></div></div>
<div class="ttc" id="astructmet__t_html_a4242ff2a85d48089d15fd5645923ee36"><div class="ttname"><a href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">met_t::us</a></div><div class="ttdeci">float us[EX][EY]</div><div class="ttdoc">Surface zonal wind [m/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03466">mptrac.h:3466</a></div></div>
<div class="ttc" id="astructmet__t_html_a5d24cf701c941649d83adad1e058898f"><div class="ttname"><a href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">met_t::cc</a></div><div class="ttdeci">float cc[EX][EY][EP]</div><div class="ttdoc">Cloud cover [1].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03565">mptrac.h:3565</a></div></div>
<div class="ttc" id="astructmet__t_html_a61ef93fdd727e61639dc6408a4573149"><div class="ttname"><a href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">met_t::ts</a></div><div class="ttdeci">float ts[EX][EY]</div><div class="ttdoc">Surface temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03460">mptrac.h:3460</a></div></div>
<div class="ttc" id="astructmet__t_html_a6fe5e21416818e1e5c865e4939fc9a5c"><div class="ttname"><a href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">met_t::ess</a></div><div class="ttdeci">float ess[EX][EY]</div><div class="ttdoc">Eastward turbulent surface stress [N/m^2].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03472">mptrac.h:3472</a></div></div>
<div class="ttc" id="astructmet__t_html_a7c44ec7c0c9f471ca8ca700adb3596c3"><div class="ttname"><a href="structmet__t.html#a7c44ec7c0c9f471ca8ca700adb3596c3">met_t::pcb</a></div><div class="ttdeci">float pcb[EX][EY]</div><div class="ttdoc">Cloud bottom pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03505">mptrac.h:3505</a></div></div>
<div class="ttc" id="astructmet__t_html_a7d6776fe9ed1966d6024567d423f0b96"><div class="ttname"><a href="structmet__t.html#a7d6776fe9ed1966d6024567d423f0b96">met_t::pel</a></div><div class="ttdeci">float pel[EX][EY]</div><div class="ttdoc">Pressure at equilibrium level (EL) [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03517">mptrac.h:3517</a></div></div>
<div class="ttc" id="astructmet__t_html_a827c930acd681d82336766f6744ac763"><div class="ttname"><a href="structmet__t.html#a827c930acd681d82336766f6744ac763">met_t::cin</a></div><div class="ttdeci">float cin[EX][EY]</div><div class="ttdoc">Convective inhibition [J/kg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03523">mptrac.h:3523</a></div></div>
<div class="ttc" id="astructmet__t_html_a83441ce7588a1230c54f4c2174bbdcfb"><div class="ttname"><a href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">met_t::plcl</a></div><div class="ttdeci">float plcl[EX][EY]</div><div class="ttdoc">Pressure at lifted condensation level (LCL) [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03511">mptrac.h:3511</a></div></div>
<div class="ttc" id="astructmet__t_html_a9677a606f7850c8143f698e9fb15273f"><div class="ttname"><a href="structmet__t.html#a9677a606f7850c8143f698e9fb15273f">met_t::tt</a></div><div class="ttdeci">float tt[EX][EY]</div><div class="ttdoc">Tropopause temperature [K].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03493">mptrac.h:3493</a></div></div>
<div class="ttc" id="astructmet__t_html_a9a55672423267749087311d62e924794"><div class="ttname"><a href="structmet__t.html#a9a55672423267749087311d62e924794">met_t::pbl</a></div><div class="ttdeci">float pbl[EX][EY]</div><div class="ttdoc">Boundary layer pressure [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03487">mptrac.h:3487</a></div></div>
<div class="ttc" id="astructmet__t_html_aa6379067afe890ea9fe7146a1668f0dc"><div class="ttname"><a href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">met_t::vs</a></div><div class="ttdeci">float vs[EX][EY]</div><div class="ttdoc">Surface meridional wind [m/s].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03469">mptrac.h:3469</a></div></div>
<div class="ttc" id="astructmet__t_html_abe8e0b1c2d6241fa20e663db28e74445"><div class="ttname"><a href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">met_t::lsm</a></div><div class="ttdeci">float lsm[EX][EY]</div><div class="ttdoc">Land-sea mask [1].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03481">mptrac.h:3481</a></div></div>
<div class="ttc" id="astructmet__t_html_abf312f05407920f9ac855cede012efe2"><div class="ttname"><a href="structmet__t.html#abf312f05407920f9ac855cede012efe2">met_t::iwc</a></div><div class="ttdeci">float iwc[EX][EY][EP]</div><div class="ttdoc">Cloud ice water content [kg/kg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03559">mptrac.h:3559</a></div></div>
<div class="ttc" id="astructmet__t_html_ac87fdccf57a65247062baccf2c2e85e8"><div class="ttname"><a href="structmet__t.html#ac87fdccf57a65247062baccf2c2e85e8">met_t::h2ot</a></div><div class="ttdeci">float h2ot[EX][EY]</div><div class="ttdoc">Tropopause water vapor volume mixing ratio [ppv].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03499">mptrac.h:3499</a></div></div>
<div class="ttc" id="astructmet__t_html_ac8e46cfdfc9fc8cfef4e2b801834a61c"><div class="ttname"><a href="structmet__t.html#ac8e46cfdfc9fc8cfef4e2b801834a61c">met_t::pv</a></div><div class="ttdeci">float pv[EX][EY][EP]</div><div class="ttdoc">Potential vorticity [PVU].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03544">mptrac.h:3544</a></div></div>
<div class="ttc" id="astructmet__t_html_ae45079d4c0137fa4416dd42ca1f117cd"><div class="ttname"><a href="structmet__t.html#ae45079d4c0137fa4416dd42ca1f117cd">met_t::cl</a></div><div class="ttdeci">float cl[EX][EY]</div><div class="ttdoc">Total column cloud water [kg/m^2].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03508">mptrac.h:3508</a></div></div>
<div class="ttc" id="astructmet__t_html_ae775ca154716cbe5773b1b1bc634d6ba"><div class="ttname"><a href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">met_t::nss</a></div><div class="ttdeci">float nss[EX][EY]</div><div class="ttdoc">Northward turbulent surface stress [N/m^2].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03475">mptrac.h:3475</a></div></div>
<div class="ttc" id="astructmet__t_html_af2f85f717aa775b52d4791c97c3ae142"><div class="ttname"><a href="structmet__t.html#af2f85f717aa775b52d4791c97c3ae142">met_t::plfc</a></div><div class="ttdeci">float plfc[EX][EY]</div><div class="ttdoc">Pressure at level of free convection (LFC) [hPa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03514">mptrac.h:3514</a></div></div>
<div class="ttc" id="astructmet__t_html_afc1b6ec607dcb27df304f6ecb48b7fea"><div class="ttname"><a href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">met_t::swc</a></div><div class="ttdeci">float swc[EX][EY][EP]</div><div class="ttdoc">Cloud snow water content [kg/kg].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03562">mptrac.h:3562</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_acc520c5d948ea75f0acb9b351a6b8b75_cgraph.png" border="0" usemap="#amptrac_8h_acc520c5d948ea75f0acb9b351a6b8b75_cgraph" alt=""/></div>
<map name="amptrac_8h_acc520c5d948ea75f0acb9b351a6b8b75_cgraph" id="amptrac_8h_acc520c5d948ea75f0acb9b351a6b8b75_cgraph">
<area shape="rect" title="Reads meteorological data from a binary file." alt="" coords="5,56,105,83"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="175,5,253,32"/>
<area shape="rect" href="mptrac_8c.html#a4b9aea19f1f7b7461d49a90bef54d286" title="Reads a 2&#45;dimensional meteorological variable from a binary file and stores it in the provided array." alt="" coords="153,56,275,83"/>
<area shape="rect" href="mptrac_8c.html#a8acf2c312916a07fa0856aa6d4948558" title="Reads 3D meteorological data from a binary file, potentially using different compression methods." alt="" coords="153,107,275,133"/>
<area shape="rect" href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14" title="Compresses or decompresses a 3&#45;D meteorological field using cmultiscale." alt="" coords="323,5,433,32"/>
<area shape="rect" href="mptrac_8c.html#a61bbe35a4ff7b797fdb64f9797a3ffd1" title="Compresses or decompresses a 3D array of floats." alt="" coords="325,56,431,83"/>
<area shape="rect" href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3" title="Compresses or decompresses a 3&#45;D float array using the SZ3 library." alt="" coords="325,107,431,133"/>
<area shape="rect" href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72" title="Compresses or decompresses a 3D array of floats using the ZFP library." alt="" coords="327,157,429,184"/>
<area shape="rect" href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c" title="Compresses or decompresses a float array using Zstandard (ZSTD)." alt="" coords="323,208,433,235"/>
</map>
</div>

</div>
</div>
<a id="a4b9aea19f1f7b7461d49a90bef54d286" name="a4b9aea19f1f7b7461d49a90bef54d286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b9aea19f1f7b7461d49a90bef54d286">&#9670;&nbsp;</a></span>read_met_bin_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_bin_2d </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>var</em>[EX][EY], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads a 2-dimensional meteorological variable from a binary file and stores it in the provided array. </p>
<p >This function reads a 2-dimensional meteorological variable from a binary file, which is assumed to be uncompressed, and stores it in the provided 2-dimensional array <code>var</code>. The variable name is used for logging purposes to identify the data being read.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>A pointer to the FILE structure representing the binary file to read from. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data. </td></tr>
    <tr><td class="paramname">var</td><td>A 2-dimensional array to store the read variable. </td></tr>
    <tr><td class="paramname">varname</td><td>A string containing the name of the variable being read.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Allocates memory for a temporary buffer to hold the uncompressed data.</li>
<li>Logs information about the variable being read from the file.</li>
<li>Reads the uncompressed data from the file into the temporary buffer.</li>
<li>Copies the data from the temporary buffer to the provided 2-dimensional array.</li>
<li>Frees the memory allocated for the temporary buffer.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the binary file contains uncompressed data and reads the data directly into the provided array without any additional processing.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07671">7671</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7675</span>                       {</div>
<div class="line"><span class="lineno"> 7676</span> </div>
<div class="line"><span class="lineno"> 7677</span>  <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno"> 7678</span> </div>
<div class="line"><span class="lineno"> 7679</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 7680</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 7681</span>        <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>);</div>
<div class="line"><span class="lineno"> 7682</span> </div>
<div class="line"><span class="lineno"> 7683</span>  <span class="comment">/* Read uncompressed... */</span></div>
<div class="line"><span class="lineno"> 7684</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read 2-D variable: %s (uncompressed)&quot;</span>, varname);</div>
<div class="line"><span class="lineno"> 7685</span>  <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 7686</span>          (<span class="keywordtype">size_t</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>),</div>
<div class="line"><span class="lineno"> 7687</span>        in);</div>
<div class="line"><span class="lineno"> 7688</span> </div>
<div class="line"><span class="lineno"> 7689</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno"> 7690</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 7691</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 7692</span>      var[ix][iy] = help[<a class="code hl_define" href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a>(ix, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>)];</div>
<div class="line"><span class="lineno"> 7693</span> </div>
<div class="line"><span class="lineno"> 7694</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 7695</span>  free(help);</div>
<div class="line"><span class="lineno"> 7696</span>}</div>
<div class="ttc" id="amptrac_8h_html_a56fa16148a574bac429287eb4612aa2e"><div class="ttname"><a href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a></div><div class="ttdeci">#define ARRAY_2D(ix, iy, ny)</div><div class="ttdoc">Macro for computing the linear index of a 2D array element.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00439">mptrac.h:439</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8acf2c312916a07fa0856aa6d4948558" name="a8acf2c312916a07fa0856aa6d4948558"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8acf2c312916a07fa0856aa6d4948558">&#9670;&nbsp;</a></span>read_met_bin_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_bin_3d </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>var</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>bound_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>bound_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads 3D meteorological data from a binary file, potentially using different compression methods. </p>
<p >This function reads 3-dimensional meteorological data from a binary file into a specified variable array. The data can be read in uncompressed form or using one of several supported compression methods. The data is then clamped to specified minimum and maximum bounds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Pointer to the input file from which to read the data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the control structure that contains metadata about the type of data and how it is stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met</td><td>Pointer to the meteorological structure that contains the dimensions of the data. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">var</td><td>3D array to store the read data, with dimensions [EX][EY][EP]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">varname</td><td>Name of the variable being read, used for logging and debugging. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bound_min</td><td>Minimum bound to which data values should be clamped. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bound_max</td><td>Maximum bound to which data values should be clamped.</td></tr>
  </table>
  </dd>
</dl>
<p>The function supports the following types of data:</p><ul>
<li>Uncompressed data</li>
<li>Packed data</li>
<li>ZFP compressed data (if compiled with ZFP support)</li>
<li>ZSTD compressed data (if compiled with ZSTD support)</li>
<li>cmultiscale compressed data (if compiled with CMS support)</li>
</ul>
<p >Depending on the compression type specified in the control structure, the appropriate reading and decompression function is used. The data is read into a temporary buffer, then copied into the output array, applying the specified bounds to each value.</p>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the dimensions EX, EY, and EP are correctly defined and match the dimensions specified in the <code>met</code> structure. </dd>
<dd>
If the appropriate compression support is not compiled, an error message is generated.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07700">7700</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7707</span>                         {</div>
<div class="line"><span class="lineno"> 7708</span> </div>
<div class="line"><span class="lineno"> 7709</span>  <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno"> 7710</span> </div>
<div class="line"><span class="lineno"> 7711</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 7712</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 7713</span>        <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> * <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>);</div>
<div class="line"><span class="lineno"> 7714</span> </div>
<div class="line"><span class="lineno"> 7715</span>  <span class="comment">/* Read uncompressed data... */</span></div>
<div class="line"><span class="lineno"> 7716</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 1) {</div>
<div class="line"><span class="lineno"> 7717</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read 3-D variable: %s (uncompressed)&quot;</span>, varname);</div>
<div class="line"><span class="lineno"> 7718</span>    <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 7719</span>            (<span class="keywordtype">size_t</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>),</div>
<div class="line"><span class="lineno"> 7720</span>          in);</div>
<div class="line"><span class="lineno"> 7721</span>  }</div>
<div class="line"><span class="lineno"> 7722</span> </div>
<div class="line"><span class="lineno"> 7723</span>  <span class="comment">/* Read packed data... */</span></div>
<div class="line"><span class="lineno"> 7724</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 2)</div>
<div class="line"><span class="lineno"> 7725</span>    <a class="code hl_function" href="mptrac_8c.html#a61bbe35a4ff7b797fdb64f9797a3ffd1">compress_pck</a>(varname, help, (<span class="keywordtype">size_t</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>),</div>
<div class="line"><span class="lineno"> 7726</span>                 (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, 1, in);</div>
<div class="line"><span class="lineno"> 7727</span> </div>
<div class="line"><span class="lineno"> 7728</span>  <span class="comment">/* Read ZFP data... */</span></div>
<div class="line"><span class="lineno"> 7729</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 3) {</div>
<div class="line"><span class="lineno"> 7730</span><span class="preprocessor">#ifdef ZFP</span></div>
<div class="line"><span class="lineno"> 7731</span>    <span class="keywordtype">int</span> precision;</div>
<div class="line"><span class="lineno"> 7732</span>    <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;precision, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7733</span>          1,</div>
<div class="line"><span class="lineno"> 7734</span>          in);</div>
<div class="line"><span class="lineno"> 7735</span> </div>
<div class="line"><span class="lineno"> 7736</span>    <span class="keywordtype">double</span> tolerance;</div>
<div class="line"><span class="lineno"> 7737</span>    <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;tolerance, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7738</span>          1,</div>
<div class="line"><span class="lineno"> 7739</span>          in);</div>
<div class="line"><span class="lineno"> 7740</span> </div>
<div class="line"><span class="lineno"> 7741</span>    <a class="code hl_function" href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72">compress_zfp</a>(varname, help, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, precision,</div>
<div class="line"><span class="lineno"> 7742</span>                 tolerance, 1, in);</div>
<div class="line"><span class="lineno"> 7743</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 7744</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MPTRAC was compiled without ZFP compression!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7745</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 7746</span>  }</div>
<div class="line"><span class="lineno"> 7747</span> </div>
<div class="line"><span class="lineno"> 7748</span>  <span class="comment">/* Read zstd data... */</span></div>
<div class="line"><span class="lineno"> 7749</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 4) {</div>
<div class="line"><span class="lineno"> 7750</span><span class="preprocessor">#ifdef ZSTD</span></div>
<div class="line"><span class="lineno"> 7751</span>    <a class="code hl_function" href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c">compress_zstd</a>(varname, help, (<span class="keywordtype">size_t</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>), 1,</div>
<div class="line"><span class="lineno"> 7752</span>                  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1601f7c2d8e163790e3a81cc647b7756">met_zstd_level</a>, in);</div>
<div class="line"><span class="lineno"> 7753</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 7754</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MPTRAC was compiled without ZSTD compression!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7755</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 7756</span>  }</div>
<div class="line"><span class="lineno"> 7757</span> </div>
<div class="line"><span class="lineno"> 7758</span>  <span class="comment">/* Read cmultiscale data... */</span></div>
<div class="line"><span class="lineno"> 7759</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 5) {</div>
<div class="line"><span class="lineno"> 7760</span><span class="preprocessor">#ifdef CMS</span></div>
<div class="line"><span class="lineno"> 7761</span>    <a class="code hl_function" href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14">compress_cms</a>(ctl, varname, help, (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>,</div>
<div class="line"><span class="lineno"> 7762</span>                 (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>, 1, in);</div>
<div class="line"><span class="lineno"> 7763</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 7764</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MPTRAC was compiled without cmultiscale compression!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7765</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 7766</span>  }</div>
<div class="line"><span class="lineno"> 7767</span> </div>
<div class="line"><span class="lineno"> 7768</span>  <span class="comment">/* Read SZ3 data... */</span></div>
<div class="line"><span class="lineno"> 7769</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 7) {</div>
<div class="line"><span class="lineno"> 7770</span><span class="preprocessor">#ifdef SZ3</span></div>
<div class="line"><span class="lineno"> 7771</span>    <span class="keywordtype">int</span> precision;</div>
<div class="line"><span class="lineno"> 7772</span>    <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;precision, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno"> 7773</span>          1,</div>
<div class="line"><span class="lineno"> 7774</span>          in);</div>
<div class="line"><span class="lineno"> 7775</span> </div>
<div class="line"><span class="lineno"> 7776</span>    <span class="keywordtype">double</span> tolerance;</div>
<div class="line"><span class="lineno"> 7777</span>    <a class="code hl_define" href="mptrac_8h.html#a68e3272a6f873b919d4f6d8982042a50">FREAD</a>(&amp;tolerance, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 7778</span>          1,</div>
<div class="line"><span class="lineno"> 7779</span>          in);</div>
<div class="line"><span class="lineno"> 7780</span> </div>
<div class="line"><span class="lineno"> 7781</span>    <a class="code hl_function" href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3">compress_sz3</a>(varname, help, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, precision,</div>
<div class="line"><span class="lineno"> 7782</span>                 tolerance, 1, in);</div>
<div class="line"><span class="lineno"> 7783</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 7784</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MPTRAC was compiled without sz3 compression!&quot;</span>);</div>
<div class="line"><span class="lineno"> 7785</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 7786</span>  }</div>
<div class="line"><span class="lineno"> 7787</span> </div>
<div class="line"><span class="lineno"> 7788</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno"> 7789</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno"> 7790</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 7791</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 7792</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 7793</span>        var[ix][iy][ip] = help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, ip, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>)];</div>
<div class="line"><span class="lineno"> 7794</span>        <span class="keywordflow">if</span> (var[ix][iy][ip] &lt; bound_min)</div>
<div class="line"><span class="lineno"> 7795</span>          var[ix][iy][ip] = bound_min;</div>
<div class="line"><span class="lineno"> 7796</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (var[ix][iy][ip] &gt; bound_max)</div>
<div class="line"><span class="lineno"> 7797</span>          var[ix][iy][ip] = bound_max;</div>
<div class="line"><span class="lineno"> 7798</span>      }</div>
<div class="line"><span class="lineno"> 7799</span> </div>
<div class="line"><span class="lineno"> 7800</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 7801</span>  free(help);</div>
<div class="line"><span class="lineno"> 7802</span>}</div>
<div class="ttc" id="amptrac_8c_html_a61bbe35a4ff7b797fdb64f9797a3ffd1"><div class="ttname"><a href="mptrac_8c.html#a61bbe35a4ff7b797fdb64f9797a3ffd1">compress_pck</a></div><div class="ttdeci">void compress_pck(const char *varname, float *array, const size_t nxy, const size_t nz, const int decompress, FILE *inout)</div><div class="ttdoc">Compresses or decompresses a 3D array of floats.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l00680">mptrac.c:680</a></div></div>
<div class="ttc" id="amptrac_8h_html_a057bb032e8b5df1b2a228b9b7931dd0c"><div class="ttname"><a href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c">compress_zstd</a></div><div class="ttdeci">void compress_zstd(const char *varname, float *array, const size_t n, const int decompress, const int level, FILE *inout)</div><div class="ttdoc">Compresses or decompresses a float array using Zstandard (ZSTD).</div></div>
<div class="ttc" id="amptrac_8h_html_a2e72346e130df723f0e0bec4eb739b14"><div class="ttname"><a href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14">compress_cms</a></div><div class="ttdeci">void compress_cms(const ctl_t *ctl, const char *varname, float *array, const size_t nx, const size_t ny, const size_t np, const double *plev, const int decompress, FILE *inout)</div><div class="ttdoc">Compresses or decompresses a 3-D meteorological field using cmultiscale.</div></div>
<div class="ttc" id="amptrac_8h_html_a412570d903373ea3f6ca36aa907f3d72"><div class="ttname"><a href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72">compress_zfp</a></div><div class="ttdeci">void compress_zfp(const char *varname, float *array, const int nx, const int ny, const int nz, const int precision, const double tolerance, const int decompress, FILE *inout)</div><div class="ttdoc">Compresses or decompresses a 3D array of floats using the ZFP library.</div></div>
<div class="ttc" id="amptrac_8h_html_ae686ad6d0ce087fddcd62a7b87c768f3"><div class="ttname"><a href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3">compress_sz3</a></div><div class="ttdeci">void compress_sz3(const char *varname, float *array, const int nx, const int ny, const int nz, const int precision, const double tolerance, const int decompress, FILE *inout)</div><div class="ttdoc">Compresses or decompresses a 3-D float array using the SZ3 library.</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a8acf2c312916a07fa0856aa6d4948558_cgraph.png" border="0" usemap="#amptrac_8h_a8acf2c312916a07fa0856aa6d4948558_cgraph" alt=""/></div>
<map name="amptrac_8h_a8acf2c312916a07fa0856aa6d4948558_cgraph" id="amptrac_8h_a8acf2c312916a07fa0856aa6d4948558_cgraph">
<area shape="rect" title="Reads 3D meteorological data from a binary file, potentially using different compression methods." alt="" coords="5,107,127,133"/>
<area shape="rect" href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14" title="Compresses or decompresses a 3&#45;D meteorological field using cmultiscale." alt="" coords="175,5,285,32"/>
<area shape="rect" href="mptrac_8c.html#a61bbe35a4ff7b797fdb64f9797a3ffd1" title="Compresses or decompresses a 3D array of floats." alt="" coords="177,56,283,83"/>
<area shape="rect" href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3" title="Compresses or decompresses a 3&#45;D float array using the SZ3 library." alt="" coords="177,107,283,133"/>
<area shape="rect" href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72" title="Compresses or decompresses a 3D array of floats using the ZFP library." alt="" coords="179,157,281,184"/>
<area shape="rect" href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c" title="Compresses or decompresses a float array using Zstandard (ZSTD)." alt="" coords="175,208,285,235"/>
</map>
</div>

</div>
</div>
<a id="af61accbe7a6587652bb15ea68d6aee03" name="af61accbe7a6587652bb15ea68d6aee03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af61accbe7a6587652bb15ea68d6aee03">&#9670;&nbsp;</a></span>read_met_cape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_cape </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates Convective Available Potential Energy (CAPE) for each grid point. </p>
<p >This function calculates the Convective Available Potential Energy (CAPE) at each grid point based on the provided meteorological data. CAPE is a measure of the energy available for deep convection, which is essential for severe weather development.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>Pointer to the control structure that contains metadata about the type of data and how it is stored. </td></tr>
    <tr><td class="paramname">clim</td><td>A pointer to a structure containing climatological data. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets up a timer to monitor the calculation time.</li>
<li>Initializes variables and constants required for the computation, such as vertical spacing and pressure levels.</li>
<li>Iterates over each grid point in parallel using OpenMP.</li>
<li>Calculates CAPE by integrating the difference in virtual temperatures between the environment and the parcel, up to the level of free convection (LFC).</li>
<li>Determines the lifted condensation level (LCL), level of free convection (LFC), equilibrium level (EL), and Convective Inhibition (CIN) for each grid point.</li>
<li>Checks the results and updates the corresponding fields in the meteorological data structure.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The function utilizes OpenMP for parallelization to enhance performance by distributing the computation across multiple threads.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07806">7806</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7809</span>              {</div>
<div class="line"><span class="lineno"> 7810</span> </div>
<div class="line"><span class="lineno"> 7811</span>  <span class="comment">/* Check parameters... */</span></div>
<div class="line"><span class="lineno"> 7812</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a47ee3960f0b2b25382062fa8dda37ede">met_cape</a> != 1)</div>
<div class="line"><span class="lineno"> 7813</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 7814</span> </div>
<div class="line"><span class="lineno"> 7815</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 7816</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_CAPE&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno"> 7817</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Calculate CAPE...&quot;</span>);</div>
<div class="line"><span class="lineno"> 7818</span> </div>
<div class="line"><span class="lineno"> 7819</span>  <span class="comment">/* Vertical spacing (about 100 m)... */</span></div>
<div class="line"><span class="lineno"> 7820</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> pfac = 1.01439, dz0 = <a class="code hl_define" href="mptrac_8h.html#a7e71def3baefc10ec36f1dd48da4050e">RI</a> / <a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a> / <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> * log(pfac);</div>
<div class="line"><span class="lineno"> 7821</span> </div>
<div class="line"><span class="lineno"> 7822</span>  <span class="comment">/* Loop over columns... */</span></div>
<div class="line"><span class="lineno"> 7823</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno"> 7824</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 7825</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno"> 7826</span> </div>
<div class="line"><span class="lineno"> 7827</span>      <span class="comment">/* Get potential temperature and water vapor at lowest 50 hPa... */</span></div>
<div class="line"><span class="lineno"> 7828</span>      <span class="keywordtype">int</span> n = 0;</div>
<div class="line"><span class="lineno"> 7829</span>      <span class="keywordtype">double</span> h2o = 0, t, theta = 0;</div>
<div class="line"><span class="lineno"> 7830</span>      <span class="keywordtype">double</span> pbot = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy], met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[0]);</div>
<div class="line"><span class="lineno"> 7831</span>      <span class="keywordtype">double</span> ptop = pbot - 50.;</div>
<div class="line"><span class="lineno"> 7832</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 7833</span>        <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] &lt;= pbot) {</div>
<div class="line"><span class="lineno"> 7834</span>          theta += <a class="code hl_define" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip], met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip]);</div>
<div class="line"><span class="lineno"> 7835</span>          h2o += met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno"> 7836</span>          n++;</div>
<div class="line"><span class="lineno"> 7837</span>        }</div>
<div class="line"><span class="lineno"> 7838</span>        <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] &lt; ptop &amp;&amp; n &gt; 0)</div>
<div class="line"><span class="lineno"> 7839</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7840</span>      }</div>
<div class="line"><span class="lineno"> 7841</span>      theta /= n;</div>
<div class="line"><span class="lineno"> 7842</span>      h2o /= n;</div>
<div class="line"><span class="lineno"> 7843</span> </div>
<div class="line"><span class="lineno"> 7844</span>      <span class="comment">/* Cannot compute anything if water vapor is missing... */</span></div>
<div class="line"><span class="lineno"> 7845</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">plcl</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno"> 7846</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#af2f85f717aa775b52d4791c97c3ae142">plfc</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno"> 7847</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a7d6776fe9ed1966d6024567d423f0b96">pel</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno"> 7848</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno"> 7849</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno"> 7850</span>      <span class="keywordflow">if</span> (h2o &lt;= 0)</div>
<div class="line"><span class="lineno"> 7851</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 7852</span> </div>
<div class="line"><span class="lineno"> 7853</span>      <span class="comment">/* Find lifted condensation level (LCL)... */</span></div>
<div class="line"><span class="lineno"> 7854</span>      ptop = <a class="code hl_define" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>(20.);</div>
<div class="line"><span class="lineno"> 7855</span>      pbot = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy];</div>
<div class="line"><span class="lineno"> 7856</span>      <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 7857</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">plcl</a>[ix][iy] = (float) (0.5 * (pbot + ptop));</div>
<div class="line"><span class="lineno"> 7858</span>        t = theta / pow(1000. / met-&gt;<a class="code hl_variable" href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">plcl</a>[ix][iy], 0.286);</div>
<div class="line"><span class="lineno"> 7859</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="mptrac_8h.html#ab72fd70a37f29f2192b751999b6c7cc2">RH</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">plcl</a>[ix][iy], t, h2o) &gt; 100.)</div>
<div class="line"><span class="lineno"> 7860</span>          ptop = met-&gt;<a class="code hl_variable" href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">plcl</a>[ix][iy];</div>
<div class="line"><span class="lineno"> 7861</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 7862</span>          pbot = met-&gt;<a class="code hl_variable" href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">plcl</a>[ix][iy];</div>
<div class="line"><span class="lineno"> 7863</span>      } <span class="keywordflow">while</span> (pbot - ptop &gt; 0.1);</div>
<div class="line"><span class="lineno"> 7864</span> </div>
<div class="line"><span class="lineno"> 7865</span>      <span class="comment">/* Calculate CIN up to LCL... */</span></div>
<div class="line"><span class="lineno"> 7866</span>      <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno"> 7867</span>      <span class="keywordtype">double</span> dcape, dz, h2o_env, t_env;</div>
<div class="line"><span class="lineno"> 7868</span>      <span class="keywordtype">double</span> p = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy];</div>
<div class="line"><span class="lineno"> 7869</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>[ix][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno"> 7870</span>      <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 7871</span>        dz = dz0 * <a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(t, h2o);</div>
<div class="line"><span class="lineno"> 7872</span>        p /= pfac;</div>
<div class="line"><span class="lineno"> 7873</span>        t = theta / pow(1000. / p, 0.286);</div>
<div class="line"><span class="lineno"> 7874</span>        <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, p, met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix], met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy],</div>
<div class="line"><span class="lineno"> 7875</span>                            &amp;t_env, ci, cw, 1);</div>
<div class="line"><span class="lineno"> 7876</span>        <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>, p, met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix], met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy],</div>
<div class="line"><span class="lineno"> 7877</span>                            &amp;h2o_env, ci, cw, 0);</div>
<div class="line"><span class="lineno"> 7878</span>        dcape = 1e3 * <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> * (<a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(t, h2o) - <a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(t_env, h2o_env)) /</div>
<div class="line"><span class="lineno"> 7879</span>          <a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(t_env, h2o_env) * dz;</div>
<div class="line"><span class="lineno"> 7880</span>        <span class="keywordflow">if</span> (dcape &lt; 0)</div>
<div class="line"><span class="lineno"> 7881</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[ix][iy] += fabsf((<span class="keywordtype">float</span>) dcape);</div>
<div class="line"><span class="lineno"> 7882</span>      } <span class="keywordflow">while</span> (p &gt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">plcl</a>[ix][iy]);</div>
<div class="line"><span class="lineno"> 7883</span> </div>
<div class="line"><span class="lineno"> 7884</span>      <span class="comment">/* Calculate level of free convection (LFC), equilibrium level (EL),</span></div>
<div class="line"><span class="lineno"> 7885</span><span class="comment">         and convective available potential energy (CAPE)... */</span></div>
<div class="line"><span class="lineno"> 7886</span>      dcape = 0;</div>
<div class="line"><span class="lineno"> 7887</span>      p = met-&gt;<a class="code hl_variable" href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">plcl</a>[ix][iy];</div>
<div class="line"><span class="lineno"> 7888</span>      t = theta / pow(1000. / p, 0.286);</div>
<div class="line"><span class="lineno"> 7889</span>      ptop = 0.75 * <a class="code hl_function" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692">clim_tropo</a>(clim, met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy]);</div>
<div class="line"><span class="lineno"> 7890</span>      <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 7891</span>        dz = dz0 * <a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(t, h2o);</div>
<div class="line"><span class="lineno"> 7892</span>        p /= pfac;</div>
<div class="line"><span class="lineno"> 7893</span>        t -= <a class="code hl_function" href="mptrac_8c.html#afa485eb277a5ced6dac0ed77665c976c">lapse_rate</a>(t, h2o) * dz;</div>
<div class="line"><span class="lineno"> 7894</span>        <span class="keywordtype">double</span> psat = <a class="code hl_define" href="mptrac_8h.html#adc5ae7e10b1b021fb68397df5bad0a64">PSAT</a>(t);</div>
<div class="line"><span class="lineno"> 7895</span>        h2o = psat / (p - (1. - <a class="code hl_define" href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a>) * psat);</div>
<div class="line"><span class="lineno"> 7896</span>        <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, p, met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix], met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy],</div>
<div class="line"><span class="lineno"> 7897</span>                            &amp;t_env, ci, cw, 1);</div>
<div class="line"><span class="lineno"> 7898</span>        <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>, p, met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix], met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy],</div>
<div class="line"><span class="lineno"> 7899</span>                            &amp;h2o_env, ci, cw, 0);</div>
<div class="line"><span class="lineno"> 7900</span>        <span class="keywordtype">double</span> dcape_old = dcape;</div>
<div class="line"><span class="lineno"> 7901</span>        dcape = 1e3 * <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> * (<a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(t, h2o) - <a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(t_env, h2o_env)) /</div>
<div class="line"><span class="lineno"> 7902</span>          <a class="code hl_define" href="mptrac_8h.html#a068492d8c01b3b2d1aebf28ded97bb71">TVIRT</a>(t_env, h2o_env) * dz;</div>
<div class="line"><span class="lineno"> 7903</span>        <span class="keywordflow">if</span> (dcape &gt; 0) {</div>
<div class="line"><span class="lineno"> 7904</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>[ix][iy] += (float) dcape;</div>
<div class="line"><span class="lineno"> 7905</span>          <span class="keywordflow">if</span> (!isfinite(met-&gt;<a class="code hl_variable" href="structmet__t.html#af2f85f717aa775b52d4791c97c3ae142">plfc</a>[ix][iy]))</div>
<div class="line"><span class="lineno"> 7906</span>            met-&gt;<a class="code hl_variable" href="structmet__t.html#af2f85f717aa775b52d4791c97c3ae142">plfc</a>[ix][iy] = (<span class="keywordtype">float</span>) p;</div>
<div class="line"><span class="lineno"> 7907</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dcape_old &gt; 0)</div>
<div class="line"><span class="lineno"> 7908</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a7d6776fe9ed1966d6024567d423f0b96">pel</a>[ix][iy] = (float) p;</div>
<div class="line"><span class="lineno"> 7909</span>        <span class="keywordflow">if</span> (dcape &lt; 0 &amp;&amp; !isfinite(met-&gt;<a class="code hl_variable" href="structmet__t.html#af2f85f717aa775b52d4791c97c3ae142">plfc</a>[ix][iy]))</div>
<div class="line"><span class="lineno"> 7910</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[ix][iy] += fabsf((<span class="keywordtype">float</span>) dcape);</div>
<div class="line"><span class="lineno"> 7911</span>      } <span class="keywordflow">while</span> (p &gt; ptop);</div>
<div class="line"><span class="lineno"> 7912</span> </div>
<div class="line"><span class="lineno"> 7913</span>      <span class="comment">/* Check results... */</span></div>
<div class="line"><span class="lineno"> 7914</span>      <span class="keywordflow">if</span> (!isfinite(met-&gt;<a class="code hl_variable" href="structmet__t.html#af2f85f717aa775b52d4791c97c3ae142">plfc</a>[ix][iy]))</div>
<div class="line"><span class="lineno"> 7915</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno"> 7916</span>    }</div>
<div class="line"><span class="lineno"> 7917</span>}</div>
<div class="ttc" id="amptrac_8c_html_a4531cb279e09061a6f34a73695c7b692"><div class="ttname"><a href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692">clim_tropo</a></div><div class="ttdeci">double clim_tropo(const clim_t *clim, const double t, const double lat)</div><div class="ttdoc">Calculates the tropopause pressure based on climatological data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l00204">mptrac.c:204</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_af61accbe7a6587652bb15ea68d6aee03_cgraph.png" border="0" usemap="#amptrac_8h_af61accbe7a6587652bb15ea68d6aee03_cgraph" alt=""/></div>
<map name="amptrac_8h_af61accbe7a6587652bb15ea68d6aee03_cgraph" id="amptrac_8h_af61accbe7a6587652bb15ea68d6aee03_cgraph">
<area shape="rect" title="Calculates Convective Available Potential Energy (CAPE) for each grid point." alt="" coords="5,56,116,83"/>
<area shape="rect" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692" title="Calculates the tropopause pressure based on climatological data." alt="" coords="195,5,278,32"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="164,56,309,83"/>
<area shape="rect" href="mptrac_8c.html#afa485eb277a5ced6dac0ed77665c976c" title="Calculates the moist adiabatic lapse rate in Kelvin per kilometer." alt="" coords="195,107,278,133"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="390,56,465,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="386,5,469,32"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="357,107,497,133"/>
</map>
</div>

</div>
</div>
<a id="a1b20694a5f995be231b64a5121eab7a9" name="a1b20694a5f995be231b64a5121eab7a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b20694a5f995be231b64a5121eab7a9">&#9670;&nbsp;</a></span>read_met_cloud()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_cloud </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates cloud-related variables for each grid point. </p>
<p >This function calculates cloud-related variables, such as cloud cover, cloud top pressure, cloud bottom pressure, and total cloud water content, based on the provided meteorological data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets up a timer to monitor the calculation time.</li>
<li>Initializes variables and constants required for the computation.</li>
<li>Iterates over each grid point in parallel using OpenMP.</li>
<li>Determines cloud-related variables based on thresholds for liquid water content (LWC), rain water content (RWC), ice water content (IWC) and snow water content (SWC).</li>
<li>Calculates cloud cover, cloud top pressure, cloud bottom pressure, and total cloud water content for each grid point.</li>
<li>Updates the corresponding fields in the meteorological data structure.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The function utilizes OpenMP for parallelization to enhance performance by distributing the computation across multiple threads.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07921">7921</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7922</span>              {</div>
<div class="line"><span class="lineno"> 7923</span> </div>
<div class="line"><span class="lineno"> 7924</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 7925</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_CLOUD&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno"> 7926</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Calculate cloud data...&quot;</span>);</div>
<div class="line"><span class="lineno"> 7927</span> </div>
<div class="line"><span class="lineno"> 7928</span>  <span class="comment">/* Thresholds for cloud detection... */</span></div>
<div class="line"><span class="lineno"> 7929</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ccmin = 0.01, cwmin = 1e-6;</div>
<div class="line"><span class="lineno"> 7930</span> </div>
<div class="line"><span class="lineno"> 7931</span>  <span class="comment">/* Loop over columns... */</span></div>
<div class="line"><span class="lineno"> 7932</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno"> 7933</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 7934</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno"> 7935</span> </div>
<div class="line"><span class="lineno"> 7936</span>      <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 7937</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a29d404429eb9f4e95bf8fa1132455fdd">pct</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno"> 7938</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a7c44ec7c0c9f471ca8ca700adb3596c3">pcb</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno"> 7939</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#ae45079d4c0137fa4416dd42ca1f117cd">cl</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno"> 7940</span> </div>
<div class="line"><span class="lineno"> 7941</span>      <span class="comment">/* Loop over pressure levels... */</span></div>
<div class="line"><span class="lineno"> 7942</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1; ip++) {</div>
<div class="line"><span class="lineno"> 7943</span> </div>
<div class="line"><span class="lineno"> 7944</span>        <span class="comment">/* Check pressure... */</span></div>
<div class="line"><span class="lineno"> 7945</span>        <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] &gt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy] || met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] &lt; <a class="code hl_define" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>(20.))</div>
<div class="line"><span class="lineno"> 7946</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 7947</span> </div>
<div class="line"><span class="lineno"> 7948</span>        <span class="comment">/* Check ice water and liquid water content... */</span></div>
<div class="line"><span class="lineno"> 7949</span>        <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>[ix][iy][ip] &gt; ccmin</div>
<div class="line"><span class="lineno"> 7950</span>            &amp;&amp; (met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[ix][iy][ip] &gt; cwmin</div>
<div class="line"><span class="lineno"> 7951</span>                || met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[ix][iy][ip] &gt; cwmin</div>
<div class="line"><span class="lineno"> 7952</span>                || met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[ix][iy][ip] &gt; cwmin</div>
<div class="line"><span class="lineno"> 7953</span>                || met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[ix][iy][ip] &gt; cwmin)) {</div>
<div class="line"><span class="lineno"> 7954</span> </div>
<div class="line"><span class="lineno"> 7955</span>          <span class="comment">/* Get cloud top pressure ... */</span></div>
<div class="line"><span class="lineno"> 7956</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a29d404429eb9f4e95bf8fa1132455fdd">pct</a>[ix][iy]</div>
<div class="line"><span class="lineno"> 7957</span>            = (float) (0.5 * (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] + (<span class="keywordtype">float</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip + 1]));</div>
<div class="line"><span class="lineno"> 7958</span> </div>
<div class="line"><span class="lineno"> 7959</span>          <span class="comment">/* Get cloud bottom pressure ... */</span></div>
<div class="line"><span class="lineno"> 7960</span>          <span class="keywordflow">if</span> (!isfinite(met-&gt;<a class="code hl_variable" href="structmet__t.html#a7c44ec7c0c9f471ca8ca700adb3596c3">pcb</a>[ix][iy]))</div>
<div class="line"><span class="lineno"> 7961</span>            met-&gt;<a class="code hl_variable" href="structmet__t.html#a7c44ec7c0c9f471ca8ca700adb3596c3">pcb</a>[ix][iy]</div>
<div class="line"><span class="lineno"> 7962</span>              = (<span class="keywordtype">float</span>) (0.5 * (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] + met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[<a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(ip - 1, 0)]));</div>
<div class="line"><span class="lineno"> 7963</span>        }</div>
<div class="line"><span class="lineno"> 7964</span> </div>
<div class="line"><span class="lineno"> 7965</span>        <span class="comment">/* Get cloud water... */</span></div>
<div class="line"><span class="lineno"> 7966</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#ae45079d4c0137fa4416dd42ca1f117cd">cl</a>[ix][iy] += (float)</div>
<div class="line"><span class="lineno"> 7967</span>          (0.5 * (met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[ix][iy][ip] + met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[ix][iy][ip + 1]</div>
<div class="line"><span class="lineno"> 7968</span>                  + met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[ix][iy][ip] + met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[ix][iy][ip + 1]</div>
<div class="line"><span class="lineno"> 7969</span>                  + met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[ix][iy][ip] + met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[ix][iy][ip + 1]</div>
<div class="line"><span class="lineno"> 7970</span>                  + met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[ix][iy][ip] + met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[ix][iy][ip + 1])</div>
<div class="line"><span class="lineno"> 7971</span>           * 100. * (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] - met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip + 1]) / <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a>);</div>
<div class="line"><span class="lineno"> 7972</span>      }</div>
<div class="line"><span class="lineno"> 7973</span>    }</div>
<div class="line"><span class="lineno"> 7974</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2776502fa762ba5034c0759d7645d1e1" name="a2776502fa762ba5034c0759d7645d1e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2776502fa762ba5034c0759d7645d1e1">&#9670;&nbsp;</a></span>read_met_detrend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_detrend </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detrends meteorological data. </p>
<p >This function detrends meteorological data by removing spatially varying backgrounds from each grid point. Detrending helps in removing systematic biases and trends from the data, enabling better analysis and modeling.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>A pointer to a structure containing control parameters. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Checks if detrending is enabled based on the control parameters.</li>
<li>Sets up a timer to monitor the detrending time.</li>
<li>Allocates memory for a temporary meteorological data structure.</li>
<li>Calculates the standard deviation and box size for detrending.</li>
<li>Calculates the detrended data by subtracting spatially varying backgrounds.</li>
<li>Updates the original meteorological data with the detrended values.</li>
<li>Frees the allocated memory.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Detrending is performed by subtracting spatially varying backgrounds calculated from neighboring grid points. </dd>
<dd>
OpenMP is utilized for parallelization to enhance performance by distributing the computation across multiple threads.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l07978">7978</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7980</span>              {</div>
<div class="line"><span class="lineno"> 7981</span> </div>
<div class="line"><span class="lineno"> 7982</span>  <a class="code hl_struct" href="structmet__t.html">met_t</a> *help;</div>
<div class="line"><span class="lineno"> 7983</span> </div>
<div class="line"><span class="lineno"> 7984</span>  <span class="comment">/* Check parameters... */</span></div>
<div class="line"><span class="lineno"> 7985</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9bc04b87ec1a0e2403117d639f6c1416">met_detrend</a> &lt;= 0)</div>
<div class="line"><span class="lineno"> 7986</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 7987</span> </div>
<div class="line"><span class="lineno"> 7988</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 7989</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_DETREND&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno"> 7990</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Detrend meteo data...&quot;</span>);</div>
<div class="line"><span class="lineno"> 7991</span> </div>
<div class="line"><span class="lineno"> 7992</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 7993</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <a class="code hl_struct" href="structmet__t.html">met_t</a>, 1);</div>
<div class="line"><span class="lineno"> 7994</span> </div>
<div class="line"><span class="lineno"> 7995</span>  <span class="comment">/* Calculate standard deviation... */</span></div>
<div class="line"><span class="lineno"> 7996</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> sigma = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9bc04b87ec1a0e2403117d639f6c1416">met_detrend</a> / 2.355;</div>
<div class="line"><span class="lineno"> 7997</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> tssq = 2. * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(sigma);</div>
<div class="line"><span class="lineno"> 7998</span> </div>
<div class="line"><span class="lineno"> 7999</span>  <span class="comment">/* Calculate box size in latitude... */</span></div>
<div class="line"><span class="lineno"> 8000</span>  <span class="keywordtype">int</span> sy = (int) (3. * <a class="code hl_define" href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">DY2DEG</a>(sigma) / fabs(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[0]));</div>
<div class="line"><span class="lineno"> 8001</span>  sy = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(1, sy), met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> / 2);</div>
<div class="line"><span class="lineno"> 8002</span> </div>
<div class="line"><span class="lineno"> 8003</span>  <span class="comment">/* Calculate background... */</span></div>
<div class="line"><span class="lineno"> 8004</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno"> 8005</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++) {</div>
<div class="line"><span class="lineno"> 8006</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno"> 8007</span> </div>
<div class="line"><span class="lineno"> 8008</span>      <span class="comment">/* Calculate Cartesian coordinates... */</span></div>
<div class="line"><span class="lineno"> 8009</span>      <span class="keywordtype">double</span> x0[3];</div>
<div class="line"><span class="lineno"> 8010</span>      <a class="code hl_function" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(0.0, met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix], met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy], x0);</div>
<div class="line"><span class="lineno"> 8011</span> </div>
<div class="line"><span class="lineno"> 8012</span>      <span class="comment">/* Calculate box size in longitude... */</span></div>
<div class="line"><span class="lineno"> 8013</span>      <span class="keywordtype">int</span> sx =</div>
<div class="line"><span class="lineno"> 8014</span>        (int) (3. * <a class="code hl_define" href="mptrac_8h.html#a6b22b78dc1239748a44cbd2db4862ef4">DX2DEG</a>(sigma, met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy]) /</div>
<div class="line"><span class="lineno"> 8015</span>               fabs(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[0]));</div>
<div class="line"><span class="lineno"> 8016</span>      sx = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(1, sx), met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> / 2);</div>
<div class="line"><span class="lineno"> 8017</span> </div>
<div class="line"><span class="lineno"> 8018</span>      <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno"> 8019</span>      <span class="keywordtype">float</span> wsum = 0;</div>
<div class="line"><span class="lineno"> 8020</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 8021</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno"> 8022</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno"> 8023</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno"> 8024</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno"> 8025</span>      }</div>
<div class="line"><span class="lineno"> 8026</span> </div>
<div class="line"><span class="lineno"> 8027</span>      <span class="comment">/* Loop over neighboring grid points... */</span></div>
<div class="line"><span class="lineno"> 8028</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix2 = ix - sx; ix2 &lt;= ix + sx; ix2++) {</div>
<div class="line"><span class="lineno"> 8029</span>        <span class="keywordtype">int</span> ix3 = ix2;</div>
<div class="line"><span class="lineno"> 8030</span>        <span class="keywordflow">if</span> (ix3 &lt; 0)</div>
<div class="line"><span class="lineno"> 8031</span>          ix3 += met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>;</div>
<div class="line"><span class="lineno"> 8032</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ix3 &gt;= met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>)</div>
<div class="line"><span class="lineno"> 8033</span>          ix3 -= met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>;</div>
<div class="line"><span class="lineno"> 8034</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy2 = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(iy - sy, 0);</div>
<div class="line"><span class="lineno"> 8035</span>             iy2 &lt;= <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(iy + sy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 1); iy2++) {</div>
<div class="line"><span class="lineno"> 8036</span> </div>
<div class="line"><span class="lineno"> 8037</span>          <span class="comment">/* Calculate Cartesian coordinates... */</span></div>
<div class="line"><span class="lineno"> 8038</span>          <span class="keywordtype">double</span> x1[3];</div>
<div class="line"><span class="lineno"> 8039</span>          <a class="code hl_function" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(0.0, met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix3], met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy2], x1);</div>
<div class="line"><span class="lineno"> 8040</span> </div>
<div class="line"><span class="lineno"> 8041</span>          <span class="comment">/* Calculate weighting factor... */</span></div>
<div class="line"><span class="lineno"> 8042</span>          <span class="keyword">const</span> <span class="keywordtype">float</span> w = (float) exp(-<a class="code hl_define" href="mptrac_8h.html#af003cf5f79f68880f39a9a95d69f19bb">DIST2</a>(x0, x1) / tssq);</div>
<div class="line"><span class="lineno"> 8043</span> </div>
<div class="line"><span class="lineno"> 8044</span>          <span class="comment">/* Add data... */</span></div>
<div class="line"><span class="lineno"> 8045</span>          wsum += w;</div>
<div class="line"><span class="lineno"> 8046</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 8047</span>            help-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix3][iy2][ip];</div>
<div class="line"><span class="lineno"> 8048</span>            help-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix3][iy2][ip];</div>
<div class="line"><span class="lineno"> 8049</span>            help-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix3][iy2][ip];</div>
<div class="line"><span class="lineno"> 8050</span>            help-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix3][iy2][ip];</div>
<div class="line"><span class="lineno"> 8051</span>          }</div>
<div class="line"><span class="lineno"> 8052</span>        }</div>
<div class="line"><span class="lineno"> 8053</span>      }</div>
<div class="line"><span class="lineno"> 8054</span> </div>
<div class="line"><span class="lineno"> 8055</span>      <span class="comment">/* Normalize... */</span></div>
<div class="line"><span class="lineno"> 8056</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 8057</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno"> 8058</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno"> 8059</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno"> 8060</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno"> 8061</span>      }</div>
<div class="line"><span class="lineno"> 8062</span>    }</div>
<div class="line"><span class="lineno"> 8063</span>  }</div>
<div class="line"><span class="lineno"> 8064</span> </div>
<div class="line"><span class="lineno"> 8065</span>  <span class="comment">/* Subtract background... */</span></div>
<div class="line"><span class="lineno"> 8066</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(3)</span></div>
<div class="line"><span class="lineno"> 8067</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8068</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8069</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 8070</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip] -= help-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno"> 8071</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip] -= help-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno"> 8072</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip] -= help-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno"> 8073</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip] -= help-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno"> 8074</span>      }</div>
<div class="line"><span class="lineno"> 8075</span> </div>
<div class="line"><span class="lineno"> 8076</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 8077</span>  free(help);</div>
<div class="line"><span class="lineno"> 8078</span>}</div>
<div class="ttc" id="amptrac_8c_html_ae3aea782dfca9019f3f2d169f8cc0f6d"><div class="ttname"><a href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a></div><div class="ttdeci">void geo2cart(const double z, const double lon, const double lat, double *x)</div><div class="ttdoc">Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l01962">mptrac.c:1962</a></div></div>
<div class="ttc" id="amptrac_8h_html_af003cf5f79f68880f39a9a95d69f19bb"><div class="ttname"><a href="mptrac_8h.html#af003cf5f79f68880f39a9a95d69f19bb">DIST2</a></div><div class="ttdeci">#define DIST2(a, b)</div><div class="ttdoc">Calculate the squared Euclidean distance between two points in Cartesian coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00683">mptrac.h:683</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a2776502fa762ba5034c0759d7645d1e1_cgraph.png" border="0" usemap="#amptrac_8h_a2776502fa762ba5034c0759d7645d1e1_cgraph" alt=""/></div>
<map name="amptrac_8h_a2776502fa762ba5034c0759d7645d1e1_cgraph" id="amptrac_8h_a2776502fa762ba5034c0759d7645d1e1_cgraph">
<area shape="rect" title="Detrends meteorological data." alt="" coords="5,5,132,32"/>
<area shape="rect" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="180,5,252,32"/>
</map>
</div>

</div>
</div>
<a id="a089d9c0099e3fc6944c2a48667362ca0" name="a089d9c0099e3fc6944c2a48667362ca0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a089d9c0099e3fc6944c2a48667362ca0">&#9670;&nbsp;</a></span>read_met_extrapolate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_extrapolate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extrapolates meteorological data. </p>
<p >This function extrapolates meteorological data by filling missing or invalid data points with values from the nearest valid point above. Extrapolation is performed column-wise, ensuring that missing data points are replaced with valid values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets up a timer to monitor the extrapolation time.</li>
<li>Loops over each grid column in parallel.</li>
<li>Finds the lowest valid data point within each column.</li>
<li>Extrapolates missing or invalid data points by copying values from the nearest valid point above.</li>
<li>Updates the meteorological data structure with the extrapolated values.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Extrapolation is performed by copying values from the nearest valid point above to fill missing or invalid data points. OpenMP is utilized for parallelization to enhance performance by distributing the computation across multiple threads.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l08082">8082</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8083</span>              {</div>
<div class="line"><span class="lineno"> 8084</span> </div>
<div class="line"><span class="lineno"> 8085</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 8086</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_EXTRAPOLATE&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno"> 8087</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Extrapolate meteo data...&quot;</span>);</div>
<div class="line"><span class="lineno"> 8088</span> </div>
<div class="line"><span class="lineno"> 8089</span>  <span class="comment">/* Loop over columns... */</span></div>
<div class="line"><span class="lineno"> 8090</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno"> 8091</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8092</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno"> 8093</span> </div>
<div class="line"><span class="lineno"> 8094</span>      <span class="comment">/* Find lowest valid data point... */</span></div>
<div class="line"><span class="lineno"> 8095</span>      <span class="keywordtype">int</span> ip0;</div>
<div class="line"><span class="lineno"> 8096</span>      <span class="keywordflow">for</span> (ip0 = met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1; ip0 &gt;= 0; ip0--)</div>
<div class="line"><span class="lineno"> 8097</span>        <span class="keywordflow">if</span> (!isfinite(met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip0])</div>
<div class="line"><span class="lineno"> 8098</span>            || !isfinite(met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip0])</div>
<div class="line"><span class="lineno"> 8099</span>            || !isfinite(met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip0])</div>
<div class="line"><span class="lineno"> 8100</span>            || !isfinite(met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip0]))</div>
<div class="line"><span class="lineno"> 8101</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8102</span> </div>
<div class="line"><span class="lineno"> 8103</span>      <span class="comment">/* Extrapolate... */</span></div>
<div class="line"><span class="lineno"> 8104</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = ip0; ip &gt;= 0; ip--) {</div>
<div class="line"><span class="lineno"> 8105</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip + 1];</div>
<div class="line"><span class="lineno"> 8106</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip + 1];</div>
<div class="line"><span class="lineno"> 8107</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip + 1];</div>
<div class="line"><span class="lineno"> 8108</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip + 1];</div>
<div class="line"><span class="lineno"> 8109</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip + 1];</div>
<div class="line"><span class="lineno"> 8110</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[ix][iy][ip + 1];</div>
<div class="line"><span class="lineno"> 8111</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[ix][iy][ip + 1];</div>
<div class="line"><span class="lineno"> 8112</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[ix][iy][ip + 1];</div>
<div class="line"><span class="lineno"> 8113</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[ix][iy][ip + 1];</div>
<div class="line"><span class="lineno"> 8114</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[ix][iy][ip + 1];</div>
<div class="line"><span class="lineno"> 8115</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>[ix][iy][ip + 1];</div>
<div class="line"><span class="lineno"> 8116</span>      }</div>
<div class="line"><span class="lineno"> 8117</span>    }</div>
<div class="line"><span class="lineno"> 8118</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a01594c9f21549808fcf2f2f8be781e79" name="a01594c9f21549808fcf2f2f8be781e79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01594c9f21549808fcf2f2f8be781e79">&#9670;&nbsp;</a></span>read_met_geopot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_geopot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates geopotential heights from meteorological data. </p>
<p >This function calculates geopotential heights from provided meteorological data using the hydrostatic equation. Geopotential heights are computed column-wise for each grid point based on the temperature, pressure, and surface height information. Optionally, the calculated geopotential heights can be smoothed horizontally using a weighted averaging scheme.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>A pointer to a structure containing control parameters. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets up a timer to monitor the geopotential height calculation time.</li>
<li>Calculates the logarithm of pressure levels for efficient computation.</li>
<li>Applies the hydrostatic equation to determine geopotential heights based on temperature, pressure, and height information.</li>
<li>Optionally, performs horizontal smoothing on the calculated geopotential heights.</li>
<li>Updates the meteorological data structure with the computed geopotential heights.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The hydrostatic equation is utilized to calculate geopotential heights, ensuring consistency with atmospheric conditions. Optionally, horizontal smoothing can be applied to the calculated geopotential heights to reduce spatial variability. OpenMP is utilized for parallelization to enhance performance by distributing the computation across multiple threads.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l08122">8122</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8124</span>              {</div>
<div class="line"><span class="lineno"> 8125</span> </div>
<div class="line"><span class="lineno"> 8126</span>  <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno"> 8127</span> </div>
<div class="line"><span class="lineno"> 8128</span>  <span class="keywordtype">double</span> logp[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>];</div>
<div class="line"><span class="lineno"> 8129</span> </div>
<div class="line"><span class="lineno"> 8130</span>  <span class="keywordtype">int</span> dx = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a416596b692cca87f14e83f851db35e29">met_geopot_sx</a>, dy = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2ec0ba6ad9f46184228f1a1784596218">met_geopot_sy</a>;</div>
<div class="line"><span class="lineno"> 8131</span> </div>
<div class="line"><span class="lineno"> 8132</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 8133</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_GEOPOT&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno"> 8134</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Calculate geopotential heights...&quot;</span>);</div>
<div class="line"><span class="lineno"> 8135</span> </div>
<div class="line"><span class="lineno"> 8136</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 8137</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 8138</span>        <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> * <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>);</div>
<div class="line"><span class="lineno"> 8139</span> </div>
<div class="line"><span class="lineno"> 8140</span>  <span class="comment">/* Calculate log pressure... */</span></div>
<div class="line"><span class="lineno"> 8141</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 8142</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 8143</span>    logp[ip] = log(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip]);</div>
<div class="line"><span class="lineno"> 8144</span> </div>
<div class="line"><span class="lineno"> 8145</span>  <span class="comment">/* Apply hydrostatic equation to calculate geopotential heights... */</span></div>
<div class="line"><span class="lineno"> 8146</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno"> 8147</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8148</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno"> 8149</span> </div>
<div class="line"><span class="lineno"> 8150</span>      <span class="comment">/* Get surface height and pressure... */</span></div>
<div class="line"><span class="lineno"> 8151</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> zs = met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[ix][iy];</div>
<div class="line"><span class="lineno"> 8152</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> lnps = log(met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy]);</div>
<div class="line"><span class="lineno"> 8153</span> </div>
<div class="line"><span class="lineno"> 8154</span>      <span class="comment">/* Get temperature and water vapor at the surface... */</span></div>
<div class="line"><span class="lineno"> 8155</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> ip0 = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy]);</div>
<div class="line"><span class="lineno"> 8156</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> ts = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip0], met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip0], met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip0 + 1],</div>
<div class="line"><span class="lineno"> 8157</span>                            met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip0 + 1], met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy]);</div>
<div class="line"><span class="lineno"> 8158</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> h2os =</div>
<div class="line"><span class="lineno"> 8159</span>        <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip0], met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip0], met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip0 + 1],</div>
<div class="line"><span class="lineno"> 8160</span>            met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip0 + 1], met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy]);</div>
<div class="line"><span class="lineno"> 8161</span> </div>
<div class="line"><span class="lineno"> 8162</span>      <span class="comment">/* Upper part of profile... */</span></div>
<div class="line"><span class="lineno"> 8163</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip0 + 1]</div>
<div class="line"><span class="lineno"> 8164</span>        = (float) (zs +</div>
<div class="line"><span class="lineno"> 8165</span>                   <a class="code hl_define" href="mptrac_8h.html#a8c73522db5d14433bd9ad2bd45d0de5f">ZDIFF</a>(lnps, ts, h2os, logp[ip0 + 1],</div>
<div class="line"><span class="lineno"> 8166</span>                         met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip0 + 1], met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip0 + 1]));</div>
<div class="line"><span class="lineno"> 8167</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = ip0 + 2; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 8168</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip]</div>
<div class="line"><span class="lineno"> 8169</span>          = (<span class="keywordtype">float</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip - 1] +</div>
<div class="line"><span class="lineno"> 8170</span>                     <a class="code hl_define" href="mptrac_8h.html#a8c73522db5d14433bd9ad2bd45d0de5f">ZDIFF</a>(logp[ip - 1], met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip - 1],</div>
<div class="line"><span class="lineno"> 8171</span>                           met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip - 1], logp[ip],</div>
<div class="line"><span class="lineno"> 8172</span>                           met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip], met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip]));</div>
<div class="line"><span class="lineno"> 8173</span> </div>
<div class="line"><span class="lineno"> 8174</span>      <span class="comment">/* Lower part of profile... */</span></div>
<div class="line"><span class="lineno"> 8175</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip0]</div>
<div class="line"><span class="lineno"> 8176</span>        = (float) (zs +</div>
<div class="line"><span class="lineno"> 8177</span>                   <a class="code hl_define" href="mptrac_8h.html#a8c73522db5d14433bd9ad2bd45d0de5f">ZDIFF</a>(lnps, ts, h2os, logp[ip0],</div>
<div class="line"><span class="lineno"> 8178</span>                         met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip0], met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip0]));</div>
<div class="line"><span class="lineno"> 8179</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = ip0 - 1; ip &gt;= 0; ip--)</div>
<div class="line"><span class="lineno"> 8180</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip]</div>
<div class="line"><span class="lineno"> 8181</span>          = (<span class="keywordtype">float</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip + 1] +</div>
<div class="line"><span class="lineno"> 8182</span>                     <a class="code hl_define" href="mptrac_8h.html#a8c73522db5d14433bd9ad2bd45d0de5f">ZDIFF</a>(logp[ip + 1], met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip + 1],</div>
<div class="line"><span class="lineno"> 8183</span>                           met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip + 1], logp[ip],</div>
<div class="line"><span class="lineno"> 8184</span>                           met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip], met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip]));</div>
<div class="line"><span class="lineno"> 8185</span>    }</div>
<div class="line"><span class="lineno"> 8186</span> </div>
<div class="line"><span class="lineno"> 8187</span>  <span class="comment">/* Check control parameters... */</span></div>
<div class="line"><span class="lineno"> 8188</span>  <span class="keywordflow">if</span> (dx == 0 || dy == 0)</div>
<div class="line"><span class="lineno"> 8189</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 8190</span> </div>
<div class="line"><span class="lineno"> 8191</span>  <span class="comment">/* Default smoothing parameters... */</span></div>
<div class="line"><span class="lineno"> 8192</span>  <span class="keywordflow">if</span> (dx &lt; 0 || dy &lt; 0) {</div>
<div class="line"><span class="lineno"> 8193</span>    <span class="keywordflow">if</span> (fabs(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[0]) &lt; 0.5) {</div>
<div class="line"><span class="lineno"> 8194</span>      dx = 3;</div>
<div class="line"><span class="lineno"> 8195</span>      dy = 2;</div>
<div class="line"><span class="lineno"> 8196</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8197</span>      dx = 6;</div>
<div class="line"><span class="lineno"> 8198</span>      dy = 4;</div>
<div class="line"><span class="lineno"> 8199</span>    }</div>
<div class="line"><span class="lineno"> 8200</span>  }</div>
<div class="line"><span class="lineno"> 8201</span> </div>
<div class="line"><span class="lineno"> 8202</span>  <span class="comment">/* Calculate weights for smoothing... */</span></div>
<div class="line"><span class="lineno"> 8203</span>  <span class="keywordtype">float</span> ws[dx + 1][dy + 1];</div>
<div class="line"><span class="lineno"> 8204</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno"> 8205</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt;= dx; ix++)</div>
<div class="line"><span class="lineno"> 8206</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; dy; iy++)</div>
<div class="line"><span class="lineno"> 8207</span>      ws[ix][iy] = (1.0f - (<span class="keywordtype">float</span>) ix / (float) dx)</div>
<div class="line"><span class="lineno"> 8208</span>        * (1.0f - (float) iy / (<span class="keywordtype">float</span>) dy);</div>
<div class="line"><span class="lineno"> 8209</span> </div>
<div class="line"><span class="lineno"> 8210</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno"> 8211</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(3)</span></div>
<div class="line"><span class="lineno"> 8212</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8213</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8214</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 8215</span>        help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ip, ix, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>)] = met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno"> 8216</span> </div>
<div class="line"><span class="lineno"> 8217</span>  <span class="comment">/* Horizontal smoothing... */</span></div>
<div class="line"><span class="lineno"> 8218</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(3)</span></div>
<div class="line"><span class="lineno"> 8219</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 8220</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8221</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno"> 8222</span>        <span class="keywordtype">float</span> res = 0, wsum = 0;</div>
<div class="line"><span class="lineno"> 8223</span>        <span class="keywordtype">int</span> iy0 = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(iy - dy + 1, 0);</div>
<div class="line"><span class="lineno"> 8224</span>        <span class="keywordtype">int</span> iy1 = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(iy + dy - 1, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 1);</div>
<div class="line"><span class="lineno"> 8225</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix2 = ix - dx + 1; ix2 &lt;= ix + dx - 1; ++ix2) {</div>
<div class="line"><span class="lineno"> 8226</span>          <span class="keywordtype">int</span> ix3 = ix2;</div>
<div class="line"><span class="lineno"> 8227</span>          <span class="keywordflow">if</span> (ix3 &lt; 0)</div>
<div class="line"><span class="lineno"> 8228</span>            ix3 += met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>;</div>
<div class="line"><span class="lineno"> 8229</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ix3 &gt;= met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>)</div>
<div class="line"><span class="lineno"> 8230</span>            ix3 -= met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>;</div>
<div class="line"><span class="lineno"> 8231</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy2 = iy0; iy2 &lt;= iy1; ++iy2)</div>
<div class="line"><span class="lineno"> 8232</span>            <span class="keywordflow">if</span> (isfinite(help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ip, ix3, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, iy2, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>)])) {</div>
<div class="line"><span class="lineno"> 8233</span>              <span class="keywordtype">float</span> w = ws[abs(ix - ix2)][abs(iy - iy2)];</div>
<div class="line"><span class="lineno"> 8234</span>              res += w * help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ip, ix3, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, iy2, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>)];</div>
<div class="line"><span class="lineno"> 8235</span>              wsum += w;</div>
<div class="line"><span class="lineno"> 8236</span>            }</div>
<div class="line"><span class="lineno"> 8237</span>        }</div>
<div class="line"><span class="lineno"> 8238</span>        <span class="keywordflow">if</span> (wsum &gt; 0)</div>
<div class="line"><span class="lineno"> 8239</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip] = res / wsum;</div>
<div class="line"><span class="lineno"> 8240</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8241</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip] = NAN;</div>
<div class="line"><span class="lineno"> 8242</span>      }</div>
<div class="line"><span class="lineno"> 8243</span> </div>
<div class="line"><span class="lineno"> 8244</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 8245</span>  free(help);</div>
<div class="line"><span class="lineno"> 8246</span>}</div>
<div class="ttc" id="amptrac_8h_html_a8c73522db5d14433bd9ad2bd45d0de5f"><div class="ttname"><a href="mptrac_8h.html#a8c73522db5d14433bd9ad2bd45d0de5f">ZDIFF</a></div><div class="ttdeci">#define ZDIFF(lnp0, t0, h2o0, lnp1, t1, h2o1)</div><div class="ttdoc">Calculate geopotential height difference.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01911">mptrac.h:1911</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a01594c9f21549808fcf2f2f8be781e79_cgraph.png" border="0" usemap="#amptrac_8h_a01594c9f21549808fcf2f2f8be781e79_cgraph" alt=""/></div>
<map name="amptrac_8h_a01594c9f21549808fcf2f2f8be781e79_cgraph" id="amptrac_8h_a01594c9f21549808fcf2f2f8be781e79_cgraph">
<area shape="rect" title="Calculates geopotential heights from meteorological data." alt="" coords="5,5,128,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="176,5,251,32"/>
</map>
</div>

</div>
</div>
<a id="a82c358b6cc1f736e2f186c8aef4d6a79" name="a82c358b6cc1f736e2f186c8aef4d6a79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82c358b6cc1f736e2f186c8aef4d6a79">&#9670;&nbsp;</a></span>read_met_grib()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_met_grib </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads meteorological data from a grib file and processes it. </p>
<p >This function reads meteorological data from a grib file specified by the <code>filename</code> parameter, using the ECCODES library. It reads grid, surface, and vertical level data, processes the data and calculates various derived meteorological fields such as geopotential heights, potential vorticity, cloud properties, and convective available potential energy (CAPE).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A constant character pointer representing the name of the grib files to read the meteorological data from. The sf or ml suffixes indicating surface or multi-level data should be replaced with XX. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure, which contains control parameters for reading and processing the meteorological data. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure that will store the meteorological data read and processed from the NetCDF file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 on success, or 0 if the file cannot be opened.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function reads grid data, vertical level data, and surface data from the file, and processes the data to calculate additional meteorological parameters.</li>
<li>If the file cannot be opened, the function logs a warning and returns 0.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Nils Nobre Wittwer </dd></dl>

</div>
</div>
<a id="ae29b6f816c6177addaaae17589e3fc90" name="ae29b6f816c6177addaaae17589e3fc90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae29b6f816c6177addaaae17589e3fc90">&#9670;&nbsp;</a></span>read_met_grib_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_grib_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mptrac_8h.html#a5aa74f0eae3fc2645b1fd1ec7efe0c8c">codes_handle</a> **&#160;</td>
          <td class="paramname"><em>handles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>count_handles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads global meteorological information from a grib file. </p>
<p >This function reads meteorological grid information from a grib file, including time and spatial dimensions. The function computes the latitude and longitude grid based on the provided boundaries and increment values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handles</td><td>A pointer to an array of codes_handle pointers representing the grib messages. </td></tr>
    <tr><td class="paramname">count_handles</td><td>The total number of grib messages in the handles array. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure to store meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets up a timer to monitor the reading time for meteorological grid information.</li>
<li>Determines the time information from the data file.</li>
<li>Retrieves grid dimensions (longitude, latitude, and vertical levels) from the grib file.</li>
<li>Reads longitudes and latitudes boundaries and increments from the grib file and computes the grid.</li>
<li>Logs the retrieved grid information for verification and debugging purposes.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Nils Nobre Wittwer </dd></dl>

</div>
</div>
<a id="a9c4adfad6db9c544b2dd4399fb7ee531" name="a9c4adfad6db9c544b2dd4399fb7ee531"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c4adfad6db9c544b2dd4399fb7ee531">&#9670;&nbsp;</a></span>read_met_grib_levels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_grib_levels </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mptrac_8h.html#a5aa74f0eae3fc2645b1fd1ec7efe0c8c">codes_handle</a> **&#160;</td>
          <td class="paramname"><em>handles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>num_messages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads meteorological variables at different vertical levels from a grib file. </p>
<p >This function reads meteorological variables such as temperature, wind components, specific humidity, ozone data, cloud parameters, and cloud cover at various vertical levels from a grib file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handles</td><td>A pointer to an array of codes_handle pointers representing the grib messages. </td></tr>
    <tr><td class="paramname">num_messages</td><td>The total number of grib messages in the handles array. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a structure containing control parameters. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure to store meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets up a timer to monitor the reading time for meteorological level data.</li>
<li>Reads meteorological variables from the grib file.</li>
<li>Checks the ordering of pressure levels to ensure they are in descending order.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Nils Nobre Wittwer </dd></dl>

</div>
</div>
<a id="a083193a16b89fb11373c95354eaf54e5" name="a083193a16b89fb11373c95354eaf54e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a083193a16b89fb11373c95354eaf54e5">&#9670;&nbsp;</a></span>read_met_grib_surface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_grib_surface </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="mptrac_8h.html#a5aa74f0eae3fc2645b1fd1ec7efe0c8c">codes_handle</a> **&#160;</td>
          <td class="paramname"><em>handles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>num_messages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads surface meteorological data from a grib file and stores it in the meteorological data structure. </p>
<p >This function reads various surface meteorological variables from a grib file and stores them in the provided meteorological data structure. Depending on the configuration, it may read data for surface pressure, geopotential height, temperature, zonal and meridional wind components, land-sea mask, and sea surface temperature.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handles</td><td>A pointer to an array of codes_handle pointers representing the grib messages. </td></tr>
    <tr><td class="paramname">num_messages</td><td>The total number of grib messages in the handles array. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a structure containing control parameters. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure to store meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets a timer for performance monitoring.</li>
<li>Reads surface meteorological data based on the configuration:</li>
<li>Reads surface pressure from "lnsp", "ps", or "sp" variables.</li>
<li>Converts surface pressure to Pa.</li>
<li>Reads geopotential height at the surface from "z" or "zm" variables.</li>
<li>Reads surface temperature from "t2m" or "2t" variables.</li>
<li>Reads zonal wind at the surface from "u10m" or "10u" variables.</li>
<li>Reads meridional wind at the surface from "v10m" or "10v" variables.</li>
<li>Reads land-sea mask from "lsm" variable.</li>
<li>Reads sea surface temperature from "sstk" or "sst" variables.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Nils Nobre Wittwer </dd></dl>

</div>
</div>
<a id="a449f642b01d0dc65cc32f86a850bcb7b" name="a449f642b01d0dc65cc32f86a850bcb7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a449f642b01d0dc65cc32f86a850bcb7b">&#9670;&nbsp;</a></span>read_met_ml2pl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_ml2pl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>var</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolates meteorological data to specified pressure levels. </p>
<p >This function interpolates meteorological data from model levels to pressure levels. The interpolation is performed in parallel over the spatial grid defined in the meteorological data structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>A pointer to a control structure containing the number of pressure levels (<code>met_np</code>) and the pressure levels themselves (<code>met_p</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">met</td><td>A pointer to a meteorological data structure containing the grid dimensions (<code>nx</code>, <code>ny</code>) and the pressure profile (<code>pl</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">var</td><td>A 3D array containing the meteorological variable to be interpolated. On output, this array will contain the interpolated values at the specified pressure levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">varname</td><td>A string representing the name of the meteorological variable being interpolated.</td></tr>
  </table>
  </dd>
</dl>
<p>This function performs the following steps:</p><ul>
<li>Sets a timer for the operation.</li>
<li>Logs the start of the interpolation process with the variable name.</li>
<li>Loops over the spatial columns (grid points).</li>
<li>For each column, copies the pressure profile.</li>
<li>Interpolates the meteorological variable to the specified pressure levels.</li>
<li>Copies the interpolated data back into the <code>var</code> array.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The interpolation is performed in parallel using OpenMP.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l09706">9706</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 9710</span>                       {</div>
<div class="line"><span class="lineno"> 9711</span> </div>
<div class="line"><span class="lineno"> 9712</span>  <span class="keywordtype">double</span> aux[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], p[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>];</div>
<div class="line"><span class="lineno"> 9713</span> </div>
<div class="line"><span class="lineno"> 9714</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 9715</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_ML2PL&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno"> 9716</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Interpolate meteo data to pressure levels: %s&quot;</span>, varname);</div>
<div class="line"><span class="lineno"> 9717</span> </div>
<div class="line"><span class="lineno"> 9718</span>  <span class="comment">/* Loop over columns... */</span></div>
<div class="line"><span class="lineno"> 9719</span><span class="preprocessor">#pragma omp parallel for default(shared) private(aux,p) collapse(2)</span></div>
<div class="line"><span class="lineno"> 9720</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 9721</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno"> 9722</span> </div>
<div class="line"><span class="lineno"> 9723</span>      <span class="comment">/* Copy pressure profile... */</span></div>
<div class="line"><span class="lineno"> 9724</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 9725</span>        p[ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno"> 9726</span> </div>
<div class="line"><span class="lineno"> 9727</span>      <span class="comment">/* Interpolate... */</span></div>
<div class="line"><span class="lineno"> 9728</span>      for (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 9729</span>        <span class="keywordtype">double</span> pt = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[ip];</div>
<div class="line"><span class="lineno"> 9730</span>        <span class="keywordflow">if</span> ((pt &gt; p[0] &amp;&amp; p[0] &gt; p[1]) || (pt &lt; p[0] &amp;&amp; p[0] &lt; p[1]))</div>
<div class="line"><span class="lineno"> 9731</span>          pt = p[0];</div>
<div class="line"><span class="lineno"> 9732</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((pt &gt; p[met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1] &amp;&amp; p[1] &gt; p[0])</div>
<div class="line"><span class="lineno"> 9733</span>                 || (pt &lt; p[met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1] &amp;&amp; p[1] &lt; p[0]))</div>
<div class="line"><span class="lineno"> 9734</span>          pt = p[met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1];</div>
<div class="line"><span class="lineno"> 9735</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> ip2 = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(p, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, pt);</div>
<div class="line"><span class="lineno"> 9736</span>        aux[ip] = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(p[ip2], var[ix][iy][ip2],</div>
<div class="line"><span class="lineno"> 9737</span>                      p[ip2 + 1], var[ix][iy][ip2 + 1], pt);</div>
<div class="line"><span class="lineno"> 9738</span>      }</div>
<div class="line"><span class="lineno"> 9739</span> </div>
<div class="line"><span class="lineno"> 9740</span>      <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno"> 9741</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>; ip++)</div>
<div class="line"><span class="lineno"> 9742</span>        var[ix][iy][ip] = (<span class="keywordtype">float</span>) aux[ip];</div>
<div class="line"><span class="lineno"> 9743</span>    }</div>
<div class="line"><span class="lineno"> 9744</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a449f642b01d0dc65cc32f86a850bcb7b_cgraph.png" border="0" usemap="#amptrac_8h_a449f642b01d0dc65cc32f86a850bcb7b_cgraph" alt=""/></div>
<map name="amptrac_8h_a449f642b01d0dc65cc32f86a850bcb7b_cgraph" id="amptrac_8h_a449f642b01d0dc65cc32f86a850bcb7b_cgraph">
<area shape="rect" title="Interpolates meteorological data to specified pressure levels." alt="" coords="5,5,120,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="168,5,243,32"/>
</map>
</div>

</div>
</div>
<a id="a305d8ee431236c52e0fd21d26f23a695" name="a305d8ee431236c52e0fd21d26f23a695"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a305d8ee431236c52e0fd21d26f23a695">&#9670;&nbsp;</a></span>read_met_monotonize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_monotonize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Makes zeta and pressure profiles monotone. </p>
<p >This function ensures that zeta and pressure profiles are monotone increasing and decreasing with altitude. It iterates over each grid point and each level to identify inversions and linearly interpolate between them to maintain monotonicity. The interpolation is performed for both zeta and pressure profiles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>A pointer to a control parameter structure. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets up a timer to monitor the processing time.</li>
<li>Iterates over each grid point in parallel using OpenMP.</li>
<li>Identifies inversions in both zeta and pressure profiles and interpolates linearly between them to make the profiles monotone increasing.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function is crucial for maintaining the physical consistency of meteorological profiles, ensuring accurate atmospheric simulations.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l09748">9748</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 9750</span>              {</div>
<div class="line"><span class="lineno"> 9751</span> </div>
<div class="line"><span class="lineno"> 9752</span>  <span class="comment">/* Check parameters... */</span></div>
<div class="line"><span class="lineno"> 9753</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> != 1)</div>
<div class="line"><span class="lineno"> 9754</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 9755</span> </div>
<div class="line"><span class="lineno"> 9756</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 9757</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_MONOTONIZE&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno"> 9758</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Make zeta profiles monotone...&quot;</span>);</div>
<div class="line"><span class="lineno"> 9759</span> </div>
<div class="line"><span class="lineno"> 9760</span>  <span class="comment">/* Create monotone zeta profiles... */</span></div>
<div class="line"><span class="lineno"> 9761</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno"> 9762</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; i++)</div>
<div class="line"><span class="lineno"> 9763</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; j++) {</div>
<div class="line"><span class="lineno"> 9764</span>      <span class="keywordtype">int</span> k = 1;</div>
<div class="line"><span class="lineno"> 9765</span> </div>
<div class="line"><span class="lineno"> 9766</span>      <span class="keywordflow">while</span> (k &lt; met-&gt;npl) {    <span class="comment">/* Check if there is an inversion at level k... */</span></div>
<div class="line"><span class="lineno"> 9767</span>        <span class="keywordflow">if</span> ((met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>[i][j][k - 1] &gt;= met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>[i][j][k])) {</div>
<div class="line"><span class="lineno"> 9768</span>          <span class="comment">/* Find the upper level k+l over the inversion... */</span></div>
<div class="line"><span class="lineno"> 9769</span>          <span class="keywordtype">int</span> l = 0;</div>
<div class="line"><span class="lineno"> 9770</span>          <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 9771</span>            l++;</div>
<div class="line"><span class="lineno"> 9772</span>          }</div>
<div class="line"><span class="lineno"> 9773</span>          <span class="keywordflow">while</span> ((met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>[i][j][k - 1] &gt;=</div>
<div class="line"><span class="lineno"> 9774</span>                  met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>[i][j][k + l]) &amp; (k + l &lt; met-&gt;npl));</div>
<div class="line"><span class="lineno"> 9775</span> </div>
<div class="line"><span class="lineno"> 9776</span>          <span class="comment">/* Interpolate linear between the top and bottom </span></div>
<div class="line"><span class="lineno"> 9777</span><span class="comment">             of the inversion... */</span></div>
<div class="line"><span class="lineno"> 9778</span>          <span class="keywordtype">float</span> s =</div>
<div class="line"><span class="lineno"> 9779</span>            (float) (met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>[i][j][k + l] - met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>[i][j][k - 1])</div>
<div class="line"><span class="lineno"> 9780</span>            / (float) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a2a9a988f67219ff510846b9cd989055d">hybrid</a>[k + l] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a2a9a988f67219ff510846b9cd989055d">hybrid</a>[k - 1]);</div>
<div class="line"><span class="lineno"> 9781</span> </div>
<div class="line"><span class="lineno"> 9782</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = k; m &lt; k + l; m++) {</div>
<div class="line"><span class="lineno"> 9783</span>            <span class="keywordtype">float</span> d = (float) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a2a9a988f67219ff510846b9cd989055d">hybrid</a>[m] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a2a9a988f67219ff510846b9cd989055d">hybrid</a>[k - 1]);</div>
<div class="line"><span class="lineno"> 9784</span>            met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>[i][j][m] = s * d + met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>[i][j][k - 1];</div>
<div class="line"><span class="lineno"> 9785</span>          }</div>
<div class="line"><span class="lineno"> 9786</span> </div>
<div class="line"><span class="lineno"> 9787</span>          <span class="comment">/* Search for more inversions above the last inversion ... */</span></div>
<div class="line"><span class="lineno"> 9788</span>          k = k + l;</div>
<div class="line"><span class="lineno"> 9789</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9790</span>          k++;</div>
<div class="line"><span class="lineno"> 9791</span>        }</div>
<div class="line"><span class="lineno"> 9792</span>      }</div>
<div class="line"><span class="lineno"> 9793</span>    }</div>
<div class="line"><span class="lineno"> 9794</span> </div>
<div class="line"><span class="lineno"> 9795</span>  <span class="comment">/* Create monotone pressure profiles... */</span></div>
<div class="line"><span class="lineno"> 9796</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno"> 9797</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; i++)</div>
<div class="line"><span class="lineno"> 9798</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; j++) {</div>
<div class="line"><span class="lineno"> 9799</span>      <span class="keywordtype">int</span> k = 1;</div>
<div class="line"><span class="lineno"> 9800</span> </div>
<div class="line"><span class="lineno"> 9801</span>      <span class="keywordflow">while</span> (k &lt; met-&gt;npl) {    <span class="comment">/* Check if there is an inversion at level k... */</span></div>
<div class="line"><span class="lineno"> 9802</span>        <span class="keywordflow">if</span> ((met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[i][j][k - 1] &lt;= met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[i][j][k])) {</div>
<div class="line"><span class="lineno"> 9803</span> </div>
<div class="line"><span class="lineno"> 9804</span>          <span class="comment">/* Find the upper level k+l over the inversion... */</span></div>
<div class="line"><span class="lineno"> 9805</span>          <span class="keywordtype">int</span> l = 0;</div>
<div class="line"><span class="lineno"> 9806</span>          <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 9807</span>            l++;</div>
<div class="line"><span class="lineno"> 9808</span>          }</div>
<div class="line"><span class="lineno"> 9809</span>          <span class="keywordflow">while</span> ((met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[i][j][k - 1] &lt;= met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[i][j][k + l]) &amp; (k + l &lt;</div>
<div class="line"><span class="lineno"> 9810</span>                                                                   met-&gt;<a class="code hl_variable" href="structmet__t.html#abe8b336b71924b14d2badd0d6c0f7c27">npl</a>));</div>
<div class="line"><span class="lineno"> 9811</span> </div>
<div class="line"><span class="lineno"> 9812</span>          <span class="comment">/* Interpolate linear between the top and bottom </span></div>
<div class="line"><span class="lineno"> 9813</span><span class="comment">             of the inversion... */</span></div>
<div class="line"><span class="lineno"> 9814</span>          <span class="keywordtype">float</span> s = (float) (met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[i][j][k + l] - met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[i][j][k - 1])</div>
<div class="line"><span class="lineno"> 9815</span>            / (float) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a2a9a988f67219ff510846b9cd989055d">hybrid</a>[k + l] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a2a9a988f67219ff510846b9cd989055d">hybrid</a>[k - 1]);</div>
<div class="line"><span class="lineno"> 9816</span> </div>
<div class="line"><span class="lineno"> 9817</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = k; m &lt; k + l; m++) {</div>
<div class="line"><span class="lineno"> 9818</span>            <span class="keywordtype">float</span> d = (float) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a2a9a988f67219ff510846b9cd989055d">hybrid</a>[m] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a2a9a988f67219ff510846b9cd989055d">hybrid</a>[k - 1]);</div>
<div class="line"><span class="lineno"> 9819</span>            met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[i][j][m] = s * d + met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[i][j][k - 1];</div>
<div class="line"><span class="lineno"> 9820</span>          }</div>
<div class="line"><span class="lineno"> 9821</span> </div>
<div class="line"><span class="lineno"> 9822</span>          <span class="comment">/* Search for more inversions above the last inversion ... */</span></div>
<div class="line"><span class="lineno"> 9823</span>          k += l;</div>
<div class="line"><span class="lineno"> 9824</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9825</span>          k++;</div>
<div class="line"><span class="lineno"> 9826</span>        }</div>
<div class="line"><span class="lineno"> 9827</span>      }</div>
<div class="line"><span class="lineno"> 9828</span>    }</div>
<div class="line"><span class="lineno"> 9829</span>}</div>
<div class="ttc" id="astructmet__t_html_a2a9a988f67219ff510846b9cd989055d"><div class="ttname"><a href="structmet__t.html#a2a9a988f67219ff510846b9cd989055d">met_t::hybrid</a></div><div class="ttdeci">double hybrid[EP]</div><div class="ttdoc">Model hybrid levels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03445">mptrac.h:3445</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d5d9f14125739740b23f1ff88baf835" name="a6d5d9f14125739740b23f1ff88baf835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d5d9f14125739740b23f1ff88baf835">&#9670;&nbsp;</a></span>read_met_nc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_met_nc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads meteorological data from a NetCDF file and processes it. </p>
<p >This function reads meteorological data from a NetCDF file specified by the <code>filename</code> parameter, using the NetCDF library. It reads grid, surface, and vertical level data, processes the data (including extrapolation, boundary conditions, and downsampling), and calculates various derived meteorological fields such as geopotential heights, potential vorticity, cloud properties, and convective available potential energy (CAPE).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A constant character pointer representing the name of the NetCDF file to read the meteorological data from. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure, which contains control parameters for reading and processing the meteorological data. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure that will store the meteorological data read and processed from the NetCDF file. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information, including rank and neighbours.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 on success, or 0 if the file cannot be opened.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function opens the NetCDF file in read-only mode using <code>nc_open</code> and handles any errors during the file opening process.</li>
<li>The function reads grid data, vertical level data, and surface data from the file, and processes the data to calculate additional meteorological parameters.</li>
<li>If the file cannot be opened, the function logs a warning and returns 0.</li>
<li>It is important to ensure that the NetCDF file contains the expected structure for meteorological data (grid, levels, surface data).</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l09833">9833</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 9837</span>            {</div>
<div class="line"><span class="lineno"> 9838</span> </div>
<div class="line"><span class="lineno"> 9839</span>  <span class="keywordtype">int</span> ncid;</div>
<div class="line"><span class="lineno"> 9840</span> </div>
<div class="line"><span class="lineno"> 9841</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno"> 9842</span><span class="preprocessor">#ifdef DD</span></div>
<div class="line"><span class="lineno"> 9843</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587663283cba9a4470dd7b753b5a1690">dd</a>) {</div>
<div class="line"><span class="lineno"> 9844</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_open_par</div>
<div class="line"><span class="lineno"> 9845</span>       (filename, NC_NOWRITE | NC_SHARE, MPI_COMM_WORLD, MPI_INFO_NULL,</div>
<div class="line"><span class="lineno"> 9846</span>        &amp;ncid))</div>
<div class="line"><span class="lineno"> 9847</span>  }</div>
<div class="line"><span class="lineno"> 9848</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 9849</span>  <span class="keywordflow">if</span> (nc_open(filename, NC_NOWRITE, &amp;ncid) != NC_NOERR) {</div>
<div class="line"><span class="lineno"> 9850</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno"> 9851</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 9852</span>  }</div>
<div class="line"><span class="lineno"> 9853</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9854</span> </div>
<div class="line"><span class="lineno"> 9855</span>  <span class="comment">/* Read coordinates of meteo data... */</span></div>
<div class="line"><span class="lineno"> 9856</span>  <a class="code hl_function" href="mptrac_8c.html#ae4562461a2883609e1768b1c3671eec4">read_met_nc_grid</a>(filename, ncid, ctl, met, dd);</div>
<div class="line"><span class="lineno"> 9857</span> </div>
<div class="line"><span class="lineno"> 9858</span>  <span class="comment">/* Read surface data... */</span></div>
<div class="line"><span class="lineno"> 9859</span>  <a class="code hl_function" href="mptrac_8c.html#aa86499774fc9def653b04f95e56b4052">read_met_nc_surface</a>(ncid, ctl, met, dd);</div>
<div class="line"><span class="lineno"> 9860</span> </div>
<div class="line"><span class="lineno"> 9861</span>  <span class="comment">/* Read meteo data on vertical levels... */</span></div>
<div class="line"><span class="lineno"> 9862</span>  <a class="code hl_function" href="mptrac_8c.html#a2ee3cac435af17ad5aaf885cc2dc3262">read_met_nc_levels</a>(ncid, ctl, met, dd);</div>
<div class="line"><span class="lineno"> 9863</span> </div>
<div class="line"><span class="lineno"> 9864</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno"> 9865</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno"> 9866</span> </div>
<div class="line"><span class="lineno"> 9867</span>  <span class="comment">/* Return success... */</span></div>
<div class="line"><span class="lineno"> 9868</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 9869</span>}</div>
<div class="ttc" id="amptrac_8c_html_a2ee3cac435af17ad5aaf885cc2dc3262"><div class="ttname"><a href="mptrac_8c.html#a2ee3cac435af17ad5aaf885cc2dc3262">read_met_nc_levels</a></div><div class="ttdeci">void read_met_nc_levels(const int ncid, const ctl_t *ctl, met_t *met, dd_t *dd)</div><div class="ttdoc">Reads and processes meteorological level data from NetCDF files with domain decomposition.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l08555">mptrac.c:8555</a></div></div>
<div class="ttc" id="amptrac_8c_html_aa86499774fc9def653b04f95e56b4052"><div class="ttname"><a href="mptrac_8c.html#aa86499774fc9def653b04f95e56b4052">read_met_nc_surface</a></div><div class="ttdeci">void read_met_nc_surface(const int ncid, const ctl_t *ctl, met_t *met, dd_t *dd)</div><div class="ttdoc">Reads and processes surface meteorological data from NetCDF files with domain decomposition.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l08417">mptrac.c:8417</a></div></div>
<div class="ttc" id="amptrac_8c_html_ae4562461a2883609e1768b1c3671eec4"><div class="ttname"><a href="mptrac_8c.html#ae4562461a2883609e1768b1c3671eec4">read_met_nc_grid</a></div><div class="ttdeci">void read_met_nc_grid(const char *filename, const int ncid, const ctl_t *ctl, met_t *met, dd_t *dd)</div><div class="ttdoc">Reads meteorological grid data from NetCDF files with domain decomposition.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l08250">mptrac.c:8250</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a6d5d9f14125739740b23f1ff88baf835_cgraph.png" border="0" usemap="#amptrac_8h_a6d5d9f14125739740b23f1ff88baf835_cgraph" alt=""/></div>
<map name="amptrac_8h_a6d5d9f14125739740b23f1ff88baf835_cgraph" id="amptrac_8h_a6d5d9f14125739740b23f1ff88baf835_cgraph">
<area shape="rect" title="Reads meteorological data from a NetCDF file and processes it." alt="" coords="5,224,103,251"/>
<area shape="rect" href="mptrac_8c.html#ae4562461a2883609e1768b1c3671eec4" title="Reads meteorological grid data from NetCDF files with domain decomposition." alt="" coords="161,123,287,149"/>
<area shape="rect" href="mptrac_8c.html#a2ee3cac435af17ad5aaf885cc2dc3262" title="Reads and processes meteorological level data from NetCDF files with domain decomposition." alt="" coords="155,224,293,251"/>
<area shape="rect" href="mptrac_8c.html#aa86499774fc9def653b04f95e56b4052" title="Reads and processes surface meteorological data from NetCDF files with domain decomposition." alt="" coords="151,275,297,301"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="379,5,458,32"/>
<area shape="rect" href="mptrac_8c.html#a6c6041039047d277d4836da1bb119e3d" title="Read meteorological grid data from a NetCDF file and set up subdomain decomposition with halos." alt="" coords="345,57,492,98"/>
<area shape="rect" href="mptrac_8c.html#a578e7ebaa62304182de8fe7ddf144b8f" title="Converts time components to seconds since January 1, 2000, 12:00:00 UTC." alt="" coords="540,148,619,175"/>
<area shape="rect" href="mptrac_8c.html#a8c5064804f7b46a4130b5411374a771d" title="Extracts and converts a timestamp from a filename to Julian seconds." alt="" coords="351,173,486,200"/>
<area shape="rect" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b" title="Interpolates meteorological data to specified pressure levels." alt="" coords="361,224,476,251"/>
<area shape="rect" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3" title="Reads a 3&#45;dimensional meteorological variable from a NetCDF file." alt="" coords="359,275,478,301"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="542,224,617,251"/>
<area shape="rect" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed" title="Reads a 2&#45;dimensional meteorological variable from a NetCDF file." alt="" coords="359,325,478,352"/>
</map>
</div>

</div>
</div>
<a id="ae4562461a2883609e1768b1c3671eec4" name="ae4562461a2883609e1768b1c3671eec4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4562461a2883609e1768b1c3671eec4">&#9670;&nbsp;</a></span>read_met_nc_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_nc_grid </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads meteorological grid data from NetCDF files with domain decomposition. </p>
<p >The <code>read_met_nc_grid</code> function reads meteorological data from NetCDF files and processes it with domain decomposition for parallel processing. It extracts time information, grid dimensions, and coordinates, and sets up hyperslabs for subdomains and halos. It also reads pressure levels and handles model level and surface data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the filename of the NetCDF file to read. </td></tr>
    <tr><td class="paramname">ncid</td><td>A NetCDF file ID. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure where meteorological data will be stored. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information, including rank and neighbours.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets filenames for meteorological data files.</li>
<li>Extracts time information from the filename or NetCDF file.</li>
<li>Validates the time information and logs it.</li>
<li>Retrieves global and local grid dimensions and checks for regular grid spacing.</li>
<li>Sets up hyperslabs for subdomains and halos, considering edge cases.</li>
<li>Adjusts grid dimensions and coordinates for subdomains and halos.</li>
<li>Reads pressure levels and computes the 3D pressure field.</li>
<li>Handles model level and surface data using GRIB handles.</li>
<li>Reads grid data and surface data from the respective files.</li>
<li>Computes the 3D pressure field and reads model level data.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the input filename and structures are properly initialized. It uses MPI for parallel processing and handles domain decomposition. The function is designed to work with NetCDF and GRIB file formats. It logs various stages of processing for debugging and validation purposes.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l08250">8250</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8255</span>            {</div>
<div class="line"><span class="lineno"> 8256</span> </div>
<div class="line"><span class="lineno"> 8257</span>  <span class="keywordtype">char</span> levname[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], tstr[10];</div>
<div class="line"><span class="lineno"> 8258</span> </div>
<div class="line"><span class="lineno"> 8259</span>  <span class="keywordtype">double</span> rtime = 0, r, r2;</div>
<div class="line"><span class="lineno"> 8260</span> </div>
<div class="line"><span class="lineno"> 8261</span>  <span class="keywordtype">int</span> varid, ndims, dimids[NC_MAX_DIMS], year2, mon2, day2, hour2, min2, sec2,</div>
<div class="line"><span class="lineno"> 8262</span>    year, mon, day, hour, min, sec;</div>
<div class="line"><span class="lineno"> 8263</span> </div>
<div class="line"><span class="lineno"> 8264</span>  <span class="keywordtype">size_t</span> dimlen;</div>
<div class="line"><span class="lineno"> 8265</span> </div>
<div class="line"><span class="lineno"> 8266</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 8267</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_NC_GRID&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 8268</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read meteo grid information...&quot;</span>);</div>
<div class="line"><span class="lineno"> 8269</span> </div>
<div class="line"><span class="lineno"> 8270</span>  <span class="comment">/* MPTRAC meteo files... */</span></div>
<div class="line"><span class="lineno"> 8271</span>  <span class="keywordflow">if</span> (!ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6607c472936ade8396ee3095595f0475">met_clams</a>) {</div>
<div class="line"><span class="lineno"> 8272</span> </div>
<div class="line"><span class="lineno"> 8273</span>    <span class="comment">/* Get time from filename... */</span></div>
<div class="line"><span class="lineno"> 8274</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a> = <a class="code hl_function" href="mptrac_8c.html#a8c5064804f7b46a4130b5411374a771d">time_from_filename</a>(filename, 16);</div>
<div class="line"><span class="lineno"> 8275</span> </div>
<div class="line"><span class="lineno"> 8276</span>    <span class="comment">/* Check time information from data file... */</span></div>
<div class="line"><span class="lineno"> 8277</span>    <a class="code hl_function" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>, &amp;year, &amp;mon, &amp;day, &amp;hour, &amp;min, &amp;sec, &amp;r);</div>
<div class="line"><span class="lineno"> 8278</span>    <span class="keywordflow">if</span> (nc_inq_varid(ncid, <span class="stringliteral">&quot;time&quot;</span>, &amp;varid) == NC_NOERR) {</div>
<div class="line"><span class="lineno"> 8279</span>      <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_var_double(ncid, varid, &amp;rtime));</div>
<div class="line"><span class="lineno"> 8280</span>      <span class="keywordflow">if</span> (fabs(year * 10000. + mon * 100. + day + hour / 24. - rtime) &gt; 1.0)</div>
<div class="line"><span class="lineno"> 8281</span>        <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Time information in meteo file does not match filename!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8282</span>    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8283</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Time information in meteo file is missing!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8284</span>  }</div>
<div class="line"><span class="lineno"> 8285</span> </div>
<div class="line"><span class="lineno"> 8286</span>  <span class="comment">/* CLaMS meteo files... */</span></div>
<div class="line"><span class="lineno"> 8287</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8288</span> </div>
<div class="line"><span class="lineno"> 8289</span>    <span class="comment">/* Read time from file... */</span></div>
<div class="line"><span class="lineno"> 8290</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;time&quot;</span>, &amp;rtime, 0);</div>
<div class="line"><span class="lineno"> 8291</span> </div>
<div class="line"><span class="lineno"> 8292</span>    <span class="comment">/* Get time from filename (considering the century)... */</span></div>
<div class="line"><span class="lineno"> 8293</span>    <span class="keywordflow">if</span> (rtime &lt; 0)</div>
<div class="line"><span class="lineno"> 8294</span>      sprintf(tstr, <span class="stringliteral">&quot;19%.2s&quot;</span>, &amp;filename[strlen(filename) - 11]);</div>
<div class="line"><span class="lineno"> 8295</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8296</span>      sprintf(tstr, <span class="stringliteral">&quot;20%.2s&quot;</span>, &amp;filename[strlen(filename) - 11]);</div>
<div class="line"><span class="lineno"> 8297</span>    year = atoi(tstr);</div>
<div class="line"><span class="lineno"> 8298</span>    sprintf(tstr, <span class="stringliteral">&quot;%.2s&quot;</span>, &amp;filename[strlen(filename) - 9]);</div>
<div class="line"><span class="lineno"> 8299</span>    mon = atoi(tstr);</div>
<div class="line"><span class="lineno"> 8300</span>    sprintf(tstr, <span class="stringliteral">&quot;%.2s&quot;</span>, &amp;filename[strlen(filename) - 7]);</div>
<div class="line"><span class="lineno"> 8301</span>    day = atoi(tstr);</div>
<div class="line"><span class="lineno"> 8302</span>    sprintf(tstr, <span class="stringliteral">&quot;%.2s&quot;</span>, &amp;filename[strlen(filename) - 5]);</div>
<div class="line"><span class="lineno"> 8303</span>    hour = atoi(tstr);</div>
<div class="line"><span class="lineno"> 8304</span>    <a class="code hl_function" href="mptrac_8c.html#a578e7ebaa62304182de8fe7ddf144b8f">time2jsec</a>(year, mon, day, hour, 0, 0, 0, &amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>);</div>
<div class="line"><span class="lineno"> 8305</span>  }</div>
<div class="line"><span class="lineno"> 8306</span> </div>
<div class="line"><span class="lineno"> 8307</span>  <span class="comment">/* Check time... */</span></div>
<div class="line"><span class="lineno"> 8308</span>  <span class="keywordflow">if</span> (year &lt; 1900 || year &gt; 2100 || mon &lt; 1 || mon &gt; 12</div>
<div class="line"><span class="lineno"> 8309</span>      || day &lt; 1 || day &gt; 31 || hour &lt; 0 || hour &gt; 23)</div>
<div class="line"><span class="lineno"> 8310</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot read time from filename!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8311</span>  <a class="code hl_function" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>, &amp;year2, &amp;mon2, &amp;day2, &amp;hour2, &amp;min2, &amp;sec2, &amp;r2);</div>
<div class="line"><span class="lineno"> 8312</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time: %.2f (%d-%02d-%02d, %02d:%02d UTC)&quot;</span>,</div>
<div class="line"><span class="lineno"> 8313</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>, year2, mon2, day2, hour2, min2);</div>
<div class="line"><span class="lineno"> 8314</span> </div>
<div class="line"><span class="lineno"> 8315</span>  <span class="comment">/* Get vertical dimension... */</span></div>
<div class="line"><span class="lineno"> 8316</span>  <span class="keywordflow">if</span> (nc_inq_varid(ncid, <span class="stringliteral">&quot;u&quot;</span>, &amp;varid) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 8317</span>    <span class="keywordflow">if</span> (nc_inq_varid(ncid, <span class="stringliteral">&quot;U&quot;</span>, &amp;varid) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 8318</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a></div>
<div class="line"><span class="lineno"> 8319</span>        (<span class="stringliteral">&quot;Variable &#39;u&#39; or &#39;U&#39; not found, cannot determine vertical dimension!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8320</span> </div>
<div class="line"><span class="lineno"> 8321</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_inq_varndims(ncid, varid, &amp;ndims));</div>
<div class="line"><span class="lineno"> 8322</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_inq_vardimid(ncid, varid, dimids));</div>
<div class="line"><span class="lineno"> 8323</span> </div>
<div class="line"><span class="lineno"> 8324</span>  <span class="keywordflow">if</span> (ndims == 4) {</div>
<div class="line"><span class="lineno"> 8325</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_inq_dim</div>
<div class="line"><span class="lineno"> 8326</span>       (ncid, dimids[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6d866e961e374a254d7dc52ea52cb3db">met_convention</a> == 0 ? 1 : 3], levname, &amp;dimlen));</div>
<div class="line"><span class="lineno"> 8327</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ndims == 3) {</div>
<div class="line"><span class="lineno"> 8328</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_inq_dim</div>
<div class="line"><span class="lineno"> 8329</span>       (ncid, dimids[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6d866e961e374a254d7dc52ea52cb3db">met_convention</a> == 0 ? 0 : 2], levname, &amp;dimlen));</div>
<div class="line"><span class="lineno"> 8330</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8331</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot determine vertical dimension!&quot;</span>)</div>
<div class="line"><span class="lineno"> 8332</span>      met-&gt;np = (<span class="keywordtype">int</span>) dimlen;</div>
<div class="line"><span class="lineno"> 8333</span> </div>
<div class="line"><span class="lineno"> 8334</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Number of levels: %d&quot;, met-&gt;np);</div>
<div class="line"><span class="lineno"> 8335</span>  if (met-&gt;np &lt; 2 || met-&gt;np &gt; <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>)</div>
<div class="line"><span class="lineno"> 8336</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(&quot;Number of levels out of range!&quot;);</div>
<div class="line"><span class="lineno"> 8337</span> </div>
<div class="line"><span class="lineno"> 8338</span>  if (!ctl-&gt;dd) {</div>
<div class="line"><span class="lineno"> 8339</span> </div>
<div class="line"><span class="lineno"> 8340</span>    <span class="comment">/* Get grid dimensions... */</span></div>
<div class="line"><span class="lineno"> 8341</span>    <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;lon&quot;</span>, &amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, 2, <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>, 1);</div>
<div class="line"><span class="lineno"> 8342</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of longitudes: %d&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>);</div>
<div class="line"><span class="lineno"> 8343</span> </div>
<div class="line"><span class="lineno"> 8344</span>    <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;lat&quot;</span>, &amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, 2, <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>, 1);</div>
<div class="line"><span class="lineno"> 8345</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of latitudes: %d&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>);</div>
<div class="line"><span class="lineno"> 8346</span> </div>
<div class="line"><span class="lineno"> 8347</span>    <span class="comment">/* Read longitudes and latitudes... */</span></div>
<div class="line"><span class="lineno"> 8348</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;lon&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, 1);</div>
<div class="line"><span class="lineno"> 8349</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Longitudes: %g, %g ... %g deg&quot;</span>,</div>
<div class="line"><span class="lineno"> 8350</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[0], met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[1], met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1]);</div>
<div class="line"><span class="lineno"> 8351</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;lat&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, 1);</div>
<div class="line"><span class="lineno"> 8352</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Latitudes: %g, %g ... %g deg&quot;</span>,</div>
<div class="line"><span class="lineno"> 8353</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[0], met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[1], met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 1]);</div>
<div class="line"><span class="lineno"> 8354</span> </div>
<div class="line"><span class="lineno"> 8355</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8356</span> </div>
<div class="line"><span class="lineno"> 8357</span>    <span class="comment">/* Use &#39;naive&#39;, i.e. equidistant lat-lon domain decomposition... */</span></div>
<div class="line"><span class="lineno"> 8358</span>    <a class="code hl_function" href="mptrac_8c.html#a6c6041039047d277d4836da1bb119e3d">read_met_nc_grid_dd_naive</a>(dd, ctl, met, ncid);</div>
<div class="line"><span class="lineno"> 8359</span> </div>
<div class="line"><span class="lineno"> 8360</span>  }</div>
<div class="line"><span class="lineno"> 8361</span> </div>
<div class="line"><span class="lineno"> 8362</span>  <span class="comment">/* Read pressure levels... */</span></div>
<div class="line"><span class="lineno"> 8363</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> &lt;= 0) {</div>
<div class="line"><span class="lineno"> 8364</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(levname, met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>, 1);</div>
<div class="line"><span class="lineno"> 8365</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 8366</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] /= 100.;</div>
<div class="line"><span class="lineno"> 8367</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Altitude levels: %g, %g ... %g km&quot;</span>,</div>
<div class="line"><span class="lineno"> 8368</span>        <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[0]), <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[1]), <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1]));</div>
<div class="line"><span class="lineno"> 8369</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Pressure levels: %g, %g ... %g hPa&quot;</span>,</div>
<div class="line"><span class="lineno"> 8370</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[0], met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[1], met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1]);</div>
<div class="line"><span class="lineno"> 8371</span>  }</div>
<div class="line"><span class="lineno"> 8372</span> </div>
<div class="line"><span class="lineno"> 8373</span>  <span class="comment">/* Read hybrid levels... */</span></div>
<div class="line"><span class="lineno"> 8374</span>  <span class="keywordflow">if</span> (strcasecmp(levname, <span class="stringliteral">&quot;hybrid&quot;</span>) == 0)</div>
<div class="line"><span class="lineno"> 8375</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;hybrid&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2a9a988f67219ff510846b9cd989055d">hybrid</a>, 1);</div>
<div class="line"><span class="lineno"> 8376</span> </div>
<div class="line"><span class="lineno"> 8377</span>  <span class="comment">/* Read model level coefficients from file... */</span></div>
<div class="line"><span class="lineno"> 8378</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> == 2) {</div>
<div class="line"><span class="lineno"> 8379</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;hyam&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#af5a4387f69e54842c9bfa297ececb84a">hyam</a>, 1);</div>
<div class="line"><span class="lineno"> 8380</span>    <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;hybm&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#afd849797692e62559cbd8d18fd3cb8b6">hybm</a>, 1);</div>
<div class="line"><span class="lineno"> 8381</span>  }</div>
<div class="line"><span class="lineno"> 8382</span> </div>
<div class="line"><span class="lineno"> 8383</span>  <span class="comment">/* Copy model level coefficients from control parameters... */</span></div>
<div class="line"><span class="lineno"> 8384</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> == 3 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> == 4) {</div>
<div class="line"><span class="lineno"> 8385</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6024bf55339aa76e34a54e29f357bf6d">met_nlev</a> &lt;= 0)</div>
<div class="line"><span class="lineno"> 8386</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;You need to specify MET_NLEV, MET_LEV_HYAM, and MET_LEV_HYBM!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8387</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6024bf55339aa76e34a54e29f357bf6d">met_nlev</a>; ip++) {</div>
<div class="line"><span class="lineno"> 8388</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#af5a4387f69e54842c9bfa297ececb84a">hyam</a>[ip] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a900048dd4610de834a719004818b920a">met_lev_hyam</a>[ip];</div>
<div class="line"><span class="lineno"> 8389</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#afd849797692e62559cbd8d18fd3cb8b6">hybm</a>[ip] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abb9c4152493385bae3424b8750bfa6c3">met_lev_hybm</a>[ip];</div>
<div class="line"><span class="lineno"> 8390</span>    }</div>
<div class="line"><span class="lineno"> 8391</span>  }</div>
<div class="line"><span class="lineno"> 8392</span> </div>
<div class="line"><span class="lineno"> 8393</span>  <span class="comment">/* Calculate eta levels... */</span></div>
<div class="line"><span class="lineno"> 8394</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6024bf55339aa76e34a54e29f357bf6d">met_nlev</a>); ++k) {</div>
<div class="line"><span class="lineno"> 8395</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#acc1a4cd2cd438402d9672ba8213ccff2">eta</a>[k] = met-&gt;<a class="code hl_variable" href="structmet__t.html#af5a4387f69e54842c9bfa297ececb84a">hyam</a>[k] / 100000.0 + met-&gt;<a class="code hl_variable" href="structmet__t.html#afd849797692e62559cbd8d18fd3cb8b6">hybm</a>[k];</div>
<div class="line"><span class="lineno"> 8396</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> &gt;= 2 &amp;&amp; k &gt; 0 &amp;&amp; met-&gt;<a class="code hl_variable" href="structmet__t.html#acc1a4cd2cd438402d9672ba8213ccff2">eta</a>[k] &lt;= met-&gt;<a class="code hl_variable" href="structmet__t.html#acc1a4cd2cd438402d9672ba8213ccff2">eta</a>[k - 1])</div>
<div class="line"><span class="lineno"> 8397</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Eta levels must be ascending!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8398</span>  }</div>
<div class="line"><span class="lineno"> 8399</span> </div>
<div class="line"><span class="lineno"> 8400</span>  <span class="comment">/* Check horizontal grid spacing... */</span></div>
<div class="line"><span class="lineno"> 8401</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 2; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8402</span>    <span class="keywordflow">if</span> (fabs</div>
<div class="line"><span class="lineno"> 8403</span>        (fabs(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix - 1]) -</div>
<div class="line"><span class="lineno"> 8404</span>         fabs(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[0])) &gt; 0.001)</div>
<div class="line"><span class="lineno"> 8405</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;No regular grid spacing in longitudes!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8406</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 2; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8407</span>    <span class="keywordflow">if</span> (fabs</div>
<div class="line"><span class="lineno"> 8408</span>        (fabs(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy] - met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy - 1]) -</div>
<div class="line"><span class="lineno"> 8409</span>         fabs(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[0])) &gt; 0.001) {</div>
<div class="line"><span class="lineno"> 8410</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;No regular grid spacing in latitudes!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8411</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8412</span>    }</div>
<div class="line"><span class="lineno"> 8413</span>}</div>
<div class="ttc" id="amptrac_8c_html_a578e7ebaa62304182de8fe7ddf144b8f"><div class="ttname"><a href="mptrac_8c.html#a578e7ebaa62304182de8fe7ddf144b8f">time2jsec</a></div><div class="ttdeci">void time2jsec(const int year, const int mon, const int day, const int hour, const int min, const int sec, const double remain, double *jsec)</div><div class="ttdoc">Converts time components to seconds since January 1, 2000, 12:00:00 UTC.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11124">mptrac.c:11124</a></div></div>
<div class="ttc" id="amptrac_8c_html_a6c6041039047d277d4836da1bb119e3d"><div class="ttname"><a href="mptrac_8c.html#a6c6041039047d277d4836da1bb119e3d">read_met_nc_grid_dd_naive</a></div><div class="ttdeci">void read_met_nc_grid_dd_naive(dd_t *dd, const ctl_t *ctl, met_t *met, const int ncid)</div><div class="ttdoc">Read meteorological grid data from a NetCDF file and set up subdomain decomposition with halos.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l09873">mptrac.c:9873</a></div></div>
<div class="ttc" id="amptrac_8c_html_a8c5064804f7b46a4130b5411374a771d"><div class="ttname"><a href="mptrac_8c.html#a8c5064804f7b46a4130b5411374a771d">time_from_filename</a></div><div class="ttdeci">double time_from_filename(const char *filename, const int offset)</div><div class="ttdoc">Extracts and converts a timestamp from a filename to Julian seconds.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11223">mptrac.c:11223</a></div></div>
<div class="ttc" id="astructmet__t_html_acc1a4cd2cd438402d9672ba8213ccff2"><div class="ttname"><a href="structmet__t.html#acc1a4cd2cd438402d9672ba8213ccff2">met_t::eta</a></div><div class="ttdeci">double eta[EP]</div><div class="ttdoc">Model level eta values.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03454">mptrac.h:3454</a></div></div>
<div class="ttc" id="astructmet__t_html_af5a4387f69e54842c9bfa297ececb84a"><div class="ttname"><a href="structmet__t.html#af5a4387f69e54842c9bfa297ececb84a">met_t::hyam</a></div><div class="ttdeci">double hyam[EP]</div><div class="ttdoc">Model level a coefficients [Pa].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03448">mptrac.h:3448</a></div></div>
<div class="ttc" id="astructmet__t_html_afd849797692e62559cbd8d18fd3cb8b6"><div class="ttname"><a href="structmet__t.html#afd849797692e62559cbd8d18fd3cb8b6">met_t::hybm</a></div><div class="ttdeci">double hybm[EP]</div><div class="ttdoc">Model level b coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03451">mptrac.h:3451</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_ae4562461a2883609e1768b1c3671eec4_cgraph.png" border="0" usemap="#amptrac_8h_ae4562461a2883609e1768b1c3671eec4_cgraph" alt=""/></div>
<map name="amptrac_8h_ae4562461a2883609e1768b1c3671eec4_cgraph" id="amptrac_8h_ae4562461a2883609e1768b1c3671eec4_cgraph">
<area shape="rect" title="Reads meteorological grid data from NetCDF files with domain decomposition." alt="" coords="5,93,131,120"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="213,5,291,32"/>
<area shape="rect" href="mptrac_8c.html#a6c6041039047d277d4836da1bb119e3d" title="Read meteorological grid data from a NetCDF file and set up subdomain decomposition with halos." alt="" coords="179,57,325,98"/>
<area shape="rect" href="mptrac_8c.html#a578e7ebaa62304182de8fe7ddf144b8f" title="Converts time components to seconds since January 1, 2000, 12:00:00 UTC." alt="" coords="373,148,452,175"/>
<area shape="rect" href="mptrac_8c.html#a8c5064804f7b46a4130b5411374a771d" title="Extracts and converts a timestamp from a filename to Julian seconds." alt="" coords="185,173,319,200"/>
</map>
</div>

</div>
</div>
<a id="a6c6041039047d277d4836da1bb119e3d" name="a6c6041039047d277d4836da1bb119e3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c6041039047d277d4836da1bb119e3d">&#9670;&nbsp;</a></span>read_met_nc_grid_dd_naive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_nc_grid_dd_naive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read meteorological grid data from a NetCDF file and set up subdomain decomposition with halos. </p>
<p >This function initializes the distributed grid decomposition for meteorological data stored in a NetCDF file. It queries global grid dimensions (longitude, latitude), determines the local subdomain size for each MPI rank, and sets up hyperslabs for reading data in parallel. It also constructs halo regions for subdomain boundaries, ensuring periodic wrap-around in the zonal direction when applicable.</p>
<p >The function adjusts subdomain sizes at the right and bottom edges of the global grid to exactly fit the full domain. It then updates the <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure with the local longitude and latitude arrays for the subdomain including halos, and stores decomposition metadata in the <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">dd</td><td>Pointer to a <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure. On output, it contains:<ul>
<li>MPI rank and size</li>
<li>subdomain start indices and counts</li>
<li>halo start indices and counts</li>
<li>subdomain longitude and latitude ranges</li>
<li>halo offsets </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing decomposition parameters:<ul>
<li><code>ctl-&gt;dd_subdomains_zonal</code> </li>
<li><code>ctl-&gt;dd_subdomains_meridional</code> </li>
<li><code>ctl-&gt;dd_halos_size</code> </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">met</td><td>Pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure. On output, it contains:<ul>
<li>subdomain grid dimensions (<code>nx</code>, <code>ny</code>, <code>np</code>)</li>
<li>longitude and latitude arrays restricted to the subdomain including halos. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncid</td><td>NetCDF file ID obtained from a call to <code>nc_open</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Requires MPI if compiled with <code>-DMPI</code>.</li>
<li>Assumes latitude is ordered from 90 to -90 (descending). A warning is issued if latitude range is positive.</li>
<li>Allocates and frees temporary arrays for global longitude and latitude.</li>
<li>Halo setup ensures overlap with neighboring subdomains, and handles wrap-around at the left and right boundaries.</li>
<li>For periodic grids, the longitude range is assumed to be 360.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l09873">9873</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 9877</span>                  {</div>
<div class="line"><span class="lineno"> 9878</span> </div>
<div class="line"><span class="lineno"> 9879</span>  <span class="keywordtype">int</span> varid;</div>
<div class="line"><span class="lineno"> 9880</span> </div>
<div class="line"><span class="lineno"> 9881</span>  <span class="comment">/* Get the MPI information... */</span></div>
<div class="line"><span class="lineno"> 9882</span><span class="preprocessor">#ifdef MPI</span></div>
<div class="line"><span class="lineno"> 9883</span>  MPI_Comm_rank(MPI_COMM_WORLD, &amp;dd-&gt;<a class="code hl_variable" href="structdd__t.html#a2522b23aa52642491ba195e63933d7f4">rank</a>);</div>
<div class="line"><span class="lineno"> 9884</span>  MPI_Comm_size(MPI_COMM_WORLD, &amp;dd-&gt;<a class="code hl_variable" href="structdd__t.html#add774577943891853b6163f35cf04914">size</a>);</div>
<div class="line"><span class="lineno"> 9885</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9886</span> </div>
<div class="line"><span class="lineno"> 9887</span>  <span class="keywordtype">int</span> help_nx_glob;</div>
<div class="line"><span class="lineno"> 9888</span>  <span class="keywordtype">int</span> help_ny_glob;</div>
<div class="line"><span class="lineno"> 9889</span> </div>
<div class="line"><span class="lineno"> 9890</span>  <span class="comment">/* Get grid dimensions... */</span></div>
<div class="line"><span class="lineno"> 9891</span>  <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;lon&quot;</span>, &amp;help_nx_glob, 0, 0, 0);</div>
<div class="line"><span class="lineno"> 9892</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of longitudes: %d&quot;</span>, help_nx_glob);</div>
<div class="line"><span class="lineno"> 9893</span>  met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> = (int) floor(help_nx_glob / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aea21f5b459b5068ca0ec982074cb4dc2">dd_subdomains_zonal</a>);</div>
<div class="line"><span class="lineno"> 9894</span> </div>
<div class="line"><span class="lineno"> 9895</span>  <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;lat&quot;</span>, &amp;help_ny_glob, 0, 0, 0);</div>
<div class="line"><span class="lineno"> 9896</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of latitudes: %d&quot;</span>, help_ny_glob);</div>
<div class="line"><span class="lineno"> 9897</span>  met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> = (int) floor(help_ny_glob / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a>);</div>
<div class="line"><span class="lineno"> 9898</span> </div>
<div class="line"><span class="lineno"> 9899</span>  <span class="keywordtype">double</span> *help_lon_glob;</div>
<div class="line"><span class="lineno"> 9900</span>  <span class="keywordtype">double</span> *help_lat_glob;</div>
<div class="line"><span class="lineno"> 9901</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help_lon_glob, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 9902</span>        help_nx_glob);</div>
<div class="line"><span class="lineno"> 9903</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help_lat_glob, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno"> 9904</span>        help_ny_glob);</div>
<div class="line"><span class="lineno"> 9905</span> </div>
<div class="line"><span class="lineno"> 9906</span>  <span class="comment">/* Read global longitudes and latitudes... */</span></div>
<div class="line"><span class="lineno"> 9907</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;lon&quot;</span>, help_lon_glob, 1);</div>
<div class="line"><span class="lineno"> 9908</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Longitudes: %g, %g ... %g deg&quot;</span>,</div>
<div class="line"><span class="lineno"> 9909</span>      help_lon_glob[0], help_lon_glob[1], help_lon_glob[help_nx_glob - 1]);</div>
<div class="line"><span class="lineno"> 9910</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;lat&quot;</span>, help_lat_glob, 1);</div>
<div class="line"><span class="lineno"> 9911</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Latitudes: %g, %g ... %g deg&quot;</span>,</div>
<div class="line"><span class="lineno"> 9912</span>      help_lat_glob[0], help_lat_glob[1], help_lat_glob[help_ny_glob - 1]);</div>
<div class="line"><span class="lineno"> 9913</span> </div>
<div class="line"><span class="lineno"> 9914</span>  <span class="comment">/* Determine hyperslabs for reading the data in parallel... */</span></div>
<div class="line"><span class="lineno"> 9915</span> </div>
<div class="line"><span class="lineno"> 9916</span>  <span class="comment">/* Check for edge cases... */</span></div>
<div class="line"><span class="lineno"> 9917</span>  <span class="keywordtype">int</span> left = (dd-&gt;<a class="code hl_variable" href="structdd__t.html#a2522b23aa52642491ba195e63933d7f4">rank</a> &lt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a> - 1);</div>
<div class="line"><span class="lineno"> 9918</span>  <span class="keywordtype">int</span> right = (dd-&gt;<a class="code hl_variable" href="structdd__t.html#a2522b23aa52642491ba195e63933d7f4">rank</a> &gt;= dd-&gt;<a class="code hl_variable" href="structdd__t.html#add774577943891853b6163f35cf04914">size</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a>);</div>
<div class="line"><span class="lineno"> 9919</span>  <span class="keywordtype">int</span> top = (dd-&gt;<a class="code hl_variable" href="structdd__t.html#a2522b23aa52642491ba195e63933d7f4">rank</a> % ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a> == 0);</div>
<div class="line"><span class="lineno"> 9920</span>  <span class="keywordtype">int</span> bottom =</div>
<div class="line"><span class="lineno"> 9921</span>    (dd-&gt;<a class="code hl_variable" href="structdd__t.html#a2522b23aa52642491ba195e63933d7f4">rank</a> % ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a> ==</div>
<div class="line"><span class="lineno"> 9922</span>     ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a> - 1);</div>
<div class="line"><span class="lineno"> 9923</span> </div>
<div class="line"><span class="lineno"> 9924</span>  <span class="comment">/* Set the hyperslab for the subdomain... */</span></div>
<div class="line"><span class="lineno"> 9925</span>  dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 9926</span>  dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[1] = 0;</div>
<div class="line"><span class="lineno"> 9927</span>  dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[2] =</div>
<div class="line"><span class="lineno"> 9928</span>    (size_t) ((dd-&gt;<a class="code hl_variable" href="structdd__t.html#a2522b23aa52642491ba195e63933d7f4">rank</a> % ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a>) * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>);</div>
<div class="line"><span class="lineno"> 9929</span>  dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[3] =</div>
<div class="line"><span class="lineno"> 9930</span>    (size_t) (floor(dd-&gt;<a class="code hl_variable" href="structdd__t.html#a2522b23aa52642491ba195e63933d7f4">rank</a> / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a>) * met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>);</div>
<div class="line"><span class="lineno"> 9931</span> </div>
<div class="line"><span class="lineno"> 9932</span>  <span class="comment">/* Extend subdomains at the right and bottom to fit the full domain. */</span></div>
<div class="line"><span class="lineno"> 9933</span>  <span class="keywordflow">if</span> (right) {</div>
<div class="line"><span class="lineno"> 9934</span>    <span class="keywordtype">int</span> gap = help_nx_glob - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aea21f5b459b5068ca0ec982074cb4dc2">dd_subdomains_zonal</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>;</div>
<div class="line"><span class="lineno"> 9935</span>    <span class="keywordflow">if</span> (gap &gt; 0) {</div>
<div class="line"><span class="lineno"> 9936</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> = met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> + gap;</div>
<div class="line"><span class="lineno"> 9937</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Extended subdomains at the right to fit to full domain.&quot;</span>);</div>
<div class="line"><span class="lineno"> 9938</span>    }</div>
<div class="line"><span class="lineno"> 9939</span>  }</div>
<div class="line"><span class="lineno"> 9940</span>  <span class="keywordflow">if</span> (bottom) {</div>
<div class="line"><span class="lineno"> 9941</span>    <span class="keywordtype">int</span> gap = help_ny_glob - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>;</div>
<div class="line"><span class="lineno"> 9942</span>    <span class="keywordflow">if</span> (gap &gt; 0) {</div>
<div class="line"><span class="lineno"> 9943</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> + gap;</div>
<div class="line"><span class="lineno"> 9944</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Extended subdomains at the bottom to fit to full domain.&quot;</span>);</div>
<div class="line"><span class="lineno"> 9945</span>    }</div>
<div class="line"><span class="lineno"> 9946</span>  }</div>
<div class="line"><span class="lineno"> 9947</span> </div>
<div class="line"><span class="lineno"> 9948</span>  <span class="comment">/* Block-size, i.e. count */</span></div>
<div class="line"><span class="lineno"> 9949</span>  dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[0] = 1;</div>
<div class="line"><span class="lineno"> 9950</span>  dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[1] = (size_t) met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>;</div>
<div class="line"><span class="lineno"> 9951</span>  dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2] = (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>;</div>
<div class="line"><span class="lineno"> 9952</span>  dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3] = (size_t) met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>;</div>
<div class="line"><span class="lineno"> 9953</span> </div>
<div class="line"><span class="lineno"> 9954</span>  <span class="comment">/* Create halos and include them into the subdomain... */</span></div>
<div class="line"><span class="lineno"> 9955</span>  if (!left &amp;&amp; !right) {</div>
<div class="line"><span class="lineno"> 9956</span>    <span class="comment">// If we are not at the left or right edge extend in zonal direction...</span></div>
<div class="line"><span class="lineno"> 9957</span>    <span class="comment">// Move the start one point to the left...</span></div>
<div class="line"><span class="lineno"> 9958</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3] =</div>
<div class="line"><span class="lineno"> 9959</span>      dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3] + (size_t) (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a> * 2);</div>
<div class="line"><span class="lineno"> 9960</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[3] =</div>
<div class="line"><span class="lineno"> 9961</span>      dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[3] - (size_t) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a>;</div>
<div class="line"><span class="lineno"> 9962</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9963</span>    <span class="comment">// If we are at the left or right edge, extend only in one zonal direction...</span></div>
<div class="line"><span class="lineno"> 9964</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3] =</div>
<div class="line"><span class="lineno"> 9965</span>      dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3] + (size_t) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a>;</div>
<div class="line"><span class="lineno"> 9966</span>    if (!left)</div>
<div class="line"><span class="lineno"> 9967</span>      <span class="comment">// If we are not at the left edge, move the start to the left... </span></div>
<div class="line"><span class="lineno"> 9968</span>      dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[3] =</div>
<div class="line"><span class="lineno"> 9969</span>        dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[3] - (size_t) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a>;</div>
<div class="line"><span class="lineno"> 9970</span>  }</div>
<div class="line"><span class="lineno"> 9971</span> </div>
<div class="line"><span class="lineno"> 9972</span>  <span class="keywordflow">if</span> (!top &amp;&amp; !bottom) {</div>
<div class="line"><span class="lineno"> 9973</span>    <span class="comment">// If we are not at the upper or lower edge extend in meridional direction...</span></div>
<div class="line"><span class="lineno"> 9974</span>    <span class="comment">// Move the start point one point down...</span></div>
<div class="line"><span class="lineno"> 9975</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2] =</div>
<div class="line"><span class="lineno"> 9976</span>      dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2] + (size_t) (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a> * 2);</div>
<div class="line"><span class="lineno"> 9977</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[2] =</div>
<div class="line"><span class="lineno"> 9978</span>      dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[2] - (size_t) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a>;</div>
<div class="line"><span class="lineno"> 9979</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9980</span>    <span class="comment">// If we are at the top or the lower edge only extend in one mer. direction...</span></div>
<div class="line"><span class="lineno"> 9981</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2] =</div>
<div class="line"><span class="lineno"> 9982</span>      dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2] + (size_t) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a>;</div>
<div class="line"><span class="lineno"> 9983</span>    if (!top)</div>
<div class="line"><span class="lineno"> 9984</span>      <span class="comment">// If we are not at the top, move the start one upward... </span></div>
<div class="line"><span class="lineno"> 9985</span>      dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[2] =</div>
<div class="line"><span class="lineno"> 9986</span>        dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[2] - (size_t) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a>;</div>
<div class="line"><span class="lineno"> 9987</span>  }</div>
<div class="line"><span class="lineno"> 9988</span> </div>
<div class="line"><span class="lineno"> 9989</span>  <span class="comment">/* Set boundary halo hyperslabs ... */</span></div>
<div class="line"><span class="lineno"> 9990</span>  <span class="keywordtype">double</span> lon_shift = 0;</div>
<div class="line"><span class="lineno"> 9991</span>  <span class="keywordflow">if</span> (left || right) {</div>
<div class="line"><span class="lineno"> 9992</span> </div>
<div class="line"><span class="lineno"> 9993</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> = met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a>;</div>
<div class="line"><span class="lineno"> 9994</span> </div>
<div class="line"><span class="lineno"> 9995</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">halo_bnd_start</a>[0] = 0;</div>
<div class="line"><span class="lineno"> 9996</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">halo_bnd_start</a>[1] = 0;</div>
<div class="line"><span class="lineno"> 9997</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">halo_bnd_start</a>[3] = (size_t) (left ? (help_nx_glob - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a>) : (0));        <span class="comment">//x</span></div>
<div class="line"><span class="lineno"> 9998</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">halo_bnd_start</a>[2] = dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[2];     <span class="comment">//y</span></div>
<div class="line"><span class="lineno"> 9999</span> </div>
<div class="line"><span class="lineno">10000</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[0] = 1;</div>
<div class="line"><span class="lineno">10001</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[1] = (size_t) met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>;</div>
<div class="line"><span class="lineno">10002</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[3] = (<span class="keywordtype">size_t</span>) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a>;</div>
<div class="line"><span class="lineno">10003</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[2] =</div>
<div class="line"><span class="lineno">10004</span>      (size_t) met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> +</div>
<div class="line"><span class="lineno">10005</span>      (<span class="keywordtype">size_t</span>) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">dd_halos_size</a> * ((top || bottom) ? 1 : 2);</div>
<div class="line"><span class="lineno">10006</span> </div>
<div class="line"><span class="lineno">10007</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#ab16175b143cbeecaeb2c36ee5b0e6866">halo_offset_start</a> = (left ? (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[3] : 0);</div>
<div class="line"><span class="lineno">10008</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a1ab27aa0213a1886a32747eec1a24819">halo_offset_end</a> = (left ? 0 : (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3]);</div>
<div class="line"><span class="lineno">10009</span>    lon_shift = (left ? -360 : 360);</div>
<div class="line"><span class="lineno">10010</span> </div>
<div class="line"><span class="lineno">10011</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10012</span> </div>
<div class="line"><span class="lineno">10013</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">halo_bnd_start</a>[0] = 0;</div>
<div class="line"><span class="lineno">10014</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">halo_bnd_start</a>[1] = 0;</div>
<div class="line"><span class="lineno">10015</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">halo_bnd_start</a>[3] = 0;</div>
<div class="line"><span class="lineno">10016</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">halo_bnd_start</a>[2] = 0;</div>
<div class="line"><span class="lineno">10017</span> </div>
<div class="line"><span class="lineno">10018</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[0] = 0;</div>
<div class="line"><span class="lineno">10019</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[1] = 0;</div>
<div class="line"><span class="lineno">10020</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[3] = 0;</div>
<div class="line"><span class="lineno">10021</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[2] = 0;</div>
<div class="line"><span class="lineno">10022</span>  }</div>
<div class="line"><span class="lineno">10023</span> </div>
<div class="line"><span class="lineno">10024</span>  <span class="comment">/* Get the range of the entire meteodata... */</span></div>
<div class="line"><span class="lineno">10025</span>  <span class="comment">/* Handle both periodic (global) and non-periodic (regional) longitude grids */</span></div>
<div class="line"><span class="lineno">10026</span>  <span class="keywordtype">double</span> lon_range = 360;</div>
<div class="line"><span class="lineno">10027</span>  <span class="comment">//if (dd_is_periodic_longitude(met, help_nx_glob)) {</span></div>
<div class="line"><span class="lineno">10028</span>  <span class="comment">/* For global grids with periodic boundaries, use full 360 degrees */</span></div>
<div class="line"><span class="lineno">10029</span>  <span class="comment">//lon_range = 360.0;</span></div>
<div class="line"><span class="lineno">10030</span>  <span class="comment">//LOG(3, &quot;Detected periodic longitude boundaries, using lon_range = 360.0&quot;);</span></div>
<div class="line"><span class="lineno">10031</span>  <span class="comment">//} else {</span></div>
<div class="line"><span class="lineno">10032</span>  <span class="comment">/* For regional grids, use the actual data range */</span></div>
<div class="line"><span class="lineno">10033</span>  <span class="comment">//lon_range = help_lon_glob[help_nx_glob - 1] - help_lon_glob[0];</span></div>
<div class="line"><span class="lineno">10034</span>  <span class="comment">//LOG(3, &quot;Detected non-periodic longitude boundaries, using lon_range = %g&quot;, lon_range);</span></div>
<div class="line"><span class="lineno">10035</span>  <span class="comment">//}</span></div>
<div class="line"><span class="lineno">10036</span> </div>
<div class="line"><span class="lineno">10037</span>  <span class="keywordtype">double</span> lat_range = help_lat_glob[help_ny_glob - 1] - help_lat_glob[0];</div>
<div class="line"><span class="lineno">10038</span> </div>
<div class="line"><span class="lineno">10039</span>  <span class="comment">/* Focus on subdomain latitudes and longitudes... */</span></div>
<div class="line"><span class="lineno">10040</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2]; iy++)</div>
<div class="line"><span class="lineno">10041</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy] = help_lat_glob[(int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[2] + iy];</div>
<div class="line"><span class="lineno">10042</span> </div>
<div class="line"><span class="lineno">10043</span>  <span class="comment">/* Focus on subdomain longitudes... */</span></div>
<div class="line"><span class="lineno">10044</span>  <span class="comment">/* Keep space at the beginning or end of the array for halo... */</span></div>
<div class="line"><span class="lineno">10045</span>  for (<span class="keywordtype">int</span> ix = 0; ix &lt; (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3]; ix++)</div>
<div class="line"><span class="lineno">10046</span>    met-&gt;lon[ix + dd-&gt;halo_offset_start] =</div>
<div class="line"><span class="lineno">10047</span>      help_lon_glob[(<span class="keywordtype">int</span>) dd-&gt;subdomain_start[3] + ix];</div>
<div class="line"><span class="lineno">10048</span> </div>
<div class="line"><span class="lineno">10049</span>  for (<span class="keywordtype">int</span> ix = 0; ix &lt; (<span class="keywordtype">int</span>) dd-&gt;halo_bnd_count[3]; ix++)</div>
<div class="line"><span class="lineno">10050</span>    met-&gt;lon[ix + dd-&gt;halo_offset_end] =</div>
<div class="line"><span class="lineno">10051</span>      help_lon_glob[(<span class="keywordtype">int</span>) dd-&gt;halo_bnd_start[3] + ix] + lon_shift;</div>
<div class="line"><span class="lineno">10052</span> </div>
<div class="line"><span class="lineno">10053</span>  <span class="comment">/* Reset the grid dimensions... */</span></div>
<div class="line"><span class="lineno">10054</span>  met-&gt;nx = (<span class="keywordtype">int</span>) dd-&gt;subdomain_count[3] + (<span class="keywordtype">int</span>) dd-&gt;halo_bnd_count[3];</div>
<div class="line"><span class="lineno">10055</span>  met-&gt;ny = (<span class="keywordtype">int</span>) dd-&gt;subdomain_count[2];</div>
<div class="line"><span class="lineno">10056</span> </div>
<div class="line"><span class="lineno">10057</span>  <span class="comment">/* Determine subdomain edges... */</span></div>
<div class="line"><span class="lineno">10058</span>  dd-&gt;subdomain_lon_min = floor(dd-&gt;rank / ctl-&gt;dd_subdomains_meridional)</div>
<div class="line"><span class="lineno">10059</span>    * (lon_range) / (<span class="keywordtype">double</span>) ctl-&gt;dd_subdomains_zonal;</div>
<div class="line"><span class="lineno">10060</span>  dd-&gt;subdomain_lon_max = dd-&gt;subdomain_lon_min</div>
<div class="line"><span class="lineno">10061</span>    + (lon_range) / (<span class="keywordtype">double</span>) ctl-&gt;dd_subdomains_zonal;</div>
<div class="line"><span class="lineno">10062</span> </div>
<div class="line"><span class="lineno">10063</span>  <span class="comment">/* Latitudes in descending order (90 to -90) */</span></div>
<div class="line"><span class="lineno">10064</span>  if (lat_range &lt; 0) {</div>
<div class="line"><span class="lineno">10065</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#a4c78887b9409bd5df6712a20a66521cb">subdomain_lat_max</a> = 90 + (dd-&gt;<a class="code hl_variable" href="structdd__t.html#a2522b23aa52642491ba195e63933d7f4">rank</a> % ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a>)</div>
<div class="line"><span class="lineno">10066</span>      * (lat_range) / (double) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a>;</div>
<div class="line"><span class="lineno">10067</span>    dd-&gt;<a class="code hl_variable" href="structdd__t.html#adea99db4e3c656e7c653f6f2f53524c7">subdomain_lat_min</a> = dd-&gt;<a class="code hl_variable" href="structdd__t.html#a4c78887b9409bd5df6712a20a66521cb">subdomain_lat_max</a></div>
<div class="line"><span class="lineno">10068</span>      + (lat_range) / (double) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afb2ac81596bfa49f6f53da327bdac0bd">dd_subdomains_meridional</a>;</div>
<div class="line"><span class="lineno">10069</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10070</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a></div>
<div class="line"><span class="lineno">10071</span>      (<span class="stringliteral">&quot;lat_range &gt; 0, but is expected to be negative, i.e. latitudes should range from 90 to -90&quot;</span>)</div>
<div class="line"><span class="lineno">10072</span>      dd-&gt;subdomain_lat_min = -90 + (dd-&gt;rank % ctl-&gt;dd_subdomains_meridional)</div>
<div class="line"><span class="lineno">10073</span>      * (lat_range) / (<span class="keywordtype">double</span>) ctl-&gt;dd_subdomains_meridional;</div>
<div class="line"><span class="lineno">10074</span>    dd-&gt;subdomain_lat_max = dd-&gt;subdomain_lat_min</div>
<div class="line"><span class="lineno">10075</span>      + (lat_range) / (<span class="keywordtype">double</span>) ctl-&gt;dd_subdomains_meridional;</div>
<div class="line"><span class="lineno">10076</span>  }</div>
<div class="line"><span class="lineno">10077</span> </div>
<div class="line"><span class="lineno">10078</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Total longitude range: %g deg&quot;, lon_range);</div>
<div class="line"><span class="lineno">10079</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Total latitude range: %g deg&quot;, lat_range);</div>
<div class="line"><span class="lineno">10080</span> </div>
<div class="line"><span class="lineno">10081</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Define subdomain properties.&quot;);</div>
<div class="line"><span class="lineno">10082</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;MPI information: Rank %d, Size %d&quot;, dd-&gt;rank, dd-&gt;size);</div>
<div class="line"><span class="lineno">10083</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Edge position: l=%d,r=%d,t=%d, b=%d&quot;, (<span class="keywordtype">int</span>) left, (<span class="keywordtype">int</span>) right,</div>
<div class="line"><span class="lineno">10084</span>      (<span class="keywordtype">int</span>) top, (<span class="keywordtype">int</span>) bottom);</div>
<div class="line"><span class="lineno">10085</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Sizes for limits: <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> %d <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> %d <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a> %d&quot;, <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>, <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>, <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>);</div>
<div class="line"><span class="lineno">10086</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Total size for subdomain meteo data: nx %d ny %d np %d&quot;, met-&gt;nx,</div>
<div class="line"><span class="lineno">10087</span>      met-&gt;ny, met-&gt;np);</div>
<div class="line"><span class="lineno">10088</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Hyperslab sizes for boundary halos: nx %d ny %d np %d&quot;,</div>
<div class="line"><span class="lineno">10089</span>      (<span class="keywordtype">int</span>) dd-&gt;halo_bnd_count[3], (<span class="keywordtype">int</span>) dd-&gt;halo_bnd_count[2],</div>
<div class="line"><span class="lineno">10090</span>      (<span class="keywordtype">int</span>) dd-&gt;halo_bnd_count[1]);</div>
<div class="line"><span class="lineno">10091</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Hyperslab sizes for subdomain and inner halos:  nx %d ny %d np %d&quot;,</div>
<div class="line"><span class="lineno">10092</span>      (<span class="keywordtype">int</span>) dd-&gt;subdomain_count[3], (<span class="keywordtype">int</span>) dd-&gt;subdomain_count[2],</div>
<div class="line"><span class="lineno">10093</span>      (<span class="keywordtype">int</span>) dd-&gt;subdomain_count[1]);</div>
<div class="line"><span class="lineno">10094</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Subdomain start: nx %ld ny %ld np %ld&quot;, dd-&gt;subdomain_start[3],</div>
<div class="line"><span class="lineno">10095</span>      dd-&gt;subdomain_start[2], dd-&gt;subdomain_start[1]);</div>
<div class="line"><span class="lineno">10096</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Boundary halo start: nx %ld ny %ld np %ld&quot;, dd-&gt;halo_bnd_start[3],</div>
<div class="line"><span class="lineno">10097</span>      dd-&gt;halo_bnd_start[2], dd-&gt;halo_bnd_start[1]);</div>
<div class="line"><span class="lineno">10098</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot;Offsets: nx %d ny %d&quot;, dd-&gt;halo_offset_start, dd-&gt;halo_offset_end);</div>
<div class="line"><span class="lineno">10099</span> </div>
<div class="line"><span class="lineno">10100</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot; %d Subdomain longitudes: %g, %g ... %g deg (edges: %g to %g)&quot;,</div>
<div class="line"><span class="lineno">10101</span>      dd-&gt;rank, met-&gt;lon[0], met-&gt;lon[1], met-&gt;lon[met-&gt;nx - 1],</div>
<div class="line"><span class="lineno">10102</span>      dd-&gt;subdomain_lon_min, dd-&gt;subdomain_lon_max);</div>
<div class="line"><span class="lineno">10103</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, &quot; %d Subdomain latitudes: %g, %g ... %g deg (edges: %g to %g)&quot;,</div>
<div class="line"><span class="lineno">10104</span>      dd-&gt;rank, met-&gt;lat[0], met-&gt;lat[1], met-&gt;lat[met-&gt;ny - 1],</div>
<div class="line"><span class="lineno">10105</span>      dd-&gt;subdomain_lat_min, dd-&gt;subdomain_lat_max);</div>
<div class="line"><span class="lineno">10106</span> </div>
<div class="line"><span class="lineno">10107</span>  free(help_lon_glob);</div>
<div class="line"><span class="lineno">10108</span>  free(help_lat_glob);</div>
<div class="line"><span class="lineno">10109</span>}</div>
<div class="ttc" id="astructctl__t_html_a067596ae0db3d3518aab0787be59af02"><div class="ttname"><a href="structctl__t.html#a067596ae0db3d3518aab0787be59af02">ctl_t::dd_halos_size</a></div><div class="ttdeci">int dd_halos_size</div><div class="ttdoc">Domain decomposition size of halos given in grid-points.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03152">mptrac.h:3152</a></div></div>
<div class="ttc" id="astructdd__t_html_a061319c81804cc16cb884a04e10dee5a"><div class="ttname"><a href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">dd_t::halo_bnd_count</a></div><div class="ttdeci">size_t halo_bnd_count[4]</div><div class="ttdoc">Hyperslab of boundary halos count.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03638">mptrac.h:3638</a></div></div>
<div class="ttc" id="astructdd__t_html_a1ab27aa0213a1886a32747eec1a24819"><div class="ttname"><a href="structdd__t.html#a1ab27aa0213a1886a32747eec1a24819">dd_t::halo_offset_end</a></div><div class="ttdeci">int halo_offset_end</div><div class="ttdoc">Hyperslab of boundary halos count.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03644">mptrac.h:3644</a></div></div>
<div class="ttc" id="astructdd__t_html_a2522b23aa52642491ba195e63933d7f4"><div class="ttname"><a href="structdd__t.html#a2522b23aa52642491ba195e63933d7f4">dd_t::rank</a></div><div class="ttdeci">int rank</div><div class="ttdoc">Rank of node.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03599">mptrac.h:3599</a></div></div>
<div class="ttc" id="astructdd__t_html_a37bbf55e5d18a77ea32169d6c7ad0c37"><div class="ttname"><a href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">dd_t::halo_bnd_start</a></div><div class="ttdeci">size_t halo_bnd_start[4]</div><div class="ttdoc">Hyperslab of boundary halos start.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03635">mptrac.h:3635</a></div></div>
<div class="ttc" id="astructdd__t_html_a4c78887b9409bd5df6712a20a66521cb"><div class="ttname"><a href="structdd__t.html#a4c78887b9409bd5df6712a20a66521cb">dd_t::subdomain_lat_max</a></div><div class="ttdeci">double subdomain_lat_max</div><div class="ttdoc">Rectangular grid limit of subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03623">mptrac.h:3623</a></div></div>
<div class="ttc" id="astructdd__t_html_ab16175b143cbeecaeb2c36ee5b0e6866"><div class="ttname"><a href="structdd__t.html#ab16175b143cbeecaeb2c36ee5b0e6866">dd_t::halo_offset_start</a></div><div class="ttdeci">int halo_offset_start</div><div class="ttdoc">Hyperslab of boundary halos count.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03641">mptrac.h:3641</a></div></div>
<div class="ttc" id="astructdd__t_html_ad58b7aeca9bd6081bf8b4d3513b5b2d9"><div class="ttname"><a href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">dd_t::subdomain_count</a></div><div class="ttdeci">size_t subdomain_count[4]</div><div class="ttdoc">Hyperslab start and count for subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03632">mptrac.h:3632</a></div></div>
<div class="ttc" id="astructdd__t_html_adab6ce7b4a33bd7ca538c518d09dbdbd"><div class="ttname"><a href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">dd_t::subdomain_start</a></div><div class="ttdeci">size_t subdomain_start[4]</div><div class="ttdoc">Hyperslab start and count for subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03629">mptrac.h:3629</a></div></div>
<div class="ttc" id="astructdd__t_html_add774577943891853b6163f35cf04914"><div class="ttname"><a href="structdd__t.html#add774577943891853b6163f35cf04914">dd_t::size</a></div><div class="ttdeci">int size</div><div class="ttdoc">Size of node.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03602">mptrac.h:3602</a></div></div>
<div class="ttc" id="astructdd__t_html_adea99db4e3c656e7c653f6f2f53524c7"><div class="ttname"><a href="structdd__t.html#adea99db4e3c656e7c653f6f2f53524c7">dd_t::subdomain_lat_min</a></div><div class="ttdeci">double subdomain_lat_min</div><div class="ttdoc">Rectangular grid limit of subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l03626">mptrac.h:3626</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ee3cac435af17ad5aaf885cc2dc3262" name="a2ee3cac435af17ad5aaf885cc2dc3262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ee3cac435af17ad5aaf885cc2dc3262">&#9670;&nbsp;</a></span>read_met_nc_levels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_nc_levels </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and processes meteorological level data from NetCDF files with domain decomposition. </p>
<p >The <code>read_met_nc_levels</code> function reads meteorological level data from a NetCDF file and processes it for use in a domain decomposition context. It handles various meteorological parameters such as temperature, wind components, humidity, ozone, cloud data, and vertical velocity. The function also processes pressure levels and interpolates data between model and pressure levels as needed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ncid</td><td>An integer representing the NetCDF file ID. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters and settings. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure where meteorological level data will be stored. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information, including rank and neighbours.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Reads temperature, horizontal wind components, and vertical velocity data.</li>
<li>Processes water vapor data, handling both specific and relative humidity.</li>
<li>Reads ozone and various cloud-related data such as liquid water content, ice water content, and cloud cover.</li>
<li>Processes zeta and zeta_dot data.</li>
<li>Stores velocities on model levels and saves the number of model levels.</li>
<li>Computes pressure on model levels using different methods based on control parameters.</li>
<li>Checks the ordering of pressure levels to ensure they are monotonic.</li>
<li>Interpolates meteorological variables from model levels to pressure levels if specified.</li>
<li>Validates the ordering of pressure levels to ensure they are in descending order.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the NetCDF file ID and structures are properly initialized. It is designed to work with NetCDF files and uses OpenMP for parallel processing. The function logs errors and warnings for missing or unreadable data fields and handles different data formats.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l08555">8555</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8559</span>            {</div>
<div class="line"><span class="lineno"> 8560</span> </div>
<div class="line"><span class="lineno"> 8561</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 8562</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_NC_LEVELS&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 8563</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read level data...&quot;</span>);</div>
<div class="line"><span class="lineno"> 8564</span> </div>
<div class="line"><span class="lineno"> 8565</span>  <span class="comment">/* Read temperature... */</span></div>
<div class="line"><span class="lineno"> 8566</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8567</span>      (ncid, <span class="stringliteral">&quot;t&quot;</span>, <span class="stringliteral">&quot;T&quot;</span>, <span class="stringliteral">&quot;temp&quot;</span>, <span class="stringliteral">&quot;TEMP&quot;</span>, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, 1.0))</div>
<div class="line"><span class="lineno"> 8568</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot read temperature!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8569</span> </div>
<div class="line"><span class="lineno"> 8570</span>  <span class="comment">/* Read horizontal wind and vertical velocity... */</span></div>
<div class="line"><span class="lineno"> 8571</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;u&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>, 1.0))</div>
<div class="line"><span class="lineno"> 8572</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot read zonal wind!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8573</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;v&quot;</span>, <span class="stringliteral">&quot;V&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>, 1.0))</div>
<div class="line"><span class="lineno"> 8574</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot read meridional wind!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8575</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8576</span>      (ncid, <span class="stringliteral">&quot;w&quot;</span>, <span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;omega&quot;</span>, <span class="stringliteral">&quot;OMEGA&quot;</span>, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>, 0.01f))</div>
<div class="line"><span class="lineno"> 8577</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read vertical velocity!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8578</span> </div>
<div class="line"><span class="lineno"> 8579</span>  <span class="comment">/* Read water vapor... */</span></div>
<div class="line"><span class="lineno"> 8580</span>  <span class="keywordflow">if</span> (!ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aaa5260e73daff92d01c55e87310ab837">met_relhum</a>) {</div>
<div class="line"><span class="lineno"> 8581</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8582</span>        (ncid, <span class="stringliteral">&quot;q&quot;</span>, <span class="stringliteral">&quot;Q&quot;</span>, <span class="stringliteral">&quot;sh&quot;</span>, <span class="stringliteral">&quot;SH&quot;</span>, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>,</div>
<div class="line"><span class="lineno"> 8583</span>         (<span class="keywordtype">float</span>) (<a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a> / <a class="code hl_define" href="mptrac_8h.html#a1c4cf7d6c3605ff72cd8b9a63379d4ea">MH2O</a>)))</div>
<div class="line"><span class="lineno"> 8584</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read specific humidity!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8585</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8586</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8587</span>        (ncid, <span class="stringliteral">&quot;rh&quot;</span>, <span class="stringliteral">&quot;RH&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>, 0.01f))</div>
<div class="line"><span class="lineno"> 8588</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read relative humidity!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8589</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno"> 8590</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8591</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8592</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 8593</span>          <span class="keywordtype">double</span> pw = met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip] * <a class="code hl_define" href="mptrac_8h.html#adc5ae7e10b1b021fb68397df5bad0a64">PSAT</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip]);</div>
<div class="line"><span class="lineno"> 8594</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip] =</div>
<div class="line"><span class="lineno"> 8595</span>            (float) (pw / (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] - (1.0 - <a class="code hl_define" href="mptrac_8h.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a>) * pw));</div>
<div class="line"><span class="lineno"> 8596</span>        }</div>
<div class="line"><span class="lineno"> 8597</span>  }</div>
<div class="line"><span class="lineno"> 8598</span> </div>
<div class="line"><span class="lineno"> 8599</span>  <span class="comment">/* Read ozone... */</span></div>
<div class="line"><span class="lineno"> 8600</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8601</span>      (ncid, <span class="stringliteral">&quot;o3&quot;</span>, <span class="stringliteral">&quot;O3&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>,</div>
<div class="line"><span class="lineno"> 8602</span>       (<span class="keywordtype">float</span>) (<a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a> / <a class="code hl_define" href="mptrac_8h.html#aa5770de64e81ecf3f35d559357f67a76">MO3</a>)))</div>
<div class="line"><span class="lineno"> 8603</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read ozone data!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8604</span> </div>
<div class="line"><span class="lineno"> 8605</span>  <span class="comment">/* Read cloud data... */</span></div>
<div class="line"><span class="lineno"> 8606</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8607</span>      (ncid, <span class="stringliteral">&quot;clwc&quot;</span>, <span class="stringliteral">&quot;CLWC&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>, 1.0))</div>
<div class="line"><span class="lineno"> 8608</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read cloud liquid water content!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8609</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8610</span>      (ncid, <span class="stringliteral">&quot;crwc&quot;</span>, <span class="stringliteral">&quot;CRWC&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>, 1.0))</div>
<div class="line"><span class="lineno"> 8611</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read cloud rain water content!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8612</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8613</span>      (ncid, <span class="stringliteral">&quot;ciwc&quot;</span>, <span class="stringliteral">&quot;CIWC&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>, 1.0))</div>
<div class="line"><span class="lineno"> 8614</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read cloud ice water content!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8615</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8616</span>      (ncid, <span class="stringliteral">&quot;cswc&quot;</span>, <span class="stringliteral">&quot;CSWC&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>, 1.0))</div>
<div class="line"><span class="lineno"> 8617</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read cloud snow water content!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8618</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8619</span>      (ncid, <span class="stringliteral">&quot;cc&quot;</span>, <span class="stringliteral">&quot;CC&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>, 1.0))</div>
<div class="line"><span class="lineno"> 8620</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read cloud cover!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8621</span> </div>
<div class="line"><span class="lineno"> 8622</span>  <span class="comment">/* Read zeta and zeta_dot... */</span></div>
<div class="line"><span class="lineno"> 8623</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 1) {</div>
<div class="line"><span class="lineno"> 8624</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8625</span>        (ncid, <span class="stringliteral">&quot;ZETA&quot;</span>, <span class="stringliteral">&quot;zeta&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>, 1.0))</div>
<div class="line"><span class="lineno"> 8626</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read ZETA!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8627</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8628</span>        (ncid, <span class="stringliteral">&quot;ZETA_DOT_TOT&quot;</span>, <span class="stringliteral">&quot;ZETA_DOT_clr&quot;</span>, <span class="stringliteral">&quot;zeta_dot_clr&quot;</span>,</div>
<div class="line"><span class="lineno"> 8629</span>         NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a1153b31e69a6542d2ee83d60c38f7bb1">zeta_dotl</a>, 0.00001157407f))</div>
<div class="line"><span class="lineno"> 8630</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read ZETA_DOT!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8631</span>  }</div>
<div class="line"><span class="lineno"> 8632</span> </div>
<div class="line"><span class="lineno"> 8633</span>  <span class="comment">/* Read eta and eta_dot... */</span></div>
<div class="line"><span class="lineno"> 8634</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 3) {</div>
<div class="line"><span class="lineno"> 8635</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 8636</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8637</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8638</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 8639</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>[ix][iy][ip] =</div>
<div class="line"><span class="lineno"> 8640</span>            (<span class="keywordtype">float</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#af5a4387f69e54842c9bfa297ececb84a">hyam</a>[ip] / 100000.0 + met-&gt;<a class="code hl_variable" href="structmet__t.html#afd849797692e62559cbd8d18fd3cb8b6">hybm</a>[ip]);</div>
<div class="line"><span class="lineno"> 8641</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8642</span>        (ncid, <span class="stringliteral">&quot;etadot&quot;</span>, <span class="stringliteral">&quot;ETADOT&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a1153b31e69a6542d2ee83d60c38f7bb1">zeta_dotl</a>,</div>
<div class="line"><span class="lineno"> 8643</span>         1.0))</div>
<div class="line"><span class="lineno"> 8644</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read eta vertical velocity!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8645</span>  }</div>
<div class="line"><span class="lineno"> 8646</span> </div>
<div class="line"><span class="lineno"> 8647</span>  <span class="comment">/* Store velocities on model levels... */</span></div>
<div class="line"><span class="lineno"> 8648</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> != 0) {</div>
<div class="line"><span class="lineno"> 8649</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 8650</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8651</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8652</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 8653</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a760447bb9eca0826b3705f30a9b8f165">ul</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno"> 8654</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a4b4aaeb8f39dea0fb511744f84535303">vl</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno"> 8655</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a4618b608901900608688f4f649dfbfc4">wl</a>[ix][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno"> 8656</span>        }</div>
<div class="line"><span class="lineno"> 8657</span> </div>
<div class="line"><span class="lineno"> 8658</span>    <span class="comment">/* Save number of model levels... */</span></div>
<div class="line"><span class="lineno"> 8659</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#abe8b336b71924b14d2badd0d6c0f7c27">npl</a> = met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>;</div>
<div class="line"><span class="lineno"> 8660</span>  }</div>
<div class="line"><span class="lineno"> 8661</span> </div>
<div class="line"><span class="lineno"> 8662</span>  <span class="comment">/* Get pressure on model levels... */</span></div>
<div class="line"><span class="lineno"> 8663</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> &gt; 0 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> != 0) {</div>
<div class="line"><span class="lineno"> 8664</span> </div>
<div class="line"><span class="lineno"> 8665</span>    <span class="comment">/* Read 3-D pressure field... */</span></div>
<div class="line"><span class="lineno"> 8666</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> == 1) {</div>
<div class="line"><span class="lineno"> 8667</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8668</span>          (ncid, <span class="stringliteral">&quot;pl&quot;</span>, <span class="stringliteral">&quot;PL&quot;</span>, <span class="stringliteral">&quot;pressure&quot;</span>, <span class="stringliteral">&quot;PRESSURE&quot;</span>, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>,</div>
<div class="line"><span class="lineno"> 8669</span>           0.01f))</div>
<div class="line"><span class="lineno"> 8670</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8671</span>            (ncid, <span class="stringliteral">&quot;press&quot;</span>, <span class="stringliteral">&quot;PRESS&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, 1.0))</div>
<div class="line"><span class="lineno"> 8672</span>          <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot read pressure on model levels!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8673</span>    }</div>
<div class="line"><span class="lineno"> 8674</span> </div>
<div class="line"><span class="lineno"> 8675</span>    <span class="comment">/* Use a and b coefficients for full levels (at layer midpoints)... */</span></div>
<div class="line"><span class="lineno"> 8676</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> == 2 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> == 3) {</div>
<div class="line"><span class="lineno"> 8677</span> </div>
<div class="line"><span class="lineno"> 8678</span>      <span class="comment">/* Check number of levels... */</span></div>
<div class="line"><span class="lineno"> 8679</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> == 3 &amp;&amp; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> != ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6024bf55339aa76e34a54e29f357bf6d">met_nlev</a>)</div>
<div class="line"><span class="lineno"> 8680</span>        <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Mismatch in number of model levels!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8681</span> </div>
<div class="line"><span class="lineno"> 8682</span>      <span class="comment">/* Calculate pressure... */</span></div>
<div class="line"><span class="lineno"> 8683</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8684</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8685</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 8686</span>            met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][ip] =</div>
<div class="line"><span class="lineno"> 8687</span>              (<span class="keywordtype">float</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#af5a4387f69e54842c9bfa297ececb84a">hyam</a>[ip] / 100. +</div>
<div class="line"><span class="lineno"> 8688</span>                       met-&gt;<a class="code hl_variable" href="structmet__t.html#afd849797692e62559cbd8d18fd3cb8b6">hybm</a>[ip] * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy]);</div>
<div class="line"><span class="lineno"> 8689</span>    }</div>
<div class="line"><span class="lineno"> 8690</span> </div>
<div class="line"><span class="lineno"> 8691</span>    <span class="comment">/* Use a and b coefficients for half levels (at layer interfaces)... */</span></div>
<div class="line"><span class="lineno"> 8692</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a97ad8d93c5cc5fd25e9528eb5cc0144a">met_vert_coord</a> == 4) {</div>
<div class="line"><span class="lineno"> 8693</span> </div>
<div class="line"><span class="lineno"> 8694</span>      <span class="comment">/* Check number of levels... */</span></div>
<div class="line"><span class="lineno"> 8695</span>      <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> + 1 != ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6024bf55339aa76e34a54e29f357bf6d">met_nlev</a>)</div>
<div class="line"><span class="lineno"> 8696</span>        <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Mismatch in number of model levels!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8697</span> </div>
<div class="line"><span class="lineno"> 8698</span>      <span class="comment">/* Calculate pressure... */</span></div>
<div class="line"><span class="lineno"> 8699</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno"> 8700</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8701</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8702</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 8703</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> p0 =</div>
<div class="line"><span class="lineno"> 8704</span>              met-&gt;<a class="code hl_variable" href="structmet__t.html#af5a4387f69e54842c9bfa297ececb84a">hyam</a>[ip] / 100. + met-&gt;<a class="code hl_variable" href="structmet__t.html#afd849797692e62559cbd8d18fd3cb8b6">hybm</a>[ip] * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy];</div>
<div class="line"><span class="lineno"> 8705</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> p1 =</div>
<div class="line"><span class="lineno"> 8706</span>              met-&gt;<a class="code hl_variable" href="structmet__t.html#af5a4387f69e54842c9bfa297ececb84a">hyam</a>[ip + 1] / 100. + met-&gt;<a class="code hl_variable" href="structmet__t.html#afd849797692e62559cbd8d18fd3cb8b6">hybm</a>[ip + 1] * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy];</div>
<div class="line"><span class="lineno"> 8707</span>            met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][ip] = (float) ((p1 - p0) / log(p1 / p0));</div>
<div class="line"><span class="lineno"> 8708</span>          }</div>
<div class="line"><span class="lineno"> 8709</span>    }</div>
<div class="line"><span class="lineno"> 8710</span> </div>
<div class="line"><span class="lineno"> 8711</span>    <span class="comment">/* Check ordering of pressure levels... */</span></div>
<div class="line"><span class="lineno"> 8712</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8713</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8714</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 1; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 8715</span>          <span class="keywordflow">if</span> ((met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][0] &gt; met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][1]</div>
<div class="line"><span class="lineno"> 8716</span>               &amp;&amp; met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][ip - 1] &lt;= met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][ip])</div>
<div class="line"><span class="lineno"> 8717</span>              || (met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][0] &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][1]</div>
<div class="line"><span class="lineno"> 8718</span>                  &amp;&amp; met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][ip - 1] &gt;= met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][ip]))</div>
<div class="line"><span class="lineno"> 8719</span>            <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Pressure profiles are not monotonic!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8720</span>  }</div>
<div class="line"><span class="lineno"> 8721</span> </div>
<div class="line"><span class="lineno"> 8722</span>  <span class="comment">/* Interpolate from model levels to pressure levels... */</span></div>
<div class="line"><span class="lineno"> 8723</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 8724</span> </div>
<div class="line"><span class="lineno"> 8725</span>    <span class="comment">/* Interpolate variables... */</span></div>
<div class="line"><span class="lineno"> 8726</span>    <a class="code hl_function" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a>(ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, <span class="stringliteral">&quot;T&quot;</span>);</div>
<div class="line"><span class="lineno"> 8727</span>    <a class="code hl_function" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a>(ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line"><span class="lineno"> 8728</span>    <a class="code hl_function" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a>(ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>, <span class="stringliteral">&quot;V&quot;</span>);</div>
<div class="line"><span class="lineno"> 8729</span>    <a class="code hl_function" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a>(ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>, <span class="stringliteral">&quot;W&quot;</span>);</div>
<div class="line"><span class="lineno"> 8730</span>    <a class="code hl_function" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a>(ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>, <span class="stringliteral">&quot;H2O&quot;</span>);</div>
<div class="line"><span class="lineno"> 8731</span>    <a class="code hl_function" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a>(ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>, <span class="stringliteral">&quot;O3&quot;</span>);</div>
<div class="line"><span class="lineno"> 8732</span>    <a class="code hl_function" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a>(ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>, <span class="stringliteral">&quot;LWC&quot;</span>);</div>
<div class="line"><span class="lineno"> 8733</span>    <a class="code hl_function" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a>(ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>, <span class="stringliteral">&quot;RWC&quot;</span>);</div>
<div class="line"><span class="lineno"> 8734</span>    <a class="code hl_function" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a>(ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>, <span class="stringliteral">&quot;IWC&quot;</span>);</div>
<div class="line"><span class="lineno"> 8735</span>    <a class="code hl_function" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a>(ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>, <span class="stringliteral">&quot;SWC&quot;</span>);</div>
<div class="line"><span class="lineno"> 8736</span>    <a class="code hl_function" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a>(ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>, <span class="stringliteral">&quot;CC&quot;</span>);</div>
<div class="line"><span class="lineno"> 8737</span> </div>
<div class="line"><span class="lineno"> 8738</span>    <span class="comment">/* Set new pressure levels... */</span></div>
<div class="line"><span class="lineno"> 8739</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a>;</div>
<div class="line"><span class="lineno"> 8740</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 8741</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[ip];</div>
<div class="line"><span class="lineno"> 8742</span>  }</div>
<div class="line"><span class="lineno"> 8743</span> </div>
<div class="line"><span class="lineno"> 8744</span>  <span class="comment">/* Check ordering of pressure levels... */</span></div>
<div class="line"><span class="lineno"> 8745</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 1; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 8746</span>    <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip - 1] &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip])</div>
<div class="line"><span class="lineno"> 8747</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Pressure levels must be descending!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8748</span>}</div>
<div class="ttc" id="amptrac_8c_html_a1ff6a4eae1eba129266c5485c77aa6a3"><div class="ttname"><a href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div><div class="ttdeci">int read_met_nc_3d(const int ncid, const char *varname, const char *varname2, const char *varname3, const char *varname4, const ctl_t *ctl, const met_t *met, dd_t *dd, float dest[EX][EY][EP], const float scl)</div><div class="ttdoc">Reads a 3-dimensional meteorological variable from a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l09014">mptrac.c:9014</a></div></div>
<div class="ttc" id="amptrac_8c_html_a449f642b01d0dc65cc32f86a850bcb7b"><div class="ttname"><a href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b">read_met_ml2pl</a></div><div class="ttdeci">void read_met_ml2pl(const ctl_t *ctl, const met_t *met, float var[EX][EY][EP], const char *varname)</div><div class="ttdoc">Interpolates meteorological data to specified pressure levels.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l09706">mptrac.c:9706</a></div></div>
<div class="ttc" id="amptrac_8h_html_a1c4cf7d6c3605ff72cd8b9a63379d4ea"><div class="ttname"><a href="mptrac_8h.html#a1c4cf7d6c3605ff72cd8b9a63379d4ea">MH2O</a></div><div class="ttdeci">#define MH2O</div><div class="ttdoc">Molar mass of water vapor [g/mol].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00244">mptrac.h:244</a></div></div>
<div class="ttc" id="amptrac_8h_html_aa5770de64e81ecf3f35d559357f67a76"><div class="ttname"><a href="mptrac_8h.html#aa5770de64e81ecf3f35d559357f67a76">MO3</a></div><div class="ttdeci">#define MO3</div><div class="ttdoc">Molar mass of ozone [g/mol].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00249">mptrac.h:249</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a2ee3cac435af17ad5aaf885cc2dc3262_cgraph.png" border="0" usemap="#amptrac_8h_a2ee3cac435af17ad5aaf885cc2dc3262_cgraph" alt=""/></div>
<map name="amptrac_8h_a2ee3cac435af17ad5aaf885cc2dc3262_cgraph" id="amptrac_8h_a2ee3cac435af17ad5aaf885cc2dc3262_cgraph">
<area shape="rect" title="Reads and processes meteorological level data from NetCDF files with domain decomposition." alt="" coords="5,31,144,57"/>
<area shape="rect" href="mptrac_8c.html#a449f642b01d0dc65cc32f86a850bcb7b" title="Interpolates meteorological data to specified pressure levels." alt="" coords="194,5,309,32"/>
<area shape="rect" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3" title="Reads a 3&#45;dimensional meteorological variable from a NetCDF file." alt="" coords="192,56,311,83"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="359,5,433,32"/>
</map>
</div>

</div>
</div>
<a id="aa86499774fc9def653b04f95e56b4052" name="aa86499774fc9def653b04f95e56b4052"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa86499774fc9def653b04f95e56b4052">&#9670;&nbsp;</a></span>read_met_nc_surface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_nc_surface </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and processes surface meteorological data from NetCDF files with domain decomposition. </p>
<p >The <code>read_met_nc_surface</code> function reads surface meteorological data from a NetCDF file and processes it for use in a domain decomposition context. It handles various surface parameters such as pressure, geopotential height, temperature, wind components, and other relevant meteorological data. The function is designed to work with different meteorological data formats and configurations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ncid</td><td>An integer representing the NetCDF file ID. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters and settings. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure where surface meteorological data will be stored. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information, including rank and neighbours.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Reads surface pressure data and converts it if necessary.</li>
<li>Handles different data formats for MPTRAC and CLaMS meteorological data.</li>
<li>Reads geopotential height at the surface and processes it based on the data format.</li>
<li>Retrieves surface temperature, zonal and meridional wind, and other surface parameters.</li>
<li>Logs warnings if specific data fields cannot be read.</li>
<li>Uses helper functions to read 2D and 3D data fields from the NetCDF file.</li>
<li>Processes and stores the read data into the provided meteorological data structure.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the NetCDF file ID and structures are properly initialized. It is designed to work with NetCDF files and uses MPI for parallel processing. The function logs warnings for missing or unreadable data fields and handles different data formats.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l08417">8417</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8421</span>            {</div>
<div class="line"><span class="lineno"> 8422</span> </div>
<div class="line"><span class="lineno"> 8423</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno"> 8424</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_SURFACE&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 8425</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read surface data...&quot;</span>);</div>
<div class="line"><span class="lineno"> 8426</span> </div>
<div class="line"><span class="lineno"> 8427</span>  <span class="comment">/* Read surface pressure... */</span></div>
<div class="line"><span class="lineno"> 8428</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8429</span>      (ncid, <span class="stringliteral">&quot;lnsp&quot;</span>, <span class="stringliteral">&quot;LNSP&quot;</span>, NULL, NULL, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>,</div>
<div class="line"><span class="lineno"> 8430</span>       1.0f, 1)) {</div>
<div class="line"><span class="lineno"> 8431</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8432</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8433</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy] = (<span class="keywordtype">float</span>) (exp(met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy]) / 100.);</div>
<div class="line"><span class="lineno"> 8434</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8435</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8436</span>        (ncid, <span class="stringliteral">&quot;ps&quot;</span>, <span class="stringliteral">&quot;PS&quot;</span>, <span class="stringliteral">&quot;sp&quot;</span>, <span class="stringliteral">&quot;SP&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>,</div>
<div class="line"><span class="lineno"> 8437</span>         0.01f, 1)) {</div>
<div class="line"><span class="lineno"> 8438</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot not read surface pressure data (use lowest level)!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8439</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8440</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8441</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy]</div>
<div class="line"><span class="lineno"> 8442</span>          = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#acd95a4753595490c2723383bd09ca035">met_np</a> &gt; 0 ? (<span class="keywordtype">float</span>) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aeffc15a483bdb95fea0f1b44982e7281">met_p</a>[0] : (<span class="keywordtype">float</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[0]);</div>
<div class="line"><span class="lineno"> 8443</span>  }</div>
<div class="line"><span class="lineno"> 8444</span> </div>
<div class="line"><span class="lineno"> 8445</span>  <span class="comment">/* MPTRAC meteo data... */</span></div>
<div class="line"><span class="lineno"> 8446</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6607c472936ade8396ee3095595f0475">met_clams</a> == 0) {</div>
<div class="line"><span class="lineno"> 8447</span> </div>
<div class="line"><span class="lineno"> 8448</span>    <span class="comment">/* Read geopotential height at the surface... */</span></div>
<div class="line"><span class="lineno"> 8449</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8450</span>        (ncid, <span class="stringliteral">&quot;z&quot;</span>, <span class="stringliteral">&quot;Z&quot;</span>, NULL, NULL, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>,</div>
<div class="line"><span class="lineno"> 8451</span>         (<span class="keywordtype">float</span>) (1. / (1000. * <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a>)), 1))</div>
<div class="line"><span class="lineno"> 8452</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8453</span>          (ncid, <span class="stringliteral">&quot;zm&quot;</span>, <span class="stringliteral">&quot;ZM&quot;</span>, NULL, NULL, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>,</div>
<div class="line"><span class="lineno"> 8454</span>           (<span class="keywordtype">float</span>) (1. / 1000.), 1))</div>
<div class="line"><span class="lineno"> 8455</span>        <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read surface geopotential height!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8456</span>  }</div>
<div class="line"><span class="lineno"> 8457</span> </div>
<div class="line"><span class="lineno"> 8458</span>  <span class="comment">/* CLaMS meteo data... */</span></div>
<div class="line"><span class="lineno"> 8459</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8460</span> </div>
<div class="line"><span class="lineno"> 8461</span>    <span class="comment">/* Read geopotential height at the surface</span></div>
<div class="line"><span class="lineno"> 8462</span><span class="comment">       (use lowermost level of 3-D data field)... */</span></div>
<div class="line"><span class="lineno"> 8463</span>    <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno"> 8464</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 8465</span>          <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> * <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>);</div>
<div class="line"><span class="lineno"> 8466</span>    memcpy(help, met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, <span class="keyword">sizeof</span>(met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>));</div>
<div class="line"><span class="lineno"> 8467</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3">read_met_nc_3d</a></div>
<div class="line"><span class="lineno"> 8468</span>        (ncid, <span class="stringliteral">&quot;gph&quot;</span>, <span class="stringliteral">&quot;GPH&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>,</div>
<div class="line"><span class="lineno"> 8469</span>         (<span class="keywordtype">float</span>) (1e-3 / <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a>)))</div>
<div class="line"><span class="lineno"> 8470</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot read geopotential height!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8471</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8472</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8473</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[ix][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[ix][iy][0];</div>
<div class="line"><span class="lineno"> 8474</span>    memcpy(met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>, help, <span class="keyword">sizeof</span>(met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>));</div>
<div class="line"><span class="lineno"> 8475</span>    free(help);</div>
<div class="line"><span class="lineno"> 8476</span>  }</div>
<div class="line"><span class="lineno"> 8477</span> </div>
<div class="line"><span class="lineno"> 8478</span>  <span class="comment">/* Read temperature at the surface... */</span></div>
<div class="line"><span class="lineno"> 8479</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8480</span>      (ncid, <span class="stringliteral">&quot;t2m&quot;</span>, <span class="stringliteral">&quot;T2M&quot;</span>, <span class="stringliteral">&quot;2t&quot;</span>, <span class="stringliteral">&quot;2T&quot;</span>, <span class="stringliteral">&quot;t2&quot;</span>, <span class="stringliteral">&quot;T2&quot;</span>, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>, 1.0,</div>
<div class="line"><span class="lineno"> 8481</span>       1))</div>
<div class="line"><span class="lineno"> 8482</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read surface temperature!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8483</span> </div>
<div class="line"><span class="lineno"> 8484</span>  <span class="comment">/* Read zonal wind at the surface... */</span></div>
<div class="line"><span class="lineno"> 8485</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8486</span>      (ncid, <span class="stringliteral">&quot;u10m&quot;</span>, <span class="stringliteral">&quot;U10M&quot;</span>, <span class="stringliteral">&quot;10u&quot;</span>, <span class="stringliteral">&quot;10U&quot;</span>, <span class="stringliteral">&quot;u10&quot;</span>, <span class="stringliteral">&quot;U10&quot;</span>, ctl, met, dd,</div>
<div class="line"><span class="lineno"> 8487</span>       met-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>, 1.0, 1))</div>
<div class="line"><span class="lineno"> 8488</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read surface zonal wind!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8489</span> </div>
<div class="line"><span class="lineno"> 8490</span>  <span class="comment">/* Read meridional wind at the surface... */</span></div>
<div class="line"><span class="lineno"> 8491</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8492</span>      (ncid, <span class="stringliteral">&quot;v10m&quot;</span>, <span class="stringliteral">&quot;V10M&quot;</span>, <span class="stringliteral">&quot;10v&quot;</span>, <span class="stringliteral">&quot;10V&quot;</span>, <span class="stringliteral">&quot;v10&quot;</span>, <span class="stringliteral">&quot;V10&quot;</span>, ctl, met, dd,</div>
<div class="line"><span class="lineno"> 8493</span>       met-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>, 1.0, 1))</div>
<div class="line"><span class="lineno"> 8494</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read surface meridional wind!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8495</span> </div>
<div class="line"><span class="lineno"> 8496</span>  <span class="comment">/* Read eastward turbulent surface stress... */</span></div>
<div class="line"><span class="lineno"> 8497</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8498</span>      (ncid, <span class="stringliteral">&quot;iews&quot;</span>, <span class="stringliteral">&quot;IEWS&quot;</span>, NULL, NULL, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>,</div>
<div class="line"><span class="lineno"> 8499</span>       1.0, 1))</div>
<div class="line"><span class="lineno"> 8500</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read eastward turbulent surface stress!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8501</span> </div>
<div class="line"><span class="lineno"> 8502</span>  <span class="comment">/* Read northward turbulent surface stress... */</span></div>
<div class="line"><span class="lineno"> 8503</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8504</span>      (ncid, <span class="stringliteral">&quot;inss&quot;</span>, <span class="stringliteral">&quot;INSS&quot;</span>, NULL, NULL, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>,</div>
<div class="line"><span class="lineno"> 8505</span>       1.0, 1))</div>
<div class="line"><span class="lineno"> 8506</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read nothward turbulent surface stress!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8507</span> </div>
<div class="line"><span class="lineno"> 8508</span>  <span class="comment">/* Read surface sensible heat flux... */</span></div>
<div class="line"><span class="lineno"> 8509</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8510</span>      (ncid, <span class="stringliteral">&quot;ishf&quot;</span>, <span class="stringliteral">&quot;ISHF&quot;</span>, NULL, NULL, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>,</div>
<div class="line"><span class="lineno"> 8511</span>       1.0, 1))</div>
<div class="line"><span class="lineno"> 8512</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read surface sensible heat flux!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8513</span> </div>
<div class="line"><span class="lineno"> 8514</span>  <span class="comment">/* Read land-sea mask... */</span></div>
<div class="line"><span class="lineno"> 8515</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8516</span>      (ncid, <span class="stringliteral">&quot;lsm&quot;</span>, <span class="stringliteral">&quot;LSM&quot;</span>, NULL, NULL, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>,</div>
<div class="line"><span class="lineno"> 8517</span>       1.0, 1))</div>
<div class="line"><span class="lineno"> 8518</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read land-sea mask!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8519</span> </div>
<div class="line"><span class="lineno"> 8520</span>  <span class="comment">/* Read sea surface temperature... */</span></div>
<div class="line"><span class="lineno"> 8521</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8522</span>      (ncid, <span class="stringliteral">&quot;sstk&quot;</span>, <span class="stringliteral">&quot;SSTK&quot;</span>, <span class="stringliteral">&quot;sst&quot;</span>, <span class="stringliteral">&quot;SST&quot;</span>, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>,</div>
<div class="line"><span class="lineno"> 8523</span>       1.0, 1))</div>
<div class="line"><span class="lineno"> 8524</span>    <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read sea surface temperature!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8525</span> </div>
<div class="line"><span class="lineno"> 8526</span>  <span class="comment">/* Read PBL... */</span></div>
<div class="line"><span class="lineno"> 8527</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a220b71ff77f479684ae659f626b1c5d9">met_pbl</a> == 0)</div>
<div class="line"><span class="lineno"> 8528</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8529</span>        (ncid, <span class="stringliteral">&quot;blp&quot;</span>, <span class="stringliteral">&quot;BLP&quot;</span>, NULL, NULL, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>,</div>
<div class="line"><span class="lineno"> 8530</span>         0.01f, 1))</div>
<div class="line"><span class="lineno"> 8531</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read planetary boundary layer pressure!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8532</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a220b71ff77f479684ae659f626b1c5d9">met_pbl</a> == 1)</div>
<div class="line"><span class="lineno"> 8533</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8534</span>        (ncid, <span class="stringliteral">&quot;blh&quot;</span>, <span class="stringliteral">&quot;BLH&quot;</span>, NULL, NULL, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>,</div>
<div class="line"><span class="lineno"> 8535</span>         0.001f, 1))</div>
<div class="line"><span class="lineno"> 8536</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read planetary boundary layer height!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8537</span> </div>
<div class="line"><span class="lineno"> 8538</span>  <span class="comment">/* Read CAPE... */</span></div>
<div class="line"><span class="lineno"> 8539</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a47ee3960f0b2b25382062fa8dda37ede">met_cape</a> == 0)</div>
<div class="line"><span class="lineno"> 8540</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8541</span>        (ncid, <span class="stringliteral">&quot;cape&quot;</span>, <span class="stringliteral">&quot;CAPE&quot;</span>, NULL, NULL, NULL, NULL, ctl, met, dd,</div>
<div class="line"><span class="lineno"> 8542</span>         met-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>, 1.0, 1))</div>
<div class="line"><span class="lineno"> 8543</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read CAPE!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8544</span> </div>
<div class="line"><span class="lineno"> 8545</span>  <span class="comment">/* Read CIN... */</span></div>
<div class="line"><span class="lineno"> 8546</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a47ee3960f0b2b25382062fa8dda37ede">met_cape</a> == 0)</div>
<div class="line"><span class="lineno"> 8547</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div>
<div class="line"><span class="lineno"> 8548</span>        (ncid, <span class="stringliteral">&quot;cin&quot;</span>, <span class="stringliteral">&quot;CIN&quot;</span>, NULL, NULL, NULL, NULL, ctl, met, dd, met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>,</div>
<div class="line"><span class="lineno"> 8549</span>         1.0, 1))</div>
<div class="line"><span class="lineno"> 8550</span>      <a class="code hl_define" href="mptrac_8h.html#a8f75b971030a39ef811d3526a62b36b8">WARN</a>(<span class="stringliteral">&quot;Cannot read convective inhibition!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8551</span>}</div>
<div class="ttc" id="amptrac_8c_html_a0ab3c3e5e9881f1b688e6840723356ed"><div class="ttname"><a href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed">read_met_nc_2d</a></div><div class="ttdeci">int read_met_nc_2d(const int ncid, const char *varname, const char *varname2, const char *varname3, const char *varname4, const char *varname5, const char *varname6, const ctl_t *ctl, const met_t *met, dd_t *dd, float dest[EX][EY], const float scl, const int init)</div><div class="ttdoc">Reads a 2-dimensional meteorological variable from a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l08752">mptrac.c:8752</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_aa86499774fc9def653b04f95e56b4052_cgraph.png" border="0" usemap="#amptrac_8h_aa86499774fc9def653b04f95e56b4052_cgraph" alt=""/></div>
<map name="amptrac_8h_aa86499774fc9def653b04f95e56b4052_cgraph" id="amptrac_8h_aa86499774fc9def653b04f95e56b4052_cgraph">
<area shape="rect" title="Reads and processes surface meteorological data from NetCDF files with domain decomposition." alt="" coords="5,31,152,57"/>
<area shape="rect" href="mptrac_8c.html#a0ab3c3e5e9881f1b688e6840723356ed" title="Reads a 2&#45;dimensional meteorological variable from a NetCDF file." alt="" coords="200,5,319,32"/>
<area shape="rect" href="mptrac_8c.html#a1ff6a4eae1eba129266c5485c77aa6a3" title="Reads a 3&#45;dimensional meteorological variable from a NetCDF file." alt="" coords="200,56,319,83"/>
</map>
</div>

</div>
</div>
<a id="a0ab3c3e5e9881f1b688e6840723356ed" name="a0ab3c3e5e9881f1b688e6840723356ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ab3c3e5e9881f1b688e6840723356ed">&#9670;&nbsp;</a></span>read_met_nc_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_met_nc_2d </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname5</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dest</em>[EX][EY], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>scl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads a 2-dimensional meteorological variable from a NetCDF file. </p>
<p >This function reads a 2-dimensional meteorological variable from a NetCDF file and stores it in a specified destination array. It supports both packed and unpacked data formats and handles missing values and scaling factors accordingly. The function also checks the meteorological data layout to ensure correct data copying.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ncid</td><td>The NetCDF file ID. </td></tr>
    <tr><td class="paramname">varname</td><td>The name of the variable to read. </td></tr>
    <tr><td class="paramname">varname2</td><td>An alternative name of the variable to read (in case varname is not found). </td></tr>
    <tr><td class="paramname">varname3</td><td>An alternative name of the variable to read (in case varname2 is not found). </td></tr>
    <tr><td class="paramname">varname4</td><td>An alternative name of the variable to read (in case varname3 is not found). </td></tr>
    <tr><td class="paramname">varname5</td><td>An alternative name of the variable to read (in case varname4 is not found). </td></tr>
    <tr><td class="paramname">varname6</td><td>An alternative name of the variable to read (in case varname5 is not found). </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a structure containing control parameters. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information, including rank and neighbours. </td></tr>
    <tr><td class="paramname">dest</td><td>The destination array to store the read data. </td></tr>
    <tr><td class="paramname">scl</td><td>A scaling factor to apply to the read data. </td></tr>
    <tr><td class="paramname">init</td><td>Flag indicating whether to initialize the destination array before reading. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 on success, 0 on failure.</dd></dl>
<p>The function performs the following steps:</p><ul>
<li>Checks if the specified variable exists in the NetCDF file.</li>
<li>Reads packed data if scaling factors are available, otherwise reads unpacked data.</li>
<li>Handles missing values and scaling factors appropriately.</li>
<li>Copies the data to the destination array, applying the scaling factor if provided.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l08752">8752</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8765</span>                  {</div>
<div class="line"><span class="lineno"> 8766</span> </div>
<div class="line"><span class="lineno"> 8767</span>  <span class="keywordtype">char</span> varsel[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 8768</span> </div>
<div class="line"><span class="lineno"> 8769</span>  <span class="keywordtype">float</span> offset, scalfac;</div>
<div class="line"><span class="lineno"> 8770</span> </div>
<div class="line"><span class="lineno"> 8771</span>  <span class="keywordtype">int</span> varid;</div>
<div class="line"><span class="lineno"> 8772</span> </div>
<div class="line"><span class="lineno"> 8773</span>  <span class="comment">/* Check if variable exists... */</span></div>
<div class="line"><span class="lineno"> 8774</span>  <span class="keywordflow">if</span> (nc_inq_varid(ncid, varname, &amp;varid) == NC_NOERR)</div>
<div class="line"><span class="lineno"> 8775</span>    sprintf(varsel, <span class="stringliteral">&quot;%s&quot;</span>, varname);</div>
<div class="line"><span class="lineno"> 8776</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varname2 != NULL</div>
<div class="line"><span class="lineno"> 8777</span>           &amp;&amp; nc_inq_varid(ncid, varname2, &amp;varid) == NC_NOERR)</div>
<div class="line"><span class="lineno"> 8778</span>    sprintf(varsel, <span class="stringliteral">&quot;%s&quot;</span>, varname2);</div>
<div class="line"><span class="lineno"> 8779</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varname3 != NULL</div>
<div class="line"><span class="lineno"> 8780</span>           &amp;&amp; nc_inq_varid(ncid, varname3, &amp;varid) == NC_NOERR)</div>
<div class="line"><span class="lineno"> 8781</span>    sprintf(varsel, <span class="stringliteral">&quot;%s&quot;</span>, varname3);</div>
<div class="line"><span class="lineno"> 8782</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varname4 != NULL</div>
<div class="line"><span class="lineno"> 8783</span>           &amp;&amp; nc_inq_varid(ncid, varname4, &amp;varid) == NC_NOERR)</div>
<div class="line"><span class="lineno"> 8784</span>    sprintf(varsel, <span class="stringliteral">&quot;%s&quot;</span>, varname4);</div>
<div class="line"><span class="lineno"> 8785</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varname5 != NULL</div>
<div class="line"><span class="lineno"> 8786</span>           &amp;&amp; nc_inq_varid(ncid, varname5, &amp;varid) == NC_NOERR)</div>
<div class="line"><span class="lineno"> 8787</span>    sprintf(varsel, <span class="stringliteral">&quot;%s&quot;</span>, varname5);</div>
<div class="line"><span class="lineno"> 8788</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varname6 != NULL</div>
<div class="line"><span class="lineno"> 8789</span>           &amp;&amp; nc_inq_varid(ncid, varname6, &amp;varid) == NC_NOERR)</div>
<div class="line"><span class="lineno"> 8790</span>    sprintf(varsel, <span class="stringliteral">&quot;%s&quot;</span>, varname6);</div>
<div class="line"><span class="lineno"> 8791</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8792</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 8793</span> </div>
<div class="line"><span class="lineno"> 8794</span>  <span class="comment">/* Read packed data... */</span></div>
<div class="line"><span class="lineno"> 8795</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a034e61c3566760c5ebe4e16f3f3c3021">met_nc_scale</a> &amp;&amp; !ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587663283cba9a4470dd7b753b5a1690">dd</a></div>
<div class="line"><span class="lineno"> 8796</span>      &amp;&amp; nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;add_offset&quot;</span>, &amp;offset) == NC_NOERR</div>
<div class="line"><span class="lineno"> 8797</span>      &amp;&amp; nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;scale_factor&quot;</span>,</div>
<div class="line"><span class="lineno"> 8798</span>                          &amp;scalfac) == NC_NOERR) {</div>
<div class="line"><span class="lineno"> 8799</span> </div>
<div class="line"><span class="lineno"> 8800</span>    <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 8801</span>    <span class="keywordtype">short</span> *help;</div>
<div class="line"><span class="lineno"> 8802</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">short</span>,</div>
<div class="line"><span class="lineno"> 8803</span>          <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> * <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>);</div>
<div class="line"><span class="lineno"> 8804</span> </div>
<div class="line"><span class="lineno"> 8805</span>    <span class="comment">/* Read fill value and missing value... */</span></div>
<div class="line"><span class="lineno"> 8806</span>    <span class="keywordtype">short</span> fillval, missval;</div>
<div class="line"><span class="lineno"> 8807</span>    <span class="keywordflow">if</span> (nc_get_att_short(ncid, varid, <span class="stringliteral">&quot;_FillValue&quot;</span>, &amp;fillval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 8808</span>      fillval = 0;</div>
<div class="line"><span class="lineno"> 8809</span>    <span class="keywordflow">if</span> (nc_get_att_short(ncid, varid, <span class="stringliteral">&quot;missing_value&quot;</span>, &amp;missval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 8810</span>      missval = 0;</div>
<div class="line"><span class="lineno"> 8811</span> </div>
<div class="line"><span class="lineno"> 8812</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 8813</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read 2-D variable: %s&quot;</span></div>
<div class="line"><span class="lineno"> 8814</span>        <span class="stringliteral">&quot; (FILL = %d, MISS = %d, SCALE = %g, OFFSET = %g)&quot;</span>,</div>
<div class="line"><span class="lineno"> 8815</span>        varsel, fillval, missval, scalfac, offset);</div>
<div class="line"><span class="lineno"> 8816</span> </div>
<div class="line"><span class="lineno"> 8817</span>    <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 8818</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_var_short(ncid, varid, help));</div>
<div class="line"><span class="lineno"> 8819</span> </div>
<div class="line"><span class="lineno"> 8820</span>    <span class="comment">/* Check meteo data layout... */</span></div>
<div class="line"><span class="lineno"> 8821</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6d866e961e374a254d7dc52ea52cb3db">met_convention</a> != 0)</div>
<div class="line"><span class="lineno"> 8822</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Meteo data layout not implemented for packed netCDF files!&quot;</span>);</div>
<div class="line"><span class="lineno"> 8823</span> </div>
<div class="line"><span class="lineno"> 8824</span>    <span class="comment">/* Copy and check data... */</span></div>
<div class="line"><span class="lineno"> 8825</span>    omp_set_dynamic(1);</div>
<div class="line"><span class="lineno"> 8826</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 8827</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8828</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno"> 8829</span>        <span class="keywordflow">if</span> (init)</div>
<div class="line"><span class="lineno"> 8830</span>          dest[ix][iy] = 0;</div>
<div class="line"><span class="lineno"> 8831</span>        <span class="keyword">const</span> <span class="keywordtype">short</span> aux = help[<a class="code hl_define" href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a>(iy, ix, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>)];</div>
<div class="line"><span class="lineno"> 8832</span>        <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 8833</span>            &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 8834</span>            &amp;&amp; fabsf(aux * scalfac + offset) &lt; 1e14f)</div>
<div class="line"><span class="lineno"> 8835</span>          dest[ix][iy] += scl * (aux * scalfac + offset);</div>
<div class="line"><span class="lineno"> 8836</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8837</span>          dest[ix][iy] = NAN;</div>
<div class="line"><span class="lineno"> 8838</span>      }</div>
<div class="line"><span class="lineno"> 8839</span>    omp_set_dynamic(0);</div>
<div class="line"><span class="lineno"> 8840</span> </div>
<div class="line"><span class="lineno"> 8841</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 8842</span>    free(help);</div>
<div class="line"><span class="lineno"> 8843</span>  }</div>
<div class="line"><span class="lineno"> 8844</span> </div>
<div class="line"><span class="lineno"> 8845</span>  <span class="comment">/* Unpacked data... */</span></div>
<div class="line"><span class="lineno"> 8846</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587663283cba9a4470dd7b753b5a1690">dd</a>) {</div>
<div class="line"><span class="lineno"> 8847</span> </div>
<div class="line"><span class="lineno"> 8848</span>    <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 8849</span>    <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno"> 8850</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 8851</span>          <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>);</div>
<div class="line"><span class="lineno"> 8852</span> </div>
<div class="line"><span class="lineno"> 8853</span>    <span class="comment">/* Read fill value and missing value... */</span></div>
<div class="line"><span class="lineno"> 8854</span>    <span class="keywordtype">float</span> fillval, missval;</div>
<div class="line"><span class="lineno"> 8855</span>    <span class="keywordflow">if</span> (nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;_FillValue&quot;</span>, &amp;fillval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 8856</span>      fillval = 0;</div>
<div class="line"><span class="lineno"> 8857</span>    <span class="keywordflow">if</span> (nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;missing_value&quot;</span>, &amp;missval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 8858</span>      missval = 0;</div>
<div class="line"><span class="lineno"> 8859</span> </div>
<div class="line"><span class="lineno"> 8860</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 8861</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read 2-D variable: %s (FILL = %g, MISS = %g)&quot;</span>,</div>
<div class="line"><span class="lineno"> 8862</span>        varsel, fillval, missval);</div>
<div class="line"><span class="lineno"> 8863</span> </div>
<div class="line"><span class="lineno"> 8864</span>    <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 8865</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_var_float(ncid, varid, help));</div>
<div class="line"><span class="lineno"> 8866</span> </div>
<div class="line"><span class="lineno"> 8867</span>    <span class="comment">/* Check meteo data layout... */</span></div>
<div class="line"><span class="lineno"> 8868</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6d866e961e374a254d7dc52ea52cb3db">met_convention</a> == 0) {</div>
<div class="line"><span class="lineno"> 8869</span> </div>
<div class="line"><span class="lineno"> 8870</span>      <span class="comment">/* Copy and check data (ordering: lat, lon)... */</span></div>
<div class="line"><span class="lineno"> 8871</span>      omp_set_dynamic(1);</div>
<div class="line"><span class="lineno"> 8872</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 8873</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 8874</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno"> 8875</span>          <span class="keywordflow">if</span> (init)</div>
<div class="line"><span class="lineno"> 8876</span>            dest[ix][iy] = 0;</div>
<div class="line"><span class="lineno"> 8877</span>          <span class="keyword">const</span> <span class="keywordtype">float</span> aux = help[<a class="code hl_define" href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a>(iy, ix, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>)];</div>
<div class="line"><span class="lineno"> 8878</span>          <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 8879</span>              &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 8880</span>              &amp;&amp; fabsf(aux) &lt; 1e14f)</div>
<div class="line"><span class="lineno"> 8881</span>            dest[ix][iy] += scl * aux;</div>
<div class="line"><span class="lineno"> 8882</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8883</span>            dest[ix][iy] = NAN;</div>
<div class="line"><span class="lineno"> 8884</span>        }</div>
<div class="line"><span class="lineno"> 8885</span>      omp_set_dynamic(0);</div>
<div class="line"><span class="lineno"> 8886</span> </div>
<div class="line"><span class="lineno"> 8887</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8888</span> </div>
<div class="line"><span class="lineno"> 8889</span>      <span class="comment">/* Copy and check data (ordering: lon, lat)... */</span></div>
<div class="line"><span class="lineno"> 8890</span>      omp_set_dynamic(1);</div>
<div class="line"><span class="lineno"> 8891</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 8892</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 8893</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++) {</div>
<div class="line"><span class="lineno"> 8894</span>          <span class="keywordflow">if</span> (init)</div>
<div class="line"><span class="lineno"> 8895</span>            dest[ix][iy] = 0;</div>
<div class="line"><span class="lineno"> 8896</span>          <span class="keyword">const</span> <span class="keywordtype">float</span> aux = help[<a class="code hl_define" href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a>(ix, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>)];</div>
<div class="line"><span class="lineno"> 8897</span>          <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 8898</span>              &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 8899</span>              &amp;&amp; fabsf(aux) &lt; 1e14f)</div>
<div class="line"><span class="lineno"> 8900</span>            dest[ix][iy] += scl * aux;</div>
<div class="line"><span class="lineno"> 8901</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8902</span>            dest[ix][iy] = NAN;</div>
<div class="line"><span class="lineno"> 8903</span>        }</div>
<div class="line"><span class="lineno"> 8904</span>      omp_set_dynamic(0);</div>
<div class="line"><span class="lineno"> 8905</span>    }</div>
<div class="line"><span class="lineno"> 8906</span> </div>
<div class="line"><span class="lineno"> 8907</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 8908</span>    free(help);</div>
<div class="line"><span class="lineno"> 8909</span> </div>
<div class="line"><span class="lineno"> 8910</span>  }</div>
<div class="line"><span class="lineno"> 8911</span>  <span class="comment">/* Domain decomposed data... */</span></div>
<div class="line"><span class="lineno"> 8912</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8913</span> </div>
<div class="line"><span class="lineno"> 8914</span>    <span class="comment">/* Read fill value and missing value... */</span></div>
<div class="line"><span class="lineno"> 8915</span>    <span class="keywordtype">float</span> fillval, missval;</div>
<div class="line"><span class="lineno"> 8916</span>    <span class="keywordflow">if</span> (nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;_FillValue&quot;</span>, &amp;fillval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 8917</span>      fillval = 0;</div>
<div class="line"><span class="lineno"> 8918</span>    <span class="keywordflow">if</span> (nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;missing_value&quot;</span>, &amp;missval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 8919</span>      missval = 0;</div>
<div class="line"><span class="lineno"> 8920</span> </div>
<div class="line"><span class="lineno"> 8921</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 8922</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read 2-D variable: %s (FILL = %g, MISS = %g)&quot;</span>,</div>
<div class="line"><span class="lineno"> 8923</span>        varsel, fillval, missval);</div>
<div class="line"><span class="lineno"> 8924</span> </div>
<div class="line"><span class="lineno"> 8925</span>    <span class="comment">/* Define hyperslab... */</span></div>
<div class="line"><span class="lineno"> 8926</span>    <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno"> 8927</span>    <span class="keywordtype">size_t</span> help_subdomain_start[3];</div>
<div class="line"><span class="lineno"> 8928</span>    <span class="keywordtype">size_t</span> help_subdomain_count[3];</div>
<div class="line"><span class="lineno"> 8929</span> </div>
<div class="line"><span class="lineno"> 8930</span>    help_subdomain_start[0] = 0;</div>
<div class="line"><span class="lineno"> 8931</span>    help_subdomain_start[1] = dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[2];</div>
<div class="line"><span class="lineno"> 8932</span>    help_subdomain_start[2] = dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>[3];</div>
<div class="line"><span class="lineno"> 8933</span> </div>
<div class="line"><span class="lineno"> 8934</span>    help_subdomain_count[0] = 1;</div>
<div class="line"><span class="lineno"> 8935</span>    help_subdomain_count[1] = dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2];   <span class="comment">//y</span></div>
<div class="line"><span class="lineno"> 8936</span>    help_subdomain_count[2] = dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3];   <span class="comment">//x</span></div>
<div class="line"><span class="lineno"> 8937</span> </div>
<div class="line"><span class="lineno"> 8938</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 8939</span>            (<span class="keywordtype">int</span>) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2] * (<span class="keywordtype">int</span>) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3]</div>
<div class="line"><span class="lineno"> 8940</span>      );</div>
<div class="line"><span class="lineno"> 8941</span> </div>
<div class="line"><span class="lineno"> 8942</span>    <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 8943</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_vara_float</div>
<div class="line"><span class="lineno"> 8944</span>       (ncid, varid, help_subdomain_start, help_subdomain_count, help));</div>
<div class="line"><span class="lineno"> 8945</span> </div>
<div class="line"><span class="lineno"> 8946</span>    <span class="comment">/* Read halos at boundaries... */</span></div>
<div class="line"><span class="lineno"> 8947</span>    <span class="keywordtype">size_t</span> help_halo_bnd_start[3];</div>
<div class="line"><span class="lineno"> 8948</span>    <span class="keywordtype">size_t</span> help_halo_bnd_count[3];</div>
<div class="line"><span class="lineno"> 8949</span> </div>
<div class="line"><span class="lineno"> 8950</span>    help_halo_bnd_start[0] = 0;</div>
<div class="line"><span class="lineno"> 8951</span>    help_halo_bnd_start[1] = dd-&gt;<a class="code hl_variable" href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">halo_bnd_start</a>[2];</div>
<div class="line"><span class="lineno"> 8952</span>    help_halo_bnd_start[2] = dd-&gt;<a class="code hl_variable" href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">halo_bnd_start</a>[3];</div>
<div class="line"><span class="lineno"> 8953</span> </div>
<div class="line"><span class="lineno"> 8954</span>    help_halo_bnd_count[0] = 1;</div>
<div class="line"><span class="lineno"> 8955</span>    help_halo_bnd_count[1] = dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[2];     <span class="comment">//y</span></div>
<div class="line"><span class="lineno"> 8956</span>    help_halo_bnd_count[2] = dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[3];     <span class="comment">//x</span></div>
<div class="line"><span class="lineno"> 8957</span> </div>
<div class="line"><span class="lineno"> 8958</span>    <span class="keywordtype">float</span> *help_halo;</div>
<div class="line"><span class="lineno"> 8959</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help_halo, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 8960</span>          help_halo_bnd_count[1] * help_halo_bnd_count[2]);</div>
<div class="line"><span class="lineno"> 8961</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_vara_float</div>
<div class="line"><span class="lineno"> 8962</span>       (ncid, varid, help_halo_bnd_start, help_halo_bnd_count, help_halo));</div>
<div class="line"><span class="lineno"> 8963</span> </div>
<div class="line"><span class="lineno"> 8964</span>    <span class="comment">/* Check meteo data layout... */</span></div>
<div class="line"><span class="lineno"> 8965</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6d866e961e374a254d7dc52ea52cb3db">met_convention</a> == 0) {</div>
<div class="line"><span class="lineno"> 8966</span>      <span class="comment">/* Copy and check data (ordering: lat, lon)... */</span></div>
<div class="line"><span class="lineno"> 8967</span><span class="preprocessor">#pragma omp parallel for default(shared) num_threads(12)</span></div>
<div class="line"><span class="lineno"> 8968</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; (int) help_subdomain_count[2]; ix++)</div>
<div class="line"><span class="lineno"> 8969</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; (int) help_subdomain_count[1]; iy++) {</div>
<div class="line"><span class="lineno"> 8970</span>          <span class="keywordflow">if</span> (init == 1)</div>
<div class="line"><span class="lineno"> 8971</span>            dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#ab16175b143cbeecaeb2c36ee5b0e6866">halo_offset_start</a>][iy] = 0;</div>
<div class="line"><span class="lineno"> 8972</span>          <span class="keyword">const</span> <span class="keywordtype">float</span> aux =</div>
<div class="line"><span class="lineno"> 8973</span>            help[<a class="code hl_define" href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a>(iy, ix, (<span class="keywordtype">int</span>) help_subdomain_count[2])];</div>
<div class="line"><span class="lineno"> 8974</span>          <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 8975</span>              &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 8976</span>              &amp;&amp; fabsf(aux) &lt; 1e14f) {</div>
<div class="line"><span class="lineno"> 8977</span>            dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#ab16175b143cbeecaeb2c36ee5b0e6866">halo_offset_start</a>][iy] += scl * aux;</div>
<div class="line"><span class="lineno"> 8978</span>          } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8979</span>            dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#ab16175b143cbeecaeb2c36ee5b0e6866">halo_offset_start</a>][iy] = NAN;</div>
<div class="line"><span class="lineno"> 8980</span>        }</div>
<div class="line"><span class="lineno"> 8981</span> </div>
<div class="line"><span class="lineno"> 8982</span>      <span class="comment">/* Copy and check data (ordering: lat, lon)... */</span></div>
<div class="line"><span class="lineno"> 8983</span><span class="preprocessor">#pragma omp parallel for default(shared) num_threads(12)</span></div>
<div class="line"><span class="lineno"> 8984</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; (int) help_halo_bnd_count[2]; ix++)</div>
<div class="line"><span class="lineno"> 8985</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; (int) help_halo_bnd_count[1]; iy++) {</div>
<div class="line"><span class="lineno"> 8986</span>          <span class="keywordflow">if</span> (init == 1)</div>
<div class="line"><span class="lineno"> 8987</span>            dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#a1ab27aa0213a1886a32747eec1a24819">halo_offset_end</a>][iy] = 0;</div>
<div class="line"><span class="lineno"> 8988</span>          <span class="keyword">const</span> <span class="keywordtype">float</span> aux =</div>
<div class="line"><span class="lineno"> 8989</span>            help_halo[<a class="code hl_define" href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a>(iy, ix, (<span class="keywordtype">int</span>) help_halo_bnd_count[2])];</div>
<div class="line"><span class="lineno"> 8990</span>          <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 8991</span>              &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 8992</span>              &amp;&amp; fabsf(aux) &lt; 1e14f)</div>
<div class="line"><span class="lineno"> 8993</span>            dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#a1ab27aa0213a1886a32747eec1a24819">halo_offset_end</a>][iy] += scl * aux;</div>
<div class="line"><span class="lineno"> 8994</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8995</span>            dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#a1ab27aa0213a1886a32747eec1a24819">halo_offset_end</a>][iy] = NAN;</div>
<div class="line"><span class="lineno"> 8996</span>          }</div>
<div class="line"><span class="lineno"> 8997</span>        }</div>
<div class="line"><span class="lineno"> 8998</span> </div>
<div class="line"><span class="lineno"> 8999</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9000</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Domain decomposition with data convection incompatible!&quot;</span>);</div>
<div class="line"><span class="lineno"> 9001</span>    }</div>
<div class="line"><span class="lineno"> 9002</span> </div>
<div class="line"><span class="lineno"> 9003</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 9004</span>    free(help);</div>
<div class="line"><span class="lineno"> 9005</span>    free(help_halo);</div>
<div class="line"><span class="lineno"> 9006</span>  }</div>
<div class="line"><span class="lineno"> 9007</span> </div>
<div class="line"><span class="lineno"> 9008</span>  <span class="comment">/* Return... */</span></div>
<div class="line"><span class="lineno"> 9009</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 9010</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ff6a4eae1eba129266c5485c77aa6a3" name="a1ff6a4eae1eba129266c5485c77aa6a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ff6a4eae1eba129266c5485c77aa6a3">&#9670;&nbsp;</a></span>read_met_nc_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_met_nc_3d </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdd__t.html">dd_t</a> *&#160;</td>
          <td class="paramname"><em>dd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dest</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>scl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads a 3-dimensional meteorological variable from a NetCDF file. </p>
<p >This function reads a 3-dimensional meteorological variable from a NetCDF file and stores it in a specified destination array. It supports both packed and unpacked data formats and handles missing values and scaling factors accordingly. The function also checks the meteorological data layout to ensure correct data copying.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ncid</td><td>The NetCDF file ID. </td></tr>
    <tr><td class="paramname">varname</td><td>The name of the variable to read. </td></tr>
    <tr><td class="paramname">varname2</td><td>An alternative name of the variable to read (in case varname is not found). </td></tr>
    <tr><td class="paramname">varname3</td><td>An alternative name of the variable to read (in case varname2 is not found). </td></tr>
    <tr><td class="paramname">varname4</td><td>An alternative name of the variable to read (in case varname3 is not found). </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a structure containing control parameters. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data. </td></tr>
    <tr><td class="paramname">dd</td><td>A pointer to an <code><a class="el" href="structdd__t.html" title="Domain decomposition data structure.">dd_t</a></code> structure containing MPI information, including rank and neighbours. </td></tr>
    <tr><td class="paramname">dest</td><td>The destination array to store the read data. </td></tr>
    <tr><td class="paramname">scl</td><td>A scaling factor to apply to the read data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 1 on success, 0 on failure.</dd></dl>
<p>The function performs the following steps:</p><ul>
<li>Checks if the specified variable exists in the NetCDF file.</li>
<li>Reads packed data if scaling factors are available, otherwise reads unpacked data.</li>
<li>Handles missing values and scaling factors appropriately.</li>
<li>Copies the data to the destination array, applying the scaling factor if provided.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l09014">9014</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 9024</span>                   {</div>
<div class="line"><span class="lineno"> 9025</span> </div>
<div class="line"><span class="lineno"> 9026</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;read_met_nc_3d&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 9027</span> </div>
<div class="line"><span class="lineno"> 9028</span>  <span class="keywordtype">char</span> varsel[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno"> 9029</span> </div>
<div class="line"><span class="lineno"> 9030</span>  <span class="keywordtype">float</span> offset, scalfac;</div>
<div class="line"><span class="lineno"> 9031</span> </div>
<div class="line"><span class="lineno"> 9032</span>  <span class="keywordtype">int</span> varid;</div>
<div class="line"><span class="lineno"> 9033</span> </div>
<div class="line"><span class="lineno"> 9034</span>  <span class="comment">/* Check if variable exists... */</span></div>
<div class="line"><span class="lineno"> 9035</span>  <span class="keywordflow">if</span> (nc_inq_varid(ncid, varname, &amp;varid) == NC_NOERR)</div>
<div class="line"><span class="lineno"> 9036</span>    sprintf(varsel, <span class="stringliteral">&quot;%s&quot;</span>, varname);</div>
<div class="line"><span class="lineno"> 9037</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varname2 != NULL</div>
<div class="line"><span class="lineno"> 9038</span>           &amp;&amp; nc_inq_varid(ncid, varname2, &amp;varid) == NC_NOERR)</div>
<div class="line"><span class="lineno"> 9039</span>    sprintf(varsel, <span class="stringliteral">&quot;%s&quot;</span>, varname2);</div>
<div class="line"><span class="lineno"> 9040</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varname3 != NULL</div>
<div class="line"><span class="lineno"> 9041</span>           &amp;&amp; nc_inq_varid(ncid, varname3, &amp;varid) == NC_NOERR)</div>
<div class="line"><span class="lineno"> 9042</span>    sprintf(varsel, <span class="stringliteral">&quot;%s&quot;</span>, varname3);</div>
<div class="line"><span class="lineno"> 9043</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (varname4 != NULL</div>
<div class="line"><span class="lineno"> 9044</span>           &amp;&amp; nc_inq_varid(ncid, varname4, &amp;varid) == NC_NOERR)</div>
<div class="line"><span class="lineno"> 9045</span>    sprintf(varsel, <span class="stringliteral">&quot;%s&quot;</span>, varname4);</div>
<div class="line"><span class="lineno"> 9046</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 9047</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 9048</span> </div>
<div class="line"><span class="lineno"> 9049</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a034e61c3566760c5ebe4e16f3f3c3021">met_nc_scale</a> &amp;&amp; !ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587663283cba9a4470dd7b753b5a1690">dd</a></div>
<div class="line"><span class="lineno"> 9050</span>      &amp;&amp; nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;add_offset&quot;</span>, &amp;offset) == NC_NOERR</div>
<div class="line"><span class="lineno"> 9051</span>      &amp;&amp; nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;scale_factor&quot;</span>,</div>
<div class="line"><span class="lineno"> 9052</span>                          &amp;scalfac) == NC_NOERR) {</div>
<div class="line"><span class="lineno"> 9053</span> </div>
<div class="line"><span class="lineno"> 9054</span>    <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 9055</span>    <span class="keywordtype">short</span> *help;</div>
<div class="line"><span class="lineno"> 9056</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">short</span>,</div>
<div class="line"><span class="lineno"> 9057</span>          <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> * <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>);</div>
<div class="line"><span class="lineno"> 9058</span> </div>
<div class="line"><span class="lineno"> 9059</span>    <span class="comment">/* Read fill value and missing value... */</span></div>
<div class="line"><span class="lineno"> 9060</span>    <span class="keywordtype">short</span> fillval, missval;</div>
<div class="line"><span class="lineno"> 9061</span>    <span class="keywordflow">if</span> (nc_get_att_short(ncid, varid, <span class="stringliteral">&quot;_FillValue&quot;</span>, &amp;fillval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 9062</span>      fillval = 0;</div>
<div class="line"><span class="lineno"> 9063</span>    <span class="keywordflow">if</span> (nc_get_att_short(ncid, varid, <span class="stringliteral">&quot;missing_value&quot;</span>, &amp;missval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 9064</span>      missval = 0;</div>
<div class="line"><span class="lineno"> 9065</span> </div>
<div class="line"><span class="lineno"> 9066</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 9067</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read 3-D variable: %s &quot;</span></div>
<div class="line"><span class="lineno"> 9068</span>        <span class="stringliteral">&quot;(FILL = %d, MISS = %d, SCALE = %g, OFFSET = %g)&quot;</span>,</div>
<div class="line"><span class="lineno"> 9069</span>        varsel, fillval, missval, scalfac, offset);</div>
<div class="line"><span class="lineno"> 9070</span> </div>
<div class="line"><span class="lineno"> 9071</span>    <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 9072</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_var_short(ncid, varid, help));</div>
<div class="line"><span class="lineno"> 9073</span> </div>
<div class="line"><span class="lineno"> 9074</span>    <span class="comment">/* Check meteo data layout... */</span></div>
<div class="line"><span class="lineno"> 9075</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6d866e961e374a254d7dc52ea52cb3db">met_convention</a> != 0)</div>
<div class="line"><span class="lineno"> 9076</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Meteo data layout not implemented for packed netCDF files!&quot;</span>);</div>
<div class="line"><span class="lineno"> 9077</span> </div>
<div class="line"><span class="lineno"> 9078</span>    <span class="comment">/* Copy and check data... */</span></div>
<div class="line"><span class="lineno"> 9079</span>    omp_set_dynamic(1);</div>
<div class="line"><span class="lineno"> 9080</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 9081</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 9082</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 9083</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 9084</span>          <span class="keyword">const</span> <span class="keywordtype">short</span> aux = help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ip, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, ix, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>)];</div>
<div class="line"><span class="lineno"> 9085</span>          <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 9086</span>              &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 9087</span>              &amp;&amp; fabsf(aux * scalfac + offset) &lt; 1e14f)</div>
<div class="line"><span class="lineno"> 9088</span>            dest[ix][iy][ip] = scl * (aux * scalfac + offset);</div>
<div class="line"><span class="lineno"> 9089</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 9090</span>            dest[ix][iy][ip] = NAN;</div>
<div class="line"><span class="lineno"> 9091</span>        }</div>
<div class="line"><span class="lineno"> 9092</span>    omp_set_dynamic(0);</div>
<div class="line"><span class="lineno"> 9093</span> </div>
<div class="line"><span class="lineno"> 9094</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 9095</span>    free(help);</div>
<div class="line"><span class="lineno"> 9096</span>  }</div>
<div class="line"><span class="lineno"> 9097</span> </div>
<div class="line"><span class="lineno"> 9098</span>  <span class="comment">/* Unpacked data... */</span></div>
<div class="line"><span class="lineno"> 9099</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a587663283cba9a4470dd7b753b5a1690">dd</a>) {</div>
<div class="line"><span class="lineno"> 9100</span> </div>
<div class="line"><span class="lineno"> 9101</span>    <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 9102</span>    <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno"> 9103</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 9104</span>          <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> * <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>);</div>
<div class="line"><span class="lineno"> 9105</span> </div>
<div class="line"><span class="lineno"> 9106</span>    <span class="comment">/* Read fill value and missing value... */</span></div>
<div class="line"><span class="lineno"> 9107</span>    <span class="keywordtype">float</span> fillval, missval;</div>
<div class="line"><span class="lineno"> 9108</span>    <span class="keywordflow">if</span> (nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;_FillValue&quot;</span>, &amp;fillval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 9109</span>      fillval = 0;</div>
<div class="line"><span class="lineno"> 9110</span>    <span class="keywordflow">if</span> (nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;missing_value&quot;</span>, &amp;missval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 9111</span>      missval = 0;</div>
<div class="line"><span class="lineno"> 9112</span> </div>
<div class="line"><span class="lineno"> 9113</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 9114</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read 3-D variable: %s (FILL = %g, MISS = %g)&quot;</span>,</div>
<div class="line"><span class="lineno"> 9115</span>        varsel, fillval, missval);</div>
<div class="line"><span class="lineno"> 9116</span> </div>
<div class="line"><span class="lineno"> 9117</span>    <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno"> 9118</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_var_float(ncid, varid, help));</div>
<div class="line"><span class="lineno"> 9119</span> </div>
<div class="line"><span class="lineno"> 9120</span>    <span class="comment">/* Check meteo data layout... */</span></div>
<div class="line"><span class="lineno"> 9121</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6d866e961e374a254d7dc52ea52cb3db">met_convention</a> == 0) {</div>
<div class="line"><span class="lineno"> 9122</span> </div>
<div class="line"><span class="lineno"> 9123</span>      <span class="comment">/* Copy and check data (ordering: lev, lat, lon)... */</span></div>
<div class="line"><span class="lineno"> 9124</span>      omp_set_dynamic(1);</div>
<div class="line"><span class="lineno"> 9125</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 9126</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno"> 9127</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 9128</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 9129</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> aux = help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ip, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, ix, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>)];</div>
<div class="line"><span class="lineno"> 9130</span>            <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 9131</span>                &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 9132</span>                &amp;&amp; fabsf(aux) &lt; 1e14f)</div>
<div class="line"><span class="lineno"> 9133</span>              dest[ix][iy][ip] = scl * aux;</div>
<div class="line"><span class="lineno"> 9134</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 9135</span>              dest[ix][iy][ip] = NAN;</div>
<div class="line"><span class="lineno"> 9136</span>          }</div>
<div class="line"><span class="lineno"> 9137</span>      omp_set_dynamic(0);</div>
<div class="line"><span class="lineno"> 9138</span> </div>
<div class="line"><span class="lineno"> 9139</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9140</span> </div>
<div class="line"><span class="lineno"> 9141</span>      <span class="comment">/* Copy and check data (ordering: lon, lat, lev)... */</span></div>
<div class="line"><span class="lineno"> 9142</span>      omp_set_dynamic(1);</div>
<div class="line"><span class="lineno"> 9143</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno"> 9144</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 9145</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno"> 9146</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++) {</div>
<div class="line"><span class="lineno"> 9147</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> aux = help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, ip, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>)];</div>
<div class="line"><span class="lineno"> 9148</span>            <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 9149</span>                &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 9150</span>                &amp;&amp; fabsf(aux) &lt; 1e14f)</div>
<div class="line"><span class="lineno"> 9151</span>              dest[ix][iy][ip] = scl * aux;</div>
<div class="line"><span class="lineno"> 9152</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 9153</span>              dest[ix][iy][ip] = NAN;</div>
<div class="line"><span class="lineno"> 9154</span>          }</div>
<div class="line"><span class="lineno"> 9155</span>      omp_set_dynamic(0);</div>
<div class="line"><span class="lineno"> 9156</span>    }</div>
<div class="line"><span class="lineno"> 9157</span> </div>
<div class="line"><span class="lineno"> 9158</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 9159</span>    free(help);</div>
<div class="line"><span class="lineno"> 9160</span> </div>
<div class="line"><span class="lineno"> 9161</span>  }</div>
<div class="line"><span class="lineno"> 9162</span>  <span class="comment">/* Domain decomposed data... */</span></div>
<div class="line"><span class="lineno"> 9163</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9164</span> </div>
<div class="line"><span class="lineno"> 9165</span>    <span class="comment">/* Read fill value and missing value... */</span></div>
<div class="line"><span class="lineno"> 9166</span>    <span class="keywordtype">float</span> fillval, missval;</div>
<div class="line"><span class="lineno"> 9167</span>    <span class="keywordflow">if</span> (nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;_FillValue&quot;</span>, &amp;fillval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 9168</span>      fillval = 0;</div>
<div class="line"><span class="lineno"> 9169</span>    <span class="keywordflow">if</span> (nc_get_att_float(ncid, varid, <span class="stringliteral">&quot;missing_value&quot;</span>, &amp;missval) != NC_NOERR)</div>
<div class="line"><span class="lineno"> 9170</span>      missval = 0;</div>
<div class="line"><span class="lineno"> 9171</span> </div>
<div class="line"><span class="lineno"> 9172</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno"> 9173</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Read 3-D variable: %s (FILL = %g, MISS = %g)&quot;</span>,</div>
<div class="line"><span class="lineno"> 9174</span>        varsel, fillval, missval);</div>
<div class="line"><span class="lineno"> 9175</span> </div>
<div class="line"><span class="lineno"> 9176</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;read_met_nc_3d_CP1&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 9177</span> </div>
<div class="line"><span class="lineno"> 9178</span>    <span class="comment">/* Define hyperslab... */</span></div>
<div class="line"><span class="lineno"> 9179</span> </div>
<div class="line"><span class="lineno"> 9180</span>    <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno"> 9181</span>    <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno"> 9182</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 9183</span>            (<span class="keywordtype">int</span>) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[0] * (<span class="keywordtype">int</span>) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[1]</div>
<div class="line"><span class="lineno"> 9184</span>          * (<span class="keywordtype">int</span>) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2] * (<span class="keywordtype">int</span>) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3]);</div>
<div class="line"><span class="lineno"> 9185</span> </div>
<div class="line"><span class="lineno"> 9186</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;read_met_nc_3d_CP2&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 9187</span> </div>
<div class="line"><span class="lineno"> 9188</span>    <span class="comment">/* Use default NetCDF parallel I/O behavior */</span></div>
<div class="line"><span class="lineno"> 9189</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_vara_float</div>
<div class="line"><span class="lineno"> 9190</span>       (ncid, varid, dd-&gt;<a class="code hl_variable" href="structdd__t.html#adab6ce7b4a33bd7ca538c518d09dbdbd">subdomain_start</a>, dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>, help));</div>
<div class="line"><span class="lineno"> 9191</span> </div>
<div class="line"><span class="lineno"> 9192</span>    <span class="comment">/* Read halos separately at boundaries... */</span></div>
<div class="line"><span class="lineno"> 9193</span>    <span class="keywordtype">float</span> *help_halo;</div>
<div class="line"><span class="lineno"> 9194</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help_halo, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno"> 9195</span>          dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[0] * dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[1] *</div>
<div class="line"><span class="lineno"> 9196</span>          dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[2] * dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[3]);</div>
<div class="line"><span class="lineno"> 9197</span> </div>
<div class="line"><span class="lineno"> 9198</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;read_met_nc_3d_CP3&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 9199</span> </div>
<div class="line"><span class="lineno"> 9200</span>    <span class="comment">/* Halo read also uses independent access */</span></div>
<div class="line"><span class="lineno"> 9201</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_get_vara_float(ncid,</div>
<div class="line"><span class="lineno"> 9202</span>                         varid,</div>
<div class="line"><span class="lineno"> 9203</span>                         dd-&gt;<a class="code hl_variable" href="structdd__t.html#a37bbf55e5d18a77ea32169d6c7ad0c37">halo_bnd_start</a>, dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>, help_halo));</div>
<div class="line"><span class="lineno"> 9204</span> </div>
<div class="line"><span class="lineno"> 9205</span>    <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;read_met_nc_3d_CP4&quot;</span>, <span class="stringliteral">&quot;INPUT&quot;</span>);</div>
<div class="line"><span class="lineno"> 9206</span> </div>
<div class="line"><span class="lineno"> 9207</span>    <span class="comment">/* Check meteo data layout... */</span></div>
<div class="line"><span class="lineno"> 9208</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6d866e961e374a254d7dc52ea52cb3db">met_convention</a> == 0) {</div>
<div class="line"><span class="lineno"> 9209</span>      <span class="comment">/* Copy and check data (ordering: lev, lat, lon)... */</span></div>
<div class="line"><span class="lineno"> 9210</span><span class="preprocessor">#pragma omp parallel for default(shared) num_threads(12)</span></div>
<div class="line"><span class="lineno"> 9211</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3]; ix++)</div>
<div class="line"><span class="lineno"> 9212</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2]; iy++)</div>
<div class="line"><span class="lineno"> 9213</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 9214</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> aux =</div>
<div class="line"><span class="lineno"> 9215</span>              help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ip, iy, (<span class="keywordtype">int</span>) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2], ix,</div>
<div class="line"><span class="lineno"> 9216</span>                            (<span class="keywordtype">int</span>) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3])];</div>
<div class="line"><span class="lineno"> 9217</span>            <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 9218</span>                &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 9219</span>                &amp;&amp; fabsf(aux) &lt; 1e14f)</div>
<div class="line"><span class="lineno"> 9220</span>              dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#ab16175b143cbeecaeb2c36ee5b0e6866">halo_offset_start</a>][iy][ip] = scl * aux;</div>
<div class="line"><span class="lineno"> 9221</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 9222</span>              dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#ab16175b143cbeecaeb2c36ee5b0e6866">halo_offset_start</a>][iy][ip] = NAN;</div>
<div class="line"><span class="lineno"> 9223</span>          }</div>
<div class="line"><span class="lineno"> 9224</span> </div>
<div class="line"><span class="lineno"> 9225</span><span class="preprocessor">#pragma omp parallel for default(shared) num_threads(12)</span></div>
<div class="line"><span class="lineno"> 9226</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[3]; ix++)</div>
<div class="line"><span class="lineno"> 9227</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[2]; iy++)</div>
<div class="line"><span class="lineno"> 9228</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno"> 9229</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> aux =</div>
<div class="line"><span class="lineno"> 9230</span>              help_halo[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ip, iy, (<span class="keywordtype">int</span>) dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[2], ix,</div>
<div class="line"><span class="lineno"> 9231</span>                                 (<span class="keywordtype">int</span>) dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[3])];</div>
<div class="line"><span class="lineno"> 9232</span>            <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 9233</span>                &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 9234</span>                &amp;&amp; fabsf(aux) &lt; 1e14f)</div>
<div class="line"><span class="lineno"> 9235</span>              dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#a1ab27aa0213a1886a32747eec1a24819">halo_offset_end</a>][iy][ip] = scl * aux;</div>
<div class="line"><span class="lineno"> 9236</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 9237</span>              dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#a1ab27aa0213a1886a32747eec1a24819">halo_offset_end</a>][iy][ip] = NAN;</div>
<div class="line"><span class="lineno"> 9238</span>          }</div>
<div class="line"><span class="lineno"> 9239</span> </div>
<div class="line"><span class="lineno"> 9240</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9241</span> </div>
<div class="line"><span class="lineno"> 9242</span>      <span class="comment">/* Copy and check data (ordering: lon, lat, lev)... */</span></div>
<div class="line"><span class="lineno"> 9243</span><span class="preprocessor">#pragma omp parallel for default(shared) num_threads(12)</span></div>
<div class="line"><span class="lineno"> 9244</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 9245</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[2]; iy++)</div>
<div class="line"><span class="lineno"> 9246</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#ad58b7aeca9bd6081bf8b4d3513b5b2d9">subdomain_count</a>[3]; ix++) {</div>
<div class="line"><span class="lineno"> 9247</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> aux = help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, ip, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>)];</div>
<div class="line"><span class="lineno"> 9248</span>            <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 9249</span>                &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 9250</span>                &amp;&amp; fabsf(aux) &lt; 1e14f)</div>
<div class="line"><span class="lineno"> 9251</span>              dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#a1ab27aa0213a1886a32747eec1a24819">halo_offset_end</a>][iy][ip] = scl * aux;</div>
<div class="line"><span class="lineno"> 9252</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 9253</span>              dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#a1ab27aa0213a1886a32747eec1a24819">halo_offset_end</a>][iy][ip] = NAN;</div>
<div class="line"><span class="lineno"> 9254</span>          }</div>
<div class="line"><span class="lineno"> 9255</span> </div>
<div class="line"><span class="lineno"> 9256</span><span class="preprocessor">#pragma omp parallel for default(shared) num_threads(12)</span></div>
<div class="line"><span class="lineno"> 9257</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno"> 9258</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[2]; iy++)</div>
<div class="line"><span class="lineno"> 9259</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; (int) dd-&gt;<a class="code hl_variable" href="structdd__t.html#a061319c81804cc16cb884a04e10dee5a">halo_bnd_count</a>[3]; ix++) {</div>
<div class="line"><span class="lineno"> 9260</span>            <span class="keyword">const</span> <span class="keywordtype">float</span> aux = help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, ip, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>)];</div>
<div class="line"><span class="lineno"> 9261</span>            <span class="keywordflow">if</span> ((fillval == 0 || aux != fillval)</div>
<div class="line"><span class="lineno"> 9262</span>                &amp;&amp; (missval == 0 || aux != missval)</div>
<div class="line"><span class="lineno"> 9263</span>                &amp;&amp; fabsf(aux) &lt; 1e14f)</div>
<div class="line"><span class="lineno"> 9264</span>              dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#ab16175b143cbeecaeb2c36ee5b0e6866">halo_offset_start</a>][iy][ip] = scl * aux;</div>
<div class="line"><span class="lineno"> 9265</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 9266</span>              dest[ix + dd-&gt;<a class="code hl_variable" href="structdd__t.html#ab16175b143cbeecaeb2c36ee5b0e6866">halo_offset_start</a>][iy][ip] = NAN;</div>
<div class="line"><span class="lineno"> 9267</span>          }</div>
<div class="line"><span class="lineno"> 9268</span>    }</div>
<div class="line"><span class="lineno"> 9269</span> </div>
<div class="line"><span class="lineno"> 9270</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno"> 9271</span>    free(help);</div>
<div class="line"><span class="lineno"> 9272</span>    free(help_halo);</div>
<div class="line"><span class="lineno"> 9273</span>  }</div>
<div class="line"><span class="lineno"> 9274</span> </div>
<div class="line"><span class="lineno"> 9275</span>  <span class="comment">/* Return... */</span></div>
<div class="line"><span class="lineno"> 9276</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 9277</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2723705c94110a3ddfc84f2f0c8ddc71" name="a2723705c94110a3ddfc84f2f0c8ddc71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2723705c94110a3ddfc84f2f0c8ddc71">&#9670;&nbsp;</a></span>read_met_pbl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_pbl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the planetary boundary layer (PBL) pressure based on meteorological data. </p>
<p >This function determines the PBL pressure for each grid point using one of four methods: 0. Read PBL pressure from meteo data file.</p><ol type="1">
<li>Read PBL heights from meteo data file and convert to pressure.</li>
<li>Determine PBL pressure based on bulk Richardson number criterion.</li>
<li>Determine PBL pressure Based on potential temperature difference. The calculated PBL height is constrained by user-defined minimum and maximum limits.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to the control structure (<code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code>), which contains parameters controlling the PBL calculation. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">met</td><td>Pointer to the meteorological data structure (<code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code>), which contains grid and atmospheric data. The <code>met-&gt;pbl</code> array is updated with the calculated PBL pressure.</td></tr>
  </table>
  </dd>
</dl>
<p>Method 0 (Precomputed PBL pressure from file):</p><ul>
<li>Read PBL pressure from meteo data file.</li>
</ul>
<p >Method 1 (Precomputed PBL height from file):</p><ul>
<li>Read PBL height from meteo data file.</li>
<li>Interpolates the PBL pressure using the geopotential heights from the meteo file.</li>
</ul>
<p >Method 2 (Richardson number criterion):</p><ul>
<li>Implements a method based on the bulk Richardson number (critical value: Ri = 0.25).</li>
<li>Iteratively evaluates vertical levels, calculating wind shear, and thermal gradients, until the Richardson number exceeds the critical threshold.</li>
<li>Interpolates between levels to find the precise height.</li>
</ul>
<p >Method 3 (Potential temperature difference):</p><ul>
<li>Computes the PBL height as the altitude where the potential temperature exceeds the surface value by 2 K.</li>
<li>Interpolates between levels to find the precise height.</li>
</ul>
<p >Final Adjustments:</p><ul>
<li>Ensures the PBL height respects user-defined minimum and maximum thresholds.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Method 2 is a standard method for estimating PBL depths, but the current implementation seems to underestimate PBL depths compared to ECMWF PBL data or Method 3. Therefore, Method 3, is selected by default. If PBL heights are available from the meteo data files, it is recommended to select Method 1.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l10113">10113</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">10115</span>              {</div>
<div class="line"><span class="lineno">10116</span> </div>
<div class="line"><span class="lineno">10117</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">10118</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_PBL&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno">10119</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Calculate planetary boundary layer...&quot;</span>);</div>
<div class="line"><span class="lineno">10120</span> </div>
<div class="line"><span class="lineno">10121</span>  <span class="comment">/* Convert PBL height from meteo file to pressure... */</span></div>
<div class="line"><span class="lineno">10122</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a220b71ff77f479684ae659f626b1c5d9">met_pbl</a> == 1) {</div>
<div class="line"><span class="lineno">10123</span> </div>
<div class="line"><span class="lineno">10124</span>    <span class="comment">/* Loop over grid points... */</span></div>
<div class="line"><span class="lineno">10125</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno">10126</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10127</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno">10128</span> </div>
<div class="line"><span class="lineno">10129</span>        <span class="comment">/* Get pressure at top of PBL... */</span></div>
<div class="line"><span class="lineno">10130</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> z = met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[ix][iy] + met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy];</div>
<div class="line"><span class="lineno">10131</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> ip = <a class="code hl_function" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861">locate_irr_float</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy], met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, z, 0);</div>
<div class="line"><span class="lineno">10132</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy] =</div>
<div class="line"><span class="lineno">10133</span>          (float) (<a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip], met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip],</div>
<div class="line"><span class="lineno">10134</span>                       met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip + 1], met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip + 1], z));</div>
<div class="line"><span class="lineno">10135</span>      }</div>
<div class="line"><span class="lineno">10136</span>  }</div>
<div class="line"><span class="lineno">10137</span> </div>
<div class="line"><span class="lineno">10138</span>  <span class="comment">/* Determine PBL based on Richardson number... */</span></div>
<div class="line"><span class="lineno">10139</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a220b71ff77f479684ae659f626b1c5d9">met_pbl</a> == 2) {</div>
<div class="line"><span class="lineno">10140</span> </div>
<div class="line"><span class="lineno">10141</span>    <span class="comment">/* Parameters used to estimate the height of the PBL</span></div>
<div class="line"><span class="lineno">10142</span><span class="comment">       (e.g., Vogelezang and Holtslag, 1996; Seidel et al., 2012)... */</span></div>
<div class="line"><span class="lineno">10143</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> rib_crit = 0.25, dz = 0.05, umin = 5.0;</div>
<div class="line"><span class="lineno">10144</span> </div>
<div class="line"><span class="lineno">10145</span>    <span class="comment">/* Loop over grid points... */</span></div>
<div class="line"><span class="lineno">10146</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno">10147</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10148</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno">10149</span> </div>
<div class="line"><span class="lineno">10150</span>        <span class="comment">/* Set bottom level of PBL... */</span></div>
<div class="line"><span class="lineno">10151</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> pbl_bot = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy] * exp(-dz / <a class="code hl_define" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a>);</div>
<div class="line"><span class="lineno">10152</span> </div>
<div class="line"><span class="lineno">10153</span>        <span class="comment">/* Find lowest level near the bottom... */</span></div>
<div class="line"><span class="lineno">10154</span>        <span class="keywordtype">int</span> ip;</div>
<div class="line"><span class="lineno">10155</span>        <span class="keywordflow">for</span> (ip = 1; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno">10156</span>          <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] &lt; pbl_bot)</div>
<div class="line"><span class="lineno">10157</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10158</span> </div>
<div class="line"><span class="lineno">10159</span>        <span class="comment">/* Get near surface data... */</span></div>
<div class="line"><span class="lineno">10160</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> h2os = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip - 1], met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip - 1],</div>
<div class="line"><span class="lineno">10161</span>                                met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip], met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip], pbl_bot);</div>
<div class="line"><span class="lineno">10162</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> tvs = <a class="code hl_define" href="mptrac_8h.html#a8cbdab681e71d411200fb104480f4862">THETAVIRT</a>(pbl_bot, met-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>[ix][iy], h2os);</div>
<div class="line"><span class="lineno">10163</span> </div>
<div class="line"><span class="lineno">10164</span>        <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno">10165</span>        <span class="keywordtype">double</span> rib_old = 0;</div>
<div class="line"><span class="lineno">10166</span> </div>
<div class="line"><span class="lineno">10167</span>        <span class="comment">/* Loop over levels... */</span></div>
<div class="line"><span class="lineno">10168</span>        <span class="keywordflow">for</span> (; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno">10169</span> </div>
<div class="line"><span class="lineno">10170</span>          <span class="comment">/* Get squared horizontal wind speed... */</span></div>
<div class="line"><span class="lineno">10171</span>          <span class="keywordtype">double</span> vh2 = <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>[ix][iy])</div>
<div class="line"><span class="lineno">10172</span>            + <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip] - met-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>[ix][iy]);</div>
<div class="line"><span class="lineno">10173</span>          vh2 = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(vh2, <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(umin));</div>
<div class="line"><span class="lineno">10174</span> </div>
<div class="line"><span class="lineno">10175</span>          <span class="comment">/* Calculate bulk Richardson number... */</span></div>
<div class="line"><span class="lineno">10176</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> rib =</div>
<div class="line"><span class="lineno">10177</span>            <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> * 1e3 * (met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>[ix][iy][ip] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[ix][iy]) / tvs</div>
<div class="line"><span class="lineno">10178</span>            * (<a class="code hl_define" href="mptrac_8h.html#a8cbdab681e71d411200fb104480f4862">THETAVIRT</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip], met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip],</div>
<div class="line"><span class="lineno">10179</span>                         met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip]) - tvs) / vh2;</div>
<div class="line"><span class="lineno">10180</span> </div>
<div class="line"><span class="lineno">10181</span>          <span class="comment">/* Check for critical value... */</span></div>
<div class="line"><span class="lineno">10182</span>          <span class="keywordflow">if</span> (rib &gt;= rib_crit) {</div>
<div class="line"><span class="lineno">10183</span>            met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy] = (float) (<a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(rib_old, met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip - 1],</div>
<div class="line"><span class="lineno">10184</span>                                            rib, met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip], rib_crit));</div>
<div class="line"><span class="lineno">10185</span>            <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy] &gt; pbl_bot)</div>
<div class="line"><span class="lineno">10186</span>              met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy] = (float) pbl_bot;</div>
<div class="line"><span class="lineno">10187</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10188</span>          }</div>
<div class="line"><span class="lineno">10189</span> </div>
<div class="line"><span class="lineno">10190</span>          <span class="comment">/* Save Richardson number... */</span></div>
<div class="line"><span class="lineno">10191</span>          rib_old = rib;</div>
<div class="line"><span class="lineno">10192</span>        }</div>
<div class="line"><span class="lineno">10193</span>      }</div>
<div class="line"><span class="lineno">10194</span>  }</div>
<div class="line"><span class="lineno">10195</span> </div>
<div class="line"><span class="lineno">10196</span>  <span class="comment">/* Determine PBL based on potential temperature... */</span></div>
<div class="line"><span class="lineno">10197</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a220b71ff77f479684ae659f626b1c5d9">met_pbl</a> == 3) {</div>
<div class="line"><span class="lineno">10198</span> </div>
<div class="line"><span class="lineno">10199</span>    <span class="comment">/* Parameters used to estimate the height of the PBL</span></div>
<div class="line"><span class="lineno">10200</span><span class="comment">       (following HYSPLIT model)... */</span></div>
<div class="line"><span class="lineno">10201</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> dtheta = 2.0, zmin = 0.1;</div>
<div class="line"><span class="lineno">10202</span> </div>
<div class="line"><span class="lineno">10203</span>    <span class="comment">/* Loop over grid points... */</span></div>
<div class="line"><span class="lineno">10204</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno">10205</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10206</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno">10207</span> </div>
<div class="line"><span class="lineno">10208</span>        <span class="comment">/* Potential temperature at the surface... */</span></div>
<div class="line"><span class="lineno">10209</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> theta0 = <a class="code hl_define" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy], met-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>[ix][iy]);</div>
<div class="line"><span class="lineno">10210</span> </div>
<div class="line"><span class="lineno">10211</span>        <span class="comment">/* Find topmost level where theta exceeds surface value by 2 K... */</span></div>
<div class="line"><span class="lineno">10212</span>        <span class="keywordtype">int</span> ip;</div>
<div class="line"><span class="lineno">10213</span>        <span class="keywordflow">for</span> (ip = met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 2; ip &gt; 0; ip--)</div>
<div class="line"><span class="lineno">10214</span>          <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] &gt;= 300.)</div>
<div class="line"><span class="lineno">10215</span>            <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] &gt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy]</div>
<div class="line"><span class="lineno">10216</span>                || <a class="code hl_define" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip], met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip]) &lt;= theta0 + dtheta)</div>
<div class="line"><span class="lineno">10217</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10218</span> </div>
<div class="line"><span class="lineno">10219</span>        <span class="comment">/* Interpolate... */</span></div>
<div class="line"><span class="lineno">10220</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy]</div>
<div class="line"><span class="lineno">10221</span>          = (float) (<a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(<a class="code hl_define" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip + 1], met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip + 1]),</div>
<div class="line"><span class="lineno">10222</span>                         met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip + 1],</div>
<div class="line"><span class="lineno">10223</span>                         <a class="code hl_define" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip], met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip]),</div>
<div class="line"><span class="lineno">10224</span>                         met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip], theta0 + dtheta));</div>
<div class="line"><span class="lineno">10225</span> </div>
<div class="line"><span class="lineno">10226</span>        <span class="comment">/* Check minimum value... */</span></div>
<div class="line"><span class="lineno">10227</span>        <span class="keywordtype">double</span> pbl_min = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy] * exp(-zmin / <a class="code hl_define" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a>);</div>
<div class="line"><span class="lineno">10228</span>        <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy] &gt; pbl_min || met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] &gt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy])</div>
<div class="line"><span class="lineno">10229</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy] = (float) pbl_min;</div>
<div class="line"><span class="lineno">10230</span>      }</div>
<div class="line"><span class="lineno">10231</span>  }</div>
<div class="line"><span class="lineno">10232</span> </div>
<div class="line"><span class="lineno">10233</span>  <span class="comment">/* Loop over grid points... */</span></div>
<div class="line"><span class="lineno">10234</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno">10235</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10236</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno">10237</span> </div>
<div class="line"><span class="lineno">10238</span>      <span class="comment">/* Check minimum value... */</span></div>
<div class="line"><span class="lineno">10239</span>      <span class="keywordtype">double</span> pbl_min = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy] * exp(-ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a183f7517467fab1c84b49db0cb236ad0">met_pbl_min</a> / <a class="code hl_define" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a>);</div>
<div class="line"><span class="lineno">10240</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy] = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy], (<span class="keywordtype">float</span>) pbl_min);</div>
<div class="line"><span class="lineno">10241</span> </div>
<div class="line"><span class="lineno">10242</span>      <span class="comment">/* Check maximum value... */</span></div>
<div class="line"><span class="lineno">10243</span>      <span class="keywordtype">double</span> pbl_max = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy] * exp(-ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6a0360667c5b3cbab3da2a9fb4841970">met_pbl_max</a> / <a class="code hl_define" href="mptrac_8h.html#a2091e935ef46727f066804a98a0d039f">H0</a>);</div>
<div class="line"><span class="lineno">10244</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy] = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy], (<span class="keywordtype">float</span>) pbl_max);</div>
<div class="line"><span class="lineno">10245</span>    }</div>
<div class="line"><span class="lineno">10246</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a2723705c94110a3ddfc84f2f0c8ddc71_cgraph.png" border="0" usemap="#amptrac_8h_a2723705c94110a3ddfc84f2f0c8ddc71_cgraph" alt=""/></div>
<map name="amptrac_8h_a2723705c94110a3ddfc84f2f0c8ddc71_cgraph" id="amptrac_8h_a2723705c94110a3ddfc84f2f0c8ddc71_cgraph">
<area shape="rect" title="Computes the planetary boundary layer (PBL) pressure based on meteorological data." alt="" coords="5,5,105,32"/>
<area shape="rect" href="mptrac_8c.html#a8b9ae6cda41f85d46c6333d039ee0861" title="Locate the index of the interval containing a given value in an irregularly spaced array." alt="" coords="153,5,260,32"/>
</map>
</div>

</div>
</div>
<a id="a38f91765df8eb0a66fb3a6408dca0600" name="a38f91765df8eb0a66fb3a6408dca0600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38f91765df8eb0a66fb3a6408dca0600">&#9670;&nbsp;</a></span>read_met_periodic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_periodic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies periodic boundary conditions to meteorological data along longitudinal axis. </p>
<p >This function applies periodic boundary conditions to meteorological data along the longitudinal axis. It checks if the difference between the last and first longitudes and the difference between the second and first longitudes are approximately equal to 360 degrees, indicating periodicity. If the condition is met, the function increases the longitude counter, sets the longitude value for the new grid point, and copies meteorological data from the first grid point to the last grid point to ensure periodicity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets timer for performance monitoring.</li>
<li>Checks if the difference between the last and first longitudes and the difference between the second and first longitudes are approximately equal to 360 degrees, indicating periodicity.</li>
<li>If periodicity is confirmed:<ul>
<li>Increases the longitude counter.</li>
<li>Sets the longitude value for the new grid point by adding the difference between the second and first longitudes to the longitude of the penultimate grid point.</li>
<li>Copies meteorological data from the first grid point to the last grid point to ensure periodicity:<ul>
<li>Surface variables (e.g., pressure, temperature, wind speed, land-sea mask, sea surface temperature) are copied.</li>
<li>Meteorological variables at each pressure level are copied.</li>
<li>Meteorological variables at each hybrid pressure level are copied.</li>
</ul>
</li>
</ul>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function is useful for generating continuous meteorological fields over a periodic domain, which is common in atmospheric modeling, especially for global simulations.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l10250">10250</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">10251</span>              {</div>
<div class="line"><span class="lineno">10252</span> </div>
<div class="line"><span class="lineno">10253</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">10254</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_PERIODIC&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno">10255</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Apply periodic boundary conditions...&quot;</span>);</div>
<div class="line"><span class="lineno">10256</span> </div>
<div class="line"><span class="lineno">10257</span>  <span class="comment">/* Check longitudes... */</span></div>
<div class="line"><span class="lineno">10258</span>  <span class="keywordflow">if</span> (!(fabs(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[0]</div>
<div class="line"><span class="lineno">10259</span>             + met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[0] - 360) &lt; 0.01))</div>
<div class="line"><span class="lineno">10260</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">10261</span> </div>
<div class="line"><span class="lineno">10262</span>  <span class="comment">/* Increase longitude counter... */</span></div>
<div class="line"><span class="lineno">10263</span>  <span class="keywordflow">if</span> ((++met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>) &gt;= <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>)</div>
<div class="line"><span class="lineno">10264</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create periodic boundary conditions!&quot;</span>);</div>
<div class="line"><span class="lineno">10265</span> </div>
<div class="line"><span class="lineno">10266</span>  <span class="comment">/* Set longitude... */</span></div>
<div class="line"><span class="lineno">10267</span>  met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 2] + met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[0];</div>
<div class="line"><span class="lineno">10268</span> </div>
<div class="line"><span class="lineno">10269</span>  <span class="comment">/* Loop over latitudes and pressure levels... */</span></div>
<div class="line"><span class="lineno">10270</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">10271</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno">10272</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[0][iy];</div>
<div class="line"><span class="lineno">10273</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[0][iy];</div>
<div class="line"><span class="lineno">10274</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>[0][iy];</div>
<div class="line"><span class="lineno">10275</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>[0][iy];</div>
<div class="line"><span class="lineno">10276</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>[0][iy];</div>
<div class="line"><span class="lineno">10277</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>[0][iy];</div>
<div class="line"><span class="lineno">10278</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>[0][iy];</div>
<div class="line"><span class="lineno">10279</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>[0][iy];</div>
<div class="line"><span class="lineno">10280</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>[0][iy];</div>
<div class="line"><span class="lineno">10281</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>[0][iy];</div>
<div class="line"><span class="lineno">10282</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[0][iy];</div>
<div class="line"><span class="lineno">10283</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>[0][iy];</div>
<div class="line"><span class="lineno">10284</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[0][iy];</div>
<div class="line"><span class="lineno">10285</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno">10286</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10287</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10288</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10289</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10290</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10291</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10292</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10293</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10294</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10295</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10296</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10297</span>    }</div>
<div class="line"><span class="lineno">10298</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#abe8b336b71924b14d2badd0d6c0f7c27">npl</a>; ip++) {</div>
<div class="line"><span class="lineno">10299</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a760447bb9eca0826b3705f30a9b8f165">ul</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a760447bb9eca0826b3705f30a9b8f165">ul</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10300</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a4b4aaeb8f39dea0fb511744f84535303">vl</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a4b4aaeb8f39dea0fb511744f84535303">vl</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10301</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a4618b608901900608688f4f649dfbfc4">wl</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a4618b608901900608688f4f649dfbfc4">wl</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10302</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#af1a12a97613433a41a2714a2634a83de">pl</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10303</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#afdf65f900ff556c3d4faef4443e3f40f">zetal</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10304</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a1153b31e69a6542d2ee83d60c38f7bb1">zeta_dotl</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1][iy][ip] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a1153b31e69a6542d2ee83d60c38f7bb1">zeta_dotl</a>[0][iy][ip];</div>
<div class="line"><span class="lineno">10305</span>    }</div>
<div class="line"><span class="lineno">10306</span>  }</div>
<div class="line"><span class="lineno">10307</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adea1a286e6ec2a763b560997203fd5b7" name="adea1a286e6ec2a763b560997203fd5b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adea1a286e6ec2a763b560997203fd5b7">&#9670;&nbsp;</a></span>read_met_polar_winds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_polar_winds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a fix for polar winds in meteorological data. </p>
<p >This function applies a fix for polar winds in meteorological data, particularly focusing on the u and v wind components. It checks if the latitudes at the top and bottom of the grid are close to the poles. If so, it transforms the winds at 89-degree latitude into Cartesian coordinates, takes their mean, and replaces the winds at 90-degree latitude with this mean, effectively fixing the unrealistic behavior of winds at the poles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets a timer for performance monitoring.</li>
<li>Checks if the latitudes at the top and bottom of the grid are close to the poles (within 0.001 degree latitude of the poles).</li>
<li>For each hemisphere (north and south):<ul>
<li>Sets latitude indices for 89 degrees and 90 degrees.</li>
<li>Determines the sign of longitude adjustments based on the hemisphere.</li>
<li>Constructs lookup tables for cosine and sine of longitudes.</li>
<li>Loops over pressure levels and performs the following operations:<ul>
<li>Transforms u and v wind components at 89 degrees latitude into Cartesian coordinates and calculates their mean.</li>
<li>Replaces u and v wind components at 90 degrees latitude with the calculated mean, effectively fixing the polar winds.</li>
</ul>
</li>
</ul>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function is useful for correcting unrealistic behavior of winds near the poles in meteorological data, which can affect various atmospheric simulations. </dd>
<dd>
Based on a Python code provided by Jens-Uwe Groo.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l10311">10311</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">10312</span>              {</div>
<div class="line"><span class="lineno">10313</span> </div>
<div class="line"><span class="lineno">10314</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">10315</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_POLAR_WINDS&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno">10316</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Apply fix for polar winds...&quot;</span>);</div>
<div class="line"><span class="lineno">10317</span> </div>
<div class="line"><span class="lineno">10318</span>  <span class="comment">/* Check latitudes... */</span></div>
<div class="line"><span class="lineno">10319</span>  <span class="keywordflow">if</span> (fabs(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[0]) &lt; 89.999 || fabs(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 1]) &lt; 89.999)</div>
<div class="line"><span class="lineno">10320</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">10321</span> </div>
<div class="line"><span class="lineno">10322</span>  <span class="comment">/* Loop over hemispheres... */</span></div>
<div class="line"><span class="lineno">10323</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ihem = 0; ihem &lt; 2; ihem++) {</div>
<div class="line"><span class="lineno">10324</span> </div>
<div class="line"><span class="lineno">10325</span>    <span class="comment">/* Set latitude indices... */</span></div>
<div class="line"><span class="lineno">10326</span>    <span class="keywordtype">int</span> i89 = 1, i90 = 0, sign = 1;</div>
<div class="line"><span class="lineno">10327</span>    <span class="keywordflow">if</span> (ihem == 1) {</div>
<div class="line"><span class="lineno">10328</span>      i89 = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 2;</div>
<div class="line"><span class="lineno">10329</span>      i90 = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 1;</div>
<div class="line"><span class="lineno">10330</span>    }</div>
<div class="line"><span class="lineno">10331</span>    <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[i90] &lt; 0)</div>
<div class="line"><span class="lineno">10332</span>      sign = -1;</div>
<div class="line"><span class="lineno">10333</span> </div>
<div class="line"><span class="lineno">10334</span>    <span class="comment">/* Look-up table of cosinus and sinus... */</span></div>
<div class="line"><span class="lineno">10335</span>    <span class="keywordtype">double</span> clon[<a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>], slon[<a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a>];</div>
<div class="line"><span class="lineno">10336</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">10337</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++) {</div>
<div class="line"><span class="lineno">10338</span>      clon[ix] = cos(sign * <a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix]));</div>
<div class="line"><span class="lineno">10339</span>      slon[ix] = sin(sign * <a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix]));</div>
<div class="line"><span class="lineno">10340</span>    }</div>
<div class="line"><span class="lineno">10341</span> </div>
<div class="line"><span class="lineno">10342</span>    <span class="comment">/* Loop over levels... */</span></div>
<div class="line"><span class="lineno">10343</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">10344</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno">10345</span> </div>
<div class="line"><span class="lineno">10346</span>      <span class="comment">/* Transform 89 degree u and v winds into Cartesian coordinates and take the mean... */</span></div>
<div class="line"><span class="lineno">10347</span>      <span class="keywordtype">double</span> vel89x = 0, vel89y = 0;</div>
<div class="line"><span class="lineno">10348</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++) {</div>
<div class="line"><span class="lineno">10349</span>        vel89x +=</div>
<div class="line"><span class="lineno">10350</span>          (met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][i89][ip] * clon[ix] -</div>
<div class="line"><span class="lineno">10351</span>           met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][i89][ip] * slon[ix]) / met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>;</div>
<div class="line"><span class="lineno">10352</span>        vel89y +=</div>
<div class="line"><span class="lineno">10353</span>          (met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][i89][ip] * slon[ix] +</div>
<div class="line"><span class="lineno">10354</span>           met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][i89][ip] * clon[ix]) / met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>;</div>
<div class="line"><span class="lineno">10355</span>      }</div>
<div class="line"><span class="lineno">10356</span> </div>
<div class="line"><span class="lineno">10357</span>      <span class="comment">/* Replace 90 degree winds by 89 degree mean... */</span></div>
<div class="line"><span class="lineno">10358</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++) {</div>
<div class="line"><span class="lineno">10359</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][i90][ip]</div>
<div class="line"><span class="lineno">10360</span>          = (float) (vel89x * clon[ix] + vel89y * slon[ix]);</div>
<div class="line"><span class="lineno">10361</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][i90][ip]</div>
<div class="line"><span class="lineno">10362</span>          = (float) (-vel89x * slon[ix] + vel89y * clon[ix]);</div>
<div class="line"><span class="lineno">10363</span>      }</div>
<div class="line"><span class="lineno">10364</span>    }</div>
<div class="line"><span class="lineno">10365</span>  }</div>
<div class="line"><span class="lineno">10366</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2c90884cb02bf90f095ff36f41e020a" name="ac2c90884cb02bf90f095ff36f41e020a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2c90884cb02bf90f095ff36f41e020a">&#9670;&nbsp;</a></span>read_met_pv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_pv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates potential vorticity (PV) from meteorological data. </p>
<p >This function calculates the potential vorticity (PV) from the provided meteorological data. It employs finite difference methods to estimate gradients of temperature, wind components, and pressure in longitude, latitude, and pressure dimensions. These gradients are then used to compute PV at each grid point. Additionally, a fix for polar regions is applied to ensure smoothness of PV values in these regions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets a timer for performance monitoring.</li>
<li>Computes powers for pressure calculation.</li>
<li>Loops over grid points in longitude:<ul>
<li>Sets latitude indices.</li>
<li>Loops over grid points in latitude:<ul>
<li>Sets indices and auxiliary variables.</li>
<li>Loops over pressure levels:<ul>
<li>Computes gradients in longitude, latitude, and pressure.</li>
<li>Calculates PV using computed gradients.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Applies a fix for polar regions to ensure smoothness of PV values.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Potential vorticity is a fundamental quantity in atmospheric dynamics, representing the potential of a fluid parcel to rotate due to changes in pressure, temperature, and wind fields. </dd>
<dd>
Based on a Python code by Mathew Barlow (<a href="https://github.com/mathewbarlow/potential-vorticity">https://github.com/mathewbarlow/potential-vorticity</a>).</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l10370">10370</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">10371</span>              {</div>
<div class="line"><span class="lineno">10372</span> </div>
<div class="line"><span class="lineno">10373</span>  <span class="keywordtype">double</span> pows[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>];</div>
<div class="line"><span class="lineno">10374</span> </div>
<div class="line"><span class="lineno">10375</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">10376</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_PV&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno">10377</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Calculate potential vorticity...&quot;</span>);</div>
<div class="line"><span class="lineno">10378</span> </div>
<div class="line"><span class="lineno">10379</span>  <span class="comment">/* Set powers... */</span></div>
<div class="line"><span class="lineno">10380</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">10381</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno">10382</span>    pows[ip] = pow(1000. / met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip], 0.286);</div>
<div class="line"><span class="lineno">10383</span> </div>
<div class="line"><span class="lineno">10384</span>  <span class="comment">/* Loop over grid points... */</span></div>
<div class="line"><span class="lineno">10385</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">10386</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++) {</div>
<div class="line"><span class="lineno">10387</span> </div>
<div class="line"><span class="lineno">10388</span>    <span class="comment">/* Set indices... */</span></div>
<div class="line"><span class="lineno">10389</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> ix0 = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(ix - 1, 0);</div>
<div class="line"><span class="lineno">10390</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> ix1 = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(ix + 1, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> - 1);</div>
<div class="line"><span class="lineno">10391</span> </div>
<div class="line"><span class="lineno">10392</span>    <span class="comment">/* Loop over grid points... */</span></div>
<div class="line"><span class="lineno">10393</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno">10394</span> </div>
<div class="line"><span class="lineno">10395</span>      <span class="comment">/* Set indices... */</span></div>
<div class="line"><span class="lineno">10396</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> iy0 = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(iy - 1, 0);</div>
<div class="line"><span class="lineno">10397</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> iy1 = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(iy + 1, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 1);</div>
<div class="line"><span class="lineno">10398</span> </div>
<div class="line"><span class="lineno">10399</span>      <span class="comment">/* Set auxiliary variables... */</span></div>
<div class="line"><span class="lineno">10400</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> latr = 0.5 * (met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy1] + met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy0]);</div>
<div class="line"><span class="lineno">10401</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> dx = 1000. * <a class="code hl_define" href="mptrac_8h.html#af32eb4cf0330afcdd3e0f3d195737a3c">DEG2DX</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix0], latr);</div>
<div class="line"><span class="lineno">10402</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> dy = 1000. * <a class="code hl_define" href="mptrac_8h.html#a6b3bf18cdd34775ace994db9a97474b1">DEG2DY</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy0]);</div>
<div class="line"><span class="lineno">10403</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> c0 = cos(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy0]));</div>
<div class="line"><span class="lineno">10404</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> c1 = cos(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy1]));</div>
<div class="line"><span class="lineno">10405</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> cr = cos(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(latr));</div>
<div class="line"><span class="lineno">10406</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> vort = 2 * 7.2921e-5 * sin(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(latr));</div>
<div class="line"><span class="lineno">10407</span> </div>
<div class="line"><span class="lineno">10408</span>      <span class="comment">/* Loop over grid points... */</span></div>
<div class="line"><span class="lineno">10409</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno">10410</span> </div>
<div class="line"><span class="lineno">10411</span>        <span class="comment">/* Get gradients in longitude... */</span></div>
<div class="line"><span class="lineno">10412</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> dtdx</div>
<div class="line"><span class="lineno">10413</span>          = (met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix1][iy][ip] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix0][iy][ip]) * pows[ip] / dx;</div>
<div class="line"><span class="lineno">10414</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> dvdx = (met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix1][iy][ip] - met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix0][iy][ip]) / dx;</div>
<div class="line"><span class="lineno">10415</span> </div>
<div class="line"><span class="lineno">10416</span>        <span class="comment">/* Get gradients in latitude... */</span></div>
<div class="line"><span class="lineno">10417</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> dtdy</div>
<div class="line"><span class="lineno">10418</span>          = (met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy1][ip] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy0][ip]) * pows[ip] / dy;</div>
<div class="line"><span class="lineno">10419</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> dudy</div>
<div class="line"><span class="lineno">10420</span>          = (met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy1][ip] * c1 - met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy0][ip] * c0) / dy;</div>
<div class="line"><span class="lineno">10421</span> </div>
<div class="line"><span class="lineno">10422</span>        <span class="comment">/* Set indices... */</span></div>
<div class="line"><span class="lineno">10423</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> ip0 = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(ip - 1, 0);</div>
<div class="line"><span class="lineno">10424</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> ip1 = <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(ip + 1, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1);</div>
<div class="line"><span class="lineno">10425</span> </div>
<div class="line"><span class="lineno">10426</span>        <span class="comment">/* Get gradients in pressure... */</span></div>
<div class="line"><span class="lineno">10427</span>        <span class="keywordtype">double</span> dtdp, dudp, dvdp;</div>
<div class="line"><span class="lineno">10428</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> dp0 = 100. * (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip] - met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip0]);</div>
<div class="line"><span class="lineno">10429</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> dp1 = 100. * (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip]);</div>
<div class="line"><span class="lineno">10430</span>        <span class="keywordflow">if</span> (ip != ip0 &amp;&amp; ip != ip1) {</div>
<div class="line"><span class="lineno">10431</span>          <span class="keywordtype">double</span> denom = dp0 * dp1 * (dp0 + dp1);</div>
<div class="line"><span class="lineno">10432</span>          dtdp = (dp0 * dp0 * met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip1] * pows[ip1]</div>
<div class="line"><span class="lineno">10433</span>                  - dp1 * dp1 * met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip0] * pows[ip0]</div>
<div class="line"><span class="lineno">10434</span>                  + (dp1 * dp1 - dp0 * dp0) * met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip] * pows[ip])</div>
<div class="line"><span class="lineno">10435</span>            / denom;</div>
<div class="line"><span class="lineno">10436</span>          dudp = (dp0 * dp0 * met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip1]</div>
<div class="line"><span class="lineno">10437</span>                  - dp1 * dp1 * met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip0]</div>
<div class="line"><span class="lineno">10438</span>                  + (dp1 * dp1 - dp0 * dp0) * met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip])</div>
<div class="line"><span class="lineno">10439</span>            / denom;</div>
<div class="line"><span class="lineno">10440</span>          dvdp = (dp0 * dp0 * met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip1]</div>
<div class="line"><span class="lineno">10441</span>                  - dp1 * dp1 * met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip0]</div>
<div class="line"><span class="lineno">10442</span>                  + (dp1 * dp1 - dp0 * dp0) * met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip])</div>
<div class="line"><span class="lineno">10443</span>            / denom;</div>
<div class="line"><span class="lineno">10444</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10445</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> denom = dp0 + dp1;</div>
<div class="line"><span class="lineno">10446</span>          dtdp =</div>
<div class="line"><span class="lineno">10447</span>            (met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip1] * pows[ip1] -</div>
<div class="line"><span class="lineno">10448</span>             met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip0] * pows[ip0]) / denom;</div>
<div class="line"><span class="lineno">10449</span>          dudp = (met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip0]) / denom;</div>
<div class="line"><span class="lineno">10450</span>          dvdp = (met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip0]) / denom;</div>
<div class="line"><span class="lineno">10451</span>        }</div>
<div class="line"><span class="lineno">10452</span> </div>
<div class="line"><span class="lineno">10453</span>        <span class="comment">/* Calculate PV... */</span></div>
<div class="line"><span class="lineno">10454</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#ac8e46cfdfc9fc8cfef4e2b801834a61c">pv</a>[ix][iy][ip] = (float)</div>
<div class="line"><span class="lineno">10455</span>          (1e6 * <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> *</div>
<div class="line"><span class="lineno">10456</span>           (-dtdp * (dvdx - dudy / cr + vort) + dvdp * dtdx - dudp * dtdy));</div>
<div class="line"><span class="lineno">10457</span>      }</div>
<div class="line"><span class="lineno">10458</span>    }</div>
<div class="line"><span class="lineno">10459</span>  }</div>
<div class="line"><span class="lineno">10460</span> </div>
<div class="line"><span class="lineno">10461</span>  <span class="comment">/* Fix for polar regions... */</span></div>
<div class="line"><span class="lineno">10462</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">10463</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10464</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++) {</div>
<div class="line"><span class="lineno">10465</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#ac8e46cfdfc9fc8cfef4e2b801834a61c">pv</a>[ix][0][ip]</div>
<div class="line"><span class="lineno">10466</span>        = met-&gt;<a class="code hl_variable" href="structmet__t.html#ac8e46cfdfc9fc8cfef4e2b801834a61c">pv</a>[ix][1][ip]</div>
<div class="line"><span class="lineno">10467</span>        = met-&gt;<a class="code hl_variable" href="structmet__t.html#ac8e46cfdfc9fc8cfef4e2b801834a61c">pv</a>[ix][2][ip];</div>
<div class="line"><span class="lineno">10468</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#ac8e46cfdfc9fc8cfef4e2b801834a61c">pv</a>[ix][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 1][ip]</div>
<div class="line"><span class="lineno">10469</span>        = met-&gt;<a class="code hl_variable" href="structmet__t.html#ac8e46cfdfc9fc8cfef4e2b801834a61c">pv</a>[ix][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 2][ip]</div>
<div class="line"><span class="lineno">10470</span>        = met-&gt;<a class="code hl_variable" href="structmet__t.html#ac8e46cfdfc9fc8cfef4e2b801834a61c">pv</a>[ix][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 3][ip];</div>
<div class="line"><span class="lineno">10471</span>    }</div>
<div class="line"><span class="lineno">10472</span>}</div>
<div class="ttc" id="amptrac_8h_html_a6b3bf18cdd34775ace994db9a97474b1"><div class="ttname"><a href="mptrac_8h.html#a6b3bf18cdd34775ace994db9a97474b1">DEG2DY</a></div><div class="ttdeci">#define DEG2DY(dlat)</div><div class="ttdoc">Convert a latitude difference to a distance in the y-direction (north-south).</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00550">mptrac.h:550</a></div></div>
<div class="ttc" id="amptrac_8h_html_af32eb4cf0330afcdd3e0f3d195737a3c"><div class="ttname"><a href="mptrac_8h.html#af32eb4cf0330afcdd3e0f3d195737a3c">DEG2DX</a></div><div class="ttdeci">#define DEG2DX(dlon, lat)</div><div class="ttdoc">Convert a longitude difference to a distance in the x-direction (east-west) at a specific latitude.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00529">mptrac.h:529</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ee63e8a6c82ac0dc569255455a50da2" name="a9ee63e8a6c82ac0dc569255455a50da2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ee63e8a6c82ac0dc569255455a50da2">&#9670;&nbsp;</a></span>read_met_ozone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_ozone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the total column ozone from meteorological ozone data. </p>
<p >This function calculates the total column ozone from the provided meteorological ozone data. It integrates ozone concentrations over altitude to obtain the column ozone density. The result is then converted to Dobson units, which represent the thickness of the ozone layer if compressed into one layer at standard temperature and pressure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological ozone data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets a timer for performance monitoring.</li>
<li>Loops over columns in longitude and latitude:<ul>
<li>Integrates ozone concentrations over altitude.</li>
<li>Converts the integrated ozone density to Dobson units.</li>
</ul>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Total column ozone is a critical metric for understanding ozone distribution in the atmosphere, with implications for climate, air quality, and UV radiation.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l10476">10476</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">10477</span>              {</div>
<div class="line"><span class="lineno">10478</span> </div>
<div class="line"><span class="lineno">10479</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">10480</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_OZONE&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno">10481</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Calculate total column ozone...&quot;</span>);</div>
<div class="line"><span class="lineno">10482</span> </div>
<div class="line"><span class="lineno">10483</span>  <span class="comment">/* Loop over columns... */</span></div>
<div class="line"><span class="lineno">10484</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno">10485</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10486</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno">10487</span> </div>
<div class="line"><span class="lineno">10488</span>      <span class="comment">/* Integrate... */</span></div>
<div class="line"><span class="lineno">10489</span>      <span class="keywordtype">double</span> cd = 0;</div>
<div class="line"><span class="lineno">10490</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 1; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno">10491</span>        <span class="keywordflow">if</span> (met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip - 1] &lt;= met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy]) {</div>
<div class="line"><span class="lineno">10492</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> vmr =</div>
<div class="line"><span class="lineno">10493</span>            0.5 * (met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[ix][iy][ip - 1] + met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[ix][iy][ip]);</div>
<div class="line"><span class="lineno">10494</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> dp = met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip - 1] - met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip];</div>
<div class="line"><span class="lineno">10495</span>          cd += vmr * <a class="code hl_define" href="mptrac_8h.html#aa5770de64e81ecf3f35d559357f67a76">MO3</a> / <a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a> * dp * 1e2 / <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a>;</div>
<div class="line"><span class="lineno">10496</span>        }</div>
<div class="line"><span class="lineno">10497</span> </div>
<div class="line"><span class="lineno">10498</span>      <span class="comment">/* Convert to Dobson units... */</span></div>
<div class="line"><span class="lineno">10499</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a0ab0cfbc1e5fe1a5c9ce3412cc4400a8">o3c</a>[ix][iy] = (float) (cd / 2.1415e-5);</div>
<div class="line"><span class="lineno">10500</span>    }</div>
<div class="line"><span class="lineno">10501</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e6ef467d264f7b13436a460c753ed8a" name="a0e6ef467d264f7b13436a460c753ed8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e6ef467d264f7b13436a460c753ed8a">&#9670;&nbsp;</a></span>read_met_sample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_sample </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Downsamples meteorological data based on specified parameters. </p>
<p >This function downsamples meteorological data based on the provided control parameters. It reduces the resolution of meteorological data by averaging over specified intervals in longitude, latitude, and altitude.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>A pointer to a structure containing control parameters for downsampling. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure containing meteorological data to be downsampled.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Checks if downsampling parameters are set to a value less than or equal to 1, if so, returns without downsampling.</li>
<li>Sets a timer for performance monitoring.</li>
<li>Allocates memory for a temporary meteorological data structure.</li>
<li>Copies metadata from the original structure to the temporary structure.</li>
<li>Performs downsampling by smoothing over specified intervals:<ul>
<li>Computes weighted averages over the specified intervals.</li>
<li>Updates the temporary structure with the smoothed values.</li>
</ul>
</li>
<li>Downsamples the smoothed data:<ul>
<li>Updates longitude and latitude arrays with downsampled values.</li>
<li>Stores downsampled meteorological variables in the original structure.</li>
</ul>
</li>
<li>Frees memory allocated for the temporary structure.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Downsampling meteorological data can be useful for reducing computational cost while preserving essential features for modeling and analysis.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l10505">10505</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">10507</span>              {</div>
<div class="line"><span class="lineno">10508</span> </div>
<div class="line"><span class="lineno">10509</span>  <a class="code hl_struct" href="structmet__t.html">met_t</a> *help;</div>
<div class="line"><span class="lineno">10510</span> </div>
<div class="line"><span class="lineno">10511</span>  <span class="comment">/* Check parameters... */</span></div>
<div class="line"><span class="lineno">10512</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1eb5d7699fd84b8522a1d666d0851fad">met_dp</a> &lt;= 1 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6b03cd434f6f12efc60dc4b8d366d6c7">met_dx</a> &lt;= 1 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae4da60e71dcd75d1b55f66036867f225">met_dy</a> &lt;= 1</div>
<div class="line"><span class="lineno">10513</span>      &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab5296a9ff61f1f50c9733462cd294889">met_sp</a> &lt;= 1 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4abb2ec4ff0e29f2648cb5e8b182e5d8">met_sx</a> &lt;= 1 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a416820ddede3de831eb41413ed6427c0">met_sy</a> &lt;= 1)</div>
<div class="line"><span class="lineno">10514</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">10515</span> </div>
<div class="line"><span class="lineno">10516</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">10517</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_SAMPLE&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno">10518</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Downsampling of meteo data...&quot;</span>);</div>
<div class="line"><span class="lineno">10519</span> </div>
<div class="line"><span class="lineno">10520</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">10521</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <a class="code hl_struct" href="structmet__t.html">met_t</a>, 1);</div>
<div class="line"><span class="lineno">10522</span> </div>
<div class="line"><span class="lineno">10523</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno">10524</span>  help-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> = met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>;</div>
<div class="line"><span class="lineno">10525</span>  help-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> = met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>;</div>
<div class="line"><span class="lineno">10526</span>  help-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> = met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>;</div>
<div class="line"><span class="lineno">10527</span>  memcpy(help-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, <span class="keyword">sizeof</span>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>));</div>
<div class="line"><span class="lineno">10528</span>  memcpy(help-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, <span class="keyword">sizeof</span>(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>));</div>
<div class="line"><span class="lineno">10529</span>  memcpy(help-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>, <span class="keyword">sizeof</span>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>));</div>
<div class="line"><span class="lineno">10530</span> </div>
<div class="line"><span class="lineno">10531</span>  <span class="comment">/* Smoothing... */</span></div>
<div class="line"><span class="lineno">10532</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6b03cd434f6f12efc60dc4b8d366d6c7">met_dx</a>) {</div>
<div class="line"><span class="lineno">10533</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae4da60e71dcd75d1b55f66036867f225">met_dy</a>) {</div>
<div class="line"><span class="lineno">10534</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1eb5d7699fd84b8522a1d666d0851fad">met_dp</a>) {</div>
<div class="line"><span class="lineno">10535</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10536</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10537</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10538</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10539</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10540</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10541</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10542</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10543</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10544</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10545</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10546</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10547</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[ix][iy] = 0;</div>
<div class="line"><span class="lineno">10548</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno">10549</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno">10550</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno">10551</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno">10552</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno">10553</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno">10554</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno">10555</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno">10556</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno">10557</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno">10558</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>[ix][iy][ip] = 0;</div>
<div class="line"><span class="lineno">10559</span>        <span class="keywordtype">float</span> wsum = 0;</div>
<div class="line"><span class="lineno">10560</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix2 = ix - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4abb2ec4ff0e29f2648cb5e8b182e5d8">met_sx</a> + 1; ix2 &lt;= ix + ctl-&gt;met_sx - 1;</div>
<div class="line"><span class="lineno">10561</span>             ix2++) {</div>
<div class="line"><span class="lineno">10562</span>          <span class="keywordtype">int</span> ix3 = ix2;</div>
<div class="line"><span class="lineno">10563</span>          <span class="keywordflow">if</span> (ix3 &lt; 0)</div>
<div class="line"><span class="lineno">10564</span>            ix3 += met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>;</div>
<div class="line"><span class="lineno">10565</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ix3 &gt;= met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>)</div>
<div class="line"><span class="lineno">10566</span>            ix3 -= met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>;</div>
<div class="line"><span class="lineno">10567</span> </div>
<div class="line"><span class="lineno">10568</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy2 = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(iy - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a416820ddede3de831eb41413ed6427c0">met_sy</a> + 1, 0);</div>
<div class="line"><span class="lineno">10569</span>               iy2 &lt;= <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(iy + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a416820ddede3de831eb41413ed6427c0">met_sy</a> - 1, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> - 1); iy2++)</div>
<div class="line"><span class="lineno">10570</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip2 = <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(ip - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab5296a9ff61f1f50c9733462cd294889">met_sp</a> + 1, 0);</div>
<div class="line"><span class="lineno">10571</span>                 ip2 &lt;= <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(ip + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab5296a9ff61f1f50c9733462cd294889">met_sp</a> - 1, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> - 1); ip2++) {</div>
<div class="line"><span class="lineno">10572</span>              <span class="keyword">const</span> <span class="keywordtype">float</span> w =</div>
<div class="line"><span class="lineno">10573</span>                (1.0f - (float) abs(ix - ix2) / (float) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4abb2ec4ff0e29f2648cb5e8b182e5d8">met_sx</a>)</div>
<div class="line"><span class="lineno">10574</span>                * (1.0f - (float) abs(iy - iy2) / (float) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a416820ddede3de831eb41413ed6427c0">met_sy</a>)</div>
<div class="line"><span class="lineno">10575</span>                * (1.0f - (float) abs(ip - ip2) / (float) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab5296a9ff61f1f50c9733462cd294889">met_sp</a>);</div>
<div class="line"><span class="lineno">10576</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10577</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10578</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10579</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10580</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10581</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10582</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10583</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10584</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10585</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10586</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10587</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10588</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[ix][iy] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[ix3][iy2];</div>
<div class="line"><span class="lineno">10589</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix3][iy2][ip2];</div>
<div class="line"><span class="lineno">10590</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix3][iy2][ip2];</div>
<div class="line"><span class="lineno">10591</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix3][iy2][ip2];</div>
<div class="line"><span class="lineno">10592</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix3][iy2][ip2];</div>
<div class="line"><span class="lineno">10593</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix3][iy2][ip2];</div>
<div class="line"><span class="lineno">10594</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[ix3][iy2][ip2];</div>
<div class="line"><span class="lineno">10595</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[ix3][iy2][ip2];</div>
<div class="line"><span class="lineno">10596</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[ix3][iy2][ip2];</div>
<div class="line"><span class="lineno">10597</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[ix3][iy2][ip2];</div>
<div class="line"><span class="lineno">10598</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[ix3][iy2][ip2];</div>
<div class="line"><span class="lineno">10599</span>              help-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>[ix][iy][ip] += w * met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>[ix3][iy2][ip2];</div>
<div class="line"><span class="lineno">10600</span>              wsum += w;</div>
<div class="line"><span class="lineno">10601</span>            }</div>
<div class="line"><span class="lineno">10602</span>        }</div>
<div class="line"><span class="lineno">10603</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10604</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10605</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10606</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10607</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10608</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10609</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10610</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10611</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10612</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10613</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10614</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10615</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[ix][iy] /= wsum;</div>
<div class="line"><span class="lineno">10616</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno">10617</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno">10618</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno">10619</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno">10620</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno">10621</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno">10622</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno">10623</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno">10624</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno">10625</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno">10626</span>        help-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>[ix][iy][ip] /= wsum;</div>
<div class="line"><span class="lineno">10627</span>      }</div>
<div class="line"><span class="lineno">10628</span>    }</div>
<div class="line"><span class="lineno">10629</span>  }</div>
<div class="line"><span class="lineno">10630</span> </div>
<div class="line"><span class="lineno">10631</span>  <span class="comment">/* Downsampling... */</span></div>
<div class="line"><span class="lineno">10632</span>  met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> = 0;</div>
<div class="line"><span class="lineno">10633</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; help-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6b03cd434f6f12efc60dc4b8d366d6c7">met_dx</a>) {</div>
<div class="line"><span class="lineno">10634</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix];</div>
<div class="line"><span class="lineno">10635</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> = 0;</div>
<div class="line"><span class="lineno">10636</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; help-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ae4da60e71dcd75d1b55f66036867f225">met_dy</a>) {</div>
<div class="line"><span class="lineno">10637</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy];</div>
<div class="line"><span class="lineno">10638</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>[ix][iy];</div>
<div class="line"><span class="lineno">10639</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>[ix][iy];</div>
<div class="line"><span class="lineno">10640</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>[ix][iy];</div>
<div class="line"><span class="lineno">10641</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>[ix][iy];</div>
<div class="line"><span class="lineno">10642</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>[ix][iy];</div>
<div class="line"><span class="lineno">10643</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>[ix][iy];</div>
<div class="line"><span class="lineno">10644</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>[ix][iy];</div>
<div class="line"><span class="lineno">10645</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>[ix][iy];</div>
<div class="line"><span class="lineno">10646</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>[ix][iy];</div>
<div class="line"><span class="lineno">10647</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>[ix][iy];</div>
<div class="line"><span class="lineno">10648</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>[ix][iy];</div>
<div class="line"><span class="lineno">10649</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>[ix][iy];</div>
<div class="line"><span class="lineno">10650</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>[ix][iy];</div>
<div class="line"><span class="lineno">10651</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> = 0;</div>
<div class="line"><span class="lineno">10652</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; help-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1eb5d7699fd84b8522a1d666d0851fad">met_dp</a>) {</div>
<div class="line"><span class="lineno">10653</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip];</div>
<div class="line"><span class="lineno">10654</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno">10655</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno">10656</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno">10657</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno">10658</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno">10659</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno">10660</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno">10661</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno">10662</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno">10663</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno">10664</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>[met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>][met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>] = help-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>[ix][iy][ip];</div>
<div class="line"><span class="lineno">10665</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>++;</div>
<div class="line"><span class="lineno">10666</span>      }</div>
<div class="line"><span class="lineno">10667</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>++;</div>
<div class="line"><span class="lineno">10668</span>    }</div>
<div class="line"><span class="lineno">10669</span>    met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>++;</div>
<div class="line"><span class="lineno">10670</span>  }</div>
<div class="line"><span class="lineno">10671</span> </div>
<div class="line"><span class="lineno">10672</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">10673</span>  free(help);</div>
<div class="line"><span class="lineno">10674</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a29701c07d5dded042b2031e09e11d679" name="a29701c07d5dded042b2031e09e11d679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29701c07d5dded042b2031e09e11d679">&#9670;&nbsp;</a></span>read_met_tropo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_met_tropo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the tropopause and related meteorological variables based on various methods and stores the results in the meteorological data structure. </p>
<p >This function calculates the tropopause and related meteorological variables using different methods specified by the control parameters. The calculated tropopause pressure is stored in the provided meteorological data structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctl</td><td>A pointer to a structure containing control parameters. </td></tr>
    <tr><td class="paramname">clim</td><td>A pointer to the climatological data structure. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to the meteorological data structure to store the calculated tropopause pressure and related variables.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets a timer for performance monitoring.</li>
<li>Retrieves altitude and pressure profiles from the meteorological data structure.</li>
<li>Depending on the control parameters (ctl-&gt;met_tropo), it calculates the tropopause using one of the following methods:<ul>
<li>If ctl-&gt;met_tropo == 0, it does not calculate the tropopause and assigns NaN values to the tropopause pressure.</li>
<li>If ctl-&gt;met_tropo == 1, it uses tropopause climatology to estimate the tropopause pressure based on latitude and time.</li>
<li>If ctl-&gt;met_tropo == 2, it calculates the tropopause based on the cold point method, finding the altitude where the temperature is at a minimum.</li>
<li>If ctl-&gt;met_tropo == 3 or ctl-&gt;met_tropo == 4, it calculates the tropopause using the WMO definition, which involves identifying a sharp temperature lapse rate between two pressure levels.</li>
<li>If ctl-&gt;met_tropo == 5, it calculates the dynamical tropopause based on potential vorticity and potential temperature profiles.</li>
</ul>
</li>
<li>Interpolates temperature, geopotential height, and water vapor content to the tropopause pressure level using spatial interpolation.</li>
<li>Stores the interpolated values in the meteorological data structure.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The function supports parallelization using OpenMP directives to improve performance.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l10678">10678</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">10681</span>              {</div>
<div class="line"><span class="lineno">10682</span> </div>
<div class="line"><span class="lineno">10683</span>  <span class="keywordtype">double</span> p2[200], pv[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], pv2[200], t[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], t2[200], th[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>],</div>
<div class="line"><span class="lineno">10684</span>    th2[200], z[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], z2[200];</div>
<div class="line"><span class="lineno">10685</span> </div>
<div class="line"><span class="lineno">10686</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">10687</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;READ_MET_TROPO&quot;</span>, <span class="stringliteral">&quot;METPROC&quot;</span>);</div>
<div class="line"><span class="lineno">10688</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Calculate tropopause...&quot;</span>);</div>
<div class="line"><span class="lineno">10689</span> </div>
<div class="line"><span class="lineno">10690</span>  <span class="comment">/* Get altitude and pressure profiles... */</span></div>
<div class="line"><span class="lineno">10691</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">10692</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; iz++)</div>
<div class="line"><span class="lineno">10693</span>    z[iz] = <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[iz]);</div>
<div class="line"><span class="lineno">10694</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">10695</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt;= 190; iz++) {</div>
<div class="line"><span class="lineno">10696</span>    z2[iz] = 4.5 + 0.1 * iz;</div>
<div class="line"><span class="lineno">10697</span>    p2[iz] = <a class="code hl_define" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>(z2[iz]);</div>
<div class="line"><span class="lineno">10698</span>  }</div>
<div class="line"><span class="lineno">10699</span> </div>
<div class="line"><span class="lineno">10700</span>  <span class="comment">/* Do not calculate tropopause... */</span></div>
<div class="line"><span class="lineno">10701</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">met_tropo</a> == 0)</div>
<div class="line"><span class="lineno">10702</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno">10703</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10704</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno">10705</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno">10706</span> </div>
<div class="line"><span class="lineno">10707</span>  <span class="comment">/* Use tropopause climatology... */</span></div>
<div class="line"><span class="lineno">10708</span>  <span class="keywordflow">else</span> if (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">met_tropo</a> == 1) {</div>
<div class="line"><span class="lineno">10709</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno">10710</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10711</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno">10712</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy] = (<span class="keywordtype">float</span>) <a class="code hl_function" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692">clim_tropo</a>(clim, met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy]);</div>
<div class="line"><span class="lineno">10713</span>  }</div>
<div class="line"><span class="lineno">10714</span> </div>
<div class="line"><span class="lineno">10715</span>  <span class="comment">/* Use cold point... */</span></div>
<div class="line"><span class="lineno">10716</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">met_tropo</a> == 2) {</div>
<div class="line"><span class="lineno">10717</span> </div>
<div class="line"><span class="lineno">10718</span>    <span class="comment">/* Loop over grid points... */</span></div>
<div class="line"><span class="lineno">10719</span><span class="preprocessor">#pragma omp parallel for default(shared) private(t,t2) collapse(2)</span></div>
<div class="line"><span class="lineno">10720</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10721</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno">10722</span> </div>
<div class="line"><span class="lineno">10723</span>        <span class="comment">/* Interpolate temperature profile... */</span></div>
<div class="line"><span class="lineno">10724</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; iz++)</div>
<div class="line"><span class="lineno">10725</span>          t[iz] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][iz];</div>
<div class="line"><span class="lineno">10726</span>        <a class="code hl_function" href="mptrac_8c.html#a62786d005ed312f3c9ba2fac7cd544fc">spline</a>(z, t, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, z2, t2, 171, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2b8390b7a9e1335c03a0877f93b051af">met_tropo_spline</a>);</div>
<div class="line"><span class="lineno">10727</span> </div>
<div class="line"><span class="lineno">10728</span>        <span class="comment">/* Find minimum... */</span></div>
<div class="line"><span class="lineno">10729</span>        <span class="keywordtype">int</span> iz = (int) gsl_stats_min_index(t2, 1, 171);</div>
<div class="line"><span class="lineno">10730</span>        <span class="keywordflow">if</span> (iz &gt; 0 &amp;&amp; iz &lt; 170)</div>
<div class="line"><span class="lineno">10731</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy] = (float) p2[iz];</div>
<div class="line"><span class="lineno">10732</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">10733</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno">10734</span>      }</div>
<div class="line"><span class="lineno">10735</span>  }</div>
<div class="line"><span class="lineno">10736</span> </div>
<div class="line"><span class="lineno">10737</span>  <span class="comment">/* Use WMO definition... */</span></div>
<div class="line"><span class="lineno">10738</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">met_tropo</a> == 3 || ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">met_tropo</a> == 4) {</div>
<div class="line"><span class="lineno">10739</span> </div>
<div class="line"><span class="lineno">10740</span>    <span class="comment">/* Loop over grid points... */</span></div>
<div class="line"><span class="lineno">10741</span><span class="preprocessor">#pragma omp parallel for default(shared) private(t,t2) collapse(2)</span></div>
<div class="line"><span class="lineno">10742</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10743</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno">10744</span> </div>
<div class="line"><span class="lineno">10745</span>        <span class="comment">/* Interpolate temperature profile... */</span></div>
<div class="line"><span class="lineno">10746</span>        <span class="keywordtype">int</span> iz;</div>
<div class="line"><span class="lineno">10747</span>        <span class="keywordflow">for</span> (iz = 0; iz &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; iz++)</div>
<div class="line"><span class="lineno">10748</span>          t[iz] = met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][iz];</div>
<div class="line"><span class="lineno">10749</span>        <a class="code hl_function" href="mptrac_8c.html#a62786d005ed312f3c9ba2fac7cd544fc">spline</a>(z, t, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, z2, t2, 191, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2b8390b7a9e1335c03a0877f93b051af">met_tropo_spline</a>);</div>
<div class="line"><span class="lineno">10750</span> </div>
<div class="line"><span class="lineno">10751</span>        <span class="comment">/* Find 1st tropopause... */</span></div>
<div class="line"><span class="lineno">10752</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno">10753</span>        <span class="keywordflow">for</span> (iz = 0; iz &lt;= 170; iz++) {</div>
<div class="line"><span class="lineno">10754</span>          <span class="keywordtype">int</span> found = 1;</div>
<div class="line"><span class="lineno">10755</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz2 = iz + 1; iz2 &lt;= iz + 20; iz2++)</div>
<div class="line"><span class="lineno">10756</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="mptrac_8h.html#a25d1c99b30b81c5705cff2f3dd224a1d">LAPSE</a>(p2[iz], t2[iz], p2[iz2], t2[iz2]) &gt; 2.0) {</div>
<div class="line"><span class="lineno">10757</span>              found = 0;</div>
<div class="line"><span class="lineno">10758</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10759</span>            }</div>
<div class="line"><span class="lineno">10760</span>          <span class="keywordflow">if</span> (found) {</div>
<div class="line"><span class="lineno">10761</span>            <span class="keywordflow">if</span> (iz &gt; 0 &amp;&amp; iz &lt; 170)</div>
<div class="line"><span class="lineno">10762</span>              met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy] = (float) p2[iz];</div>
<div class="line"><span class="lineno">10763</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10764</span>          }</div>
<div class="line"><span class="lineno">10765</span>        }</div>
<div class="line"><span class="lineno">10766</span> </div>
<div class="line"><span class="lineno">10767</span>        <span class="comment">/* Find 2nd tropopause... */</span></div>
<div class="line"><span class="lineno">10768</span>        <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">met_tropo</a> == 4) {</div>
<div class="line"><span class="lineno">10769</span>          met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno">10770</span>          <span class="keywordflow">for</span> (; iz &lt;= 170; iz++) {</div>
<div class="line"><span class="lineno">10771</span>            <span class="keywordtype">int</span> found = 1;</div>
<div class="line"><span class="lineno">10772</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz2 = iz + 1; iz2 &lt;= iz + 10; iz2++)</div>
<div class="line"><span class="lineno">10773</span>              <span class="keywordflow">if</span> (<a class="code hl_define" href="mptrac_8h.html#a25d1c99b30b81c5705cff2f3dd224a1d">LAPSE</a>(p2[iz], t2[iz], p2[iz2], t2[iz2]) &lt; 3.0) {</div>
<div class="line"><span class="lineno">10774</span>                found = 0;</div>
<div class="line"><span class="lineno">10775</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10776</span>              }</div>
<div class="line"><span class="lineno">10777</span>            <span class="keywordflow">if</span> (found)</div>
<div class="line"><span class="lineno">10778</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10779</span>          }</div>
<div class="line"><span class="lineno">10780</span>          <span class="keywordflow">for</span> (; iz &lt;= 170; iz++) {</div>
<div class="line"><span class="lineno">10781</span>            <span class="keywordtype">int</span> found = 1;</div>
<div class="line"><span class="lineno">10782</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz2 = iz + 1; iz2 &lt;= iz + 20; iz2++)</div>
<div class="line"><span class="lineno">10783</span>              <span class="keywordflow">if</span> (<a class="code hl_define" href="mptrac_8h.html#a25d1c99b30b81c5705cff2f3dd224a1d">LAPSE</a>(p2[iz], t2[iz], p2[iz2], t2[iz2]) &gt; 2.0) {</div>
<div class="line"><span class="lineno">10784</span>                found = 0;</div>
<div class="line"><span class="lineno">10785</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10786</span>              }</div>
<div class="line"><span class="lineno">10787</span>            <span class="keywordflow">if</span> (found) {</div>
<div class="line"><span class="lineno">10788</span>              <span class="keywordflow">if</span> (iz &gt; 0 &amp;&amp; iz &lt; 170)</div>
<div class="line"><span class="lineno">10789</span>                met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy] = (float) p2[iz];</div>
<div class="line"><span class="lineno">10790</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10791</span>            }</div>
<div class="line"><span class="lineno">10792</span>          }</div>
<div class="line"><span class="lineno">10793</span>        }</div>
<div class="line"><span class="lineno">10794</span>      }</div>
<div class="line"><span class="lineno">10795</span>  }</div>
<div class="line"><span class="lineno">10796</span> </div>
<div class="line"><span class="lineno">10797</span>  <span class="comment">/* Use dynamical tropopause... */</span></div>
<div class="line"><span class="lineno">10798</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5303a68a713ead5d3e144ec4183a9a86">met_tropo</a> == 5) {</div>
<div class="line"><span class="lineno">10799</span> </div>
<div class="line"><span class="lineno">10800</span>    <span class="comment">/* Loop over grid points... */</span></div>
<div class="line"><span class="lineno">10801</span><span class="preprocessor">#pragma omp parallel for default(shared) private(pv,pv2,th,th2) collapse(2)</span></div>
<div class="line"><span class="lineno">10802</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10803</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno">10804</span> </div>
<div class="line"><span class="lineno">10805</span>        <span class="comment">/* Interpolate potential vorticity profile... */</span></div>
<div class="line"><span class="lineno">10806</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; iz++)</div>
<div class="line"><span class="lineno">10807</span>          pv[iz] = met-&gt;<a class="code hl_variable" href="structmet__t.html#ac8e46cfdfc9fc8cfef4e2b801834a61c">pv</a>[ix][iy][iz];</div>
<div class="line"><span class="lineno">10808</span>        <a class="code hl_function" href="mptrac_8c.html#a62786d005ed312f3c9ba2fac7cd544fc">spline</a>(z, pv, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, z2, pv2, 171, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2b8390b7a9e1335c03a0877f93b051af">met_tropo_spline</a>);</div>
<div class="line"><span class="lineno">10809</span> </div>
<div class="line"><span class="lineno">10810</span>        <span class="comment">/* Interpolate potential temperature profile... */</span></div>
<div class="line"><span class="lineno">10811</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; iz++)</div>
<div class="line"><span class="lineno">10812</span>          th[iz] = <a class="code hl_define" href="mptrac_8h.html#a7d6c988afa363960f9cb5f3b589d2ae4">THETA</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[iz], met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>[ix][iy][iz]);</div>
<div class="line"><span class="lineno">10813</span>        <a class="code hl_function" href="mptrac_8c.html#a62786d005ed312f3c9ba2fac7cd544fc">spline</a>(z, th, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, z2, th2, 171, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2b8390b7a9e1335c03a0877f93b051af">met_tropo_spline</a>);</div>
<div class="line"><span class="lineno">10814</span> </div>
<div class="line"><span class="lineno">10815</span>        <span class="comment">/* Find dynamical tropopause... */</span></div>
<div class="line"><span class="lineno">10816</span>        met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy] = NAN;</div>
<div class="line"><span class="lineno">10817</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt;= 170; iz++)</div>
<div class="line"><span class="lineno">10818</span>          <span class="keywordflow">if</span> (fabs(pv2[iz]) &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fa995de108b6beeee9d4e5c4f9f68bb">met_tropo_pv</a></div>
<div class="line"><span class="lineno">10819</span>              || th2[iz] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aec254fc45d24615056f6b07643176171">met_tropo_theta</a>) {</div>
<div class="line"><span class="lineno">10820</span>            <span class="keywordflow">if</span> (iz &gt; 0 &amp;&amp; iz &lt; 170)</div>
<div class="line"><span class="lineno">10821</span>              met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy] = (float) p2[iz];</div>
<div class="line"><span class="lineno">10822</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10823</span>          }</div>
<div class="line"><span class="lineno">10824</span>      }</div>
<div class="line"><span class="lineno">10825</span>  }</div>
<div class="line"><span class="lineno">10826</span> </div>
<div class="line"><span class="lineno">10827</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">10828</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot calculate tropopause!&quot;</span>);</div>
<div class="line"><span class="lineno">10829</span> </div>
<div class="line"><span class="lineno">10830</span>  <span class="comment">/* Interpolate temperature, geopotential height, and water vapor... */</span></div>
<div class="line"><span class="lineno">10831</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno">10832</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">10833</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++) {</div>
<div class="line"><span class="lineno">10834</span>      <span class="keywordtype">double</span> h2ot, tt, zt;</div>
<div class="line"><span class="lineno">10835</span>      <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno">10836</span>      <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy], met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix],</div>
<div class="line"><span class="lineno">10837</span>                          met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy], &amp;tt, ci, cw, 1);</div>
<div class="line"><span class="lineno">10838</span>      <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy], met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix],</div>
<div class="line"><span class="lineno">10839</span>                          met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy], &amp;zt, ci, cw, 0);</div>
<div class="line"><span class="lineno">10840</span>      <a class="code hl_function" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1">intpol_met_space_3d</a>(met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>[ix][iy], met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>[ix],</div>
<div class="line"><span class="lineno">10841</span>                          met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>[iy], &amp;h2ot, ci, cw, 0);</div>
<div class="line"><span class="lineno">10842</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a9677a606f7850c8143f698e9fb15273f">tt</a>[ix][iy] = (float) tt;</div>
<div class="line"><span class="lineno">10843</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#a043690c89804f40d4a8940b7d3393707">zt</a>[ix][iy] = (float) zt;</div>
<div class="line"><span class="lineno">10844</span>      met-&gt;<a class="code hl_variable" href="structmet__t.html#ac87fdccf57a65247062baccf2c2e85e8">h2ot</a>[ix][iy] = (float) h2ot;</div>
<div class="line"><span class="lineno">10845</span>    }</div>
<div class="line"><span class="lineno">10846</span>}</div>
<div class="ttc" id="amptrac_8c_html_a62786d005ed312f3c9ba2fac7cd544fc"><div class="ttname"><a href="mptrac_8c.html#a62786d005ed312f3c9ba2fac7cd544fc">spline</a></div><div class="ttdeci">void spline(const double *x, const double *y, const int n, const double *x2, double *y2, const int n2, const int method)</div><div class="ttdoc">Performs spline interpolation or linear interpolation.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l11056">mptrac.c:11056</a></div></div>
<div class="ttc" id="amptrac_8h_html_a25d1c99b30b81c5705cff2f3dd224a1d"><div class="ttname"><a href="mptrac_8h.html#a25d1c99b30b81c5705cff2f3dd224a1d">LAPSE</a></div><div class="ttdeci">#define LAPSE(p1, t1, p2, t2)</div><div class="ttdoc">Calculate lapse rate.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00991">mptrac.h:991</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a29701c07d5dded042b2031e09e11d679_cgraph.png" border="0" usemap="#amptrac_8h_a29701c07d5dded042b2031e09e11d679_cgraph" alt=""/></div>
<map name="amptrac_8h_a29701c07d5dded042b2031e09e11d679_cgraph" id="amptrac_8h_a29701c07d5dded042b2031e09e11d679_cgraph">
<area shape="rect" title="Calculates the tropopause and related meteorological variables based on various methods and stores th..." alt="" coords="5,56,117,83"/>
<area shape="rect" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692" title="Calculates the tropopause pressure based on climatological data." alt="" coords="197,56,279,83"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="165,107,311,133"/>
<area shape="rect" href="mptrac_8c.html#a62786d005ed312f3c9ba2fac7cd544fc" title="Performs spline interpolation or linear interpolation." alt="" coords="210,5,266,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="391,31,466,57"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="387,81,470,108"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="359,132,499,159"/>
</map>
</div>

</div>
</div>
<a id="a1365b8fd93db0fc3fe4c467107710d03" name="a1365b8fd93db0fc3fe4c467107710d03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1365b8fd93db0fc3fe4c467107710d03">&#9670;&nbsp;</a></span>read_obs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_obs </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>robs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nobs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads observation data from a file and stores it in arrays. </p>
<p >This function reads observation data from a specified file in either ASCII or NetCDF format, depending on the value of the OBS_TYPE control parameter. It stores the time, altitude, longitude, latitude, and observation values in the provided arrays.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The path to the observation data file. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a structure containing control parameters. </td></tr>
    <tr><td class="paramname">rt</td><td>An array to store the time values of the observations. </td></tr>
    <tr><td class="paramname">rz</td><td>An array to store the altitude values of the observations. </td></tr>
    <tr><td class="paramname">rlon</td><td>An array to store the longitude values of the observations. </td></tr>
    <tr><td class="paramname">rlat</td><td>An array to store the latitude values of the observations. </td></tr>
    <tr><td class="paramname">robs</td><td>An array to store the observation values. </td></tr>
    <tr><td class="paramname">nobs</td><td>A pointer to an integer variable to store the number of observations read.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Logs an informational message indicating the observation data file being read.</li>
<li>Reads the observation data from the file based on the OBS_TYPE control parameter:<ul>
<li>If ctl-&gt;obs_type == 0, it reads the data from an ASCII file using the read_obs_asc function.</li>
<li>If ctl-&gt;obs_type == 1, it reads the data from a NetCDF file using the read_obs_nc function.</li>
<li>If ctl-&gt;obs_type is neither 0 nor 1, it generates an error message indicating that the OBS_TYPE must be set to 0 or 1.</li>
</ul>
</li>
<li>Checks if the time values are in ascending order and generates an error message if not.</li>
<li>Logs statistical information about the observation data, including the number of observations, time range, altitude range, longitude range, latitude range, and observation value range.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the observation data file is formatted correctly and that the arrays provided have sufficient memory allocated to store the data.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd>
<dd>
Mingzhao Liu </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l10850">10850</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">10858</span>             {</div>
<div class="line"><span class="lineno">10859</span> </div>
<div class="line"><span class="lineno">10860</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno">10861</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Read observation data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno">10862</span> </div>
<div class="line"><span class="lineno">10863</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno">10864</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a874cf53d903cea2e96423bacd2fafdab">obs_type</a> == 0)</div>
<div class="line"><span class="lineno">10865</span>    <a class="code hl_function" href="mptrac_8c.html#a29da9a205ad3577ba3890f3e1e4350c3">read_obs_asc</a>(filename, rt, rz, rlon, rlat, robs, nobs);</div>
<div class="line"><span class="lineno">10866</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a874cf53d903cea2e96423bacd2fafdab">obs_type</a> == 1)</div>
<div class="line"><span class="lineno">10867</span>    <a class="code hl_function" href="mptrac_8c.html#a4536a82b3dc62081d26114c1250b1427">read_obs_nc</a>(filename, rt, rz, rlon, rlat, robs, nobs);</div>
<div class="line"><span class="lineno">10868</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">10869</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Set OBS_TYPE to 0 or 1!&quot;</span>);</div>
<div class="line"><span class="lineno">10870</span> </div>
<div class="line"><span class="lineno">10871</span>  <span class="comment">/* Check time... */</span></div>
<div class="line"><span class="lineno">10872</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; *nobs; i++)</div>
<div class="line"><span class="lineno">10873</span>    <span class="keywordflow">if</span> (rt[i] &lt; rt[i - 1])</div>
<div class="line"><span class="lineno">10874</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Time must be ascending!&quot;</span>);</div>
<div class="line"><span class="lineno">10875</span> </div>
<div class="line"><span class="lineno">10876</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno">10877</span>  <span class="keywordtype">int</span> n = *nobs;</div>
<div class="line"><span class="lineno">10878</span>  <span class="keywordtype">double</span> mini, maxi;</div>
<div class="line"><span class="lineno">10879</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Number of observations: %d&quot;</span>, *nobs);</div>
<div class="line"><span class="lineno">10880</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, rt, 1, (<span class="keywordtype">size_t</span>) n);</div>
<div class="line"><span class="lineno">10881</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Time range: %.2f ... %.2f s&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno">10882</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, rz, 1, (<span class="keywordtype">size_t</span>) n);</div>
<div class="line"><span class="lineno">10883</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Altitude range: %g ... %g km&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno">10884</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, rlon, 1, (<span class="keywordtype">size_t</span>) n);</div>
<div class="line"><span class="lineno">10885</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Longitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno">10886</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, rlat, 1, (<span class="keywordtype">size_t</span>) n);</div>
<div class="line"><span class="lineno">10887</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Latitude range: %g ... %g deg&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno">10888</span>  gsl_stats_minmax(&amp;mini, &amp;maxi, robs, 1, (<span class="keywordtype">size_t</span>) n);</div>
<div class="line"><span class="lineno">10889</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Observation range: %g ... %g&quot;</span>, mini, maxi);</div>
<div class="line"><span class="lineno">10890</span>}</div>
<div class="ttc" id="amptrac_8c_html_a29da9a205ad3577ba3890f3e1e4350c3"><div class="ttname"><a href="mptrac_8c.html#a29da9a205ad3577ba3890f3e1e4350c3">read_obs_asc</a></div><div class="ttdeci">void read_obs_asc(const char *filename, double *rt, double *rz, double *rlon, double *rlat, double *robs, int *nobs)</div><div class="ttdoc">Reads observation data from an ASCII file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l10894">mptrac.c:10894</a></div></div>
<div class="ttc" id="amptrac_8c_html_a4536a82b3dc62081d26114c1250b1427"><div class="ttname"><a href="mptrac_8c.html#a4536a82b3dc62081d26114c1250b1427">read_obs_nc</a></div><div class="ttdeci">void read_obs_nc(const char *filename, double *rt, double *rz, double *rlon, double *rlat, double *robs, int *nobs)</div><div class="ttdoc">Reads observation data from a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l10922">mptrac.c:10922</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a1365b8fd93db0fc3fe4c467107710d03_cgraph.png" border="0" usemap="#amptrac_8h_a1365b8fd93db0fc3fe4c467107710d03_cgraph" alt=""/></div>
<map name="amptrac_8h_a1365b8fd93db0fc3fe4c467107710d03_cgraph" id="amptrac_8h_a1365b8fd93db0fc3fe4c467107710d03_cgraph">
<area shape="rect" title="Reads observation data from a file and stores it in arrays." alt="" coords="5,31,80,57"/>
<area shape="rect" href="mptrac_8c.html#a29da9a205ad3577ba3890f3e1e4350c3" title="Reads observation data from an ASCII file." alt="" coords="128,5,231,32"/>
<area shape="rect" href="mptrac_8c.html#a4536a82b3dc62081d26114c1250b1427" title="Reads observation data from a NetCDF file." alt="" coords="131,56,227,83"/>
</map>
</div>

</div>
</div>
<a id="a29da9a205ad3577ba3890f3e1e4350c3" name="a29da9a205ad3577ba3890f3e1e4350c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29da9a205ad3577ba3890f3e1e4350c3">&#9670;&nbsp;</a></span>read_obs_asc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_obs_asc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>robs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nobs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads observation data from an ASCII file. </p>
<p >This function reads observation data from a specified ASCII file. It extracts time, altitude, longitude, latitude, and observation values from each line of the file and stores them in the provided arrays.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The path to the ASCII file containing the observation data. </td></tr>
    <tr><td class="paramname">rt</td><td>An array to store the time values of the observations. </td></tr>
    <tr><td class="paramname">rz</td><td>An array to store the altitude values of the observations. </td></tr>
    <tr><td class="paramname">rlon</td><td>An array to store the longitude values of the observations. </td></tr>
    <tr><td class="paramname">rlat</td><td>An array to store the latitude values of the observations. </td></tr>
    <tr><td class="paramname">robs</td><td>An array to store the observation values. </td></tr>
    <tr><td class="paramname">nobs</td><td>A pointer to an integer variable to store the number of observations read.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Attempts to open the specified observation data file in read mode.</li>
<li>Reads each line of the file and parses it to extract the time, altitude, longitude, latitude, and observation values using the sscanf function.</li>
<li>Stores the extracted values in the respective arrays.</li>
<li>Checks if the number of observations exceeds the maximum allowed limit (NOBS) and generates an error message if so.</li>
<li>Closes the observation data file after reading all data.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the observation data file is properly formatted and that the arrays provided have sufficient memory allocated to store the data.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l10894">10894</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">10901</span>             {</div>
<div class="line"><span class="lineno">10902</span> </div>
<div class="line"><span class="lineno">10903</span>  <span class="comment">/* Open observation data file... */</span></div>
<div class="line"><span class="lineno">10904</span>  FILE *in;</div>
<div class="line"><span class="lineno">10905</span>  <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno">10906</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno">10907</span> </div>
<div class="line"><span class="lineno">10908</span>  <span class="comment">/* Read observations... */</span></div>
<div class="line"><span class="lineno">10909</span>  <span class="keywordtype">char</span> line[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno">10910</span>  <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in))</div>
<div class="line"><span class="lineno">10911</span>    <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%lg %lg %lg %lg %lg&quot;</span>, &amp;rt[*nobs], &amp;rz[*nobs],</div>
<div class="line"><span class="lineno">10912</span>               &amp;rlon[*nobs], &amp;rlat[*nobs], &amp;robs[*nobs]) == 5)</div>
<div class="line"><span class="lineno">10913</span>      <span class="keywordflow">if</span> ((++(*nobs)) &gt;= <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>)</div>
<div class="line"><span class="lineno">10914</span>        <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many observations!&quot;</span>);</div>
<div class="line"><span class="lineno">10915</span> </div>
<div class="line"><span class="lineno">10916</span>  <span class="comment">/* Close observation data file... */</span></div>
<div class="line"><span class="lineno">10917</span>  fclose(in);</div>
<div class="line"><span class="lineno">10918</span>}</div>
<div class="ttc" id="amptrac_8h_html_a4e6d37e546b0cac9bffdd01ec84f53dd"><div class="ttname"><a href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a></div><div class="ttdeci">#define NOBS</div><div class="ttdoc">Maximum number of observation data points.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00328">mptrac.h:328</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4536a82b3dc62081d26114c1250b1427" name="a4536a82b3dc62081d26114c1250b1427"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4536a82b3dc62081d26114c1250b1427">&#9670;&nbsp;</a></span>read_obs_nc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_obs_nc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>robs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nobs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads observation data from a NetCDF file. </p>
<p >This function reads observation data from a specified NetCDF file. It extracts time, altitude, longitude, latitude, and observation values from the variables in the NetCDF file and stores them in the provided arrays.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The path to the NetCDF file containing the observation data. </td></tr>
    <tr><td class="paramname">rt</td><td>An array to store the time values of the observations. </td></tr>
    <tr><td class="paramname">rz</td><td>An array to store the altitude values of the observations. </td></tr>
    <tr><td class="paramname">rlon</td><td>An array to store the longitude values of the observations. </td></tr>
    <tr><td class="paramname">rlat</td><td>An array to store the latitude values of the observations. </td></tr>
    <tr><td class="paramname">robs</td><td>An array to store the observation values. </td></tr>
    <tr><td class="paramname">nobs</td><td>A pointer to an integer variable to store the number of observations read.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Attempts to open the specified NetCDF file in read-only mode using the nc_open function.</li>
<li>Queries the dimensions of the 'nobs' variable in the NetCDF file to determine the number of observations using the NC_INQ_DIM macro.</li>
<li>Reads the 'time', 'alt', 'lon', 'lat', and 'obs' variables from the NetCDF file using the NC_GET_DOUBLE macro and stores them in the respective arrays.</li>
<li>Closes the NetCDF file after reading all data using the nc_close function.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The function assumes that the NetCDF file contains the required variables ('time', 'alt', 'lon', 'lat', 'obs') and that the arrays provided have sufficient memory allocated to store the data.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l10922">10922</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">10929</span>             {</div>
<div class="line"><span class="lineno">10930</span> </div>
<div class="line"><span class="lineno">10931</span>  <span class="keywordtype">int</span> ncid, varid;</div>
<div class="line"><span class="lineno">10932</span> </div>
<div class="line"><span class="lineno">10933</span>  <span class="comment">/* Open netCDF file... */</span></div>
<div class="line"><span class="lineno">10934</span>  <span class="keywordflow">if</span> (nc_open(filename, NC_NOWRITE, &amp;ncid) != NC_NOERR)</div>
<div class="line"><span class="lineno">10935</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno">10936</span> </div>
<div class="line"><span class="lineno">10937</span>  <span class="comment">/* Read the observations from the NetCDF file... */</span></div>
<div class="line"><span class="lineno">10938</span>  <a class="code hl_define" href="mptrac_8h.html#af2af2081610570f29a5d50b3864b4f9c">NC_INQ_DIM</a>(<span class="stringliteral">&quot;nobs&quot;</span>, nobs, 1, <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>, 1);</div>
<div class="line"><span class="lineno">10939</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;time&quot;</span>, rt, 1);</div>
<div class="line"><span class="lineno">10940</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;alt&quot;</span>, rz, 1);</div>
<div class="line"><span class="lineno">10941</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;lon&quot;</span>, rlon, 1);</div>
<div class="line"><span class="lineno">10942</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;lat&quot;</span>, rlat, 1);</div>
<div class="line"><span class="lineno">10943</span>  <a class="code hl_define" href="mptrac_8h.html#ad7d3c9758dc177ab607539de4625d6ca">NC_GET_DOUBLE</a>(<span class="stringliteral">&quot;obs&quot;</span>, robs, 1);</div>
<div class="line"><span class="lineno">10944</span> </div>
<div class="line"><span class="lineno">10945</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">10946</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno">10947</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d07c7baed461e240ff50585ddeed80a" name="a7d07c7baed461e240ff50585ddeed80a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d07c7baed461e240ff50585ddeed80a">&#9670;&nbsp;</a></span>scan_ctl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double scan_ctl </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>arridx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>defvalue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scans a control file or command-line arguments for a specified variable. </p>
<p >This function scans either a control file or command-line arguments for a specified variable name and retrieves its value. It searches for the variable name in the control file or command-line arguments and returns its corresponding value. If the variable is not found, it returns a default value specified by the user.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The name of the control file to be scanned. If NULL, only command-line arguments will be scanned. </td></tr>
    <tr><td class="paramname">argc</td><td>The number of command-line arguments. </td></tr>
    <tr><td class="paramname">argv</td><td>An array of command-line arguments. </td></tr>
    <tr><td class="paramname">varname</td><td>The name of the variable to be searched. </td></tr>
    <tr><td class="paramname">arridx</td><td>The index of the variable array, if applicable. Set to -1 if not an array. </td></tr>
    <tr><td class="paramname">defvalue</td><td>The default value to be returned if the variable is not found. </td></tr>
    <tr><td class="paramname">value</td><td>A pointer to a character array to store the retrieved value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The retrieved value of the variable as a double.</dd></dl>
<p>The function performs the following steps:</p><ul>
<li>Attempts to open the specified control file in read mode using the fopen function. If the filename ends with a '-', the file is not opened.</li>
<li>Constructs the full variable name based on the variable name and array index provided.</li>
<li>Reads data from the control file, searching for the full variable name. If found, it sets the contain flag to 1 and breaks the loop.</li>
<li>Searches through the command-line arguments for the full variable name. If found, it sets the value and contain flag and breaks the loop.</li>
<li>Closes the control file if opened.</li>
<li>If the variable is not found, it sets the value to the default value provided or throws an error if no default value is provided.</li>
<li>Writes the variable name and its value to the log.</li>
<li>Copies the retrieved value to the value parameter if it is not NULL.</li>
<li>Returns the retrieved value as a double after converting it from a string using the atof function.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the variable names and their values in the control file or command-line arguments are separated by whitespace.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l10951">10951</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">10958</span>               {</div>
<div class="line"><span class="lineno">10959</span> </div>
<div class="line"><span class="lineno">10960</span>  FILE *in = NULL;</div>
<div class="line"><span class="lineno">10961</span> </div>
<div class="line"><span class="lineno">10962</span>  <span class="keywordtype">char</span> fullname1[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], fullname2[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], rval[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno">10963</span> </div>
<div class="line"><span class="lineno">10964</span>  <span class="keywordtype">int</span> contain = 0, i;</div>
<div class="line"><span class="lineno">10965</span> </div>
<div class="line"><span class="lineno">10966</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno">10967</span>  <span class="keywordflow">if</span> (filename[strlen(filename) - 1] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno">10968</span>    <span class="keywordflow">if</span> (!(in = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno">10969</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno">10970</span> </div>
<div class="line"><span class="lineno">10971</span>  <span class="comment">/* Set full variable name... */</span></div>
<div class="line"><span class="lineno">10972</span>  <span class="keywordflow">if</span> (arridx &gt;= 0) {</div>
<div class="line"><span class="lineno">10973</span>    sprintf(fullname1, <span class="stringliteral">&quot;%s[%d]&quot;</span>, varname, arridx);</div>
<div class="line"><span class="lineno">10974</span>    sprintf(fullname2, <span class="stringliteral">&quot;%s[*]&quot;</span>, varname);</div>
<div class="line"><span class="lineno">10975</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10976</span>    sprintf(fullname1, <span class="stringliteral">&quot;%s&quot;</span>, varname);</div>
<div class="line"><span class="lineno">10977</span>    sprintf(fullname2, <span class="stringliteral">&quot;%s&quot;</span>, varname);</div>
<div class="line"><span class="lineno">10978</span>  }</div>
<div class="line"><span class="lineno">10979</span> </div>
<div class="line"><span class="lineno">10980</span>  <span class="comment">/* Read data... */</span></div>
<div class="line"><span class="lineno">10981</span>  <span class="keywordflow">if</span> (in != NULL) {</div>
<div class="line"><span class="lineno">10982</span>    <span class="keywordtype">char</span> dummy[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], line[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], rvarname[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno">10983</span>    <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in)) {</div>
<div class="line"><span class="lineno">10984</span>      <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%4999s %4999s %4999s&quot;</span>, rvarname, dummy, rval) == 3)</div>
<div class="line"><span class="lineno">10985</span>        <span class="keywordflow">if</span> (strcasecmp(rvarname, fullname1) == 0 ||</div>
<div class="line"><span class="lineno">10986</span>            strcasecmp(rvarname, fullname2) == 0) {</div>
<div class="line"><span class="lineno">10987</span>          contain = 1;</div>
<div class="line"><span class="lineno">10988</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10989</span>        }</div>
<div class="line"><span class="lineno">10990</span>    }</div>
<div class="line"><span class="lineno">10991</span>  }</div>
<div class="line"><span class="lineno">10992</span>  <span class="keywordflow">for</span> (i = 1; i &lt; argc - 1; i++)</div>
<div class="line"><span class="lineno">10993</span>    <span class="keywordflow">if</span> (strcasecmp(argv[i], fullname1) == 0 ||</div>
<div class="line"><span class="lineno">10994</span>        strcasecmp(argv[i], fullname2) == 0) {</div>
<div class="line"><span class="lineno">10995</span>      sprintf(rval, <span class="stringliteral">&quot;%s&quot;</span>, argv[i + 1]);</div>
<div class="line"><span class="lineno">10996</span>      contain = 1;</div>
<div class="line"><span class="lineno">10997</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10998</span>    }</div>
<div class="line"><span class="lineno">10999</span> </div>
<div class="line"><span class="lineno">11000</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">11001</span>  <span class="keywordflow">if</span> (in != NULL)</div>
<div class="line"><span class="lineno">11002</span>    fclose(in);</div>
<div class="line"><span class="lineno">11003</span> </div>
<div class="line"><span class="lineno">11004</span>  <span class="comment">/* Check for missing variables... */</span></div>
<div class="line"><span class="lineno">11005</span>  <span class="keywordflow">if</span> (!contain) {</div>
<div class="line"><span class="lineno">11006</span>    <span class="keywordflow">if</span> (strlen(defvalue) &gt; 0)</div>
<div class="line"><span class="lineno">11007</span>      sprintf(rval, <span class="stringliteral">&quot;%s&quot;</span>, defvalue);</div>
<div class="line"><span class="lineno">11008</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">11009</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Missing variable %s!\n&quot;</span>, fullname1);</div>
<div class="line"><span class="lineno">11010</span>  }</div>
<div class="line"><span class="lineno">11011</span> </div>
<div class="line"><span class="lineno">11012</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno">11013</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;%s = %s&quot;</span>, fullname1, rval);</div>
<div class="line"><span class="lineno">11014</span> </div>
<div class="line"><span class="lineno">11015</span>  <span class="comment">/* Return values... */</span></div>
<div class="line"><span class="lineno">11016</span>  <span class="keywordflow">if</span> (value != NULL)</div>
<div class="line"><span class="lineno">11017</span>    sprintf(value, <span class="stringliteral">&quot;%s&quot;</span>, rval);</div>
<div class="line"><span class="lineno">11018</span>  <span class="keywordflow">return</span> atof(rval);</div>
<div class="line"><span class="lineno">11019</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b580107362b559d90f6766d340cc370" name="a1b580107362b559d90f6766d340cc370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b580107362b559d90f6766d340cc370">&#9670;&nbsp;</a></span>sedi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sedi </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>rhop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the sedimentation velocity of a particle in air. </p>
<p >This function calculates the sedimentation velocity of a particle in air using the given parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The atmospheric pressure [hPa]. </td></tr>
    <tr><td class="paramname">T</td><td>The temperature [K]. </td></tr>
    <tr><td class="paramname">rp</td><td>The radius of the particle [microns]. </td></tr>
    <tr><td class="paramname">rhop</td><td>The density of the particle [kg/m^3]. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The sedimentation velocity of the particle [m/s].</dd></dl>
<p>The function performs the following steps:</p><ul>
<li>Converts the radius of the particle from microns to meters.</li>
<li>Calculates the density of dry air using the given atmospheric pressure and temperature.</li>
<li>Calculates the dynamic viscosity of air using Sutherland's formula.</li>
<li>Calculates the thermal velocity of an air molecule using the given temperature.</li>
<li>Calculates the mean free path of an air molecule.</li>
<li>Computes the Knudsen number for air based on the ratio of mean free path to particle radius.</li>
<li>Applies the Cunningham slip-flow correction factor to account for particle size.</li>
<li>Computes the sedimentation velocity of the particle based on the difference in densities between the particle and air, incorporating the slip-flow correction.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function assumes that the ideal gas law and Stokes' law are applicable for calculating the sedimentation velocity of the particle.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11023">11023</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11027</span>                     {</div>
<div class="line"><span class="lineno">11028</span> </div>
<div class="line"><span class="lineno">11029</span>  <span class="comment">/* Convert particle radius from microns to m... */</span></div>
<div class="line"><span class="lineno">11030</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rp_help = rp * 1e-6;</div>
<div class="line"><span class="lineno">11031</span> </div>
<div class="line"><span class="lineno">11032</span>  <span class="comment">/* Density of dry air [kg / m^3]... */</span></div>
<div class="line"><span class="lineno">11033</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rho = <a class="code hl_define" href="mptrac_8h.html#ae088e183d18a16fd6ab469d48ce3f06a">RHO</a>(p, T);</div>
<div class="line"><span class="lineno">11034</span> </div>
<div class="line"><span class="lineno">11035</span>  <span class="comment">/* Dynamic viscosity of air [kg / (m s)]... */</span></div>
<div class="line"><span class="lineno">11036</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> eta = 1.8325e-5 * (416.16 / (T + 120.)) * pow(T / 296.16, 1.5);</div>
<div class="line"><span class="lineno">11037</span> </div>
<div class="line"><span class="lineno">11038</span>  <span class="comment">/* Thermal velocity of an air molecule [m / s]... */</span></div>
<div class="line"><span class="lineno">11039</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> v = sqrt(8. * <a class="code hl_define" href="mptrac_8h.html#a1841fd1a462d245d8c73dce55e2f45da">KB</a> * T / (M_PI * 4.8096e-26));</div>
<div class="line"><span class="lineno">11040</span> </div>
<div class="line"><span class="lineno">11041</span>  <span class="comment">/* Mean free path of an air molecule [m]... */</span></div>
<div class="line"><span class="lineno">11042</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> lambda = 2. * eta / (rho * v);</div>
<div class="line"><span class="lineno">11043</span> </div>
<div class="line"><span class="lineno">11044</span>  <span class="comment">/* Knudsen number for air (dimensionless)... */</span></div>
<div class="line"><span class="lineno">11045</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> K = lambda / rp_help;</div>
<div class="line"><span class="lineno">11046</span> </div>
<div class="line"><span class="lineno">11047</span>  <span class="comment">/* Cunningham slip-flow correction (dimensionless)... */</span></div>
<div class="line"><span class="lineno">11048</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> G = 1. + K * (1.249 + 0.42 * exp(-0.87 / K));</div>
<div class="line"><span class="lineno">11049</span> </div>
<div class="line"><span class="lineno">11050</span>  <span class="comment">/* Sedimentation velocity [m / s]... */</span></div>
<div class="line"><span class="lineno">11051</span>  <span class="keywordflow">return</span> 2. * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(rp_help) * (rhop - rho) * <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a> / (9. * eta) * G;</div>
<div class="line"><span class="lineno">11052</span>}</div>
<div class="ttc" id="amptrac_8h_html_a1841fd1a462d245d8c73dce55e2f45da"><div class="ttname"><a href="mptrac_8h.html#a1841fd1a462d245d8c73dce55e2f45da">KB</a></div><div class="ttdeci">#define KB</div><div class="ttdoc">Boltzmann constant [kg m^2/(K s^2)].</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00234">mptrac.h:234</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62786d005ed312f3c9ba2fac7cd544fc" name="a62786d005ed312f3c9ba2fac7cd544fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62786d005ed312f3c9ba2fac7cd544fc">&#9670;&nbsp;</a></span>spline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spline </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs spline interpolation or linear interpolation. </p>
<p >This function interpolates a set of data points using either cubic spline interpolation or linear interpolation, depending on the specified method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The array of x-coordinates of the data points. </td></tr>
    <tr><td class="paramname">y</td><td>The array of y-coordinates of the data points. </td></tr>
    <tr><td class="paramname">n</td><td>The number of data points. </td></tr>
    <tr><td class="paramname">x2</td><td>The array of x-coordinates where interpolation is required. </td></tr>
    <tr><td class="paramname">y2</td><td>The array to store the interpolated y-values. </td></tr>
    <tr><td class="paramname">n2</td><td>The number of points to interpolate. </td></tr>
    <tr><td class="paramname">method</td><td>The interpolation method: 1 for cubic spline, 0 for linear interpolation.</td></tr>
  </table>
  </dd>
</dl>
<p>If the method is set to 1 (cubic spline interpolation):</p><ul>
<li>The function initializes a cubic spline interpolator using GSL.</li>
<li>It interpolates the y-values at the specified x-coordinates using the spline.</li>
<li>The interpolated y-values are stored in the provided y2 array.</li>
</ul>
<p >If the method is set to 0 (linear interpolation):</p><ul>
<li>The function performs linear interpolation between adjacent data points.</li>
<li>It locates the interval where each interpolation point falls and calculates the interpolated y-value using linear interpolation.</li>
<li>The interpolated y-values are stored in the provided y2 array.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The x-coordinates in both arrays (x and x2) must be sorted in ascending order.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11056">11056</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11063</span>                    {</div>
<div class="line"><span class="lineno">11064</span> </div>
<div class="line"><span class="lineno">11065</span>  <span class="comment">/* Cubic spline interpolation... */</span></div>
<div class="line"><span class="lineno">11066</span>  <span class="keywordflow">if</span> (method == 1) {</div>
<div class="line"><span class="lineno">11067</span> </div>
<div class="line"><span class="lineno">11068</span>    <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">11069</span>    gsl_interp_accel *acc = gsl_interp_accel_alloc();</div>
<div class="line"><span class="lineno">11070</span>    gsl_spline *s = gsl_spline_alloc(gsl_interp_cspline, (<span class="keywordtype">size_t</span>) n);</div>
<div class="line"><span class="lineno">11071</span> </div>
<div class="line"><span class="lineno">11072</span>    <span class="comment">/* Interpolate profile... */</span></div>
<div class="line"><span class="lineno">11073</span>    gsl_spline_init(s, x, y, (<span class="keywordtype">size_t</span>) n);</div>
<div class="line"><span class="lineno">11074</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n2; i++)</div>
<div class="line"><span class="lineno">11075</span>      <span class="keywordflow">if</span> (x2[i] &lt;= x[0])</div>
<div class="line"><span class="lineno">11076</span>        y2[i] = y[0];</div>
<div class="line"><span class="lineno">11077</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x2[i] &gt;= x[n - 1])</div>
<div class="line"><span class="lineno">11078</span>        y2[i] = y[n - 1];</div>
<div class="line"><span class="lineno">11079</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">11080</span>        y2[i] = gsl_spline_eval(s, x2[i], acc);</div>
<div class="line"><span class="lineno">11081</span> </div>
<div class="line"><span class="lineno">11082</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">11083</span>    gsl_spline_free(s);</div>
<div class="line"><span class="lineno">11084</span>    gsl_interp_accel_free(acc);</div>
<div class="line"><span class="lineno">11085</span>  }</div>
<div class="line"><span class="lineno">11086</span> </div>
<div class="line"><span class="lineno">11087</span>  <span class="comment">/* Linear interpolation... */</span></div>
<div class="line"><span class="lineno">11088</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">11089</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n2; i++)</div>
<div class="line"><span class="lineno">11090</span>      <span class="keywordflow">if</span> (x2[i] &lt;= x[0])</div>
<div class="line"><span class="lineno">11091</span>        y2[i] = y[0];</div>
<div class="line"><span class="lineno">11092</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x2[i] &gt;= x[n - 1])</div>
<div class="line"><span class="lineno">11093</span>        y2[i] = y[n - 1];</div>
<div class="line"><span class="lineno">11094</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">11095</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_function" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc">locate_irr</a>(x, n, x2[i]);</div>
<div class="line"><span class="lineno">11096</span>        y2[i] = <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(x[idx], y[idx], x[idx + 1], y[idx + 1], x2[i]);</div>
<div class="line"><span class="lineno">11097</span>      }</div>
<div class="line"><span class="lineno">11098</span>  }</div>
<div class="line"><span class="lineno">11099</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a62786d005ed312f3c9ba2fac7cd544fc_cgraph.png" border="0" usemap="#amptrac_8h_a62786d005ed312f3c9ba2fac7cd544fc_cgraph" alt=""/></div>
<map name="amptrac_8h_a62786d005ed312f3c9ba2fac7cd544fc_cgraph" id="amptrac_8h_a62786d005ed312f3c9ba2fac7cd544fc_cgraph">
<area shape="rect" title="Performs spline interpolation or linear interpolation." alt="" coords="5,5,61,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="109,5,184,32"/>
</map>
</div>

</div>
</div>
<a id="a87088b5ccf95f03d986f1bdd570b5b2f" name="a87088b5ccf95f03d986f1bdd570b5b2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87088b5ccf95f03d986f1bdd570b5b2f">&#9670;&nbsp;</a></span>stddev()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float stddev </td>
          <td>(</td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the standard deviation of a set of data. </p>
<p >This function calculates the standard deviation of a set of floating-point data values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Pointer to the array of data values. </td></tr>
    <tr><td class="paramname">n</td><td>Number of data values in the array. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The standard deviation of the data values. If the number of data values is less than or equal to 0, returns 0.</dd></dl>
<p>The standard deviation is calculated using the formula:</p>
<p class="formulaDsp">
\[ \sigma = \sqrt{\frac{\sum_{i=1}^{n} (x_i - \bar{x})^2}{n}} \]
</p>
<p >where:</p><ul>
<li>\( \sigma \) is the standard deviation,</li>
<li>\( x_i \) is each data value,</li>
<li>\( \bar{x} \) is the mean of the data values, and</li>
<li>\( n \) is the total number of data values.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11103">11103</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11105</span>               {</div>
<div class="line"><span class="lineno">11106</span> </div>
<div class="line"><span class="lineno">11107</span>  <span class="keywordflow">if</span> (n &lt;= 0)</div>
<div class="line"><span class="lineno">11108</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">11109</span> </div>
<div class="line"><span class="lineno">11110</span>  <span class="keywordtype">float</span> mean = 0, var = 0;</div>
<div class="line"><span class="lineno">11111</span> </div>
<div class="line"><span class="lineno">11112</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">11113</span>    mean += data[i];</div>
<div class="line"><span class="lineno">11114</span>    var += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(data[i]);</div>
<div class="line"><span class="lineno">11115</span>  }</div>
<div class="line"><span class="lineno">11116</span> </div>
<div class="line"><span class="lineno">11117</span>  var = var / (float) n - <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(mean / (<span class="keywordtype">float</span>) n);</div>
<div class="line"><span class="lineno">11118</span> </div>
<div class="line"><span class="lineno">11119</span>  <span class="keywordflow">return</span> (var &gt; 0 ? sqrtf(var) : 0);</div>
<div class="line"><span class="lineno">11120</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a578e7ebaa62304182de8fe7ddf144b8f" name="a578e7ebaa62304182de8fe7ddf144b8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a578e7ebaa62304182de8fe7ddf144b8f">&#9670;&nbsp;</a></span>time2jsec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void time2jsec </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>hour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>remain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>jsec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts time components to seconds since January 1, 2000, 12:00:00 UTC. </p>
<p >This function calculates the number of seconds elapsed since January 1, 2000, 12:00:00 UTC, based on the provided year, month, day, hour, minute, and second. It also includes a fractional part to represent the remaining seconds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">year</td><td>The year. </td></tr>
    <tr><td class="paramname">mon</td><td>The month (1-12). </td></tr>
    <tr><td class="paramname">day</td><td>The day of the month (1-31). </td></tr>
    <tr><td class="paramname">hour</td><td>The hour of the day (0-23). </td></tr>
    <tr><td class="paramname">min</td><td>The minute (0-59). </td></tr>
    <tr><td class="paramname">sec</td><td>The second (0-59). </td></tr>
    <tr><td class="paramname">remain</td><td>The fractional part of seconds. </td></tr>
    <tr><td class="paramname">jsec</td><td>Pointer to store the calculated number of seconds since January 1, 2000, 12:00:00 UTC.</td></tr>
  </table>
  </dd>
</dl>
<p>The function calculates the time elapsed since January 1, 2000, 12:00:00 UTC, up to the specified time and includes any fractional seconds indicated by the "remain" parameter.</p>
<dl class="section note"><dt>Note</dt><dd>The function uses the timegm function, which is similar to mktime but operates in UTC.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11124">11124</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11132</span>                {</div>
<div class="line"><span class="lineno">11133</span> </div>
<div class="line"><span class="lineno">11134</span>  <span class="keyword">struct </span>tm t0, t1;</div>
<div class="line"><span class="lineno">11135</span> </div>
<div class="line"><span class="lineno">11136</span>  t0.tm_year = 100;</div>
<div class="line"><span class="lineno">11137</span>  t0.tm_mon = 0;</div>
<div class="line"><span class="lineno">11138</span>  t0.tm_mday = 1;</div>
<div class="line"><span class="lineno">11139</span>  t0.tm_hour = 0;</div>
<div class="line"><span class="lineno">11140</span>  t0.tm_min = 0;</div>
<div class="line"><span class="lineno">11141</span>  t0.tm_sec = 0;</div>
<div class="line"><span class="lineno">11142</span> </div>
<div class="line"><span class="lineno">11143</span>  t1.tm_year = year - 1900;</div>
<div class="line"><span class="lineno">11144</span>  t1.tm_mon = mon - 1;</div>
<div class="line"><span class="lineno">11145</span>  t1.tm_mday = day;</div>
<div class="line"><span class="lineno">11146</span>  t1.tm_hour = hour;</div>
<div class="line"><span class="lineno">11147</span>  t1.tm_min = min;</div>
<div class="line"><span class="lineno">11148</span>  t1.tm_sec = sec;</div>
<div class="line"><span class="lineno">11149</span> </div>
<div class="line"><span class="lineno">11150</span>  *jsec = (double) timegm(&amp;t1) - (double) timegm(&amp;t0) + remain;</div>
<div class="line"><span class="lineno">11151</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d6fa50cf378c33b8ba9575d17cffe9c" name="a6d6fa50cf378c33b8ba9575d17cffe9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d6fa50cf378c33b8ba9575d17cffe9c">&#9670;&nbsp;</a></span>timer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timer </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measures and reports elapsed time for named and grouped timers. </p>
<p >The <code>timer</code> function measures elapsed time for a specified named timer and an optional group of timers, accumulating time statistics such as minimum, maximum, and mean elapsed times. It also provides an option to log the timing statistics to an output.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>A string representing the name of the timer. </td></tr>
    <tr><td class="paramname">group</td><td>A string representing the group to which the timer belongs. </td></tr>
    <tr><td class="paramname">output</td><td>An integer flag indicating whether to report the timing statistics (non-zero to report).</td></tr>
  </table>
  </dd>
</dl>
<p>The function keeps track of multiple timers and groups. When called, it:</p><ul>
<li>Gets the current time and calculates the elapsed time since the last call.</li>
<li>Adds the elapsed time to the current timers' statistics.</li>
<li>Reports the statistics if the <code>output</code> parameter is non-zero.</li>
<li>Identifies the IDs of the next timer and group based on the provided <code>name</code> and <code>group</code>.</li>
<li>Checks if the <code>name</code> and <code>group</code> are new, and if so, initializes them.</li>
<li>Saves the starting time for the next measurement.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The function uses OpenMP's <code>omp_get_wtime()</code> to get the current wall time. </dd>
<dd>
The function maintains static arrays and variables to store timer names, groups, and statistics. </dd>
<dd>
The maximum number of timers and groups is defined by the <code>NTIMER</code> macro.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>If the number of timers or groups exceeds <code>NTIMER</code>, the function will trigger an error message.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11155">11155</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11158</span>                    {</div>
<div class="line"><span class="lineno">11159</span> </div>
<div class="line"><span class="lineno">11160</span>  <span class="keyword">static</span> <span class="keywordtype">char</span> names[<a class="code hl_define" href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">NTIMER</a>][100], groups[<a class="code hl_define" href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">NTIMER</a>][100];</div>
<div class="line"><span class="lineno">11161</span> </div>
<div class="line"><span class="lineno">11162</span>  <span class="keyword">static</span> <span class="keywordtype">double</span> rt_name[<a class="code hl_define" href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">NTIMER</a>], rt_group[<a class="code hl_define" href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">NTIMER</a>],</div>
<div class="line"><span class="lineno">11163</span>    rt_min[<a class="code hl_define" href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">NTIMER</a>], rt_max[<a class="code hl_define" href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">NTIMER</a>], dt, t0, t1;</div>
<div class="line"><span class="lineno">11164</span> </div>
<div class="line"><span class="lineno">11165</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> iname = -1, igroup = -1, nname, ngroup, ct_name[<a class="code hl_define" href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">NTIMER</a>];</div>
<div class="line"><span class="lineno">11166</span> </div>
<div class="line"><span class="lineno">11167</span>  <span class="comment">/* Get time... */</span></div>
<div class="line"><span class="lineno">11168</span>  t1 = omp_get_wtime();</div>
<div class="line"><span class="lineno">11169</span>  dt = t1 - t0;</div>
<div class="line"><span class="lineno">11170</span> </div>
<div class="line"><span class="lineno">11171</span>  <span class="comment">/* Add elapsed time to current timers... */</span></div>
<div class="line"><span class="lineno">11172</span>  <span class="keywordflow">if</span> (iname &gt;= 0) {</div>
<div class="line"><span class="lineno">11173</span>    rt_name[iname] += dt;</div>
<div class="line"><span class="lineno">11174</span>    rt_min[iname] = (ct_name[iname] &lt;= 0 ? dt : <a class="code hl_define" href="mptrac_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(rt_min[iname], dt));</div>
<div class="line"><span class="lineno">11175</span>    rt_max[iname] = (ct_name[iname] &lt;= 0 ? dt : <a class="code hl_define" href="mptrac_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(rt_max[iname], dt));</div>
<div class="line"><span class="lineno">11176</span>    ct_name[iname]++;</div>
<div class="line"><span class="lineno">11177</span>  }</div>
<div class="line"><span class="lineno">11178</span>  <span class="keywordflow">if</span> (igroup &gt;= 0)</div>
<div class="line"><span class="lineno">11179</span>    rt_group[igroup] += t1 - t0;</div>
<div class="line"><span class="lineno">11180</span> </div>
<div class="line"><span class="lineno">11181</span>  <span class="comment">/* Report timers... */</span></div>
<div class="line"><span class="lineno">11182</span>  <span class="keywordflow">if</span> (output) {</div>
<div class="line"><span class="lineno">11183</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nname; i++)</div>
<div class="line"><span class="lineno">11184</span>      <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;TIMER_%s = %.3f s    (min= %g s, mean= %g s,&quot;</span></div>
<div class="line"><span class="lineno">11185</span>          <span class="stringliteral">&quot; max= %g s, n= %d)&quot;</span>, names[i], rt_name[i], rt_min[i],</div>
<div class="line"><span class="lineno">11186</span>          rt_name[i] / ct_name[i], rt_max[i], ct_name[i]);</div>
<div class="line"><span class="lineno">11187</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ngroup; i++)</div>
<div class="line"><span class="lineno">11188</span>      <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;TIMER_GROUP_%s = %.3f s&quot;</span>, groups[i], rt_group[i]);</div>
<div class="line"><span class="lineno">11189</span>    <span class="keywordtype">double</span> total = 0.0;</div>
<div class="line"><span class="lineno">11190</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nname; i++)</div>
<div class="line"><span class="lineno">11191</span>      total += rt_name[i];</div>
<div class="line"><span class="lineno">11192</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;TIMER_TOTAL = %.3f s&quot;</span>, total);</div>
<div class="line"><span class="lineno">11193</span>  }</div>
<div class="line"><span class="lineno">11194</span> </div>
<div class="line"><span class="lineno">11195</span>  <span class="comment">/* Identify IDs of next timer... */</span></div>
<div class="line"><span class="lineno">11196</span>  <span class="keywordflow">for</span> (iname = 0; iname &lt; nname; iname++)</div>
<div class="line"><span class="lineno">11197</span>    <span class="keywordflow">if</span> (strcasecmp(name, names[iname]) == 0)</div>
<div class="line"><span class="lineno">11198</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">11199</span>  <span class="keywordflow">for</span> (igroup = 0; igroup &lt; ngroup; igroup++)</div>
<div class="line"><span class="lineno">11200</span>    <span class="keywordflow">if</span> (strcasecmp(group, groups[igroup]) == 0)</div>
<div class="line"><span class="lineno">11201</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">11202</span> </div>
<div class="line"><span class="lineno">11203</span>  <span class="comment">/* Check whether this is a new timer... */</span></div>
<div class="line"><span class="lineno">11204</span>  <span class="keywordflow">if</span> (iname &gt;= nname) {</div>
<div class="line"><span class="lineno">11205</span>    sprintf(names[iname], <span class="stringliteral">&quot;%s&quot;</span>, name);</div>
<div class="line"><span class="lineno">11206</span>    <span class="keywordflow">if</span> ((++nname) &gt;= <a class="code hl_define" href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">NTIMER</a>)</div>
<div class="line"><span class="lineno">11207</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many timers!&quot;</span>);</div>
<div class="line"><span class="lineno">11208</span>  }</div>
<div class="line"><span class="lineno">11209</span> </div>
<div class="line"><span class="lineno">11210</span>  <span class="comment">/* Check whether this is a new group... */</span></div>
<div class="line"><span class="lineno">11211</span>  <span class="keywordflow">if</span> (igroup &gt;= ngroup) {</div>
<div class="line"><span class="lineno">11212</span>    sprintf(groups[igroup], <span class="stringliteral">&quot;%s&quot;</span>, group);</div>
<div class="line"><span class="lineno">11213</span>    <span class="keywordflow">if</span> ((++ngroup) &gt;= <a class="code hl_define" href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">NTIMER</a>)</div>
<div class="line"><span class="lineno">11214</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many groups!&quot;</span>);</div>
<div class="line"><span class="lineno">11215</span>  }</div>
<div class="line"><span class="lineno">11216</span> </div>
<div class="line"><span class="lineno">11217</span>  <span class="comment">/* Save starting time... */</span></div>
<div class="line"><span class="lineno">11218</span>  t0 = t1;</div>
<div class="line"><span class="lineno">11219</span>}</div>
<div class="ttc" id="amptrac_8h_html_ab14495ae1f9667df5d198613bcc8d092"><div class="ttname"><a href="mptrac_8h.html#ab14495ae1f9667df5d198613bcc8d092">NTIMER</a></div><div class="ttdeci">#define NTIMER</div><div class="ttdoc">Maximum number of timers.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l02087">mptrac.h:2087</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c5064804f7b46a4130b5411374a771d" name="a8c5064804f7b46a4130b5411374a771d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c5064804f7b46a4130b5411374a771d">&#9670;&nbsp;</a></span>time_from_filename()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double time_from_filename </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extracts and converts a timestamp from a filename to Julian seconds. </p>
<p >The <code>time_from_filename</code> function parses a given filename to extract a timestamp and converts it to Julian seconds. The timestamp is expected to follow a specific format and position within the filename, defined by the <code>offset</code> parameter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the filename containing the timestamp. </td></tr>
    <tr><td class="paramname">offset</td><td>An integer indicating the position from the end of the filename where the timestamp starts.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The time in Julian seconds as a double.</dd></dl>
<p>The function performs the following steps:</p><ul>
<li>Extracts the year, month, day, hour, and minute components of the timestamp from the filename using the given offset.</li>
<li>Validates the extracted components to ensure they represent a valid date and time.</li>
<li>Converts the validated date and time components to Julian seconds using the <code>time2jsec</code> function.</li>
<li>Returns the computed time in Julian seconds.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The expected format of the timestamp in the filename is <code>YYYY-MM-DD_HH-MM</code> (e.g., "2023-05-27_14-45").</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>If the extracted components do not represent a valid date and time, the function will trigger an error message.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11223">11223</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11225</span>                    {</div>
<div class="line"><span class="lineno">11226</span> </div>
<div class="line"><span class="lineno">11227</span>  <span class="keywordtype">char</span> tstr[10];</div>
<div class="line"><span class="lineno">11228</span> </div>
<div class="line"><span class="lineno">11229</span>  <span class="keywordtype">double</span> t;</div>
<div class="line"><span class="lineno">11230</span> </div>
<div class="line"><span class="lineno">11231</span>  <span class="comment">/* Get time from filename... */</span></div>
<div class="line"><span class="lineno">11232</span>  <span class="keywordtype">int</span> len = (int) strlen(filename);</div>
<div class="line"><span class="lineno">11233</span>  sprintf(tstr, <span class="stringliteral">&quot;%.4s&quot;</span>, &amp;filename[len - offset]);</div>
<div class="line"><span class="lineno">11234</span>  <span class="keywordtype">int</span> year = atoi(tstr);</div>
<div class="line"><span class="lineno">11235</span>  sprintf(tstr, <span class="stringliteral">&quot;%.2s&quot;</span>, &amp;filename[len - offset + 5]);</div>
<div class="line"><span class="lineno">11236</span>  <span class="keywordtype">int</span> mon = atoi(tstr);</div>
<div class="line"><span class="lineno">11237</span>  sprintf(tstr, <span class="stringliteral">&quot;%.2s&quot;</span>, &amp;filename[len - offset + 8]);</div>
<div class="line"><span class="lineno">11238</span>  <span class="keywordtype">int</span> day = atoi(tstr);</div>
<div class="line"><span class="lineno">11239</span>  sprintf(tstr, <span class="stringliteral">&quot;%.2s&quot;</span>, &amp;filename[len - offset + 11]);</div>
<div class="line"><span class="lineno">11240</span>  <span class="keywordtype">int</span> hour = atoi(tstr);</div>
<div class="line"><span class="lineno">11241</span>  sprintf(tstr, <span class="stringliteral">&quot;%.2s&quot;</span>, &amp;filename[len - offset + 14]);</div>
<div class="line"><span class="lineno">11242</span>  <span class="keywordtype">int</span> min = atoi(tstr);</div>
<div class="line"><span class="lineno">11243</span> </div>
<div class="line"><span class="lineno">11244</span>  <span class="comment">/* Check time... */</span></div>
<div class="line"><span class="lineno">11245</span>  <span class="keywordflow">if</span> (year &lt; 1900 || year &gt; 2100 || mon &lt; 1 || mon &gt; 12 || day &lt; 1</div>
<div class="line"><span class="lineno">11246</span>      || day &gt; 31 || hour &lt; 0 || hour &gt; 23 || min &lt; 0 || min &gt; 59)</div>
<div class="line"><span class="lineno">11247</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot read time from filename!&quot;</span>);</div>
<div class="line"><span class="lineno">11248</span> </div>
<div class="line"><span class="lineno">11249</span>  <span class="comment">/* Convert time to Julian seconds... */</span></div>
<div class="line"><span class="lineno">11250</span>  <a class="code hl_function" href="mptrac_8c.html#a578e7ebaa62304182de8fe7ddf144b8f">time2jsec</a>(year, mon, day, hour, min, 0, 0.0, &amp;t);</div>
<div class="line"><span class="lineno">11251</span> </div>
<div class="line"><span class="lineno">11252</span>  <span class="comment">/* Return time... */</span></div>
<div class="line"><span class="lineno">11253</span>  <span class="keywordflow">return</span> t;</div>
<div class="line"><span class="lineno">11254</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a8c5064804f7b46a4130b5411374a771d_cgraph.png" border="0" usemap="#amptrac_8h_a8c5064804f7b46a4130b5411374a771d_cgraph" alt=""/></div>
<map name="amptrac_8h_a8c5064804f7b46a4130b5411374a771d_cgraph" id="amptrac_8h_a8c5064804f7b46a4130b5411374a771d_cgraph">
<area shape="rect" title="Extracts and converts a timestamp from a filename to Julian seconds." alt="" coords="5,5,140,32"/>
<area shape="rect" href="mptrac_8c.html#a578e7ebaa62304182de8fe7ddf144b8f" title="Converts time components to seconds since January 1, 2000, 12:00:00 UTC." alt="" coords="188,5,267,32"/>
</map>
</div>

</div>
</div>
<a id="a90bdbbffe8b8633d84a48d2ddd311180" name="a90bdbbffe8b8633d84a48d2ddd311180"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90bdbbffe8b8633d84a48d2ddd311180">&#9670;&nbsp;</a></span>tropo_weight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tropo_weight </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structclim__t.html">clim_t</a> *&#160;</td>
          <td class="paramname"><em>clim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes a weighting factor based on tropopause pressure. </p>
<p >This function calculates a weighting factor for a given pressure value in relation to the tropopause pressure. The weighting factor is determined as follows:</p><ul>
<li>Returns 1 if the pressure is greater than a calculated upper limit.</li>
<li>Returns 0 if the pressure is less than a calculated lower limit.</li>
<li>Linearly interpolates between 1 and 0 within the range defined by the upper and lower limits.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">clim</td><td>Pointer to the climatology data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Pointer to the atmospheric data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Index of the pressure value to evaluate within the atmospheric data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Weighting factor (double) in the range [0, 1].</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11258">11258</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11261</span>                {</div>
<div class="line"><span class="lineno">11262</span> </div>
<div class="line"><span class="lineno">11263</span>  <span class="comment">/* Get tropopause pressure... */</span></div>
<div class="line"><span class="lineno">11264</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> pt = <a class="code hl_function" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692">clim_tropo</a>(clim, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]);</div>
<div class="line"><span class="lineno">11265</span> </div>
<div class="line"><span class="lineno">11266</span>  <span class="comment">/* Get pressure range... */</span></div>
<div class="line"><span class="lineno">11267</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> p1 = pt * 0.866877899;</div>
<div class="line"><span class="lineno">11268</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> p0 = pt / 0.866877899;</div>
<div class="line"><span class="lineno">11269</span> </div>
<div class="line"><span class="lineno">11270</span>  <span class="comment">/* Get weighting factor... */</span></div>
<div class="line"><span class="lineno">11271</span>  <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &gt; p0)</div>
<div class="line"><span class="lineno">11272</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">11273</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &lt; p1)</div>
<div class="line"><span class="lineno">11274</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">11275</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">11276</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="mptrac_8h.html#aebaef4a0f8136be064bf1d29ce1ced83">LIN</a>(p0, 1.0, p1, 0.0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]);</div>
<div class="line"><span class="lineno">11277</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a90bdbbffe8b8633d84a48d2ddd311180_cgraph.png" border="0" usemap="#amptrac_8h_a90bdbbffe8b8633d84a48d2ddd311180_cgraph" alt=""/></div>
<map name="amptrac_8h_a90bdbbffe8b8633d84a48d2ddd311180_cgraph" id="amptrac_8h_a90bdbbffe8b8633d84a48d2ddd311180_cgraph">
<area shape="rect" title="Computes a weighting factor based on tropopause pressure." alt="" coords="5,31,101,57"/>
<area shape="rect" href="mptrac_8c.html#a4531cb279e09061a6f34a73695c7b692" title="Calculates the tropopause pressure based on climatological data." alt="" coords="149,31,232,57"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="284,5,359,32"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="280,56,363,83"/>
</map>
</div>

</div>
</div>
<a id="a70603265840ed0c76957a2df53dabc5a" name="a70603265840ed0c76957a2df53dabc5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70603265840ed0c76957a2df53dabc5a">&#9670;&nbsp;</a></span>write_atm_asc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_atm_asc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes air parcel data to an ASCII file or gnuplot. </p>
<p >The <code>write_atm_asc</code> function writes the atmospheric data stored in the <code>atm</code> structure to an ASCII file specified by <code>filename</code> or to pipe to gnuplot if requested.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the name of the file to write the data to. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data. </td></tr>
    <tr><td class="paramname">t</td><td>The current time used for filtering and timestamping.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets the time interval for the output data based on the control parameters.</li>
<li>Checks if gnuplot output is requested and, if so, creates a pipe to gnuplot and sets up the plot.</li>
<li>If gnuplot output is not requested, creates an ASCII file for writing.</li>
<li>Writes the header information to the output file, including the description of each column.</li>
<li>Iterates over the particles in the <code>atm</code> structure, filtering by time if specified, and writes the data to the output file.</li>
<li>Closes the output file or gnuplot pipe.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11281">11281</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11285</span>                  {</div>
<div class="line"><span class="lineno">11286</span> </div>
<div class="line"><span class="lineno">11287</span>  FILE *out;</div>
<div class="line"><span class="lineno">11288</span> </div>
<div class="line"><span class="lineno">11289</span>  <span class="comment">/* Set time interval for output... */</span></div>
<div class="line"><span class="lineno">11290</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = t - 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">11291</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t1 = t + 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">11292</span> </div>
<div class="line"><span class="lineno">11293</span>  <span class="comment">/* Check if gnuplot output is requested... */</span></div>
<div class="line"><span class="lineno">11294</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a06975fa14d8c7f7813bf83fa4166f819">atm_gpfile</a>[0] != <span class="charliteral">&#39;-&#39;</span>) {</div>
<div class="line"><span class="lineno">11295</span> </div>
<div class="line"><span class="lineno">11296</span>    <span class="comment">/* Create gnuplot pipe... */</span></div>
<div class="line"><span class="lineno">11297</span>    <span class="keywordflow">if</span> (!(out = popen(<span class="stringliteral">&quot;gnuplot&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">11298</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create pipe to gnuplot!&quot;</span>);</div>
<div class="line"><span class="lineno">11299</span> </div>
<div class="line"><span class="lineno">11300</span>    <span class="comment">/* Set plot filename... */</span></div>
<div class="line"><span class="lineno">11301</span>    fprintf(out, <span class="stringliteral">&quot;set out \&quot;%s.png\&quot;\n&quot;</span>, filename);</div>
<div class="line"><span class="lineno">11302</span> </div>
<div class="line"><span class="lineno">11303</span>    <span class="comment">/* Set time string... */</span></div>
<div class="line"><span class="lineno">11304</span>    <span class="keywordtype">double</span> r;</div>
<div class="line"><span class="lineno">11305</span>    <span class="keywordtype">int</span> year, mon, day, hour, min, sec;</div>
<div class="line"><span class="lineno">11306</span>    <a class="code hl_function" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a>(t, &amp;year, &amp;mon, &amp;day, &amp;hour, &amp;min, &amp;sec, &amp;r);</div>
<div class="line"><span class="lineno">11307</span>    fprintf(out, <span class="stringliteral">&quot;timestr=\&quot;%d-%02d-%02d, %02d:%02d UTC\&quot;\n&quot;</span>,</div>
<div class="line"><span class="lineno">11308</span>            year, mon, day, hour, min);</div>
<div class="line"><span class="lineno">11309</span> </div>
<div class="line"><span class="lineno">11310</span>    <span class="comment">/* Dump gnuplot file to pipe... */</span></div>
<div class="line"><span class="lineno">11311</span>    FILE *in;</div>
<div class="line"><span class="lineno">11312</span>    <span class="keywordflow">if</span> (!(in = fopen(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a06975fa14d8c7f7813bf83fa4166f819">atm_gpfile</a>, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno">11313</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno">11314</span>    <span class="keywordtype">char</span> line[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno">11315</span>    <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in))</div>
<div class="line"><span class="lineno">11316</span>      fprintf(out, <span class="stringliteral">&quot;%s&quot;</span>, line);</div>
<div class="line"><span class="lineno">11317</span>    fclose(in);</div>
<div class="line"><span class="lineno">11318</span>  }</div>
<div class="line"><span class="lineno">11319</span> </div>
<div class="line"><span class="lineno">11320</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">11321</span> </div>
<div class="line"><span class="lineno">11322</span>    <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">11323</span>    <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">11324</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno">11325</span>  }</div>
<div class="line"><span class="lineno">11326</span> </div>
<div class="line"><span class="lineno">11327</span>  <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno">11328</span>  fprintf(out,</div>
<div class="line"><span class="lineno">11329</span>          <span class="stringliteral">&quot;# $1 = time [s]\n&quot;</span></div>
<div class="line"><span class="lineno">11330</span>          <span class="stringliteral">&quot;# $2 = altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno">11331</span>          <span class="stringliteral">&quot;# $3 = longitude [deg]\n&quot;</span> <span class="stringliteral">&quot;# $4 = latitude [deg]\n&quot;</span>);</div>
<div class="line"><span class="lineno">11332</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">11333</span>    fprintf(out, <span class="stringliteral">&quot;# $%i = %s [%s]\n&quot;</span>, iq + 5, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq],</div>
<div class="line"><span class="lineno">11334</span>            ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq]);</div>
<div class="line"><span class="lineno">11335</span>  fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">11336</span> </div>
<div class="line"><span class="lineno">11337</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">11338</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa98efec197e5a7bf0abd5f30ba44de72">atm_stride</a>) {</div>
<div class="line"><span class="lineno">11339</span> </div>
<div class="line"><span class="lineno">11340</span>    <span class="comment">/* Check time... */</span></div>
<div class="line"><span class="lineno">11341</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9279f2a56adc9780721e00e35bed2b3d">atm_filter</a> == 2 &amp;&amp; (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1))</div>
<div class="line"><span class="lineno">11342</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">11343</span> </div>
<div class="line"><span class="lineno">11344</span>    <span class="comment">/* Write output... */</span></div>
<div class="line"><span class="lineno">11345</span>    fprintf(out, <span class="stringliteral">&quot;%.2f %g %g %g&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]),</div>
<div class="line"><span class="lineno">11346</span>            atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]);</div>
<div class="line"><span class="lineno">11347</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">11348</span>      fprintf(out, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><span class="lineno">11349</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9279f2a56adc9780721e00e35bed2b3d">atm_filter</a> == 1 &amp;&amp; (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1))</div>
<div class="line"><span class="lineno">11350</span>        fprintf(out, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq], NAN);</div>
<div class="line"><span class="lineno">11351</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">11352</span>        fprintf(out, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq], atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq][ip]);</div>
<div class="line"><span class="lineno">11353</span>    }</div>
<div class="line"><span class="lineno">11354</span>    fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">11355</span>  }</div>
<div class="line"><span class="lineno">11356</span> </div>
<div class="line"><span class="lineno">11357</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">11358</span>  fclose(out);</div>
<div class="line"><span class="lineno">11359</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a70603265840ed0c76957a2df53dabc5a_cgraph.png" border="0" usemap="#amptrac_8h_a70603265840ed0c76957a2df53dabc5a_cgraph" alt=""/></div>
<map name="amptrac_8h_a70603265840ed0c76957a2df53dabc5a_cgraph" id="amptrac_8h_a70603265840ed0c76957a2df53dabc5a_cgraph">
<area shape="rect" title="Writes air parcel data to an ASCII file or gnuplot." alt="" coords="5,5,112,32"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="160,5,239,32"/>
</map>
</div>

</div>
</div>
<a id="af40f268fa1f23a997abbebc49d4c88d2" name="af40f268fa1f23a997abbebc49d4c88d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af40f268fa1f23a997abbebc49d4c88d2">&#9670;&nbsp;</a></span>write_atm_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_atm_bin </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes air parcel data to a binary file. </p>
<p >The <code>write_atm_bin</code> function writes the air parcel data stored in the <code>atm</code> structure to a binary file specified by <code>filename</code>. The function includes versioning information and ensures that all relevant data arrays are written in a consistent binary format.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the name of the file to write the data to. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Creates the binary file for writing. If the file cannot be created, it triggers an error message.</li>
<li>Writes a version number for the binary data format.</li>
<li>Writes the number of particles to the file.</li>
<li>Writes the time, pressure, longitude, and latitude arrays to the file.</li>
<li>Iterates over the quantities specified in the <code>ctl</code> structure and writes each quantity array to the file.</li>
<li>Writes a final flag to indicate the end of the binary data.</li>
<li>Closes the file.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11363">11363</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11366</span>                    {</div>
<div class="line"><span class="lineno">11367</span> </div>
<div class="line"><span class="lineno">11368</span>  FILE *out;</div>
<div class="line"><span class="lineno">11369</span> </div>
<div class="line"><span class="lineno">11370</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">11371</span>  <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">11372</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno">11373</span> </div>
<div class="line"><span class="lineno">11374</span>  <span class="comment">/* Write version of binary data... */</span></div>
<div class="line"><span class="lineno">11375</span>  <span class="keywordtype">int</span> version = 100;</div>
<div class="line"><span class="lineno">11376</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;version, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">11377</span>         1,</div>
<div class="line"><span class="lineno">11378</span>         out);</div>
<div class="line"><span class="lineno">11379</span> </div>
<div class="line"><span class="lineno">11380</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">11381</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">11382</span>         1,</div>
<div class="line"><span class="lineno">11383</span>         out);</div>
<div class="line"><span class="lineno">11384</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11385</span>           (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>,</div>
<div class="line"><span class="lineno">11386</span>         out);</div>
<div class="line"><span class="lineno">11387</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11388</span>           (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>,</div>
<div class="line"><span class="lineno">11389</span>         out);</div>
<div class="line"><span class="lineno">11390</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11391</span>           (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>,</div>
<div class="line"><span class="lineno">11392</span>         out);</div>
<div class="line"><span class="lineno">11393</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11394</span>           (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>,</div>
<div class="line"><span class="lineno">11395</span>         out);</div>
<div class="line"><span class="lineno">11396</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">11397</span>    <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11398</span>             (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>,</div>
<div class="line"><span class="lineno">11399</span>           out);</div>
<div class="line"><span class="lineno">11400</span> </div>
<div class="line"><span class="lineno">11401</span>  <span class="comment">/* Write final flag... */</span></div>
<div class="line"><span class="lineno">11402</span>  <span class="keywordtype">int</span> <span class="keyword">final</span> = 999;</div>
<div class="line"><span class="lineno">11403</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;<span class="keyword">final</span>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">11404</span>         1,</div>
<div class="line"><span class="lineno">11405</span>         out);</div>
<div class="line"><span class="lineno">11406</span> </div>
<div class="line"><span class="lineno">11407</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">11408</span>  fclose(out);</div>
<div class="line"><span class="lineno">11409</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acdc1746c0cf47f3116b471f66f6a3e0c" name="acdc1746c0cf47f3116b471f66f6a3e0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdc1746c0cf47f3116b471f66f6a3e0c">&#9670;&nbsp;</a></span>write_atm_clams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_atm_clams </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes air parcel data to a NetCDF file in the CLaMS format. </p>
<p >The <code>write_atm_clams</code> function creates a NetCDF file and writes air parcel data into it. The data includes time, latitude, longitude, pressure, and other specified quantities. The function defines the dimensions and variables, sets global attributes, and writes the data to the file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the name of the output file. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Creates the NetCDF file with the specified filename.</li>
<li>Defines the dimensions for time and the number of particles (NPARTS).</li>
<li>Defines variables for time, latitude, longitude, pressure, zeta, and other quantities.</li>
<li>Sets global attributes for the vertical coordinate name and model.</li>
<li>Writes the data into the NetCDF file.</li>
<li>Closes the NetCDF file after writing.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11413">11413</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11416</span>                    {</div>
<div class="line"><span class="lineno">11417</span> </div>
<div class="line"><span class="lineno">11418</span>  <span class="keywordtype">int</span> tid, pid, ncid, varid;</div>
<div class="line"><span class="lineno">11419</span>  <span class="keywordtype">size_t</span> start[2], count[2];</div>
<div class="line"><span class="lineno">11420</span> </div>
<div class="line"><span class="lineno">11421</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">11422</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_create(filename, NC_NETCDF4, &amp;ncid));</div>
<div class="line"><span class="lineno">11423</span> </div>
<div class="line"><span class="lineno">11424</span>  <span class="comment">/* Define dimensions... */</span></div>
<div class="line"><span class="lineno">11425</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;time&quot;</span>, 1, &amp;tid));</div>
<div class="line"><span class="lineno">11426</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;NPARTS&quot;</span>, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, &amp;pid));</div>
<div class="line"><span class="lineno">11427</span> </div>
<div class="line"><span class="lineno">11428</span>  <span class="comment">/* Define variables and their attributes... */</span></div>
<div class="line"><span class="lineno">11429</span>  <span class="keywordtype">int</span> dim_ids[2] = { tid, pid };</div>
<div class="line"><span class="lineno">11430</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;time&quot;</span>, NC_DOUBLE, 1, &amp;tid, <span class="stringliteral">&quot;Time&quot;</span>,</div>
<div class="line"><span class="lineno">11431</span>             <span class="stringliteral">&quot;seconds since 2000-01-01 00:00:00 UTC&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11432</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;LAT&quot;</span>, NC_DOUBLE, 1, &amp;pid, <span class="stringliteral">&quot;Latitude&quot;</span>, <span class="stringliteral">&quot;deg&quot;</span>,</div>
<div class="line"><span class="lineno">11433</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11434</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;LON&quot;</span>, NC_DOUBLE, 1, &amp;pid, <span class="stringliteral">&quot;Longitude&quot;</span>, <span class="stringliteral">&quot;deg&quot;</span>,</div>
<div class="line"><span class="lineno">11435</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11436</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;PRESS&quot;</span>, NC_DOUBLE, 1, &amp;pid, <span class="stringliteral">&quot;Pressure&quot;</span>, <span class="stringliteral">&quot;hPa&quot;</span>,</div>
<div class="line"><span class="lineno">11437</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11438</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;ZETA&quot;</span>, NC_DOUBLE, 1, &amp;pid, <span class="stringliteral">&quot;Zeta&quot;</span>, <span class="stringliteral">&quot;K&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11439</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">11440</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], NC_DOUBLE, 2, dim_ids,</div>
<div class="line"><span class="lineno">11441</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq],</div>
<div class="line"><span class="lineno">11442</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac13bb67666a0310b0f8b591e1d2a29bb">atm_nc_quant</a>[iq]);</div>
<div class="line"><span class="lineno">11443</span> </div>
<div class="line"><span class="lineno">11444</span>  <span class="comment">/* Define global attributes... */</span></div>
<div class="line"><span class="lineno">11445</span>  <a class="code hl_define" href="mptrac_8h.html#a218e2f27b530e30c0905d28be265e00f">NC_PUT_ATT_GLOBAL</a>(<span class="stringliteral">&quot;exp_VERTCOOR_name&quot;</span>, <span class="stringliteral">&quot;zeta&quot;</span>);</div>
<div class="line"><span class="lineno">11446</span>  <a class="code hl_define" href="mptrac_8h.html#a218e2f27b530e30c0905d28be265e00f">NC_PUT_ATT_GLOBAL</a>(<span class="stringliteral">&quot;model&quot;</span>, <span class="stringliteral">&quot;MPTRAC&quot;</span>);</div>
<div class="line"><span class="lineno">11447</span> </div>
<div class="line"><span class="lineno">11448</span>  <span class="comment">/* End definitions... */</span></div>
<div class="line"><span class="lineno">11449</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_enddef(ncid));</div>
<div class="line"><span class="lineno">11450</span> </div>
<div class="line"><span class="lineno">11451</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">11452</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;time&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 0);</div>
<div class="line"><span class="lineno">11453</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;LAT&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, 0);</div>
<div class="line"><span class="lineno">11454</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;LON&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, 0);</div>
<div class="line"><span class="lineno">11455</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;PRESS&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, 0);</div>
<div class="line"><span class="lineno">11456</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;ZETA&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6dcfd67edca4a35aeca78f6bfbd04487">qnt_zeta_d</a>], 0);</div>
<div class="line"><span class="lineno">11457</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">11458</span>    <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq], 0);</div>
<div class="line"><span class="lineno">11459</span> </div>
<div class="line"><span class="lineno">11460</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">11461</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno">11462</span>}</div>
<div class="ttc" id="amptrac_8h_html_a218e2f27b530e30c0905d28be265e00f"><div class="ttname"><a href="mptrac_8h.html#a218e2f27b530e30c0905d28be265e00f">NC_PUT_ATT_GLOBAL</a></div><div class="ttdeci">#define NC_PUT_ATT_GLOBAL(attname, text)</div><div class="ttdoc">Add a global text attribute to a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01366">mptrac.h:1366</a></div></div>
<div class="ttc" id="amptrac_8h_html_acca20163a6d11e1ee94426b2e44d5c17"><div class="ttname"><a href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a></div><div class="ttdeci">#define NC_DEF_VAR(varname, type, ndims, dims, long_name, units, level, quant)</div><div class="ttdoc">Define a NetCDF variable with attributes.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01196">mptrac.h:1196</a></div></div>
<div class="ttc" id="amptrac_8h_html_ae8b2166768c41952fc7e05faef7bb593"><div class="ttname"><a href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a></div><div class="ttdeci">#define NC_PUT_DOUBLE(varname, ptr, hyperslab)</div><div class="ttdoc">Write double precision data to a NetCDF variable.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01280">mptrac.h:1280</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a094daf77749905feec48a3e69fb779e1" name="a094daf77749905feec48a3e69fb779e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a094daf77749905feec48a3e69fb779e1">&#9670;&nbsp;</a></span>write_atm_clams_traj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_atm_clams_traj </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dirname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes CLaMS trajectory data to a NetCDF file. </p>
<p >The <code>write_atm_clams_traj</code> function writes trajectory data for the CLaMS model to a NetCDF file. The file is created and populated with data including time, latitude, longitude, pressure, and other quantities. The function also handles the creation of a final initialization file at the last time step.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dirname</td><td>A string representing the directory name where the file will be created. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data. </td></tr>
    <tr><td class="paramname">t</td><td>The current time in seconds since a reference epoch.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Determines the start and stop times of the calculation.</li>
<li>Constructs the output filename based on the start and stop times.</li>
<li>Defines the hyperslab for the trajectory file.</li>
<li>Creates the NetCDF file if it's the first time step and defines dimensions and variables.</li>
<li>Writes the trajectory data to the NetCDF file.</li>
<li>At the last time step, creates an initialization file with the final data.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Jan Clemens </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11466">11466</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11470</span>                  {</div>
<div class="line"><span class="lineno">11471</span> </div>
<div class="line"><span class="lineno">11472</span>  <span class="comment">/* Global Counter... */</span></div>
<div class="line"><span class="lineno">11473</span>  <span class="keyword">static</span> <span class="keywordtype">size_t</span> out_cnt = 0;</div>
<div class="line"><span class="lineno">11474</span> </div>
<div class="line"><span class="lineno">11475</span>  <span class="keywordtype">double</span> r, r_start, r_stop;</div>
<div class="line"><span class="lineno">11476</span>  <span class="keywordtype">int</span> year, mon, day, hour, min, sec;</div>
<div class="line"><span class="lineno">11477</span>  <span class="keywordtype">int</span> year_start, mon_start, day_start, hour_start, min_start, sec_start;</div>
<div class="line"><span class="lineno">11478</span>  <span class="keywordtype">int</span> year_stop, mon_stop, day_stop, hour_stop, min_stop, sec_stop;</div>
<div class="line"><span class="lineno">11479</span>  <span class="keywordtype">char</span> filename_out[2 * <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>] = <span class="stringliteral">&quot;traj_fix_3d_YYYYMMDDHH_YYYYMMDDHH.nc&quot;</span>;</div>
<div class="line"><span class="lineno">11480</span> </div>
<div class="line"><span class="lineno">11481</span>  <span class="keywordtype">int</span> ncid, varid, tid, pid, cid;</div>
<div class="line"><span class="lineno">11482</span>  <span class="keywordtype">int</span> dim_ids[2];</div>
<div class="line"><span class="lineno">11483</span> </div>
<div class="line"><span class="lineno">11484</span>  <span class="comment">/* time, nparc */</span></div>
<div class="line"><span class="lineno">11485</span>  <span class="keywordtype">size_t</span> start[2];</div>
<div class="line"><span class="lineno">11486</span>  <span class="keywordtype">size_t</span> count[2];</div>
<div class="line"><span class="lineno">11487</span> </div>
<div class="line"><span class="lineno">11488</span>  <span class="comment">/* Determine start and stop times of calculation... */</span></div>
<div class="line"><span class="lineno">11489</span>  <a class="code hl_function" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a>(t, &amp;year, &amp;mon, &amp;day, &amp;hour, &amp;min, &amp;sec, &amp;r);</div>
<div class="line"><span class="lineno">11490</span>  <a class="code hl_function" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a>, &amp;year_start, &amp;mon_start, &amp;day_start, &amp;hour_start,</div>
<div class="line"><span class="lineno">11491</span>            &amp;min_start, &amp;sec_start, &amp;r_start);</div>
<div class="line"><span class="lineno">11492</span>  <a class="code hl_function" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a>, &amp;year_stop, &amp;mon_stop, &amp;day_stop, &amp;hour_stop,</div>
<div class="line"><span class="lineno">11493</span>            &amp;min_stop, &amp;sec_stop, &amp;r_stop);</div>
<div class="line"><span class="lineno">11494</span> </div>
<div class="line"><span class="lineno">11495</span>  sprintf(filename_out,</div>
<div class="line"><span class="lineno">11496</span>          <span class="stringliteral">&quot;%s/traj_fix_3d_%02d%02d%02d%02d_%02d%02d%02d%02d.nc&quot;</span>, dirname,</div>
<div class="line"><span class="lineno">11497</span>          year_start % 100, mon_start, day_start, hour_start,</div>
<div class="line"><span class="lineno">11498</span>          year_stop % 100, mon_stop, day_stop, hour_stop);</div>
<div class="line"><span class="lineno">11499</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write traj file: %s&quot;</span>, filename_out);</div>
<div class="line"><span class="lineno">11500</span> </div>
<div class="line"><span class="lineno">11501</span>  <span class="comment">/* Define hyperslap for the traj_file... */</span></div>
<div class="line"><span class="lineno">11502</span>  start[0] = out_cnt;</div>
<div class="line"><span class="lineno">11503</span>  start[1] = 0;</div>
<div class="line"><span class="lineno">11504</span>  count[0] = 1;</div>
<div class="line"><span class="lineno">11505</span>  count[1] = (size_t) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>;</div>
<div class="line"><span class="lineno">11506</span> </div>
<div class="line"><span class="lineno">11507</span>  <span class="comment">/* Create the file at the first timestep... */</span></div>
<div class="line"><span class="lineno">11508</span>  if (out_cnt == 0) {</div>
<div class="line"><span class="lineno">11509</span> </div>
<div class="line"><span class="lineno">11510</span>    <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">11511</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_create(filename_out, NC_NETCDF4, &amp;ncid));</div>
<div class="line"><span class="lineno">11512</span> </div>
<div class="line"><span class="lineno">11513</span>    <span class="comment">/* Define dimensions... */</span></div>
<div class="line"><span class="lineno">11514</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;time&quot;</span>, NC_UNLIMITED, &amp;tid));</div>
<div class="line"><span class="lineno">11515</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;NPARTS&quot;</span>, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, &amp;pid));</div>
<div class="line"><span class="lineno">11516</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;TMDT&quot;</span>, 7, &amp;cid));</div>
<div class="line"><span class="lineno">11517</span>    dim_ids[0] = tid;</div>
<div class="line"><span class="lineno">11518</span>    dim_ids[1] = pid;</div>
<div class="line"><span class="lineno">11519</span> </div>
<div class="line"><span class="lineno">11520</span>    <span class="comment">/* Define variables and their attributes... */</span></div>
<div class="line"><span class="lineno">11521</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;time&quot;</span>, NC_DOUBLE, 1, &amp;tid, <span class="stringliteral">&quot;Time&quot;</span>,</div>
<div class="line"><span class="lineno">11522</span>               <span class="stringliteral">&quot;seconds since 2000-01-01 00:00:00 UTC&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11523</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;LAT&quot;</span>, NC_DOUBLE, 2, dim_ids, <span class="stringliteral">&quot;Latitude&quot;</span>, <span class="stringliteral">&quot;deg&quot;</span>,</div>
<div class="line"><span class="lineno">11524</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11525</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;LON&quot;</span>, NC_DOUBLE, 2, dim_ids, <span class="stringliteral">&quot;Longitude&quot;</span>, <span class="stringliteral">&quot;deg&quot;</span>,</div>
<div class="line"><span class="lineno">11526</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11527</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;PRESS&quot;</span>, NC_DOUBLE, 2, dim_ids, <span class="stringliteral">&quot;Pressure&quot;</span>, <span class="stringliteral">&quot;hPa&quot;</span>,</div>
<div class="line"><span class="lineno">11528</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11529</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;ZETA&quot;</span>, NC_DOUBLE, 2, dim_ids, <span class="stringliteral">&quot;Zeta&quot;</span>, <span class="stringliteral">&quot;K&quot;</span>,</div>
<div class="line"><span class="lineno">11530</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11531</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">11532</span>      <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], NC_DOUBLE, 2, dim_ids,</div>
<div class="line"><span class="lineno">11533</span>                 ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq],</div>
<div class="line"><span class="lineno">11534</span>                 ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac13bb67666a0310b0f8b591e1d2a29bb">atm_nc_quant</a>[iq]);</div>
<div class="line"><span class="lineno">11535</span> </div>
<div class="line"><span class="lineno">11536</span>    <span class="comment">/* Define global attributes... */</span></div>
<div class="line"><span class="lineno">11537</span>    <a class="code hl_define" href="mptrac_8h.html#a218e2f27b530e30c0905d28be265e00f">NC_PUT_ATT_GLOBAL</a>(<span class="stringliteral">&quot;exp_VERTCOOR_name&quot;</span>, <span class="stringliteral">&quot;zeta&quot;</span>);</div>
<div class="line"><span class="lineno">11538</span>    <a class="code hl_define" href="mptrac_8h.html#a218e2f27b530e30c0905d28be265e00f">NC_PUT_ATT_GLOBAL</a>(<span class="stringliteral">&quot;model&quot;</span>, <span class="stringliteral">&quot;MPTRAC&quot;</span>);</div>
<div class="line"><span class="lineno">11539</span> </div>
<div class="line"><span class="lineno">11540</span>    <span class="comment">/* End definitions... */</span></div>
<div class="line"><span class="lineno">11541</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_enddef(ncid));</div>
<div class="line"><span class="lineno">11542</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno">11543</span>  }</div>
<div class="line"><span class="lineno">11544</span> </div>
<div class="line"><span class="lineno">11545</span>  <span class="comment">/* Increment global counter to change hyperslap... */</span></div>
<div class="line"><span class="lineno">11546</span>  out_cnt++;</div>
<div class="line"><span class="lineno">11547</span> </div>
<div class="line"><span class="lineno">11548</span>  <span class="comment">/* Open file... */</span></div>
<div class="line"><span class="lineno">11549</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_open(filename_out, NC_WRITE, &amp;ncid));</div>
<div class="line"><span class="lineno">11550</span> </div>
<div class="line"><span class="lineno">11551</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">11552</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;time&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 1);</div>
<div class="line"><span class="lineno">11553</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;LAT&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, 1);</div>
<div class="line"><span class="lineno">11554</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;LON&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, 1);</div>
<div class="line"><span class="lineno">11555</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;PRESS&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, 1);</div>
<div class="line"><span class="lineno">11556</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad9524b57f1aaace70190a78966fc5076">advect_vert_coord</a> == 1) {</div>
<div class="line"><span class="lineno">11557</span>    <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;ZETA&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9382d9e9b29e10eeee582e1e10ff365a">qnt_zeta</a>], 1);</div>
<div class="line"><span class="lineno">11558</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9382d9e9b29e10eeee582e1e10ff365a">qnt_zeta</a> &gt;= 0) {</div>
<div class="line"><span class="lineno">11559</span>    <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;ZETA&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6dcfd67edca4a35aeca78f6bfbd04487">qnt_zeta_d</a>], 1);</div>
<div class="line"><span class="lineno">11560</span>  }</div>
<div class="line"><span class="lineno">11561</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">11562</span>    <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq], 1);</div>
<div class="line"><span class="lineno">11563</span> </div>
<div class="line"><span class="lineno">11564</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">11565</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno">11566</span> </div>
<div class="line"><span class="lineno">11567</span>  <span class="comment">/* At the last time step create the init_fix_YYYYMMDDHH file... */</span></div>
<div class="line"><span class="lineno">11568</span>  <span class="keywordflow">if</span> ((year == year_stop) &amp;&amp; (mon == mon_stop)</div>
<div class="line"><span class="lineno">11569</span>      &amp;&amp; (day == day_stop) &amp;&amp; (hour == hour_stop)) {</div>
<div class="line"><span class="lineno">11570</span> </div>
<div class="line"><span class="lineno">11571</span>    <span class="comment">/* Set filename... */</span></div>
<div class="line"><span class="lineno">11572</span>    <span class="keywordtype">char</span> filename_init[2 * <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>] = <span class="stringliteral">&quot;./init_fix_YYYYMMDDHH.nc&quot;</span>;</div>
<div class="line"><span class="lineno">11573</span>    sprintf(filename_init, <span class="stringliteral">&quot;%s/init_fix_%02d%02d%02d%02d.nc&quot;</span>,</div>
<div class="line"><span class="lineno">11574</span>            dirname, year_stop % 100, mon_stop, day_stop, hour_stop);</div>
<div class="line"><span class="lineno">11575</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write init file: %s&quot;</span>, filename_init);</div>
<div class="line"><span class="lineno">11576</span> </div>
<div class="line"><span class="lineno">11577</span>    <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">11578</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_create(filename_init, NC_NETCDF4, &amp;ncid));</div>
<div class="line"><span class="lineno">11579</span> </div>
<div class="line"><span class="lineno">11580</span>    <span class="comment">/* Define dimensions... */</span></div>
<div class="line"><span class="lineno">11581</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;time&quot;</span>, 1, &amp;tid));</div>
<div class="line"><span class="lineno">11582</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;NPARTS&quot;</span>, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, &amp;pid));</div>
<div class="line"><span class="lineno">11583</span>    dim_ids[0] = tid;</div>
<div class="line"><span class="lineno">11584</span>    dim_ids[1] = pid;</div>
<div class="line"><span class="lineno">11585</span> </div>
<div class="line"><span class="lineno">11586</span>    <span class="comment">/* Define variables and their attributes... */</span></div>
<div class="line"><span class="lineno">11587</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;time&quot;</span>, NC_DOUBLE, 1, &amp;tid, <span class="stringliteral">&quot;Time&quot;</span>,</div>
<div class="line"><span class="lineno">11588</span>               <span class="stringliteral">&quot;seconds since 2000-01-01 00:00:00 UTC&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11589</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;LAT&quot;</span>, NC_DOUBLE, 1, &amp;pid, <span class="stringliteral">&quot;Latitude&quot;</span>, <span class="stringliteral">&quot;deg&quot;</span>,</div>
<div class="line"><span class="lineno">11590</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11591</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;LON&quot;</span>, NC_DOUBLE, 1, &amp;pid, <span class="stringliteral">&quot;Longitude&quot;</span>, <span class="stringliteral">&quot;deg&quot;</span>,</div>
<div class="line"><span class="lineno">11592</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11593</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;PRESS&quot;</span>, NC_DOUBLE, 1, &amp;pid, <span class="stringliteral">&quot;Pressure&quot;</span>, <span class="stringliteral">&quot;hPa&quot;</span>,</div>
<div class="line"><span class="lineno">11594</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11595</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;ZETA&quot;</span>, NC_DOUBLE, 1, &amp;pid, <span class="stringliteral">&quot;Zeta&quot;</span>, <span class="stringliteral">&quot;K&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11596</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">11597</span>      <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], NC_DOUBLE, 2, dim_ids,</div>
<div class="line"><span class="lineno">11598</span>                 ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq],</div>
<div class="line"><span class="lineno">11599</span>                 ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac13bb67666a0310b0f8b591e1d2a29bb">atm_nc_quant</a>[iq]);</div>
<div class="line"><span class="lineno">11600</span> </div>
<div class="line"><span class="lineno">11601</span>    <span class="comment">/* Define global attributes... */</span></div>
<div class="line"><span class="lineno">11602</span>    <a class="code hl_define" href="mptrac_8h.html#a218e2f27b530e30c0905d28be265e00f">NC_PUT_ATT_GLOBAL</a>(<span class="stringliteral">&quot;exp_VERTCOOR_name&quot;</span>, <span class="stringliteral">&quot;zeta&quot;</span>);</div>
<div class="line"><span class="lineno">11603</span>    <a class="code hl_define" href="mptrac_8h.html#a218e2f27b530e30c0905d28be265e00f">NC_PUT_ATT_GLOBAL</a>(<span class="stringliteral">&quot;model&quot;</span>, <span class="stringliteral">&quot;MPTRAC&quot;</span>);</div>
<div class="line"><span class="lineno">11604</span> </div>
<div class="line"><span class="lineno">11605</span>    <span class="comment">/* End definitions... */</span></div>
<div class="line"><span class="lineno">11606</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_enddef(ncid));</div>
<div class="line"><span class="lineno">11607</span> </div>
<div class="line"><span class="lineno">11608</span>    <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">11609</span>    <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;time&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 0);</div>
<div class="line"><span class="lineno">11610</span>    <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;LAT&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, 0);</div>
<div class="line"><span class="lineno">11611</span>    <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;LON&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, 0);</div>
<div class="line"><span class="lineno">11612</span>    <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;PRESS&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, 0);</div>
<div class="line"><span class="lineno">11613</span>    <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;ZETA&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6dcfd67edca4a35aeca78f6bfbd04487">qnt_zeta_d</a>], 0);</div>
<div class="line"><span class="lineno">11614</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">11615</span>      <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq], 0);</div>
<div class="line"><span class="lineno">11616</span> </div>
<div class="line"><span class="lineno">11617</span>    <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">11618</span>    <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno">11619</span>  }</div>
<div class="line"><span class="lineno">11620</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a094daf77749905feec48a3e69fb779e1_cgraph.png" border="0" usemap="#amptrac_8h_a094daf77749905feec48a3e69fb779e1_cgraph" alt=""/></div>
<map name="amptrac_8h_a094daf77749905feec48a3e69fb779e1_cgraph" id="amptrac_8h_a094daf77749905feec48a3e69fb779e1_cgraph">
<area shape="rect" title="Writes CLaMS trajectory data to a NetCDF file." alt="" coords="5,5,152,32"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="200,5,279,32"/>
</map>
</div>

</div>
</div>
<a id="aff66d76a0f9415997955f47edeff5b99" name="aff66d76a0f9415997955f47edeff5b99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff66d76a0f9415997955f47edeff5b99">&#9670;&nbsp;</a></span>write_atm_nc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_atm_nc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes air parcel data to a NetCDF file. </p>
<p >The <code>write_atm_nc</code> function creates a NetCDF file and writes air parcel data into it. The data includes time, pressure, longitude, latitude, and other specified quantities. The function defines the dimensions and variables, sets global attributes, and writes the data to the file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the name of the output file. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Creates the NetCDF file with the specified filename.</li>
<li>Defines the dimension for the number of observations (obs).</li>
<li>Defines variables for time, pressure, longitude, latitude, and other quantities.</li>
<li>Sets global attributes for the feature type.</li>
<li>Writes the data into the NetCDF file.</li>
<li>Closes the NetCDF file after writing.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11624">11624</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11627</span>                    {</div>
<div class="line"><span class="lineno">11628</span> </div>
<div class="line"><span class="lineno">11629</span>  <span class="keywordtype">int</span> ncid, obsid, varid;</div>
<div class="line"><span class="lineno">11630</span> </div>
<div class="line"><span class="lineno">11631</span>  <span class="keywordtype">size_t</span> start[2], count[2];</div>
<div class="line"><span class="lineno">11632</span> </div>
<div class="line"><span class="lineno">11633</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">11634</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_create(filename, NC_NETCDF4, &amp;ncid));</div>
<div class="line"><span class="lineno">11635</span> </div>
<div class="line"><span class="lineno">11636</span>  <span class="comment">/* Define dimensions... */</span></div>
<div class="line"><span class="lineno">11637</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;obs&quot;</span>, (<span class="keywordtype">size_t</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>, &amp;obsid));</div>
<div class="line"><span class="lineno">11638</span> </div>
<div class="line"><span class="lineno">11639</span>  <span class="comment">/* Define variables and their attributes... */</span></div>
<div class="line"><span class="lineno">11640</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;time&quot;</span>, NC_DOUBLE, 1, &amp;obsid, <span class="stringliteral">&quot;time&quot;</span>,</div>
<div class="line"><span class="lineno">11641</span>             <span class="stringliteral">&quot;seconds since 2000-01-01 00:00:00 UTC&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11642</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;press&quot;</span>, NC_DOUBLE, 1, &amp;obsid, <span class="stringliteral">&quot;pressure&quot;</span>, <span class="stringliteral">&quot;hPa&quot;</span>,</div>
<div class="line"><span class="lineno">11643</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11644</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;lon&quot;</span>, NC_DOUBLE, 1, &amp;obsid, <span class="stringliteral">&quot;longitude&quot;</span>, <span class="stringliteral">&quot;degrees_east&quot;</span>,</div>
<div class="line"><span class="lineno">11645</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11646</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;lat&quot;</span>, NC_DOUBLE, 1, &amp;obsid, <span class="stringliteral">&quot;latitude&quot;</span>, <span class="stringliteral">&quot;degrees_north&quot;</span>,</div>
<div class="line"><span class="lineno">11647</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">11648</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">11649</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], NC_DOUBLE, 1, &amp;obsid,</div>
<div class="line"><span class="lineno">11650</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aef44654a72cbb96ba47c6284bd5f2316">qnt_longname</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq],</div>
<div class="line"><span class="lineno">11651</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#adbebe57221067b42b5f3186a40d06128">atm_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac13bb67666a0310b0f8b591e1d2a29bb">atm_nc_quant</a>[iq]);</div>
<div class="line"><span class="lineno">11652</span> </div>
<div class="line"><span class="lineno">11653</span>  <span class="comment">/* Define global attributes... */</span></div>
<div class="line"><span class="lineno">11654</span>  <a class="code hl_define" href="mptrac_8h.html#a218e2f27b530e30c0905d28be265e00f">NC_PUT_ATT_GLOBAL</a>(<span class="stringliteral">&quot;featureType&quot;</span>, <span class="stringliteral">&quot;point&quot;</span>);</div>
<div class="line"><span class="lineno">11655</span> </div>
<div class="line"><span class="lineno">11656</span>  <span class="comment">/* End definitions... */</span></div>
<div class="line"><span class="lineno">11657</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_enddef(ncid));</div>
<div class="line"><span class="lineno">11658</span> </div>
<div class="line"><span class="lineno">11659</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">11660</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;time&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>, 0);</div>
<div class="line"><span class="lineno">11661</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;press&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>, 0);</div>
<div class="line"><span class="lineno">11662</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;lon&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>, 0);</div>
<div class="line"><span class="lineno">11663</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;lat&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>, 0);</div>
<div class="line"><span class="lineno">11664</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">11665</span>    <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq], 0);</div>
<div class="line"><span class="lineno">11666</span> </div>
<div class="line"><span class="lineno">11667</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">11668</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno">11669</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afe2f86cb96a4de47d262cf7776164d46" name="afe2f86cb96a4de47d262cf7776164d46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe2f86cb96a4de47d262cf7776164d46">&#9670;&nbsp;</a></span>write_csi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_csi </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes Critical Success Index (CSI) data to a file. </p>
<p >The <code>write_csi</code> function processes air parcel and observation data to calculate and write various verification statistics, including the Critical Success Index (CSI), to a specified output file at regular intervals. The statistics include measures such as the number of hits, misses, and false alarms, bias, probability of detection, false alarm rate, equitable threat score, and correlation coefficients.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the name of the output file. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data. </td></tr>
    <tr><td class="paramname">t</td><td>A double representing the current time.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Initializes resources and sets up the output file if the current time is the start time.</li>
<li>Reads observation data and kernel data if provided.</li>
<li>Sets grid box sizes and horizontal coordinates.</li>
<li>Allocates memory for mean and count arrays.</li>
<li>Loops over observations and model data to accumulate mean values and counts.</li>
<li>Analyzes the grid cells to calculate CSI and other statistics.</li>
<li>Writes the calculated statistics to the output file at specified intervals.</li>
<li>Frees allocated resources and closes the file when the processing is complete.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11673">11673</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11677</span>                  {</div>
<div class="line"><span class="lineno">11678</span> </div>
<div class="line"><span class="lineno">11679</span>  <span class="keyword">static</span> FILE *out;</div>
<div class="line"><span class="lineno">11680</span> </div>
<div class="line"><span class="lineno">11681</span>  <span class="keyword">static</span> <span class="keywordtype">double</span> *modmean, *obsmean, *obsstd, *rt, *rz, *rlon, *rlat, *robs,</div>
<div class="line"><span class="lineno">11682</span>    *area, dlon, dlat, dz, x[<a class="code hl_define" href="mptrac_8h.html#ad7d0bf1acdf6b0da23c3ccd8ce8f6caa">NCSI</a>], y[<a class="code hl_define" href="mptrac_8h.html#ad7d0bf1acdf6b0da23c3ccd8ce8f6caa">NCSI</a>], obsstdn[<a class="code hl_define" href="mptrac_8h.html#ad7d0bf1acdf6b0da23c3ccd8ce8f6caa">NCSI</a>], kz[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], kw[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>];</div>
<div class="line"><span class="lineno">11683</span> </div>
<div class="line"><span class="lineno">11684</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> *obscount, nobs, nk;</div>
<div class="line"><span class="lineno">11685</span> </div>
<div class="line"><span class="lineno">11686</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> ct[<a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>], cx[<a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>], cy[<a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>], cz[<a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>], n[<a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>];</div>
<div class="line"><span class="lineno">11687</span> </div>
<div class="line"><span class="lineno">11688</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ensemble = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">nens</a> &gt; 0);</div>
<div class="line"><span class="lineno">11689</span> </div>
<div class="line"><span class="lineno">11690</span>  <span class="comment">/* Set timer */</span></div>
<div class="line"><span class="lineno">11691</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;WRITE_CSI&quot;</span>, <span class="stringliteral">&quot;OUTPUT&quot;</span>);</div>
<div class="line"><span class="lineno">11692</span> </div>
<div class="line"><span class="lineno">11693</span>  <span class="comment">/* Check quantities... */</span></div>
<div class="line"><span class="lineno">11694</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &lt; 0)</div>
<div class="line"><span class="lineno">11695</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Need quantity mass!&quot;</span>);</div>
<div class="line"><span class="lineno">11696</span>  <span class="keywordflow">if</span> (ensemble) {</div>
<div class="line"><span class="lineno">11697</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a> &lt; 0)</div>
<div class="line"><span class="lineno">11698</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Missing ensemble IDs!&quot;</span>);</div>
<div class="line"><span class="lineno">11699</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">nens</a> &gt; <a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>)</div>
<div class="line"><span class="lineno">11700</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many ensembles!&quot;</span>);</div>
<div class="line"><span class="lineno">11701</span>  }</div>
<div class="line"><span class="lineno">11702</span> </div>
<div class="line"><span class="lineno">11703</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno">11704</span>  <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a>) {</div>
<div class="line"><span class="lineno">11705</span> </div>
<div class="line"><span class="lineno">11706</span>    <span class="comment">/* Allocate.. */</span></div>
<div class="line"><span class="lineno">11707</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(area, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11708</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">csi_ny</a>);</div>
<div class="line"><span class="lineno">11709</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rt, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11710</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">11711</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rz, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11712</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">11713</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rlon, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11714</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">11715</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rlat, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11716</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">11717</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(robs, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11718</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">11719</span> </div>
<div class="line"><span class="lineno">11720</span>    <span class="comment">/* Read observation data... */</span></div>
<div class="line"><span class="lineno">11721</span>    <a class="code hl_function" href="mptrac_8c.html#a1365b8fd93db0fc3fe4c467107710d03">read_obs</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a01ea628e12cf0025aa0731f52d13da10">csi_obsfile</a>, ctl, rt, rz, rlon, rlat, robs, &amp;nobs);</div>
<div class="line"><span class="lineno">11722</span> </div>
<div class="line"><span class="lineno">11723</span>    <span class="comment">/* Read kernel data... */</span></div>
<div class="line"><span class="lineno">11724</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a378603f0fe74b4236f45f78bf4bc02dc">csi_kernel</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno">11725</span>      <a class="code hl_function" href="mptrac_8c.html#a7a3277ab872141360b876c25b5643ba6">read_kernel</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a378603f0fe74b4236f45f78bf4bc02dc">csi_kernel</a>, kz, kw, &amp;nk);</div>
<div class="line"><span class="lineno">11726</span> </div>
<div class="line"><span class="lineno">11727</span>    <span class="comment">/* Create new file... */</span></div>
<div class="line"><span class="lineno">11728</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write CSI%s data: %s&quot;</span>, ensemble ? <span class="stringliteral">&quot; ensemble&quot;</span> : <span class="stringliteral">&quot;&quot;</span>, filename);</div>
<div class="line"><span class="lineno">11729</span>    <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">11730</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno">11731</span> </div>
<div class="line"><span class="lineno">11732</span>    <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno">11733</span>    fprintf(out,</div>
<div class="line"><span class="lineno">11734</span>            <span class="stringliteral">&quot;# $1 = time [s]\n&quot;</span></div>
<div class="line"><span class="lineno">11735</span>            <span class="stringliteral">&quot;# $2 = ensemble ID\n&quot;</span></div>
<div class="line"><span class="lineno">11736</span>            <span class="stringliteral">&quot;# $3 = number of hits (cx)\n&quot;</span></div>
<div class="line"><span class="lineno">11737</span>            <span class="stringliteral">&quot;# $4 = number of misses (cy)\n&quot;</span></div>
<div class="line"><span class="lineno">11738</span>            <span class="stringliteral">&quot;# $5 = number of false alarms (cz)\n&quot;</span></div>
<div class="line"><span class="lineno">11739</span>            <span class="stringliteral">&quot;# $6 = number of observations (cx + cy)\n&quot;</span></div>
<div class="line"><span class="lineno">11740</span>            <span class="stringliteral">&quot;# $7 = number of forecasts (cx + cz)\n&quot;</span></div>
<div class="line"><span class="lineno">11741</span>            <span class="stringliteral">&quot;# $8 = bias (%%)\n&quot;</span></div>
<div class="line"><span class="lineno">11742</span>            <span class="stringliteral">&quot;# $9 = POD (%%)\n&quot;</span></div>
<div class="line"><span class="lineno">11743</span>            <span class="stringliteral">&quot;# $10 = FAR (%%)\n&quot;</span></div>
<div class="line"><span class="lineno">11744</span>            <span class="stringliteral">&quot;# $11 = CSI (%%)\n&quot;</span></div>
<div class="line"><span class="lineno">11745</span>            <span class="stringliteral">&quot;# $12 = hits by random chance\n&quot;</span></div>
<div class="line"><span class="lineno">11746</span>            <span class="stringliteral">&quot;# $13 = ETS (%%)\n&quot;</span></div>
<div class="line"><span class="lineno">11747</span>            <span class="stringliteral">&quot;# $14 = Pearson R\n&quot;</span></div>
<div class="line"><span class="lineno">11748</span>            <span class="stringliteral">&quot;# $15 = Spearman R\n&quot;</span></div>
<div class="line"><span class="lineno">11749</span>            <span class="stringliteral">&quot;# $16 = mean error [kg/m]\n&quot;</span></div>
<div class="line"><span class="lineno">11750</span>            <span class="stringliteral">&quot;# $17 = RMSE [kg/m]\n&quot;</span></div>
<div class="line"><span class="lineno">11751</span>            <span class="stringliteral">&quot;# $18 = MAE [kg/m]\n&quot;</span></div>
<div class="line"><span class="lineno">11752</span>            <span class="stringliteral">&quot;# $19 = log-likelihood\n&quot;</span> <span class="stringliteral">&quot;# $20 = number of points\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">11753</span> </div>
<div class="line"><span class="lineno">11754</span>    <span class="comment">/* Set grid box size... */</span></div>
<div class="line"><span class="lineno">11755</span>    dz = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a55a1915a7e8ef2a91a2553a8393b4329">csi_z1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a98aa14528bd795eaf31eae63a33c630f">csi_z0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0409a87481145b01eb3fd61042f35abc">csi_nz</a>;</div>
<div class="line"><span class="lineno">11756</span>    dlon = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0cd8031f829953cb90912d9eecfe67b3">csi_lon1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a396d8bbb52aaf8408e90c207aa7f7312">csi_lon0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a21159a48d018215b1bb5af62214b9063">csi_nx</a>;</div>
<div class="line"><span class="lineno">11757</span>    dlat = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a015b2de1c61e25a2e8abb0fba4a05c24">csi_lat1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a219b7e2f9f53597e84a87d349e32bcb5">csi_lat0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">csi_ny</a>;</div>
<div class="line"><span class="lineno">11758</span> </div>
<div class="line"><span class="lineno">11759</span>    <span class="comment">/* Set horizontal coordinates... */</span></div>
<div class="line"><span class="lineno">11760</span>    for (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">csi_ny</a>; iy++) {</div>
<div class="line"><span class="lineno">11761</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> lat = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a219b7e2f9f53597e84a87d349e32bcb5">csi_lat0</a> + dlat * (iy + 0.5);</div>
<div class="line"><span class="lineno">11762</span>      area[iy] = dlat * dlon * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(<a class="code hl_define" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a> * M_PI / 180.0) * cos(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(lat));</div>
<div class="line"><span class="lineno">11763</span>    }</div>
<div class="line"><span class="lineno">11764</span>  }</div>
<div class="line"><span class="lineno">11765</span> </div>
<div class="line"><span class="lineno">11766</span>  <span class="comment">/* Set time interval... */</span></div>
<div class="line"><span class="lineno">11767</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = t - 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">11768</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t1 = t + 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">11769</span> </div>
<div class="line"><span class="lineno">11770</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">11771</span>  <span class="keywordtype">int</span> grid_size = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a21159a48d018215b1bb5af62214b9063">csi_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">csi_ny</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0409a87481145b01eb3fd61042f35abc">csi_nz</a>;</div>
<div class="line"><span class="lineno">11772</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(modmean, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11773</span>          (ensemble ? ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">nens</a> : 1) * grid_size);</div>
<div class="line"><span class="lineno">11774</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(obsmean, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11775</span>        grid_size);</div>
<div class="line"><span class="lineno">11776</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(obscount, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">11777</span>        grid_size);</div>
<div class="line"><span class="lineno">11778</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(obsstd, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">11779</span>        grid_size);</div>
<div class="line"><span class="lineno">11780</span> </div>
<div class="line"><span class="lineno">11781</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno">11782</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; (ensemble ? ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">nens</a> : 1); i++)</div>
<div class="line"><span class="lineno">11783</span>    ct[i] = cx[i] = cy[i] = cz[i] = n[i] = 0;</div>
<div class="line"><span class="lineno">11784</span> </div>
<div class="line"><span class="lineno">11785</span>  <span class="comment">/* Loop over observations... */</span></div>
<div class="line"><span class="lineno">11786</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nobs; i++) {</div>
<div class="line"><span class="lineno">11787</span>    <span class="keywordflow">if</span> (rt[i] &lt; t0 || rt[i] &gt;= t1 || !isfinite(robs[i]))</div>
<div class="line"><span class="lineno">11788</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">11789</span> </div>
<div class="line"><span class="lineno">11790</span>    <span class="comment">/* Calculate indices... */</span></div>
<div class="line"><span class="lineno">11791</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> ix = (int) ((rlon[i] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a396d8bbb52aaf8408e90c207aa7f7312">csi_lon0</a>) / dlon);</div>
<div class="line"><span class="lineno">11792</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iy = (int) ((rlat[i] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a219b7e2f9f53597e84a87d349e32bcb5">csi_lat0</a>) / dlat);</div>
<div class="line"><span class="lineno">11793</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iz = (int) ((rz[i] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a98aa14528bd795eaf31eae63a33c630f">csi_z0</a>) / dz);</div>
<div class="line"><span class="lineno">11794</span>    <span class="keywordflow">if</span> (ix &lt; 0 || ix &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a21159a48d018215b1bb5af62214b9063">csi_nx</a> || iy &lt; 0 || iy &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">csi_ny</a> || iz &lt; 0</div>
<div class="line"><span class="lineno">11795</span>        || iz &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0409a87481145b01eb3fd61042f35abc">csi_nz</a>)</div>
<div class="line"><span class="lineno">11796</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">11797</span> </div>
<div class="line"><span class="lineno">11798</span>    <span class="comment">/* Get mean observation index... */</span></div>
<div class="line"><span class="lineno">11799</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">csi_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0409a87481145b01eb3fd61042f35abc">csi_nz</a>);</div>
<div class="line"><span class="lineno">11800</span>    obsmean[idx] += robs[i];</div>
<div class="line"><span class="lineno">11801</span>    obsstd[idx] += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(robs[i]);</div>
<div class="line"><span class="lineno">11802</span>    obscount[idx]++;</div>
<div class="line"><span class="lineno">11803</span>  }</div>
<div class="line"><span class="lineno">11804</span> </div>
<div class="line"><span class="lineno">11805</span>  <span class="comment">/* Analyze model data... */</span></div>
<div class="line"><span class="lineno">11806</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno">11807</span> </div>
<div class="line"><span class="lineno">11808</span>    <span class="comment">/* Check time... */</span></div>
<div class="line"><span class="lineno">11809</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1)</div>
<div class="line"><span class="lineno">11810</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">11811</span> </div>
<div class="line"><span class="lineno">11812</span>    <span class="comment">/* Get ensemble ID... */</span></div>
<div class="line"><span class="lineno">11813</span>    <span class="keywordtype">int</span> ens_id = ensemble ? (int) atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>][ip] : 0;</div>
<div class="line"><span class="lineno">11814</span>    if (ens_id &lt; 0 || ens_id &gt;= (ensemble ? ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">nens</a> : 1))</div>
<div class="line"><span class="lineno">11815</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Ensemble ID out of range!&quot;</span>);</div>
<div class="line"><span class="lineno">11816</span> </div>
<div class="line"><span class="lineno">11817</span>    <span class="comment">/* Get indices... */</span></div>
<div class="line"><span class="lineno">11818</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> ix = (int) ((atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a396d8bbb52aaf8408e90c207aa7f7312">csi_lon0</a>) / dlon);</div>
<div class="line"><span class="lineno">11819</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iy = (int) ((atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a219b7e2f9f53597e84a87d349e32bcb5">csi_lat0</a>) / dlat);</div>
<div class="line"><span class="lineno">11820</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iz = (int) ((<a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]) - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a98aa14528bd795eaf31eae63a33c630f">csi_z0</a>) / dz);</div>
<div class="line"><span class="lineno">11821</span>    <span class="keywordflow">if</span> (ix &lt; 0 || ix &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a21159a48d018215b1bb5af62214b9063">csi_nx</a> || iy &lt; 0 || iy &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">csi_ny</a> || iz &lt; 0</div>
<div class="line"><span class="lineno">11822</span>        || iz &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0409a87481145b01eb3fd61042f35abc">csi_nz</a>)</div>
<div class="line"><span class="lineno">11823</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">11824</span> </div>
<div class="line"><span class="lineno">11825</span>    <span class="comment">/* Get total mass in grid cell... */</span></div>
<div class="line"><span class="lineno">11826</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> idx =</div>
<div class="line"><span class="lineno">11827</span>      ens_id * grid_size + <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">csi_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0409a87481145b01eb3fd61042f35abc">csi_nz</a>);</div>
<div class="line"><span class="lineno">11828</span>    modmean[idx] +=</div>
<div class="line"><span class="lineno">11829</span>      <a class="code hl_function" href="mptrac_8c.html#ae61cf973263fcc45574daa27d0dec8cd">kernel_weight</a>(kz, kw, nk, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]) * atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip];</div>
<div class="line"><span class="lineno">11830</span>  }</div>
<div class="line"><span class="lineno">11831</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; (ensemble ? ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8be23ace67543cf50c8b071a3111694f">nens</a> : 1); e++) {</div>
<div class="line"><span class="lineno">11832</span>    <span class="comment">/* Analyze all grid cells... */</span></div>
<div class="line"><span class="lineno">11833</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a21159a48d018215b1bb5af62214b9063">csi_nx</a>; ix++)</div>
<div class="line"><span class="lineno">11834</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">csi_ny</a>; iy++)</div>
<div class="line"><span class="lineno">11835</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0409a87481145b01eb3fd61042f35abc">csi_nz</a>; iz++) {</div>
<div class="line"><span class="lineno">11836</span> </div>
<div class="line"><span class="lineno">11837</span>          <span class="comment">/* Calculate mean observation index... */</span></div>
<div class="line"><span class="lineno">11838</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17759fe1c0d11bb19777559e24808d40">csi_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0409a87481145b01eb3fd61042f35abc">csi_nz</a>);</div>
<div class="line"><span class="lineno">11839</span>          <span class="keywordflow">if</span> (e == 0)</div>
<div class="line"><span class="lineno">11840</span>            <span class="keywordflow">if</span> (obscount[idx]) {</div>
<div class="line"><span class="lineno">11841</span>              obsmean[idx] /= obscount[idx];</div>
<div class="line"><span class="lineno">11842</span>              obsstd[idx] =</div>
<div class="line"><span class="lineno">11843</span>                sqrt(obsstd[idx] / obscount[idx] - <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(obsmean[idx]));</div>
<div class="line"><span class="lineno">11844</span>            }</div>
<div class="line"><span class="lineno">11845</span> </div>
<div class="line"><span class="lineno">11846</span>          <span class="comment">/* Calculate model mean per ensemble... */</span></div>
<div class="line"><span class="lineno">11847</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> midx = e * grid_size + idx;</div>
<div class="line"><span class="lineno">11848</span>          <span class="keywordflow">if</span> (modmean[midx] &gt; 0)</div>
<div class="line"><span class="lineno">11849</span>            modmean[midx] /= (1e6 * area[iy]);</div>
<div class="line"><span class="lineno">11850</span> </div>
<div class="line"><span class="lineno">11851</span>          <span class="comment">/* Check number of observations... */</span></div>
<div class="line"><span class="lineno">11852</span>          <span class="keywordflow">if</span> (obscount[idx]) {</div>
<div class="line"><span class="lineno">11853</span> </div>
<div class="line"><span class="lineno">11854</span>            <span class="comment">/* Calculate CSI... */</span></div>
<div class="line"><span class="lineno">11855</span>            ct[e]++;</div>
<div class="line"><span class="lineno">11856</span>            <span class="keywordflow">if</span> (obsmean[idx] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0a450754f8661100135aa790ea26df16">csi_obsmin</a></div>
<div class="line"><span class="lineno">11857</span>                &amp;&amp; modmean[midx] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4aa05c61a9c0c1d0f3737f2190b1ebdc">csi_modmin</a>)</div>
<div class="line"><span class="lineno">11858</span>              cx[e]++;</div>
<div class="line"><span class="lineno">11859</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (obsmean[idx] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0a450754f8661100135aa790ea26df16">csi_obsmin</a>)</div>
<div class="line"><span class="lineno">11860</span>              cy[e]++;</div>
<div class="line"><span class="lineno">11861</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (modmean[midx] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4aa05c61a9c0c1d0f3737f2190b1ebdc">csi_modmin</a>)</div>
<div class="line"><span class="lineno">11862</span>              cz[e]++;</div>
<div class="line"><span class="lineno">11863</span> </div>
<div class="line"><span class="lineno">11864</span>            <span class="comment">/* Save data for other verification statistics... */</span></div>
<div class="line"><span class="lineno">11865</span>            <span class="keywordflow">if</span> (obsmean[idx] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0a450754f8661100135aa790ea26df16">csi_obsmin</a></div>
<div class="line"><span class="lineno">11866</span>                || modmean[midx] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4aa05c61a9c0c1d0f3737f2190b1ebdc">csi_modmin</a>) {</div>
<div class="line"><span class="lineno">11867</span>              x[n[e]] = modmean[midx];</div>
<div class="line"><span class="lineno">11868</span>              y[n[e]] = obsmean[idx];</div>
<div class="line"><span class="lineno">11869</span>              <span class="keywordflow">if</span> (modmean[midx] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4aa05c61a9c0c1d0f3737f2190b1ebdc">csi_modmin</a>)</div>
<div class="line"><span class="lineno">11870</span>                obsstdn[n[e]] = obsstd[idx];</div>
<div class="line"><span class="lineno">11871</span>              <span class="keywordflow">if</span> ((++n[e]) &gt;= <a class="code hl_define" href="mptrac_8h.html#ad7d0bf1acdf6b0da23c3ccd8ce8f6caa">NCSI</a>)</div>
<div class="line"><span class="lineno">11872</span>                <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Too many points for statistics!&quot;</span>);</div>
<div class="line"><span class="lineno">11873</span>            }</div>
<div class="line"><span class="lineno">11874</span>          }</div>
<div class="line"><span class="lineno">11875</span>        }</div>
<div class="line"><span class="lineno">11876</span>    <span class="comment">/* Write output... */</span></div>
<div class="line"><span class="lineno">11877</span>    <span class="keywordflow">if</span> (fmod(t, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a466eb100ca9ab4f5f605e14a27a61f1d">csi_dt_out</a>) == 0) {</div>
<div class="line"><span class="lineno">11878</span> </div>
<div class="line"><span class="lineno">11879</span>      <span class="keywordflow">if</span> (n[e] == 0)</div>
<div class="line"><span class="lineno">11880</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">11881</span> </div>
<div class="line"><span class="lineno">11882</span>      <span class="comment">/* Calculate verification statistics</span></div>
<div class="line"><span class="lineno">11883</span><span class="comment">         (https://www.cawcr.gov.au/projects/verification/) ... */</span></div>
<div class="line"><span class="lineno">11884</span>      <span class="keyword">static</span> <span class="keywordtype">double</span> work[2 * <a class="code hl_define" href="mptrac_8h.html#ad7d0bf1acdf6b0da23c3ccd8ce8f6caa">NCSI</a>], work2[2 * <a class="code hl_define" href="mptrac_8h.html#ad7d0bf1acdf6b0da23c3ccd8ce8f6caa">NCSI</a>];</div>
<div class="line"><span class="lineno">11885</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> n_obs = cx[e] + cy[e];</div>
<div class="line"><span class="lineno">11886</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> n_for = cx[e] + cz[e];</div>
<div class="line"><span class="lineno">11887</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> cx_rd = (ct[e] &gt; 0) ? (1. * n_obs * n_for) / ct[e] : NAN;</div>
<div class="line"><span class="lineno">11888</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> bias = (n_obs &gt; 0) ? 100. * n_for / n_obs : NAN;</div>
<div class="line"><span class="lineno">11889</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> pod = (n_obs &gt; 0) ? 100. * cx[e] / n_obs : NAN;</div>
<div class="line"><span class="lineno">11890</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> far = (n_for &gt; 0) ? 100. * cz[e] / n_for : NAN;</div>
<div class="line"><span class="lineno">11891</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> csi =</div>
<div class="line"><span class="lineno">11892</span>        (cx[e] + cy[e] + cz[e] &gt;</div>
<div class="line"><span class="lineno">11893</span>         0) ? 100. * cx[e] / (cx[e] + cy[e] + cz[e]) : NAN;</div>
<div class="line"><span class="lineno">11894</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> ets =</div>
<div class="line"><span class="lineno">11895</span>        (cx[e] + cy[e] + cz[e] - cx_rd &gt;</div>
<div class="line"><span class="lineno">11896</span>         0) ? 100. * (cx[e] - cx_rd) / (cx[e] + cy[e] + cz[e] - cx_rd) : NAN;</div>
<div class="line"><span class="lineno">11897</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> rho_p = gsl_stats_correlation(x, 1, y, 1, (<span class="keywordtype">size_t</span>) n[e]);</div>
<div class="line"><span class="lineno">11898</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> rho_s =</div>
<div class="line"><span class="lineno">11899</span>        gsl_stats_spearman(x, 1, y, 1, (<span class="keywordtype">size_t</span>) n[e], work);</div>
<div class="line"><span class="lineno">11900</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n[e]; i++) {</div>
<div class="line"><span class="lineno">11901</span>        work[i] = x[i] - y[i];</div>
<div class="line"><span class="lineno">11902</span>        work2[i] = (obsstdn[i] != 0) ? work[i] / obsstdn[i] : 0;</div>
<div class="line"><span class="lineno">11903</span>      }</div>
<div class="line"><span class="lineno">11904</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> mean = gsl_stats_mean(work, 1, (<span class="keywordtype">size_t</span>) n[e]);</div>
<div class="line"><span class="lineno">11905</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> rmse =</div>
<div class="line"><span class="lineno">11906</span>        gsl_stats_sd_with_fixed_mean(work, 1, (<span class="keywordtype">size_t</span>) n[e], 0.0);</div>
<div class="line"><span class="lineno">11907</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> absdev = gsl_stats_absdev_m(work, 1, (<span class="keywordtype">size_t</span>) n[e], 0.0);</div>
<div class="line"><span class="lineno">11908</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> loglikelihood =</div>
<div class="line"><span class="lineno">11909</span>        gsl_stats_tss_m(work2, 1, (<span class="keywordtype">size_t</span>) n[e], 0.0) * -0.5;</div>
<div class="line"><span class="lineno">11910</span> </div>
<div class="line"><span class="lineno">11911</span>      <span class="comment">/* Write... */</span></div>
<div class="line"><span class="lineno">11912</span>      fprintf(out,</div>
<div class="line"><span class="lineno">11913</span>              <span class="stringliteral">&quot;%.2f %d %d %d %d %d %d %g %g %g %g %g %g %g %g %g %g %g %g %d\n&quot;</span>,</div>
<div class="line"><span class="lineno">11914</span>              t, ensemble ? e : -999, cx[e], cy[e], cz[e], n_obs, n_for, bias,</div>
<div class="line"><span class="lineno">11915</span>              pod, far, csi, cx_rd, ets, rho_p, rho_s, mean, rmse, absdev,</div>
<div class="line"><span class="lineno">11916</span>              loglikelihood, n[e]);</div>
<div class="line"><span class="lineno">11917</span> </div>
<div class="line"><span class="lineno">11918</span>      <span class="comment">/* Set counters to zero... */</span></div>
<div class="line"><span class="lineno">11919</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n[e]; i++)</div>
<div class="line"><span class="lineno">11920</span>        work[i] = work2[i] = x[i] = y[i] = obsstdn[i] = 0;</div>
<div class="line"><span class="lineno">11921</span>      ct[e] = cx[e] = cy[e] = cz[e] = n[e] = 0;</div>
<div class="line"><span class="lineno">11922</span>    }</div>
<div class="line"><span class="lineno">11923</span>  }</div>
<div class="line"><span class="lineno">11924</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">11925</span>  free(modmean);</div>
<div class="line"><span class="lineno">11926</span>  free(obsmean);</div>
<div class="line"><span class="lineno">11927</span>  free(obscount);</div>
<div class="line"><span class="lineno">11928</span>  free(obsstd);</div>
<div class="line"><span class="lineno">11929</span> </div>
<div class="line"><span class="lineno">11930</span>  <span class="comment">/* Finalize... */</span></div>
<div class="line"><span class="lineno">11931</span>  <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a>) {</div>
<div class="line"><span class="lineno">11932</span> </div>
<div class="line"><span class="lineno">11933</span>    <span class="comment">/* Close output file... */</span></div>
<div class="line"><span class="lineno">11934</span>    fclose(out);</div>
<div class="line"><span class="lineno">11935</span> </div>
<div class="line"><span class="lineno">11936</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">11937</span>    free(area);</div>
<div class="line"><span class="lineno">11938</span>    free(rt);</div>
<div class="line"><span class="lineno">11939</span>    free(rz);</div>
<div class="line"><span class="lineno">11940</span>    free(rlon);</div>
<div class="line"><span class="lineno">11941</span>    free(rlat);</div>
<div class="line"><span class="lineno">11942</span>    free(robs);</div>
<div class="line"><span class="lineno">11943</span>  }</div>
<div class="line"><span class="lineno">11944</span>}</div>
<div class="ttc" id="amptrac_8c_html_a1365b8fd93db0fc3fe4c467107710d03"><div class="ttname"><a href="mptrac_8c.html#a1365b8fd93db0fc3fe4c467107710d03">read_obs</a></div><div class="ttdeci">void read_obs(const char *filename, const ctl_t *ctl, double *rt, double *rz, double *rlon, double *rlat, double *robs, int *nobs)</div><div class="ttdoc">Reads observation data from a file and stores it in arrays.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l10850">mptrac.c:10850</a></div></div>
<div class="ttc" id="amptrac_8c_html_a7a3277ab872141360b876c25b5643ba6"><div class="ttname"><a href="mptrac_8c.html#a7a3277ab872141360b876c25b5643ba6">read_kernel</a></div><div class="ttdeci">void read_kernel(const char *filename, double kz[EP], double kw[EP], int *nk)</div><div class="ttdoc">Reads kernel function data from a file and populates the provided arrays.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l07482">mptrac.c:7482</a></div></div>
<div class="ttc" id="amptrac_8c_html_ae61cf973263fcc45574daa27d0dec8cd"><div class="ttname"><a href="mptrac_8c.html#ae61cf973263fcc45574daa27d0dec8cd">kernel_weight</a></div><div class="ttdeci">double kernel_weight(const double kz[EP], const double kw[EP], const int nk, const double p)</div><div class="ttdoc">Calculates the kernel weight based on altitude and given kernel data.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l02615">mptrac.c:2615</a></div></div>
<div class="ttc" id="amptrac_8h_html_a1dd69f988ec51453efc614485237c23a"><div class="ttname"><a href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a></div><div class="ttdeci">#define NENS</div><div class="ttdoc">Maximum number of data points for ensemble analysis.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00323">mptrac.h:323</a></div></div>
<div class="ttc" id="amptrac_8h_html_ad7d0bf1acdf6b0da23c3ccd8ce8f6caa"><div class="ttname"><a href="mptrac_8h.html#ad7d0bf1acdf6b0da23c3ccd8ce8f6caa">NCSI</a></div><div class="ttdeci">#define NCSI</div><div class="ttdoc">Maximum number of data points for CSI calculation.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l00318">mptrac.h:318</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_afe2f86cb96a4de47d262cf7776164d46_cgraph.png" border="0" usemap="#amptrac_8h_afe2f86cb96a4de47d262cf7776164d46_cgraph" alt=""/></div>
<map name="amptrac_8h_afe2f86cb96a4de47d262cf7776164d46_cgraph" id="amptrac_8h_afe2f86cb96a4de47d262cf7776164d46_cgraph">
<area shape="rect" title="Writes Critical Success Index (CSI) data to a file." alt="" coords="5,56,80,83"/>
<area shape="rect" href="mptrac_8c.html#ae61cf973263fcc45574daa27d0dec8cd" title="Calculates the kernel weight based on altitude and given kernel data." alt="" coords="128,5,231,32"/>
<area shape="rect" href="mptrac_8c.html#a7a3277ab872141360b876c25b5643ba6" title="Reads kernel function data from a file and populates the provided arrays." alt="" coords="135,56,224,83"/>
<area shape="rect" href="mptrac_8c.html#a1365b8fd93db0fc3fe4c467107710d03" title="Reads observation data from a file and stores it in arrays." alt="" coords="142,107,217,133"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="293,5,367,32"/>
<area shape="rect" href="mptrac_8c.html#a29da9a205ad3577ba3890f3e1e4350c3" title="Reads observation data from an ASCII file." alt="" coords="279,81,381,108"/>
<area shape="rect" href="mptrac_8c.html#a4536a82b3dc62081d26114c1250b1427" title="Reads observation data from a NetCDF file." alt="" coords="282,132,378,159"/>
</map>
</div>

</div>
</div>
<a id="a26de995e28ccaf098f62a6cc007ba312" name="a26de995e28ccaf098f62a6cc007ba312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26de995e28ccaf098f62a6cc007ba312">&#9670;&nbsp;</a></span>write_csi_ens()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_csi_ens </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes ensemble-based Critical Success Index (CSI) and other verification statistics to an output file. </p>
<p >This function computes and writes various statistical verification metrics that assess the performance of ensemble forecasts compared to observations. The output includes, for each ensemble member:</p><ul>
<li>Critical Success Index (CSI)</li>
<li>Equitable Threat Score (ETS)</li>
<li>Bias (forecast/observation ratio)</li>
<li>Probability of Detection (POD)</li>
<li>False Alarm Rate (FAR)</li>
<li>Correlation coefficients (Pearson, Spearman)</li>
<li>Error metrics (mean error, RMSE, mean absolute error)</li>
<li>Log-likelihood of the normalized errors</li>
</ul>
<p >On the first invocation (when <code>t == ctl-&gt;t_start</code>), the function loads observation data and kernel weights, allocates necessary arrays, and creates a new output file with a descriptive header. On the final call (when <code>t == ctl-&gt;t_stop</code>), the function closes the file and frees all persistent memory.</p>
<p >Output is written at time steps divisible by <code>ctl-&gt;csi_dt_out</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Path to the output file where statistics will be written. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctl</td><td>Pointer to control structure containing configuration, ensemble settings, and spatial/time grid info. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atm</td><td>Pointer to atmospheric data structure holding model output. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Current simulation/model time.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function maintains internal static buffers and handles memory management across time steps. It validates input configuration and will terminate with an error message if required quantities are missing or if limits (e.g., number of ensembles or data points) are exceeded.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">If</td><td>required quantities (mass or ensemble IDs) are undefined, if ensemble IDs are out of bounds, or if the output file cannot be created.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mingzhao Liu </dd></dl>

</div>
</div>
<a id="a4036654b5bb8eaf257500214c2f0407d" name="a4036654b5bb8eaf257500214c2f0407d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4036654b5bb8eaf257500214c2f0407d">&#9670;&nbsp;</a></span>write_ens()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_ens </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes ensemble data to a file. </p>
<p >The <code>write_ens</code> function processes air parcel data to calculate ensemble means and standard deviations for various quantities and writes them to a specified output file. It handles ensemble members and calculates statistics such as means and standard deviations for each ensemble, along with latitude, longitude, altitude, and time information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the name of the output file. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data. </td></tr>
    <tr><td class="paramname">t</td><td>A double representing the current time.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Initializes resources and sets up necessary variables.</li>
<li>Sets a time interval for processing data.</li>
<li>Loops over air parcels to accumulate means and standard deviations for each ensemble member.</li>
<li>Creates an output file and writes header information.</li>
<li>Writes ensemble data, including time, altitude, latitude, longitude, means, standard deviations, and the number of members.</li>
<li>Closes the output file.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l11948">11948</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">11952</span>                  {</div>
<div class="line"><span class="lineno">11953</span> </div>
<div class="line"><span class="lineno">11954</span>  <span class="keyword">static</span> FILE *out;</div>
<div class="line"><span class="lineno">11955</span> </div>
<div class="line"><span class="lineno">11956</span>  <span class="keyword">static</span> <span class="keywordtype">double</span> dummy, lat, lon, qm[<a class="code hl_define" href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>][<a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>], qs[<a class="code hl_define" href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>][<a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>], xm[<a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>][3],</div>
<div class="line"><span class="lineno">11957</span>    x[3], zm[<a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>];</div>
<div class="line"><span class="lineno">11958</span> </div>
<div class="line"><span class="lineno">11959</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> n[<a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>];</div>
<div class="line"><span class="lineno">11960</span> </div>
<div class="line"><span class="lineno">11961</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">11962</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;WRITE_ENS&quot;</span>, <span class="stringliteral">&quot;OUTPUT&quot;</span>);</div>
<div class="line"><span class="lineno">11963</span> </div>
<div class="line"><span class="lineno">11964</span>  <span class="comment">/* Check quantities... */</span></div>
<div class="line"><span class="lineno">11965</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a> &lt; 0)</div>
<div class="line"><span class="lineno">11966</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Missing ensemble IDs!&quot;</span>);</div>
<div class="line"><span class="lineno">11967</span> </div>
<div class="line"><span class="lineno">11968</span>  <span class="comment">/* Set time interval... */</span></div>
<div class="line"><span class="lineno">11969</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = t - 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">11970</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t1 = t + 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">11971</span> </div>
<div class="line"><span class="lineno">11972</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno">11973</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>; i++) {</div>
<div class="line"><span class="lineno">11974</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">11975</span>      qm[iq][i] = qs[iq][i] = 0;</div>
<div class="line"><span class="lineno">11976</span>    xm[i][0] = xm[i][1] = xm[i][2] = zm[i] = 0;</div>
<div class="line"><span class="lineno">11977</span>    n[i] = 0;</div>
<div class="line"><span class="lineno">11978</span>  }</div>
<div class="line"><span class="lineno">11979</span> </div>
<div class="line"><span class="lineno">11980</span>  <span class="comment">/* Loop over air parcels... */</span></div>
<div class="line"><span class="lineno">11981</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno">11982</span> </div>
<div class="line"><span class="lineno">11983</span>    <span class="comment">/* Check time... */</span></div>
<div class="line"><span class="lineno">11984</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1)</div>
<div class="line"><span class="lineno">11985</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">11986</span> </div>
<div class="line"><span class="lineno">11987</span>    <span class="comment">/* Check ensemble ID... */</span></div>
<div class="line"><span class="lineno">11988</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>][ip] &lt; 0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>][ip] &gt;= <a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>)</div>
<div class="line"><span class="lineno">11989</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Ensemble ID is out of range!&quot;</span>);</div>
<div class="line"><span class="lineno">11990</span> </div>
<div class="line"><span class="lineno">11991</span>    <span class="comment">/* Get means... */</span></div>
<div class="line"><span class="lineno">11992</span>    <a class="code hl_function" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], x);</div>
<div class="line"><span class="lineno">11993</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">11994</span>      qm[iq][ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>] += atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq][ip];</div>
<div class="line"><span class="lineno">11995</span>      qs[iq][ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>] += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq][ip]);</div>
<div class="line"><span class="lineno">11996</span>    }</div>
<div class="line"><span class="lineno">11997</span>    xm[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>][0] += x[0];</div>
<div class="line"><span class="lineno">11998</span>    xm[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>][1] += x[1];</div>
<div class="line"><span class="lineno">11999</span>    xm[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>][2] += x[2];</div>
<div class="line"><span class="lineno">12000</span>    zm[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>] += <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]);</div>
<div class="line"><span class="lineno">12001</span>    n[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace61e592378505a9011133dc02d249a7">qnt_ens</a>]++;</div>
<div class="line"><span class="lineno">12002</span>  }</div>
<div class="line"><span class="lineno">12003</span> </div>
<div class="line"><span class="lineno">12004</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">12005</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write ensemble data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno">12006</span>  <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">12007</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno">12008</span> </div>
<div class="line"><span class="lineno">12009</span>  <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno">12010</span>  fprintf(out,</div>
<div class="line"><span class="lineno">12011</span>          <span class="stringliteral">&quot;# $1 = time [s]\n&quot;</span></div>
<div class="line"><span class="lineno">12012</span>          <span class="stringliteral">&quot;# $2 = altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno">12013</span>          <span class="stringliteral">&quot;# $3 = longitude [deg]\n&quot;</span> <span class="stringliteral">&quot;# $4 = latitude [deg]\n&quot;</span>);</div>
<div class="line"><span class="lineno">12014</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">12015</span>    fprintf(out, <span class="stringliteral">&quot;# $%d = %s (mean) [%s]\n&quot;</span>, 5 + iq,</div>
<div class="line"><span class="lineno">12016</span>            ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq]);</div>
<div class="line"><span class="lineno">12017</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">12018</span>    fprintf(out, <span class="stringliteral">&quot;# $%d = %s (sigma) [%s]\n&quot;</span>, 5 + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a> + iq,</div>
<div class="line"><span class="lineno">12019</span>            ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq]);</div>
<div class="line"><span class="lineno">12020</span>  fprintf(out, <span class="stringliteral">&quot;# $%d = number of members\n\n&quot;</span>, 5 + 2 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>);</div>
<div class="line"><span class="lineno">12021</span> </div>
<div class="line"><span class="lineno">12022</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">12023</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="mptrac_8h.html#a1dd69f988ec51453efc614485237c23a">NENS</a>; i++)</div>
<div class="line"><span class="lineno">12024</span>    <span class="keywordflow">if</span> (n[i] &gt; 0) {</div>
<div class="line"><span class="lineno">12025</span>      <a class="code hl_function" href="mptrac_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4">cart2geo</a>(xm[i], &amp;dummy, &amp;lon, &amp;lat);</div>
<div class="line"><span class="lineno">12026</span>      fprintf(out, <span class="stringliteral">&quot;%.2f %g %g %g&quot;</span>, t, zm[i] / n[i], lon, lat);</div>
<div class="line"><span class="lineno">12027</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12028</span>        fprintf(out, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><span class="lineno">12029</span>        fprintf(out, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq], qm[iq][i] / n[i]);</div>
<div class="line"><span class="lineno">12030</span>      }</div>
<div class="line"><span class="lineno">12031</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12032</span>        fprintf(out, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><span class="lineno">12033</span>        <span class="keywordtype">double</span> var = qs[iq][i] / n[i] - <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(qm[iq][i] / n[i]);</div>
<div class="line"><span class="lineno">12034</span>        fprintf(out, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq], (var &gt; 0 ? sqrt(var) : 0));</div>
<div class="line"><span class="lineno">12035</span>      }</div>
<div class="line"><span class="lineno">12036</span>      fprintf(out, <span class="stringliteral">&quot; %d\n&quot;</span>, n[i]);</div>
<div class="line"><span class="lineno">12037</span>    }</div>
<div class="line"><span class="lineno">12038</span> </div>
<div class="line"><span class="lineno">12039</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">12040</span>  fclose(out);</div>
<div class="line"><span class="lineno">12041</span>}</div>
<div class="ttc" id="amptrac_8c_html_aaf98f7230de0893b8dc4833d3c83c7a4"><div class="ttname"><a href="mptrac_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4">cart2geo</a></div><div class="ttdeci">void cart2geo(const double *x, double *z, double *lon, double *lat)</div><div class="ttdoc">State variables of cuRAND random number generator.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l00074">mptrac.c:74</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a4036654b5bb8eaf257500214c2f0407d_cgraph.png" border="0" usemap="#amptrac_8h_a4036654b5bb8eaf257500214c2f0407d_cgraph" alt=""/></div>
<map name="amptrac_8h_a4036654b5bb8eaf257500214c2f0407d_cgraph" id="amptrac_8h_a4036654b5bb8eaf257500214c2f0407d_cgraph">
<area shape="rect" title="Writes ensemble data to a file." alt="" coords="5,31,84,57"/>
<area shape="rect" href="mptrac_8c.html#aaf98f7230de0893b8dc4833d3c83c7a4" title="State variables of cuRAND random number generator." alt="" coords="132,5,204,32"/>
<area shape="rect" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="132,56,204,83"/>
</map>
</div>

</div>
</div>
<a id="af185d3a188bc2279135c58c8d5f24795" name="af185d3a188bc2279135c58c8d5f24795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af185d3a188bc2279135c58c8d5f24795">&#9670;&nbsp;</a></span>write_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_grid </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes grid data to a file in ASCII or netCDF format. </p>
<p >The <code>write_grid</code> function processes air parcel data to calculate various grid-based statistics such as column density, mean, and standard deviation for specified quantities. It then writes this data to a specified output file either in ASCII or netCDF format based on the configuration parameters provided in the <code>ctl</code> structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the name of the output file. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">met0</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure containing meteorological data for the initial time step. </td></tr>
    <tr><td class="paramname">met1</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure containing meteorological data for the final time step. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure containing atmospheric data. </td></tr>
    <tr><td class="paramname">t</td><td>A double representing the current time.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Initializes resources and sets up necessary variables.</li>
<li>Reads kernel data if it is specified in the control parameters.</li>
<li>Allocates memory for various arrays to store grid data.</li>
<li>Determines the grid box size and sets up vertical and horizontal coordinates.</li>
<li>Sets a time interval for output data processing.</li>
<li>Calculates grid box indices for atmospheric model data.</li>
<li>Averages data within each grid box.</li>
<li>Calculates column density and volume mixing ratio.</li>
<li>Writes data to the output file either in ASCII or netCDF format based on the specified <code>grid_type</code> in the control parameters.</li>
<li>Frees allocated memory.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The function supports parallel processing using OpenMP for certain computational tasks to improve performance.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l12045">12045</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">12051</span>                  {</div>
<div class="line"><span class="lineno">12052</span> </div>
<div class="line"><span class="lineno">12053</span>  <span class="keyword">static</span> <span class="keywordtype">double</span> kz[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>], kw[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>];</div>
<div class="line"><span class="lineno">12054</span> </div>
<div class="line"><span class="lineno">12055</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> nk;</div>
<div class="line"><span class="lineno">12056</span> </div>
<div class="line"><span class="lineno">12057</span>  <span class="keywordtype">double</span> *cd, *mean[<a class="code hl_define" href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>], *sigma[<a class="code hl_define" href="mptrac_8h.html#a68c2775fc4d7385df9c7bb96d23b482b">NQ</a>], *vmr_impl, *z, *lon, *lat, *area, *press;</div>
<div class="line"><span class="lineno">12058</span> </div>
<div class="line"><span class="lineno">12059</span>  <span class="keywordtype">int</span> *ixs, *iys, *izs, *np;</div>
<div class="line"><span class="lineno">12060</span> </div>
<div class="line"><span class="lineno">12061</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">12062</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;WRITE_GRID&quot;</span>, <span class="stringliteral">&quot;OUTPUT&quot;</span>);</div>
<div class="line"><span class="lineno">12063</span> </div>
<div class="line"><span class="lineno">12064</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno">12065</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write grid data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno">12066</span> </div>
<div class="line"><span class="lineno">12067</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno">12068</span>  <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a>) {</div>
<div class="line"><span class="lineno">12069</span> </div>
<div class="line"><span class="lineno">12070</span>    <span class="comment">/* Read kernel data... */</span></div>
<div class="line"><span class="lineno">12071</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4dc20e7eacf1e45a61ed1910e0e88d1b">grid_kernel</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno">12072</span>      <a class="code hl_function" href="mptrac_8c.html#a7a3277ab872141360b876c25b5643ba6">read_kernel</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4dc20e7eacf1e45a61ed1910e0e88d1b">grid_kernel</a>, kz, kw, &amp;nk);</div>
<div class="line"><span class="lineno">12073</span>  }</div>
<div class="line"><span class="lineno">12074</span> </div>
<div class="line"><span class="lineno">12075</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">12076</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(cd, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12077</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12078</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12079</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(mean[iq], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12080</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12081</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(sigma[iq], <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12082</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12083</span>  }</div>
<div class="line"><span class="lineno">12084</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(vmr_impl, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12085</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12086</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(z, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12087</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12088</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(lon, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12089</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>);</div>
<div class="line"><span class="lineno">12090</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(lat, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12091</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>);</div>
<div class="line"><span class="lineno">12092</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(area, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12093</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>);</div>
<div class="line"><span class="lineno">12094</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(press, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12095</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12096</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(np, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12097</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12098</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(ixs, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12099</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno">12100</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(iys, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12101</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno">12102</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(izs, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12103</span>        atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>);</div>
<div class="line"><span class="lineno">12104</span> </div>
<div class="line"><span class="lineno">12105</span>  <span class="comment">/* Set grid box size... */</span></div>
<div class="line"><span class="lineno">12106</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> dz = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1a5460bac04c277c0e66efc9f2f85810">grid_z1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0060ec5c97cb80d4721c3970c68012f5">grid_z0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>;</div>
<div class="line"><span class="lineno">12107</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> dlon = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a895d5f67cd12ab54481ebfa36f359b77">grid_lon1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2b398376ae2ebe6e02a34465367943de">grid_lon0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>;</div>
<div class="line"><span class="lineno">12108</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> dlat = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af89d6bfcdbc4250e2d30dd7e453b3048">grid_lat1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a25bb036fcbb73ed2452d42212cd3c09f">grid_lat0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>;</div>
<div class="line"><span class="lineno">12109</span> </div>
<div class="line"><span class="lineno">12110</span>  <span class="comment">/* Set vertical coordinates... */</span></div>
<div class="line"><span class="lineno">12111</span>#pragma omp parallel <span class="keywordflow">for</span> <span class="keywordflow">default</span>(shared)</div>
<div class="line"><span class="lineno">12112</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>; iz++) {</div>
<div class="line"><span class="lineno">12113</span>    z[iz] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0060ec5c97cb80d4721c3970c68012f5">grid_z0</a> + dz * (iz + 0.5);</div>
<div class="line"><span class="lineno">12114</span>    press[iz] = <a class="code hl_define" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>(z[iz]);</div>
<div class="line"><span class="lineno">12115</span>  }</div>
<div class="line"><span class="lineno">12116</span> </div>
<div class="line"><span class="lineno">12117</span>  <span class="comment">/* Set horizontal coordinates... */</span></div>
<div class="line"><span class="lineno">12118</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>; ix++)</div>
<div class="line"><span class="lineno">12119</span>    lon[ix] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2b398376ae2ebe6e02a34465367943de">grid_lon0</a> + dlon * (ix + 0.5);</div>
<div class="line"><span class="lineno">12120</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">12121</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>; iy++) {</div>
<div class="line"><span class="lineno">12122</span>    lat[iy] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a25bb036fcbb73ed2452d42212cd3c09f">grid_lat0</a> + dlat * (iy + 0.5);</div>
<div class="line"><span class="lineno">12123</span>    area[iy] = dlat * dlon * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(<a class="code hl_define" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a> * M_PI / 180.) * cos(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(lat[iy]));</div>
<div class="line"><span class="lineno">12124</span>  }</div>
<div class="line"><span class="lineno">12125</span> </div>
<div class="line"><span class="lineno">12126</span>  <span class="comment">/* Set time interval for output... */</span></div>
<div class="line"><span class="lineno">12127</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = t - 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">12128</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t1 = t + 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">12129</span> </div>
<div class="line"><span class="lineno">12130</span>  <span class="comment">/* Get grid box indices... */</span></div>
<div class="line"><span class="lineno">12131</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">12132</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno">12133</span>    ixs[ip] = (int) ((atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2b398376ae2ebe6e02a34465367943de">grid_lon0</a>) / dlon);</div>
<div class="line"><span class="lineno">12134</span>    iys[ip] = (int) ((atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a25bb036fcbb73ed2452d42212cd3c09f">grid_lat0</a>) / dlat);</div>
<div class="line"><span class="lineno">12135</span>    izs[ip] = (int) ((<a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]) - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0060ec5c97cb80d4721c3970c68012f5">grid_z0</a>) / dz);</div>
<div class="line"><span class="lineno">12136</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1</div>
<div class="line"><span class="lineno">12137</span>        || ixs[ip] &lt; 0 || ixs[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a></div>
<div class="line"><span class="lineno">12138</span>        || iys[ip] &lt; 0 || iys[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a></div>
<div class="line"><span class="lineno">12139</span>        || izs[ip] &lt; 0 || izs[ip] &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>)</div>
<div class="line"><span class="lineno">12140</span>      izs[ip] = -1;</div>
<div class="line"><span class="lineno">12141</span>  }</div>
<div class="line"><span class="lineno">12142</span> </div>
<div class="line"><span class="lineno">12143</span>  <span class="comment">/* Average data... */</span></div>
<div class="line"><span class="lineno">12144</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++)</div>
<div class="line"><span class="lineno">12145</span>    <span class="keywordflow">if</span> (izs[ip] &gt;= 0) {</div>
<div class="line"><span class="lineno">12146</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> idx =</div>
<div class="line"><span class="lineno">12147</span>        <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ixs[ip], iys[ip], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, izs[ip], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12148</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> kernel = <a class="code hl_function" href="mptrac_8c.html#ae61cf973263fcc45574daa27d0dec8cd">kernel_weight</a>(kz, kw, nk, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]);</div>
<div class="line"><span class="lineno">12149</span>      np[idx]++;</div>
<div class="line"><span class="lineno">12150</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12151</span>        mean[iq][idx] += kernel * atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq][ip];</div>
<div class="line"><span class="lineno">12152</span>        sigma[iq][idx] += <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(kernel * atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq][ip]);</div>
<div class="line"><span class="lineno">12153</span>      }</div>
<div class="line"><span class="lineno">12154</span>    }</div>
<div class="line"><span class="lineno">12155</span> </div>
<div class="line"><span class="lineno">12156</span>  <span class="comment">/* Calculate column density and volume mixing ratio... */</span></div>
<div class="line"><span class="lineno">12157</span><span class="preprocessor">#pragma omp parallel for default(shared)</span></div>
<div class="line"><span class="lineno">12158</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>; ix++)</div>
<div class="line"><span class="lineno">12159</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>; iy++)</div>
<div class="line"><span class="lineno">12160</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>; iz++) {</div>
<div class="line"><span class="lineno">12161</span> </div>
<div class="line"><span class="lineno">12162</span>        <span class="comment">/* Get grid index... */</span></div>
<div class="line"><span class="lineno">12163</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12164</span> </div>
<div class="line"><span class="lineno">12165</span>        <span class="comment">/* Calculate column density... */</span></div>
<div class="line"><span class="lineno">12166</span>        cd[idx] = NAN;</div>
<div class="line"><span class="lineno">12167</span>        <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &gt;= 0)</div>
<div class="line"><span class="lineno">12168</span>          cd[idx] = mean[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][idx] / (1e6 * area[iy]);</div>
<div class="line"><span class="lineno">12169</span> </div>
<div class="line"><span class="lineno">12170</span>        <span class="comment">/* Calculate volume mixing ratio (implicit)... */</span></div>
<div class="line"><span class="lineno">12171</span>        vmr_impl[idx] = NAN;</div>
<div class="line"><span class="lineno">12172</span>        <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &gt;= 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> &gt; 0 &amp;&amp; met0 != NULL</div>
<div class="line"><span class="lineno">12173</span>            &amp;&amp; met1 != NULL) {</div>
<div class="line"><span class="lineno">12174</span>          vmr_impl[idx] = 0;</div>
<div class="line"><span class="lineno">12175</span>          <span class="keywordflow">if</span> (mean[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][idx] &gt; 0) {</div>
<div class="line"><span class="lineno">12176</span> </div>
<div class="line"><span class="lineno">12177</span>            <span class="comment">/* Get temperature... */</span></div>
<div class="line"><span class="lineno">12178</span>            <span class="keywordtype">double</span> temp;</div>
<div class="line"><span class="lineno">12179</span>            <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno">12180</span>            <a class="code hl_function" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, t, press[iz],</div>
<div class="line"><span class="lineno">12181</span>                               lon[ix], lat[iy], &amp;temp, ci, cw, 1);</div>
<div class="line"><span class="lineno">12182</span> </div>
<div class="line"><span class="lineno">12183</span>            <span class="comment">/* Calculate volume mixing ratio... */</span></div>
<div class="line"><span class="lineno">12184</span>            vmr_impl[idx] =</div>
<div class="line"><span class="lineno">12185</span>              <a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a> / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> * cd[idx] / (<a class="code hl_define" href="mptrac_8h.html#ae088e183d18a16fd6ab469d48ce3f06a">RHO</a>(press[iz], temp) * dz * 1e3);</div>
<div class="line"><span class="lineno">12186</span>          }</div>
<div class="line"><span class="lineno">12187</span>        }</div>
<div class="line"><span class="lineno">12188</span> </div>
<div class="line"><span class="lineno">12189</span>        <span class="comment">/* Calculate mean... */</span></div>
<div class="line"><span class="lineno">12190</span>        <span class="keywordflow">if</span> (np[idx] &gt; 0)</div>
<div class="line"><span class="lineno">12191</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12192</span>            mean[iq][idx] /= np[idx];</div>
<div class="line"><span class="lineno">12193</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> var = sigma[iq][idx] / np[idx] - <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(mean[iq][idx]);</div>
<div class="line"><span class="lineno">12194</span>            sigma[iq][idx] = (var &gt; 0 ? sqrt(var) : 0);</div>
<div class="line"><span class="lineno">12195</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">12196</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12197</span>            mean[iq][idx] = NAN;</div>
<div class="line"><span class="lineno">12198</span>            sigma[iq][idx] = NAN;</div>
<div class="line"><span class="lineno">12199</span>          }</div>
<div class="line"><span class="lineno">12200</span>      }</div>
<div class="line"><span class="lineno">12201</span> </div>
<div class="line"><span class="lineno">12202</span>  <span class="comment">/* Write ASCII data... */</span></div>
<div class="line"><span class="lineno">12203</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a37c580065a63c21f5421ee78e3c4b3d9">grid_type</a> == 0)</div>
<div class="line"><span class="lineno">12204</span>    <a class="code hl_function" href="mptrac_8c.html#a543c818eac1224703400c9554104d643">write_grid_asc</a>(filename, ctl, cd, mean, sigma, vmr_impl,</div>
<div class="line"><span class="lineno">12205</span>                   t, z, lon, lat, area, dz, np);</div>
<div class="line"><span class="lineno">12206</span> </div>
<div class="line"><span class="lineno">12207</span>  <span class="comment">/* Write netCDF data... */</span></div>
<div class="line"><span class="lineno">12208</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a37c580065a63c21f5421ee78e3c4b3d9">grid_type</a> == 1)</div>
<div class="line"><span class="lineno">12209</span>    <a class="code hl_function" href="mptrac_8c.html#ae0a8f7561c1902f48e3ba8e9731eba9f">write_grid_nc</a>(filename, ctl, cd, mean, sigma, vmr_impl,</div>
<div class="line"><span class="lineno">12210</span>                  t, z, lon, lat, area, dz, np);</div>
<div class="line"><span class="lineno">12211</span> </div>
<div class="line"><span class="lineno">12212</span>  <span class="comment">/* Error message... */</span></div>
<div class="line"><span class="lineno">12213</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">12214</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Grid data format GRID_TYPE unknown!&quot;</span>);</div>
<div class="line"><span class="lineno">12215</span> </div>
<div class="line"><span class="lineno">12216</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">12217</span>  free(cd);</div>
<div class="line"><span class="lineno">12218</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12219</span>    free(mean[iq]);</div>
<div class="line"><span class="lineno">12220</span>    free(sigma[iq]);</div>
<div class="line"><span class="lineno">12221</span>  }</div>
<div class="line"><span class="lineno">12222</span>  free(vmr_impl);</div>
<div class="line"><span class="lineno">12223</span>  free(z);</div>
<div class="line"><span class="lineno">12224</span>  free(lon);</div>
<div class="line"><span class="lineno">12225</span>  free(lat);</div>
<div class="line"><span class="lineno">12226</span>  free(area);</div>
<div class="line"><span class="lineno">12227</span>  free(press);</div>
<div class="line"><span class="lineno">12228</span>  free(np);</div>
<div class="line"><span class="lineno">12229</span>  free(ixs);</div>
<div class="line"><span class="lineno">12230</span>  free(iys);</div>
<div class="line"><span class="lineno">12231</span>  free(izs);</div>
<div class="line"><span class="lineno">12232</span>}</div>
<div class="ttc" id="amptrac_8c_html_a543c818eac1224703400c9554104d643"><div class="ttname"><a href="mptrac_8c.html#a543c818eac1224703400c9554104d643">write_grid_asc</a></div><div class="ttdeci">void write_grid_asc(const char *filename, const ctl_t *ctl, const double *cd, double *mean[NQ], double *sigma[NQ], const double *vmr_impl, const double t, const double *z, const double *lon, const double *lat, const double *area, const double dz, const int *np)</div><div class="ttdoc">Writes grid data to an ASCII file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l12236">mptrac.c:12236</a></div></div>
<div class="ttc" id="amptrac_8c_html_ae0a8f7561c1902f48e3ba8e9731eba9f"><div class="ttname"><a href="mptrac_8c.html#ae0a8f7561c1902f48e3ba8e9731eba9f">write_grid_nc</a></div><div class="ttdeci">void write_grid_nc(const char *filename, const ctl_t *ctl, const double *cd, double *mean[NQ], double *sigma[NQ], const double *vmr_impl, const double t, const double *z, const double *lon, const double *lat, const double *area, const double dz, const int *np)</div><div class="ttdoc">Writes grid data to a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l12340">mptrac.c:12340</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_af185d3a188bc2279135c58c8d5f24795_cgraph.png" border="0" usemap="#amptrac_8h_af185d3a188bc2279135c58c8d5f24795_cgraph" alt=""/></div>
<map name="amptrac_8h_af185d3a188bc2279135c58c8d5f24795_cgraph" id="amptrac_8h_af185d3a188bc2279135c58c8d5f24795_cgraph">
<area shape="rect" title="Writes grid data to a file in ASCII or netCDF format." alt="" coords="5,157,84,184"/>
<area shape="rect" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6" title="Interpolates meteorological data in 3D space and time." alt="" coords="132,56,267,83"/>
<area shape="rect" href="mptrac_8c.html#ae61cf973263fcc45574daa27d0dec8cd" title="Calculates the kernel weight based on altitude and given kernel data." alt="" coords="336,107,439,133"/>
<area shape="rect" href="mptrac_8c.html#a7a3277ab872141360b876c25b5643ba6" title="Reads kernel function data from a file and populates the provided arrays." alt="" coords="155,157,244,184"/>
<area shape="rect" href="mptrac_8c.html#a543c818eac1224703400c9554104d643" title="Writes grid data to an ASCII file." alt="" coords="146,208,253,235"/>
<area shape="rect" href="mptrac_8c.html#ae0a8f7561c1902f48e3ba8e9731eba9f" title="Writes grid data to a NetCDF file." alt="" coords="150,259,249,285"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="315,56,460,83"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="508,5,648,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="541,107,615,133"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="537,56,619,83"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="348,208,427,235"/>
</map>
</div>

</div>
</div>
<a id="a543c818eac1224703400c9554104d643" name="a543c818eac1224703400c9554104d643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a543c818eac1224703400c9554104d643">&#9670;&nbsp;</a></span>write_grid_asc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_grid_asc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>cd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mean</em>[NQ], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sigma</em>[NQ], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>vmr_impl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>np</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes grid data to an ASCII file. </p>
<p >The <code>write_grid_asc</code> function writes gridded air parcel data, including column density, mean and standard deviation for specified quantities, and volume mixing ratio (if available), to an ASCII file. The function also supports writing gnuplot commands to generate plots if requested in the control parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the name of the output file. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">cd</td><td>An array of doubles representing column density values. </td></tr>
    <tr><td class="paramname">mean</td><td>An array of arrays of doubles representing the mean values for specified quantities. </td></tr>
    <tr><td class="paramname">sigma</td><td>An array of arrays of doubles representing the standard deviation values for specified quantities. </td></tr>
    <tr><td class="paramname">vmr_impl</td><td>An array of doubles representing the volume mixing ratio (implicit) values. </td></tr>
    <tr><td class="paramname">t</td><td>A double representing the current time. </td></tr>
    <tr><td class="paramname">z</td><td>An array of doubles representing vertical coordinates (altitude). </td></tr>
    <tr><td class="paramname">lon</td><td>An array of doubles representing longitudinal coordinates. </td></tr>
    <tr><td class="paramname">lat</td><td>An array of doubles representing latitudinal coordinates. </td></tr>
    <tr><td class="paramname">area</td><td>An array of doubles representing surface area values. </td></tr>
    <tr><td class="paramname">dz</td><td>A double representing the layer depth. </td></tr>
    <tr><td class="paramname">np</td><td>An array of integers representing the number of particles.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Checks if gnuplot output is requested in the control parameters and sets up a gnuplot pipe if needed.</li>
<li>If gnuplot output is requested, sets the plot filename and time string, and dumps gnuplot file contents to the pipe.</li>
<li>Otherwise, creates the output file for writing in ASCII format.</li>
<li>Writes the header information to the output file, including column labels.</li>
<li>Writes the grid data to the output file, including time, altitude, coordinates, surface area, layer depth, column density, volume mixing ratio, number of particles, mean values for specified quantities, and standard deviation values if requested.</li>
<li>Closes the output file.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The function supports writing gnuplot commands to generate plots if requested in the control parameters. It also supports writing mean and standard deviation values for specified quantities if requested.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l12236">12236</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">12249</span>                 {</div>
<div class="line"><span class="lineno">12250</span> </div>
<div class="line"><span class="lineno">12251</span>  FILE *out;</div>
<div class="line"><span class="lineno">12252</span> </div>
<div class="line"><span class="lineno">12253</span>  <span class="comment">/* Check if gnuplot output is requested... */</span></div>
<div class="line"><span class="lineno">12254</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a30f012c96cb05d5a99004d9ce032277c">grid_gpfile</a>[0] != <span class="charliteral">&#39;-&#39;</span>) {</div>
<div class="line"><span class="lineno">12255</span> </div>
<div class="line"><span class="lineno">12256</span>    <span class="comment">/* Create gnuplot pipe... */</span></div>
<div class="line"><span class="lineno">12257</span>    <span class="keywordflow">if</span> (!(out = popen(<span class="stringliteral">&quot;gnuplot&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">12258</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create pipe to gnuplot!&quot;</span>);</div>
<div class="line"><span class="lineno">12259</span> </div>
<div class="line"><span class="lineno">12260</span>    <span class="comment">/* Set plot filename... */</span></div>
<div class="line"><span class="lineno">12261</span>    fprintf(out, <span class="stringliteral">&quot;set out \&quot;%s.png\&quot;\n&quot;</span>, filename);</div>
<div class="line"><span class="lineno">12262</span> </div>
<div class="line"><span class="lineno">12263</span>    <span class="comment">/* Set time string... */</span></div>
<div class="line"><span class="lineno">12264</span>    <span class="keywordtype">double</span> r;</div>
<div class="line"><span class="lineno">12265</span>    <span class="keywordtype">int</span> year, mon, day, hour, min, sec;</div>
<div class="line"><span class="lineno">12266</span>    <a class="code hl_function" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9">jsec2time</a>(t, &amp;year, &amp;mon, &amp;day, &amp;hour, &amp;min, &amp;sec, &amp;r);</div>
<div class="line"><span class="lineno">12267</span>    fprintf(out, <span class="stringliteral">&quot;timestr=\&quot;%d-%02d-%02d, %02d:%02d UTC\&quot;\n&quot;</span>,</div>
<div class="line"><span class="lineno">12268</span>            year, mon, day, hour, min);</div>
<div class="line"><span class="lineno">12269</span> </div>
<div class="line"><span class="lineno">12270</span>    <span class="comment">/* Dump gnuplot file to pipe... */</span></div>
<div class="line"><span class="lineno">12271</span>    FILE *in;</div>
<div class="line"><span class="lineno">12272</span>    <span class="keywordtype">char</span> line[<a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno">12273</span>    <span class="keywordflow">if</span> (!(in = fopen(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a30f012c96cb05d5a99004d9ce032277c">grid_gpfile</a>, <span class="stringliteral">&quot;r&quot;</span>)))</div>
<div class="line"><span class="lineno">12274</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot open file!&quot;</span>);</div>
<div class="line"><span class="lineno">12275</span>    <span class="keywordflow">while</span> (fgets(line, <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>, in))</div>
<div class="line"><span class="lineno">12276</span>      fprintf(out, <span class="stringliteral">&quot;%s&quot;</span>, line);</div>
<div class="line"><span class="lineno">12277</span>    fclose(in);</div>
<div class="line"><span class="lineno">12278</span>  }</div>
<div class="line"><span class="lineno">12279</span> </div>
<div class="line"><span class="lineno">12280</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">12281</span> </div>
<div class="line"><span class="lineno">12282</span>    <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">12283</span>    <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">12284</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno">12285</span>  }</div>
<div class="line"><span class="lineno">12286</span> </div>
<div class="line"><span class="lineno">12287</span>  <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno">12288</span>  fprintf(out,</div>
<div class="line"><span class="lineno">12289</span>          <span class="stringliteral">&quot;# $1 = time [s]\n&quot;</span></div>
<div class="line"><span class="lineno">12290</span>          <span class="stringliteral">&quot;# $2 = altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno">12291</span>          <span class="stringliteral">&quot;# $3 = longitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno">12292</span>          <span class="stringliteral">&quot;# $4 = latitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno">12293</span>          <span class="stringliteral">&quot;# $5 = surface area [km^2]\n&quot;</span></div>
<div class="line"><span class="lineno">12294</span>          <span class="stringliteral">&quot;# $6 = layer depth [km]\n&quot;</span></div>
<div class="line"><span class="lineno">12295</span>          <span class="stringliteral">&quot;# $7 = column density (implicit) [kg/m^2]\n&quot;</span></div>
<div class="line"><span class="lineno">12296</span>          <span class="stringliteral">&quot;# $8 = volume mixing ratio (implicit) [ppv]\n&quot;</span></div>
<div class="line"><span class="lineno">12297</span>          <span class="stringliteral">&quot;# $9 = number of particles [1]\n&quot;</span>);</div>
<div class="line"><span class="lineno">12298</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">12299</span>    fprintf(out, <span class="stringliteral">&quot;# $%i = %s (mean) [%s]\n&quot;</span>, 10 + iq, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq],</div>
<div class="line"><span class="lineno">12300</span>            ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq]);</div>
<div class="line"><span class="lineno">12301</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3b10e6157d7ccde448863065a4df9558">grid_stddev</a>)</div>
<div class="line"><span class="lineno">12302</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">12303</span>      fprintf(out, <span class="stringliteral">&quot;# $%i = %s (stddev) [%s]\n&quot;</span>, 10 + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a> + iq,</div>
<div class="line"><span class="lineno">12304</span>              ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq]);</div>
<div class="line"><span class="lineno">12305</span>  fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">12306</span> </div>
<div class="line"><span class="lineno">12307</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">12308</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>; ix++) {</div>
<div class="line"><span class="lineno">12309</span>    <span class="keywordflow">if</span> (ix &gt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a> &gt; 1 &amp;&amp; !ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac7a96c566e02c9e88a73e53248a89cb5">grid_sparse</a>)</div>
<div class="line"><span class="lineno">12310</span>      fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">12311</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>; iy++) {</div>
<div class="line"><span class="lineno">12312</span>      <span class="keywordflow">if</span> (iy &gt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a> &gt; 1 &amp;&amp; !ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac7a96c566e02c9e88a73e53248a89cb5">grid_sparse</a>)</div>
<div class="line"><span class="lineno">12313</span>        fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">12314</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>; iz++) {</div>
<div class="line"><span class="lineno">12315</span>        <span class="keywordtype">int</span> idx = <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12316</span>        <span class="keywordflow">if</span> (!ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ac7a96c566e02c9e88a73e53248a89cb5">grid_sparse</a> || vmr_impl[idx] &gt; 0) {</div>
<div class="line"><span class="lineno">12317</span>          fprintf(out, <span class="stringliteral">&quot;%.2f %g %g %g %g %g %g %g %d&quot;</span>, t, z[iz], lon[ix],</div>
<div class="line"><span class="lineno">12318</span>                  lat[iy], area[iy], dz, cd[idx], vmr_impl[idx], np[idx]);</div>
<div class="line"><span class="lineno">12319</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12320</span>            fprintf(out, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><span class="lineno">12321</span>            fprintf(out, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq], mean[iq][idx]);</div>
<div class="line"><span class="lineno">12322</span>          }</div>
<div class="line"><span class="lineno">12323</span>          <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3b10e6157d7ccde448863065a4df9558">grid_stddev</a>)</div>
<div class="line"><span class="lineno">12324</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12325</span>              fprintf(out, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><span class="lineno">12326</span>              fprintf(out, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq], sigma[iq][idx]);</div>
<div class="line"><span class="lineno">12327</span>            }</div>
<div class="line"><span class="lineno">12328</span>          fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">12329</span>        }</div>
<div class="line"><span class="lineno">12330</span>      }</div>
<div class="line"><span class="lineno">12331</span>    }</div>
<div class="line"><span class="lineno">12332</span>  }</div>
<div class="line"><span class="lineno">12333</span> </div>
<div class="line"><span class="lineno">12334</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">12335</span>  fclose(out);</div>
<div class="line"><span class="lineno">12336</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a543c818eac1224703400c9554104d643_cgraph.png" border="0" usemap="#amptrac_8h_a543c818eac1224703400c9554104d643_cgraph" alt=""/></div>
<map name="amptrac_8h_a543c818eac1224703400c9554104d643_cgraph" id="amptrac_8h_a543c818eac1224703400c9554104d643_cgraph">
<area shape="rect" title="Writes grid data to an ASCII file." alt="" coords="5,5,112,32"/>
<area shape="rect" href="mptrac_8c.html#acc0c1829ca7770d2dd6342f2cdf10bb9" title="Converts Julian seconds to calendar date and time components." alt="" coords="160,5,239,32"/>
</map>
</div>

</div>
</div>
<a id="ae0a8f7561c1902f48e3ba8e9731eba9f" name="ae0a8f7561c1902f48e3ba8e9731eba9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0a8f7561c1902f48e3ba8e9731eba9f">&#9670;&nbsp;</a></span>write_grid_nc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_grid_nc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>cd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mean</em>[NQ], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sigma</em>[NQ], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>vmr_impl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>np</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes grid data to a NetCDF file. </p>
<p >The <code>write_grid_nc</code> function writes gridded air parcel data, including column density, mean and standard deviation for specified quantities, and volume mixing ratio (if available), to a NetCDF file. NetCDF is a self-describing, machine-independent data format for storing scientific data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the name of the output file. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">cd</td><td>An array of doubles representing column density values. </td></tr>
    <tr><td class="paramname">mean</td><td>An array of arrays of doubles representing the mean values for specified quantities. </td></tr>
    <tr><td class="paramname">sigma</td><td>An array of arrays of doubles representing the standard deviation values for specified quantities. </td></tr>
    <tr><td class="paramname">vmr_impl</td><td>An array of doubles representing the volume mixing ratio (implicit) values. </td></tr>
    <tr><td class="paramname">t</td><td>A double representing the current time. </td></tr>
    <tr><td class="paramname">z</td><td>An array of doubles representing vertical coordinates (altitude). </td></tr>
    <tr><td class="paramname">lon</td><td>An array of doubles representing longitudinal coordinates. </td></tr>
    <tr><td class="paramname">lat</td><td>An array of doubles representing latitudinal coordinates. </td></tr>
    <tr><td class="paramname">area</td><td>An array of doubles representing surface area values. </td></tr>
    <tr><td class="paramname">dz</td><td>A double representing the layer depth. </td></tr>
    <tr><td class="paramname">np</td><td>An array of integers representing the number of particles.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Allocates memory for temporary arrays required for writing data.</li>
<li>Creates a NetCDF file with the specified filename.</li>
<li>Defines dimensions and variables in the NetCDF file, along with their attributes.</li>
<li>Writes the data arrays to the NetCDF file.</li>
<li>Closes the NetCDF file.</li>
<li>Frees allocated memory.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>NetCDF files are commonly used in scientific computing and can be accessed by various programming languages and software packages. Additionally, the function supports writing mean and standard deviation values for specified quantities if requested.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l12340">12340</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">12353</span>                 {</div>
<div class="line"><span class="lineno">12354</span> </div>
<div class="line"><span class="lineno">12355</span>  <span class="keywordtype">char</span> longname[2 * <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>], varname[2 * <a class="code hl_define" href="mptrac_8h.html#a05b49c662c073f89e86804f7856622a0">LEN</a>];</div>
<div class="line"><span class="lineno">12356</span> </div>
<div class="line"><span class="lineno">12357</span>  <span class="keywordtype">double</span> *help;</div>
<div class="line"><span class="lineno">12358</span> </div>
<div class="line"><span class="lineno">12359</span>  <span class="keywordtype">int</span> *help2, ncid, dimid[10], varid;</div>
<div class="line"><span class="lineno">12360</span> </div>
<div class="line"><span class="lineno">12361</span>  <span class="keywordtype">size_t</span> start[2], count[2];</div>
<div class="line"><span class="lineno">12362</span> </div>
<div class="line"><span class="lineno">12363</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">12364</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12365</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12366</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help2, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12367</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>);</div>
<div class="line"><span class="lineno">12368</span> </div>
<div class="line"><span class="lineno">12369</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">12370</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_create(filename, NC_NETCDF4, &amp;ncid));</div>
<div class="line"><span class="lineno">12371</span> </div>
<div class="line"><span class="lineno">12372</span>  <span class="comment">/* Define dimensions... */</span></div>
<div class="line"><span class="lineno">12373</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;time&quot;</span>, 1, &amp;dimid[0]));</div>
<div class="line"><span class="lineno">12374</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;z&quot;</span>, (<span class="keywordtype">size_t</span>) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>, &amp;dimid[1]));</div>
<div class="line"><span class="lineno">12375</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;lat&quot;</span>, (<span class="keywordtype">size_t</span>) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, &amp;dimid[2]));</div>
<div class="line"><span class="lineno">12376</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;lon&quot;</span>, (<span class="keywordtype">size_t</span>) ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>, &amp;dimid[3]));</div>
<div class="line"><span class="lineno">12377</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;dz&quot;</span>, 1, &amp;dimid[4]));</div>
<div class="line"><span class="lineno">12378</span> </div>
<div class="line"><span class="lineno">12379</span>  <span class="comment">/* Define variables and their attributes... */</span></div>
<div class="line"><span class="lineno">12380</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;time&quot;</span>, NC_DOUBLE, 1, &amp;dimid[0], <span class="stringliteral">&quot;time&quot;</span>,</div>
<div class="line"><span class="lineno">12381</span>             <span class="stringliteral">&quot;seconds since 2000-01-01 00:00:00 UTC&quot;</span>, 0, 0);</div>
<div class="line"><span class="lineno">12382</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;z&quot;</span>, NC_DOUBLE, 1, &amp;dimid[1], <span class="stringliteral">&quot;altitude&quot;</span>, <span class="stringliteral">&quot;km&quot;</span>, 0, 0);</div>
<div class="line"><span class="lineno">12383</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;lat&quot;</span>, NC_DOUBLE, 1, &amp;dimid[2], <span class="stringliteral">&quot;latitude&quot;</span>, <span class="stringliteral">&quot;degrees_north&quot;</span>, 0,</div>
<div class="line"><span class="lineno">12384</span>             0);</div>
<div class="line"><span class="lineno">12385</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;lon&quot;</span>, NC_DOUBLE, 1, &amp;dimid[3], <span class="stringliteral">&quot;longitude&quot;</span>, <span class="stringliteral">&quot;degrees_east&quot;</span>, 0,</div>
<div class="line"><span class="lineno">12386</span>             0);</div>
<div class="line"><span class="lineno">12387</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;dz&quot;</span>, NC_DOUBLE, 1, &amp;dimid[1], <span class="stringliteral">&quot;layer depth&quot;</span>, <span class="stringliteral">&quot;km&quot;</span>, 0, 0);</div>
<div class="line"><span class="lineno">12388</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;area&quot;</span>, NC_DOUBLE, 1, &amp;dimid[2], <span class="stringliteral">&quot;surface area&quot;</span>, <span class="stringliteral">&quot;km**2&quot;</span>, 0, 0);</div>
<div class="line"><span class="lineno">12389</span> </div>
<div class="line"><span class="lineno">12390</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;cd&quot;</span>, NC_FLOAT, 4, dimid, <span class="stringliteral">&quot;column density&quot;</span>, <span class="stringliteral">&quot;kg m**-2&quot;</span>,</div>
<div class="line"><span class="lineno">12391</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a231a88993a5cba0a0838de7b34d6d621">grid_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12392</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;vmr_impl&quot;</span>, NC_FLOAT, 4, dimid,</div>
<div class="line"><span class="lineno">12393</span>             <span class="stringliteral">&quot;volume mixing ratio (implicit)&quot;</span>, <span class="stringliteral">&quot;ppv&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a231a88993a5cba0a0838de7b34d6d621">grid_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12394</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;np&quot;</span>, NC_INT, 4, dimid, <span class="stringliteral">&quot;number of particles&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>, 0, 0);</div>
<div class="line"><span class="lineno">12395</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12396</span>    sprintf(varname, <span class="stringliteral">&quot;%s_mean&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq]);</div>
<div class="line"><span class="lineno">12397</span>    sprintf(longname, <span class="stringliteral">&quot;%s (mean)&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aef44654a72cbb96ba47c6284bd5f2316">qnt_longname</a>[iq]);</div>
<div class="line"><span class="lineno">12398</span>    <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(varname, NC_DOUBLE, 4, dimid, longname, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq],</div>
<div class="line"><span class="lineno">12399</span>               ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a231a88993a5cba0a0838de7b34d6d621">grid_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a87ac3308dd3334c5614855d437383139">grid_nc_quant</a>[iq]);</div>
<div class="line"><span class="lineno">12400</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3b10e6157d7ccde448863065a4df9558">grid_stddev</a>) {</div>
<div class="line"><span class="lineno">12401</span>      sprintf(varname, <span class="stringliteral">&quot;%s_stddev&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq]);</div>
<div class="line"><span class="lineno">12402</span>      sprintf(longname, <span class="stringliteral">&quot;%s (stddev)&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aef44654a72cbb96ba47c6284bd5f2316">qnt_longname</a>[iq]);</div>
<div class="line"><span class="lineno">12403</span>      <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(varname, NC_DOUBLE, 4, dimid, longname, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq],</div>
<div class="line"><span class="lineno">12404</span>                 ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a231a88993a5cba0a0838de7b34d6d621">grid_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a87ac3308dd3334c5614855d437383139">grid_nc_quant</a>[iq]);</div>
<div class="line"><span class="lineno">12405</span>    }</div>
<div class="line"><span class="lineno">12406</span>  }</div>
<div class="line"><span class="lineno">12407</span>  <span class="comment">/* End definitions... */</span></div>
<div class="line"><span class="lineno">12408</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_enddef(ncid));</div>
<div class="line"><span class="lineno">12409</span> </div>
<div class="line"><span class="lineno">12410</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">12411</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;time&quot;</span>, &amp;t, 0);</div>
<div class="line"><span class="lineno">12412</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;lon&quot;</span>, lon, 0);</div>
<div class="line"><span class="lineno">12413</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;lat&quot;</span>, lat, 0);</div>
<div class="line"><span class="lineno">12414</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;z&quot;</span>, z, 0);</div>
<div class="line"><span class="lineno">12415</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;area&quot;</span>, area, 0);</div>
<div class="line"><span class="lineno">12416</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;dz&quot;</span>, &amp;dz, 0);</div>
<div class="line"><span class="lineno">12417</span> </div>
<div class="line"><span class="lineno">12418</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>; ix++)</div>
<div class="line"><span class="lineno">12419</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>; iy++)</div>
<div class="line"><span class="lineno">12420</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>; iz++)</div>
<div class="line"><span class="lineno">12421</span>        help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(iz, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, ix, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>)] =</div>
<div class="line"><span class="lineno">12422</span>          cd[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>)];</div>
<div class="line"><span class="lineno">12423</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;cd&quot;</span>, help, 0);</div>
<div class="line"><span class="lineno">12424</span> </div>
<div class="line"><span class="lineno">12425</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>; ix++)</div>
<div class="line"><span class="lineno">12426</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>; iy++)</div>
<div class="line"><span class="lineno">12427</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>; iz++)</div>
<div class="line"><span class="lineno">12428</span>        help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(iz, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, ix, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>)] =</div>
<div class="line"><span class="lineno">12429</span>          vmr_impl[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>)];</div>
<div class="line"><span class="lineno">12430</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;vmr_impl&quot;</span>, help, 0);</div>
<div class="line"><span class="lineno">12431</span> </div>
<div class="line"><span class="lineno">12432</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>; ix++)</div>
<div class="line"><span class="lineno">12433</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>; iy++)</div>
<div class="line"><span class="lineno">12434</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>; iz++)</div>
<div class="line"><span class="lineno">12435</span>        help2[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(iz, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, ix, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>)] =</div>
<div class="line"><span class="lineno">12436</span>          np[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>)];</div>
<div class="line"><span class="lineno">12437</span>  <a class="code hl_define" href="mptrac_8h.html#a3ed28cecbf584b977168813e9e2e0e32">NC_PUT_INT</a>(<span class="stringliteral">&quot;np&quot;</span>, help2, 0);</div>
<div class="line"><span class="lineno">12438</span> </div>
<div class="line"><span class="lineno">12439</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12440</span>    sprintf(varname, <span class="stringliteral">&quot;%s_mean&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq]);</div>
<div class="line"><span class="lineno">12441</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>; ix++)</div>
<div class="line"><span class="lineno">12442</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>; iy++)</div>
<div class="line"><span class="lineno">12443</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>; iz++)</div>
<div class="line"><span class="lineno">12444</span>          help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(iz, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, ix, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>)] =</div>
<div class="line"><span class="lineno">12445</span>            mean[iq][<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>)];</div>
<div class="line"><span class="lineno">12446</span>    <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(varname, help, 0);</div>
<div class="line"><span class="lineno">12447</span>  }</div>
<div class="line"><span class="lineno">12448</span> </div>
<div class="line"><span class="lineno">12449</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a3b10e6157d7ccde448863065a4df9558">grid_stddev</a>)</div>
<div class="line"><span class="lineno">12450</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">12451</span>      sprintf(varname, <span class="stringliteral">&quot;%s_stddev&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq]);</div>
<div class="line"><span class="lineno">12452</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>; ix++)</div>
<div class="line"><span class="lineno">12453</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>; iy++)</div>
<div class="line"><span class="lineno">12454</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>; iz++)</div>
<div class="line"><span class="lineno">12455</span>            help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(iz, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, ix, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a235ea5cb832f13023339bafe9eeffd20">grid_nx</a>)] =</div>
<div class="line"><span class="lineno">12456</span>              sigma[iq][<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a9a533d295b5533e6a4ca9197694186c5">grid_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aa315cd84c43255d483d552a0d2c6d18f">grid_nz</a>)];</div>
<div class="line"><span class="lineno">12457</span>      <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(varname, help, 0);</div>
<div class="line"><span class="lineno">12458</span>    }</div>
<div class="line"><span class="lineno">12459</span> </div>
<div class="line"><span class="lineno">12460</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">12461</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno">12462</span> </div>
<div class="line"><span class="lineno">12463</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">12464</span>  free(help);</div>
<div class="line"><span class="lineno">12465</span>  free(help2);</div>
<div class="line"><span class="lineno">12466</span>}</div>
<div class="ttc" id="amptrac_8h_html_a3ed28cecbf584b977168813e9e2e0e32"><div class="ttname"><a href="mptrac_8h.html#a3ed28cecbf584b977168813e9e2e0e32">NC_PUT_INT</a></div><div class="ttdeci">#define NC_PUT_INT(varname, ptr, hyperslab)</div><div class="ttdoc">Write integer data to a NetCDF variable.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01327">mptrac.h:1327</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af330c627ed04b0ae7098b89e2577e733" name="af330c627ed04b0ae7098b89e2577e733"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af330c627ed04b0ae7098b89e2577e733">&#9670;&nbsp;</a></span>write_met_bin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_met_bin </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes meteorological data in binary format to a specified file. </p>
<p >This function writes meteorological data from the <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure to a binary file. The data includes grid and surface data, as well as multi-level data such as temperature, velocity components, and atmospheric properties. The compression options for multi-level data (ZFP) are controlled via the <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure. The function supports multiple variables, such as surface pressure, temperature, wind components, and cloud properties.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A constant character pointer representing the name of the file to write the binary data to. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure, which holds control parameters including the type of meteorological data, compression settings, and grid dimensions. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure that contains the meteorological data to be written to the binary file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function creates a new file to write the data. If the file cannot be created, an error is generated.</li>
<li>The type of meteorological data (<code>ctl-&gt;met_type</code>) and the version of the binary format are written at the beginning of the file.</li>
<li>Grid data such as longitude, latitude, pressure levels, and time are written to the file.</li>
<li>Surface data (e.g., pressure, temperature, wind components) are written using the <code>write_met_bin_2d</code> helper function.</li>
<li>Multi-level (3D) data such as geopotential height, temperature, and wind velocity are written using the <code>write_met_bin_3d</code> function with optional ZFP compression settings.</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l12470">12470</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">12473</span>              {</div>
<div class="line"><span class="lineno">12474</span> </div>
<div class="line"><span class="lineno">12475</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">12476</span>  FILE *out;</div>
<div class="line"><span class="lineno">12477</span>  <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">12478</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno">12479</span> </div>
<div class="line"><span class="lineno">12480</span>  <span class="comment">/* Write type of binary data... */</span></div>
<div class="line"><span class="lineno">12481</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12482</span>         1,</div>
<div class="line"><span class="lineno">12483</span>         out);</div>
<div class="line"><span class="lineno">12484</span> </div>
<div class="line"><span class="lineno">12485</span>  <span class="comment">/* Write version of binary data... */</span></div>
<div class="line"><span class="lineno">12486</span>  <span class="keywordtype">int</span> version = 103;</div>
<div class="line"><span class="lineno">12487</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;version, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12488</span>         1,</div>
<div class="line"><span class="lineno">12489</span>         out);</div>
<div class="line"><span class="lineno">12490</span> </div>
<div class="line"><span class="lineno">12491</span>  <span class="comment">/* Write grid data... */</span></div>
<div class="line"><span class="lineno">12492</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12493</span>         1,</div>
<div class="line"><span class="lineno">12494</span>         out);</div>
<div class="line"><span class="lineno">12495</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12496</span>         1,</div>
<div class="line"><span class="lineno">12497</span>         out);</div>
<div class="line"><span class="lineno">12498</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12499</span>         1,</div>
<div class="line"><span class="lineno">12500</span>         out);</div>
<div class="line"><span class="lineno">12501</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12502</span>         1,</div>
<div class="line"><span class="lineno">12503</span>         out);</div>
<div class="line"><span class="lineno">12504</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12505</span>           (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>,</div>
<div class="line"><span class="lineno">12506</span>         out);</div>
<div class="line"><span class="lineno">12507</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12508</span>           (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>,</div>
<div class="line"><span class="lineno">12509</span>         out);</div>
<div class="line"><span class="lineno">12510</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12511</span>           (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>,</div>
<div class="line"><span class="lineno">12512</span>         out);</div>
<div class="line"><span class="lineno">12513</span> </div>
<div class="line"><span class="lineno">12514</span>  <span class="comment">/* Write surface data... */</span></div>
<div class="line"><span class="lineno">12515</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>, <span class="stringliteral">&quot;PS&quot;</span>);</div>
<div class="line"><span class="lineno">12516</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>, <span class="stringliteral">&quot;TS&quot;</span>);</div>
<div class="line"><span class="lineno">12517</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>, <span class="stringliteral">&quot;ZS&quot;</span>);</div>
<div class="line"><span class="lineno">12518</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>, <span class="stringliteral">&quot;US&quot;</span>);</div>
<div class="line"><span class="lineno">12519</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>, <span class="stringliteral">&quot;VS&quot;</span>);</div>
<div class="line"><span class="lineno">12520</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>, <span class="stringliteral">&quot;ESS&quot;</span>);</div>
<div class="line"><span class="lineno">12521</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>, <span class="stringliteral">&quot;NSS&quot;</span>);</div>
<div class="line"><span class="lineno">12522</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>, <span class="stringliteral">&quot;SHF&quot;</span>);</div>
<div class="line"><span class="lineno">12523</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>, <span class="stringliteral">&quot;LSM&quot;</span>);</div>
<div class="line"><span class="lineno">12524</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>, <span class="stringliteral">&quot;SST&quot;</span>);</div>
<div class="line"><span class="lineno">12525</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>, <span class="stringliteral">&quot;PBL&quot;</span>);</div>
<div class="line"><span class="lineno">12526</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>, <span class="stringliteral">&quot;PT&quot;</span>);</div>
<div class="line"><span class="lineno">12527</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a9677a606f7850c8143f698e9fb15273f">tt</a>, <span class="stringliteral">&quot;TT&quot;</span>);</div>
<div class="line"><span class="lineno">12528</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a043690c89804f40d4a8940b7d3393707">zt</a>, <span class="stringliteral">&quot;ZT&quot;</span>);</div>
<div class="line"><span class="lineno">12529</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#ac87fdccf57a65247062baccf2c2e85e8">h2ot</a>, <span class="stringliteral">&quot;H2OT&quot;</span>);</div>
<div class="line"><span class="lineno">12530</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a29d404429eb9f4e95bf8fa1132455fdd">pct</a>, <span class="stringliteral">&quot;PCT&quot;</span>);</div>
<div class="line"><span class="lineno">12531</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a7c44ec7c0c9f471ca8ca700adb3596c3">pcb</a>, <span class="stringliteral">&quot;PCB&quot;</span>);</div>
<div class="line"><span class="lineno">12532</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#ae45079d4c0137fa4416dd42ca1f117cd">cl</a>, <span class="stringliteral">&quot;CL&quot;</span>);</div>
<div class="line"><span class="lineno">12533</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">plcl</a>, <span class="stringliteral">&quot;PLCL&quot;</span>);</div>
<div class="line"><span class="lineno">12534</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#af2f85f717aa775b52d4791c97c3ae142">plfc</a>, <span class="stringliteral">&quot;PLFC&quot;</span>);</div>
<div class="line"><span class="lineno">12535</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a7d6776fe9ed1966d6024567d423f0b96">pel</a>, <span class="stringliteral">&quot;PEL&quot;</span>);</div>
<div class="line"><span class="lineno">12536</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>, <span class="stringliteral">&quot;CAPE&quot;</span>);</div>
<div class="line"><span class="lineno">12537</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>, <span class="stringliteral">&quot;CIN&quot;</span>);</div>
<div class="line"><span class="lineno">12538</span>  <a class="code hl_function" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a>(out, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a0ab0cfbc1e5fe1a5c9ce3412cc4400a8">o3c</a>, <span class="stringliteral">&quot;O3C&quot;</span>);</div>
<div class="line"><span class="lineno">12539</span> </div>
<div class="line"><span class="lineno">12540</span>  <span class="comment">/* Write level data... */</span></div>
<div class="line"><span class="lineno">12541</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#aaaa04cf36044fcc02d518fe667d63bb3">z</a>, <span class="stringliteral">&quot;Z&quot;</span>,</div>
<div class="line"><span class="lineno">12542</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[0], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[0]);</div>
<div class="line"><span class="lineno">12543</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, <span class="stringliteral">&quot;T&quot;</span>,</div>
<div class="line"><span class="lineno">12544</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[1], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[1]);</div>
<div class="line"><span class="lineno">12545</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>, <span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line"><span class="lineno">12546</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[2], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[2]);</div>
<div class="line"><span class="lineno">12547</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>, <span class="stringliteral">&quot;V&quot;</span>,</div>
<div class="line"><span class="lineno">12548</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[3], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[3]);</div>
<div class="line"><span class="lineno">12549</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>, <span class="stringliteral">&quot;W&quot;</span>,</div>
<div class="line"><span class="lineno">12550</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[4], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[4]);</div>
<div class="line"><span class="lineno">12551</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#ac8e46cfdfc9fc8cfef4e2b801834a61c">pv</a>, <span class="stringliteral">&quot;PV&quot;</span>,</div>
<div class="line"><span class="lineno">12552</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[5], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[5]);</div>
<div class="line"><span class="lineno">12553</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>, <span class="stringliteral">&quot;H2O&quot;</span>,</div>
<div class="line"><span class="lineno">12554</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[6], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[6]);</div>
<div class="line"><span class="lineno">12555</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>, <span class="stringliteral">&quot;O3&quot;</span>,</div>
<div class="line"><span class="lineno">12556</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[7], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[7]);</div>
<div class="line"><span class="lineno">12557</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>, <span class="stringliteral">&quot;LWC&quot;</span>,</div>
<div class="line"><span class="lineno">12558</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[8], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[8]);</div>
<div class="line"><span class="lineno">12559</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>, <span class="stringliteral">&quot;RWC&quot;</span>,</div>
<div class="line"><span class="lineno">12560</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[9], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[9]);</div>
<div class="line"><span class="lineno">12561</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>, <span class="stringliteral">&quot;IWC&quot;</span>,</div>
<div class="line"><span class="lineno">12562</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[10], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[10]);</div>
<div class="line"><span class="lineno">12563</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>, <span class="stringliteral">&quot;SWC&quot;</span>,</div>
<div class="line"><span class="lineno">12564</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[11], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[11]);</div>
<div class="line"><span class="lineno">12565</span>  <a class="code hl_function" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a>(out, ctl, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>, <span class="stringliteral">&quot;CC&quot;</span>,</div>
<div class="line"><span class="lineno">12566</span>                   ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a6662fe4a16e40dd370963936f5f1a833">met_comp_prec</a>[12], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2239f6bc182dca64b8cf50f23dff3940">met_comp_tol</a>[12]);</div>
<div class="line"><span class="lineno">12567</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="mptrac_8h.html#a1d2af32106d1fe82729714d3aa28a1c4">METVAR</a> != 13)</div>
<div class="line"><span class="lineno">12568</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Number of meteo variables doesn&#39;t match!&quot;</span>);</div>
<div class="line"><span class="lineno">12569</span> </div>
<div class="line"><span class="lineno">12570</span>  <span class="comment">/* Write final flag... */</span></div>
<div class="line"><span class="lineno">12571</span>  <span class="keywordtype">int</span> <span class="keyword">final</span> = 999;</div>
<div class="line"><span class="lineno">12572</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;<span class="keyword">final</span>, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12573</span>         1,</div>
<div class="line"><span class="lineno">12574</span>         out);</div>
<div class="line"><span class="lineno">12575</span> </div>
<div class="line"><span class="lineno">12576</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">12577</span>  fclose(out);</div>
<div class="line"><span class="lineno">12578</span>}</div>
<div class="ttc" id="amptrac_8c_html_a135c74d7aa047461b2a8c72b312bd567"><div class="ttname"><a href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567">write_met_bin_3d</a></div><div class="ttdeci">void write_met_bin_3d(FILE *out, const ctl_t *ctl, met_t *met, float var[EX][EY][EP], const char *varname, const int precision, const double tolerance)</div><div class="ttdoc">Writes a 3-dimensional meteorological variable to a binary file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l12611">mptrac.c:12611</a></div></div>
<div class="ttc" id="amptrac_8c_html_ac27e0e729035eecb9097b57538aa1669"><div class="ttname"><a href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669">write_met_bin_2d</a></div><div class="ttdeci">void write_met_bin_2d(FILE *out, met_t *met, float var[EX][EY], const char *varname)</div><div class="ttdoc">Writes a 2-dimensional meteorological variable to a binary file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l12582">mptrac.c:12582</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_af330c627ed04b0ae7098b89e2577e733_cgraph.png" border="0" usemap="#amptrac_8h_af330c627ed04b0ae7098b89e2577e733_cgraph" alt=""/></div>
<map name="amptrac_8h_af330c627ed04b0ae7098b89e2577e733_cgraph" id="amptrac_8h_af330c627ed04b0ae7098b89e2577e733_cgraph">
<area shape="rect" title="Writes meteorological data in binary format to a specified file." alt="" coords="5,81,108,108"/>
<area shape="rect" href="mptrac_8c.html#ac27e0e729035eecb9097b57538aa1669" title="Writes a 2&#45;dimensional meteorological variable to a binary file." alt="" coords="156,56,280,83"/>
<area shape="rect" href="mptrac_8c.html#a135c74d7aa047461b2a8c72b312bd567" title="Writes a 3&#45;dimensional meteorological variable to a binary file." alt="" coords="156,107,280,133"/>
<area shape="rect" href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14" title="Compresses or decompresses a 3&#45;D meteorological field using cmultiscale." alt="" coords="328,5,439,32"/>
<area shape="rect" href="mptrac_8c.html#a61bbe35a4ff7b797fdb64f9797a3ffd1" title="Compresses or decompresses a 3D array of floats." alt="" coords="330,56,437,83"/>
<area shape="rect" href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3" title="Compresses or decompresses a 3&#45;D float array using the SZ3 library." alt="" coords="330,107,437,133"/>
<area shape="rect" href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72" title="Compresses or decompresses a 3D array of floats using the ZFP library." alt="" coords="332,157,435,184"/>
<area shape="rect" href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c" title="Compresses or decompresses a float array using Zstandard (ZSTD)." alt="" coords="328,208,439,235"/>
</map>
</div>

</div>
</div>
<a id="ac27e0e729035eecb9097b57538aa1669" name="ac27e0e729035eecb9097b57538aa1669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac27e0e729035eecb9097b57538aa1669">&#9670;&nbsp;</a></span>write_met_bin_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_met_bin_2d </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>var</em>[EX][EY], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a 2-dimensional meteorological variable to a binary file. </p>
<p >The <code>write_met_bin_2d</code> function writes a 2-dimensional meteorological variable to a binary file specified by the <code>out</code> parameter. The variable data is provided in a 2-dimensional array <code>var</code> with maximum dimensions <code>EX</code> by <code>EY</code>. The variable name is provided as a string in the <code>varname</code> parameter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>A pointer to a FILE structure representing the output file. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure containing meteorological data. </td></tr>
    <tr><td class="paramname">var</td><td>An array of floats representing the 2-dimensional variable data. </td></tr>
    <tr><td class="paramname">varname</td><td>A string containing the name of the variable being written.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Allocates memory for a temporary buffer to hold the variable data.</li>
<li>Copies the variable data from the 2-dimensional array <code>var</code> to the temporary buffer <code>help</code>.</li>
<li>Writes the uncompressed variable data to the binary file specified by <code>out</code>.</li>
<li>Logs a message indicating the successful writing of the variable data.</li>
<li>Frees the allocated memory.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function is typically used to write surface data or other 2-dimensional meteorological variables to a binary file.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l12582">12582</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">12586</span>                       {</div>
<div class="line"><span class="lineno">12587</span> </div>
<div class="line"><span class="lineno">12588</span>  <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno">12589</span> </div>
<div class="line"><span class="lineno">12590</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">12591</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno">12592</span>        <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>);</div>
<div class="line"><span class="lineno">12593</span> </div>
<div class="line"><span class="lineno">12594</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno">12595</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">12596</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno">12597</span>      help[<a class="code hl_define" href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a>(ix, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>)] = var[ix][iy];</div>
<div class="line"><span class="lineno">12598</span> </div>
<div class="line"><span class="lineno">12599</span>  <span class="comment">/* Write uncompressed data... */</span></div>
<div class="line"><span class="lineno">12600</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Write 2-D variable: %s (uncompressed)&quot;</span>, varname);</div>
<div class="line"><span class="lineno">12601</span>  <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno">12602</span>           (<span class="keywordtype">size_t</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>),</div>
<div class="line"><span class="lineno">12603</span>         out);</div>
<div class="line"><span class="lineno">12604</span> </div>
<div class="line"><span class="lineno">12605</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">12606</span>  free(help);</div>
<div class="line"><span class="lineno">12607</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a135c74d7aa047461b2a8c72b312bd567" name="a135c74d7aa047461b2a8c72b312bd567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a135c74d7aa047461b2a8c72b312bd567">&#9670;&nbsp;</a></span>write_met_bin_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_met_bin_3d </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>var</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>precision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a 3-dimensional meteorological variable to a binary file. </p>
<p >The <code>write_met_bin_3d</code> function writes a 3-dimensional meteorological variable to a binary file specified by the <code>out</code> parameter. The variable data is provided in a 3-dimensional array <code>var</code> with maximum dimensions <code>EX</code> by <code>EY</code> by <code>EP</code>. The variable name is provided as a string in the <code>varname</code> parameter. Additionally, the function takes parameters for specifying the compression precision and tolerance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>A pointer to a FILE structure representing the output file. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure containing meteorological data. </td></tr>
    <tr><td class="paramname">var</td><td>An array of floats representing the 3-dimensional variable data. </td></tr>
    <tr><td class="paramname">varname</td><td>A string containing the name of the variable being written. </td></tr>
    <tr><td class="paramname">precision</td><td>An integer specifying the precision of compression (for certain compression methods). </td></tr>
    <tr><td class="paramname">tolerance</td><td>A double specifying the tolerance for compression (for certain compression methods).</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Allocates memory for a temporary buffer to hold the variable data.</li>
<li>Copies the variable data from the 3-dimensional array <code>var</code> to the temporary buffer <code>help</code>.</li>
<li>Writes the variable data to the binary file specified by <code>out</code> using the specified compression method (uncompressed, packed, ZFP, ZSTD, cmultiscale).</li>
<li>Logs a message indicating the successful writing of the variable data.</li>
<li>Frees the allocated memory.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function is typically used to write level data or other 3-dimensional meteorological variables to a binary file.</dd>
<dd>
Depending on the value of <code>ctl-&gt;met_type</code>, the function writes the variable data using different compression methods. If <code>ctl-&gt;met_type</code> is not supported, an error message is logged.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l12611">12611</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">12618</span>                          {</div>
<div class="line"><span class="lineno">12619</span> </div>
<div class="line"><span class="lineno">12620</span>  <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno">12621</span> </div>
<div class="line"><span class="lineno">12622</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">12623</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno">12624</span>        <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> * <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>);</div>
<div class="line"><span class="lineno">12625</span> </div>
<div class="line"><span class="lineno">12626</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno">12627</span><span class="preprocessor">#pragma omp parallel for default(shared) collapse(2)</span></div>
<div class="line"><span class="lineno">12628</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">12629</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno">12630</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno">12631</span>        help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, ip, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>)] = var[ix][iy][ip];</div>
<div class="line"><span class="lineno">12632</span> </div>
<div class="line"><span class="lineno">12633</span>  <span class="comment">/* Write uncompressed data... */</span></div>
<div class="line"><span class="lineno">12634</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 1) {</div>
<div class="line"><span class="lineno">12635</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(2, <span class="stringliteral">&quot;Write 3-D variable: %s (uncompressed)&quot;</span>, varname);</div>
<div class="line"><span class="lineno">12636</span>    <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno">12637</span>             (<span class="keywordtype">size_t</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>),</div>
<div class="line"><span class="lineno">12638</span>           out);</div>
<div class="line"><span class="lineno">12639</span>  }</div>
<div class="line"><span class="lineno">12640</span> </div>
<div class="line"><span class="lineno">12641</span>  <span class="comment">/* Write packed data... */</span></div>
<div class="line"><span class="lineno">12642</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 2)</div>
<div class="line"><span class="lineno">12643</span>    <a class="code hl_function" href="mptrac_8c.html#a61bbe35a4ff7b797fdb64f9797a3ffd1">compress_pck</a>(varname, help, (<span class="keywordtype">size_t</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>),</div>
<div class="line"><span class="lineno">12644</span>                 (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, 0, out);</div>
<div class="line"><span class="lineno">12645</span> </div>
<div class="line"><span class="lineno">12646</span>  <span class="comment">/* Write ZFP data... */</span></div>
<div class="line"><span class="lineno">12647</span><span class="preprocessor">#ifdef ZFP</span></div>
<div class="line"><span class="lineno">12648</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 3) {</div>
<div class="line"><span class="lineno">12649</span>    <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;precision, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12650</span>           1,</div>
<div class="line"><span class="lineno">12651</span>           out);</div>
<div class="line"><span class="lineno">12652</span>    <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;tolerance, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12653</span>           1,</div>
<div class="line"><span class="lineno">12654</span>           out);</div>
<div class="line"><span class="lineno">12655</span>    <a class="code hl_function" href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72">compress_zfp</a>(varname, help, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, precision,</div>
<div class="line"><span class="lineno">12656</span>                 tolerance, 0, out);</div>
<div class="line"><span class="lineno">12657</span>  }</div>
<div class="line"><span class="lineno">12658</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">12659</span> </div>
<div class="line"><span class="lineno">12660</span>  <span class="comment">/* Write zstd data... */</span></div>
<div class="line"><span class="lineno">12661</span><span class="preprocessor">#ifdef ZSTD</span></div>
<div class="line"><span class="lineno">12662</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 4)</div>
<div class="line"><span class="lineno">12663</span>    <a class="code hl_function" href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c">compress_zstd</a>(varname, help, (<span class="keywordtype">size_t</span>) (met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a> * met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>), 0,</div>
<div class="line"><span class="lineno">12664</span>                  ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a1601f7c2d8e163790e3a81cc647b7756">met_zstd_level</a>, out);</div>
<div class="line"><span class="lineno">12665</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">12666</span> </div>
<div class="line"><span class="lineno">12667</span>  <span class="comment">/* Write cmultiscale data... */</span></div>
<div class="line"><span class="lineno">12668</span><span class="preprocessor">#ifdef CMS</span></div>
<div class="line"><span class="lineno">12669</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 5) {</div>
<div class="line"><span class="lineno">12670</span>    <a class="code hl_function" href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14">compress_cms</a>(ctl, varname, help, (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>,</div>
<div class="line"><span class="lineno">12671</span>                 (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>, 0, out);</div>
<div class="line"><span class="lineno">12672</span>  }</div>
<div class="line"><span class="lineno">12673</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">12674</span> </div>
<div class="line"><span class="lineno">12675</span>  <span class="comment">/* Write SZ3 data... */</span></div>
<div class="line"><span class="lineno">12676</span><span class="preprocessor">#ifdef SZ3</span></div>
<div class="line"><span class="lineno">12677</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#afc013488cddf18deab78993e93068416">met_type</a> == 7) {</div>
<div class="line"><span class="lineno">12678</span>    <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;precision, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">12679</span>           1,</div>
<div class="line"><span class="lineno">12680</span>           out);</div>
<div class="line"><span class="lineno">12681</span>    <a class="code hl_define" href="mptrac_8h.html#a1e67562ddd8fb52548a4ca02d3640bac">FWRITE</a>(&amp;tolerance, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12682</span>           1,</div>
<div class="line"><span class="lineno">12683</span>           out);</div>
<div class="line"><span class="lineno">12684</span>    <a class="code hl_function" href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3">compress_sz3</a>(varname, help, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, precision,</div>
<div class="line"><span class="lineno">12685</span>                 tolerance, 0, out);</div>
<div class="line"><span class="lineno">12686</span>  }</div>
<div class="line"><span class="lineno">12687</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">12688</span> </div>
<div class="line"><span class="lineno">12689</span>  <span class="comment">/* Unknown method... */</span></div>
<div class="line"><span class="lineno">12690</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">12691</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;MET_TYPE not supported!&quot;</span>);</div>
<div class="line"><span class="lineno">12692</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(3, <span class="stringliteral">&quot;%d %g&quot;</span>, precision, tolerance);</div>
<div class="line"><span class="lineno">12693</span>  }</div>
<div class="line"><span class="lineno">12694</span> </div>
<div class="line"><span class="lineno">12695</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">12696</span>  free(help);</div>
<div class="line"><span class="lineno">12697</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a135c74d7aa047461b2a8c72b312bd567_cgraph.png" border="0" usemap="#amptrac_8h_a135c74d7aa047461b2a8c72b312bd567_cgraph" alt=""/></div>
<map name="amptrac_8h_a135c74d7aa047461b2a8c72b312bd567_cgraph" id="amptrac_8h_a135c74d7aa047461b2a8c72b312bd567_cgraph">
<area shape="rect" title="Writes a 3&#45;dimensional meteorological variable to a binary file." alt="" coords="5,107,129,133"/>
<area shape="rect" href="mptrac_8h.html#a2e72346e130df723f0e0bec4eb739b14" title="Compresses or decompresses a 3&#45;D meteorological field using cmultiscale." alt="" coords="177,5,288,32"/>
<area shape="rect" href="mptrac_8c.html#a61bbe35a4ff7b797fdb64f9797a3ffd1" title="Compresses or decompresses a 3D array of floats." alt="" coords="179,56,286,83"/>
<area shape="rect" href="mptrac_8h.html#ae686ad6d0ce087fddcd62a7b87c768f3" title="Compresses or decompresses a 3&#45;D float array using the SZ3 library." alt="" coords="179,107,286,133"/>
<area shape="rect" href="mptrac_8h.html#a412570d903373ea3f6ca36aa907f3d72" title="Compresses or decompresses a 3D array of floats using the ZFP library." alt="" coords="181,157,284,184"/>
<area shape="rect" href="mptrac_8h.html#a057bb032e8b5df1b2a228b9b7931dd0c" title="Compresses or decompresses a float array using Zstandard (ZSTD)." alt="" coords="177,208,288,235"/>
</map>
</div>

</div>
</div>
<a id="a92ad405ee98c55d656f4b9fcb4957503" name="a92ad405ee98c55d656f4b9fcb4957503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92ad405ee98c55d656f4b9fcb4957503">&#9670;&nbsp;</a></span>write_met_nc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_met_nc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes meteorological data to a NetCDF file. </p>
<p >This function creates and writes meteorological data to a NetCDF file in the NetCDF-4 format. It defines the required dimensions, grid, surface variables, and level data within the NetCDF structure and writes the corresponding values from the <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure. The function uses helper functions to write 2D surface and 3D level data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A constant character pointer representing the name of the NetCDF file to create and write the data to. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure that contains control parameters, such as the NetCDF level and quantization settings. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure that contains the meteorological data to be written to the NetCDF file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function uses the NetCDF-4 format for efficient data storage.</li>
<li>It defines the grid dimensions (time, longitude, latitude, pressure levels) and adds global attributes like units and descriptions for each variable.</li>
<li>The surface variables include surface pressure, geopotential, 2-meter temperature, and wind components, which are defined on a 2D grid (latitude  longitude).</li>
<li>The level variables, such as temperature, wind velocities, and cloud properties, are defined on a 3D grid (pressure level  latitude  longitude).</li>
</ul>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l12701">12701</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">12704</span>              {</div>
<div class="line"><span class="lineno">12705</span> </div>
<div class="line"><span class="lineno">12706</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">12707</span>  <span class="keywordtype">int</span> ncid, varid;</div>
<div class="line"><span class="lineno">12708</span>  <span class="keywordtype">size_t</span> start[4], count[4];</div>
<div class="line"><span class="lineno">12709</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_create(filename, NC_NETCDF4, &amp;ncid));</div>
<div class="line"><span class="lineno">12710</span> </div>
<div class="line"><span class="lineno">12711</span>  <span class="comment">/* Define dimensions... */</span></div>
<div class="line"><span class="lineno">12712</span>  <span class="keywordtype">int</span> tid, lonid, latid, levid;</div>
<div class="line"><span class="lineno">12713</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;time&quot;</span>, 1, &amp;tid));</div>
<div class="line"><span class="lineno">12714</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;lon&quot;</span>, (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>, &amp;lonid));</div>
<div class="line"><span class="lineno">12715</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;lat&quot;</span>, (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, &amp;latid));</div>
<div class="line"><span class="lineno">12716</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_def_dim(ncid, <span class="stringliteral">&quot;lev&quot;</span>, (<span class="keywordtype">size_t</span>) met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>, &amp;levid));</div>
<div class="line"><span class="lineno">12717</span> </div>
<div class="line"><span class="lineno">12718</span>  <span class="comment">/* Define grid... */</span></div>
<div class="line"><span class="lineno">12719</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;time&quot;</span>, NC_DOUBLE, 1, &amp;tid, <span class="stringliteral">&quot;time&quot;</span>,</div>
<div class="line"><span class="lineno">12720</span>             <span class="stringliteral">&quot;seconds since 2000-01-01 00:00:00 UTC&quot;</span>, 0, 0);</div>
<div class="line"><span class="lineno">12721</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;lon&quot;</span>, NC_DOUBLE, 1, &amp;lonid, <span class="stringliteral">&quot;longitude&quot;</span>, <span class="stringliteral">&quot;degrees_east&quot;</span>, 0, 0);</div>
<div class="line"><span class="lineno">12722</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;lat&quot;</span>, NC_DOUBLE, 1, &amp;latid, <span class="stringliteral">&quot;latitude&quot;</span>, <span class="stringliteral">&quot;degrees_north&quot;</span>, 0, 0);</div>
<div class="line"><span class="lineno">12723</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;lev&quot;</span>, NC_DOUBLE, 1, &amp;levid, <span class="stringliteral">&quot;pressure&quot;</span>, <span class="stringliteral">&quot;Pa&quot;</span>, 0, 0);</div>
<div class="line"><span class="lineno">12724</span> </div>
<div class="line"><span class="lineno">12725</span>  <span class="comment">/* Define surface variables... */</span></div>
<div class="line"><span class="lineno">12726</span>  <span class="keywordtype">int</span> dimid2[2] = { latid, lonid };</div>
<div class="line"><span class="lineno">12727</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;sp&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Surface pressure&quot;</span>, <span class="stringliteral">&quot;Pa&quot;</span>,</div>
<div class="line"><span class="lineno">12728</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12729</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;z&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Geopotential&quot;</span>, <span class="stringliteral">&quot;m**2 s**-2&quot;</span>,</div>
<div class="line"><span class="lineno">12730</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12731</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;t2m&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;2 metre temperature&quot;</span>, <span class="stringliteral">&quot;K&quot;</span>,</div>
<div class="line"><span class="lineno">12732</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12733</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;u10m&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;10 metre U wind component&quot;</span>,</div>
<div class="line"><span class="lineno">12734</span>             <span class="stringliteral">&quot;m s**-1&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12735</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;v10m&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;10 metre V wind component&quot;</span>,</div>
<div class="line"><span class="lineno">12736</span>             <span class="stringliteral">&quot;m s**-1&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12737</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;iews&quot;</span>, NC_FLOAT, 2, dimid2,</div>
<div class="line"><span class="lineno">12738</span>             <span class="stringliteral">&quot;Instantaneous eastward turbulent surface stress&quot;</span>, <span class="stringliteral">&quot;N m**-2&quot;</span>,</div>
<div class="line"><span class="lineno">12739</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12740</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;inss&quot;</span>, NC_FLOAT, 2, dimid2,</div>
<div class="line"><span class="lineno">12741</span>             <span class="stringliteral">&quot;Instantaneous northward turbulent surface stress&quot;</span>, <span class="stringliteral">&quot;N m**-2&quot;</span>,</div>
<div class="line"><span class="lineno">12742</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12743</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;ishf&quot;</span>, NC_FLOAT, 2, dimid2,</div>
<div class="line"><span class="lineno">12744</span>             <span class="stringliteral">&quot;Instantaneous surface sensible heat flux&quot;</span>, <span class="stringliteral">&quot;W m**-1&quot;</span>,</div>
<div class="line"><span class="lineno">12745</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12746</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;lsm&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Land/sea mask&quot;</span>, <span class="stringliteral">&quot;-&quot;</span>,</div>
<div class="line"><span class="lineno">12747</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12748</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;sstk&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Sea surface temperature&quot;</span>, <span class="stringliteral">&quot;K&quot;</span>,</div>
<div class="line"><span class="lineno">12749</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12750</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;blp&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Boundary layer pressure&quot;</span>, <span class="stringliteral">&quot;Pa&quot;</span>,</div>
<div class="line"><span class="lineno">12751</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12752</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;pt&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Tropopause pressure&quot;</span>, <span class="stringliteral">&quot;Pa&quot;</span>,</div>
<div class="line"><span class="lineno">12753</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12754</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;tt&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Tropopause temperature&quot;</span>, <span class="stringliteral">&quot;K&quot;</span>,</div>
<div class="line"><span class="lineno">12755</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12756</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;zt&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Tropopause height&quot;</span>, <span class="stringliteral">&quot;m&quot;</span>,</div>
<div class="line"><span class="lineno">12757</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12758</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;h2ot&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Tropopause water vapor&quot;</span>, <span class="stringliteral">&quot;ppv&quot;</span>,</div>
<div class="line"><span class="lineno">12759</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12760</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;pct&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Cloud top pressure&quot;</span>, <span class="stringliteral">&quot;Pa&quot;</span>,</div>
<div class="line"><span class="lineno">12761</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12762</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;pcb&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Cloud bottom pressure&quot;</span>, <span class="stringliteral">&quot;Pa&quot;</span>,</div>
<div class="line"><span class="lineno">12763</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12764</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;cl&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Total column cloud water&quot;</span>,</div>
<div class="line"><span class="lineno">12765</span>             <span class="stringliteral">&quot;kg m**2&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12766</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;plcl&quot;</span>, NC_FLOAT, 2, dimid2,</div>
<div class="line"><span class="lineno">12767</span>             <span class="stringliteral">&quot;Pressure at lifted condensation level (LCL)&quot;</span>, <span class="stringliteral">&quot;Pa&quot;</span>,</div>
<div class="line"><span class="lineno">12768</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12769</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;plfc&quot;</span>, NC_FLOAT, 2, dimid2,</div>
<div class="line"><span class="lineno">12770</span>             <span class="stringliteral">&quot;Pressure at level of free convection (LFC)&quot;</span>, <span class="stringliteral">&quot;Pa&quot;</span>,</div>
<div class="line"><span class="lineno">12771</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12772</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;pel&quot;</span>, NC_FLOAT, 2, dimid2,</div>
<div class="line"><span class="lineno">12773</span>             <span class="stringliteral">&quot;Pressure at equilibrium level (EL)&quot;</span>, <span class="stringliteral">&quot;Pa&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>,</div>
<div class="line"><span class="lineno">12774</span>             0);</div>
<div class="line"><span class="lineno">12775</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;cape&quot;</span>, NC_FLOAT, 2, dimid2,</div>
<div class="line"><span class="lineno">12776</span>             <span class="stringliteral">&quot;Convective available potential energy&quot;</span>, <span class="stringliteral">&quot;J kg**-1&quot;</span>,</div>
<div class="line"><span class="lineno">12777</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12778</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;cin&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Convective inhibition&quot;</span>,</div>
<div class="line"><span class="lineno">12779</span>             <span class="stringliteral">&quot;J kg**-1&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12780</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;o3c&quot;</span>, NC_FLOAT, 2, dimid2, <span class="stringliteral">&quot;Total column ozone&quot;</span>, <span class="stringliteral">&quot;DU&quot;</span>,</div>
<div class="line"><span class="lineno">12781</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, 0);</div>
<div class="line"><span class="lineno">12782</span> </div>
<div class="line"><span class="lineno">12783</span>  <span class="comment">/* Define level data... */</span></div>
<div class="line"><span class="lineno">12784</span>  <span class="keywordtype">int</span> dimid3[3] = { levid, latid, lonid };</div>
<div class="line"><span class="lineno">12785</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;t&quot;</span>, NC_FLOAT, 3, dimid3, <span class="stringliteral">&quot;Temperature&quot;</span>, <span class="stringliteral">&quot;K&quot;</span>,</div>
<div class="line"><span class="lineno">12786</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a>);</div>
<div class="line"><span class="lineno">12787</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;u&quot;</span>, NC_FLOAT, 3, dimid3, <span class="stringliteral">&quot;U velocity&quot;</span>, <span class="stringliteral">&quot;m s**-1&quot;</span>,</div>
<div class="line"><span class="lineno">12788</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a>);</div>
<div class="line"><span class="lineno">12789</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;v&quot;</span>, NC_FLOAT, 3, dimid3, <span class="stringliteral">&quot;V velocity&quot;</span>, <span class="stringliteral">&quot;m s**-1&quot;</span>,</div>
<div class="line"><span class="lineno">12790</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a>);</div>
<div class="line"><span class="lineno">12791</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;w&quot;</span>, NC_FLOAT, 3, dimid3, <span class="stringliteral">&quot;Vertical velocity&quot;</span>, <span class="stringliteral">&quot;Pa s**-1&quot;</span>,</div>
<div class="line"><span class="lineno">12792</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a>);</div>
<div class="line"><span class="lineno">12793</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;q&quot;</span>, NC_FLOAT, 3, dimid3, <span class="stringliteral">&quot;Specific humidity&quot;</span>, <span class="stringliteral">&quot;kg kg**-1&quot;</span>,</div>
<div class="line"><span class="lineno">12794</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a>);</div>
<div class="line"><span class="lineno">12795</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;o3&quot;</span>, NC_FLOAT, 3, dimid3, <span class="stringliteral">&quot;Ozone mass mixing ratio&quot;</span>,</div>
<div class="line"><span class="lineno">12796</span>             <span class="stringliteral">&quot;kg kg**-1&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a>);</div>
<div class="line"><span class="lineno">12797</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;clwc&quot;</span>, NC_FLOAT, 3, dimid3, <span class="stringliteral">&quot;Cloud liquid water content&quot;</span>,</div>
<div class="line"><span class="lineno">12798</span>             <span class="stringliteral">&quot;kg kg**-1&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a>);</div>
<div class="line"><span class="lineno">12799</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;crwc&quot;</span>, NC_FLOAT, 3, dimid3, <span class="stringliteral">&quot;Cloud rain water content&quot;</span>,</div>
<div class="line"><span class="lineno">12800</span>             <span class="stringliteral">&quot;kg kg**-1&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a>);</div>
<div class="line"><span class="lineno">12801</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;ciwc&quot;</span>, NC_FLOAT, 3, dimid3, <span class="stringliteral">&quot;Cloud ice water content&quot;</span>,</div>
<div class="line"><span class="lineno">12802</span>             <span class="stringliteral">&quot;kg kg**-1&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a>);</div>
<div class="line"><span class="lineno">12803</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;cswc&quot;</span>, NC_FLOAT, 3, dimid3, <span class="stringliteral">&quot;Cloud snow water content&quot;</span>,</div>
<div class="line"><span class="lineno">12804</span>             <span class="stringliteral">&quot;kg kg**-1&quot;</span>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a>);</div>
<div class="line"><span class="lineno">12805</span>  <a class="code hl_define" href="mptrac_8h.html#acca20163a6d11e1ee94426b2e44d5c17">NC_DEF_VAR</a>(<span class="stringliteral">&quot;cc&quot;</span>, NC_FLOAT, 3, dimid3, <span class="stringliteral">&quot;Cloud cover&quot;</span>, <span class="stringliteral">&quot;-&quot;</span>,</div>
<div class="line"><span class="lineno">12806</span>             ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ace79737fafa3d437976cddc48dc6f1d3">met_nc_level</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abe51e81e7cc30fa279a6d87e2e405bec">met_nc_quant</a>);</div>
<div class="line"><span class="lineno">12807</span> </div>
<div class="line"><span class="lineno">12808</span>  <span class="comment">/* End definitions... */</span></div>
<div class="line"><span class="lineno">12809</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_enddef(ncid));</div>
<div class="line"><span class="lineno">12810</span> </div>
<div class="line"><span class="lineno">12811</span>  <span class="comment">/* Write grid data... */</span></div>
<div class="line"><span class="lineno">12812</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;time&quot;</span>, &amp;met-&gt;<a class="code hl_variable" href="structmet__t.html#acf9d509f67dbc7ad8119d40a2757285f">time</a>, 0);</div>
<div class="line"><span class="lineno">12813</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;lon&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#a85df96bff71dfa55576a995234a87b8f">lon</a>, 0);</div>
<div class="line"><span class="lineno">12814</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;lat&quot;</span>, met-&gt;<a class="code hl_variable" href="structmet__t.html#af7b2d03415a8164a3e0a29da55a9f371">lat</a>, 0);</div>
<div class="line"><span class="lineno">12815</span>  <span class="keywordtype">double</span> phelp[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>];</div>
<div class="line"><span class="lineno">12816</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno">12817</span>    phelp[ip] = 100. * met-&gt;<a class="code hl_variable" href="structmet__t.html#affbacae5925ff68007396b525622ee34">p</a>[ip];</div>
<div class="line"><span class="lineno">12818</span>  <a class="code hl_define" href="mptrac_8h.html#ae8b2166768c41952fc7e05faef7bb593">NC_PUT_DOUBLE</a>(<span class="stringliteral">&quot;lev&quot;</span>, phelp, 0);</div>
<div class="line"><span class="lineno">12819</span> </div>
<div class="line"><span class="lineno">12820</span>  <span class="comment">/* Write surface data... */</span></div>
<div class="line"><span class="lineno">12821</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;sp&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3ea571f00b50e6ba8191ec620bc1d15e">ps</a>, 100.0f);</div>
<div class="line"><span class="lineno">12822</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;z&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a52f25b39ae97c30393755cefc303ccd0">zs</a>, (<span class="keywordtype">float</span>) (1000. * <a class="code hl_define" href="mptrac_8h.html#a6440afc9207bc5eba00d9161ff744e16">G0</a>));</div>
<div class="line"><span class="lineno">12823</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;t2m&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a61ef93fdd727e61639dc6408a4573149">ts</a>, 1.0f);</div>
<div class="line"><span class="lineno">12824</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;u10m&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a4242ff2a85d48089d15fd5645923ee36">us</a>, 1.0f);</div>
<div class="line"><span class="lineno">12825</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;v10m&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#aa6379067afe890ea9fe7146a1668f0dc">vs</a>, 1.0f);</div>
<div class="line"><span class="lineno">12826</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;iews&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a6fe5e21416818e1e5c865e4939fc9a5c">ess</a>, 1.0f);</div>
<div class="line"><span class="lineno">12827</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;inss&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#ae775ca154716cbe5773b1b1bc634d6ba">nss</a>, 1.0f);</div>
<div class="line"><span class="lineno">12828</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;ishf&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3bc7785b3dea585270d402d925c02425">shf</a>, 1.0f);</div>
<div class="line"><span class="lineno">12829</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;lsm&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#abe8e0b1c2d6241fa20e663db28e74445">lsm</a>, 1.0f);</div>
<div class="line"><span class="lineno">12830</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;sstk&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a04c8115782b3dc6697111fdeb7c8f860">sst</a>, 1.0f);</div>
<div class="line"><span class="lineno">12831</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;blp&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a9a55672423267749087311d62e924794">pbl</a>, 100.0f);</div>
<div class="line"><span class="lineno">12832</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;pt&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a86578dd751b3d5bcb696265f4a1ac47d">pt</a>, 100.0f);</div>
<div class="line"><span class="lineno">12833</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;tt&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a9677a606f7850c8143f698e9fb15273f">tt</a>, 1.0f);</div>
<div class="line"><span class="lineno">12834</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;zt&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a043690c89804f40d4a8940b7d3393707">zt</a>, 1000.0f);</div>
<div class="line"><span class="lineno">12835</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;h2ot&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#ac87fdccf57a65247062baccf2c2e85e8">h2ot</a>, 1.0f);</div>
<div class="line"><span class="lineno">12836</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;pct&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a29d404429eb9f4e95bf8fa1132455fdd">pct</a>, 100.0f);</div>
<div class="line"><span class="lineno">12837</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;pcb&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a7c44ec7c0c9f471ca8ca700adb3596c3">pcb</a>, 100.0f);</div>
<div class="line"><span class="lineno">12838</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;cl&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#ae45079d4c0137fa4416dd42ca1f117cd">cl</a>, 1.0f);</div>
<div class="line"><span class="lineno">12839</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;plcl&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a83441ce7588a1230c54f4c2174bbdcfb">plcl</a>, 100.0f);</div>
<div class="line"><span class="lineno">12840</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;plfc&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#af2f85f717aa775b52d4791c97c3ae142">plfc</a>, 100.0f);</div>
<div class="line"><span class="lineno">12841</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;pel&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a7d6776fe9ed1966d6024567d423f0b96">pel</a>, 100.0f);</div>
<div class="line"><span class="lineno">12842</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;cape&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a1db66ae86edf896a545c0332dfeabb0f">cape</a>, 1.0f);</div>
<div class="line"><span class="lineno">12843</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;cin&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a827c930acd681d82336766f6744ac763">cin</a>, 1.0f);</div>
<div class="line"><span class="lineno">12844</span>  <a class="code hl_function" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a>(ncid, <span class="stringliteral">&quot;o3c&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a0ab0cfbc1e5fe1a5c9ce3412cc4400a8">o3c</a>, 1.0f);</div>
<div class="line"><span class="lineno">12845</span> </div>
<div class="line"><span class="lineno">12846</span>  <span class="comment">/* Write level data... */</span></div>
<div class="line"><span class="lineno">12847</span>  <a class="code hl_function" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;t&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, 1.0f);</div>
<div class="line"><span class="lineno">12848</span>  <a class="code hl_function" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;u&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a68b715eb9e5fa3a9c8f400e0c5667cc9">u</a>, 1.0f);</div>
<div class="line"><span class="lineno">12849</span>  <a class="code hl_function" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;v&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#abc29d5fbea8f527b849837efacd76eaa">v</a>, 1.0f);</div>
<div class="line"><span class="lineno">12850</span>  <a class="code hl_function" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;w&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a210cc808698557c4824a4a8d7908fe73">w</a>, 100.0f);</div>
<div class="line"><span class="lineno">12851</span>  <a class="code hl_function" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;q&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>, (<span class="keywordtype">float</span>) (<a class="code hl_define" href="mptrac_8h.html#a1c4cf7d6c3605ff72cd8b9a63379d4ea">MH2O</a> / <a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a>));</div>
<div class="line"><span class="lineno">12852</span>  <a class="code hl_function" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;o3&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>, (<span class="keywordtype">float</span>) (<a class="code hl_define" href="mptrac_8h.html#aa5770de64e81ecf3f35d559357f67a76">MO3</a> / <a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a>));</div>
<div class="line"><span class="lineno">12853</span>  <a class="code hl_function" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;clwc&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a40590e0c0c66a5a1f6903a474de87ee0">lwc</a>, 1.0f);</div>
<div class="line"><span class="lineno">12854</span>  <a class="code hl_function" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;crwc&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a05425967991c53f965f2551eb12321d8">rwc</a>, 1.0f);</div>
<div class="line"><span class="lineno">12855</span>  <a class="code hl_function" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;ciwc&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#abf312f05407920f9ac855cede012efe2">iwc</a>, 1.0f);</div>
<div class="line"><span class="lineno">12856</span>  <a class="code hl_function" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;cswc&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#afc1b6ec607dcb27df304f6ecb48b7fea">swc</a>, 1.0f);</div>
<div class="line"><span class="lineno">12857</span>  <a class="code hl_function" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a>(ncid, <span class="stringliteral">&quot;cc&quot;</span>, met, met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d24cf701c941649d83adad1e058898f">cc</a>, 1.0f);</div>
<div class="line"><span class="lineno">12858</span> </div>
<div class="line"><span class="lineno">12859</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">12860</span>  <a class="code hl_define" href="mptrac_8h.html#a2678db26e1acda0cccd79553b9cc9b51">NC</a>(nc_close(ncid));</div>
<div class="line"><span class="lineno">12861</span>}</div>
<div class="ttc" id="amptrac_8c_html_a0bed36c022857a81c5d80e45e8be582a"><div class="ttname"><a href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a">write_met_nc_2d</a></div><div class="ttdeci">void write_met_nc_2d(const int ncid, const char *varname, met_t *met, float var[EX][EY], const float scl)</div><div class="ttdoc">Writes a 2D meteorological variable to a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l12865">mptrac.c:12865</a></div></div>
<div class="ttc" id="amptrac_8c_html_ae14d46547d2b1260b2ba857499b180d7"><div class="ttname"><a href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7">write_met_nc_3d</a></div><div class="ttdeci">void write_met_nc_3d(const int ncid, const char *varname, met_t *met, float var[EX][EY][EP], const float scl)</div><div class="ttdoc">Writes a 3D meteorological variable to a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8c_source.html#l12894">mptrac.c:12894</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a92ad405ee98c55d656f4b9fcb4957503_cgraph.png" border="0" usemap="#amptrac_8h_a92ad405ee98c55d656f4b9fcb4957503_cgraph" alt=""/></div>
<map name="amptrac_8h_a92ad405ee98c55d656f4b9fcb4957503_cgraph" id="amptrac_8h_a92ad405ee98c55d656f4b9fcb4957503_cgraph">
<area shape="rect" title="Writes meteorological data to a NetCDF file." alt="" coords="5,31,105,57"/>
<area shape="rect" href="mptrac_8c.html#a0bed36c022857a81c5d80e45e8be582a" title="Writes a 2D meteorological variable to a NetCDF file." alt="" coords="153,5,275,32"/>
<area shape="rect" href="mptrac_8c.html#ae14d46547d2b1260b2ba857499b180d7" title="Writes a 3D meteorological variable to a NetCDF file." alt="" coords="153,56,275,83"/>
</map>
</div>

</div>
</div>
<a id="a0bed36c022857a81c5d80e45e8be582a" name="a0bed36c022857a81c5d80e45e8be582a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bed36c022857a81c5d80e45e8be582a">&#9670;&nbsp;</a></span>write_met_nc_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_met_nc_2d </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>var</em>[EX][EY], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>scl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a 2D meteorological variable to a NetCDF file. </p>
<p >This function writes a 2D meteorological variable, stored in the array <code>var</code>, to a NetCDF file with the specified variable name. The data is scaled by a factor <code>scl</code> before being written. The function handles memory allocation for the data copy, scaling, and freeing the allocated memory after writing the data to the NetCDF file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ncid</td><td>The NetCDF file ID. This is an integer that identifies the NetCDF file where the data will be written. It is assumed that this file has already been opened for writing. </td></tr>
    <tr><td class="paramname">varname</td><td>A pointer to a string containing the name of the variable in the NetCDF file where the data will be stored. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure of type <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> that contains metadata about the meteorological field, including the dimensions <code>nx</code> (number of points in x-direction) and <code>ny</code> (number of points in y-direction). </td></tr>
    <tr><td class="paramname">var</td><td>A 2D array of dimensions <code>EX x EY</code> containing the meteorological data to be written. The data is provided in the format <code>var[ix][iy]</code>, where <code>ix</code> is the index in the x-direction and <code>iy</code> is the index in the y-direction. </td></tr>
    <tr><td class="paramname">scl</td><td>A scaling factor applied to each element in the <code>var</code> array before writing to the NetCDF file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l12865">12865</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">12870</span>                   {</div>
<div class="line"><span class="lineno">12871</span> </div>
<div class="line"><span class="lineno">12872</span>  <span class="keywordtype">int</span> varid;</div>
<div class="line"><span class="lineno">12873</span>  <span class="keywordtype">size_t</span> start[4], count[4];</div>
<div class="line"><span class="lineno">12874</span> </div>
<div class="line"><span class="lineno">12875</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">12876</span>  <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno">12877</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno">12878</span>        <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a>);</div>
<div class="line"><span class="lineno">12879</span> </div>
<div class="line"><span class="lineno">12880</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno">12881</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">12882</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno">12883</span>      help[<a class="code hl_define" href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a>(iy, ix, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>)] = scl * var[ix][iy];</div>
<div class="line"><span class="lineno">12884</span> </div>
<div class="line"><span class="lineno">12885</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">12886</span>  <a class="code hl_define" href="mptrac_8h.html#ac0e202b5cb2a0adea56392860c4ffb86">NC_PUT_FLOAT</a>(varname, help, 0);</div>
<div class="line"><span class="lineno">12887</span> </div>
<div class="line"><span class="lineno">12888</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">12889</span>  free(help);</div>
<div class="line"><span class="lineno">12890</span>}</div>
<div class="ttc" id="amptrac_8h_html_ac0e202b5cb2a0adea56392860c4ffb86"><div class="ttname"><a href="mptrac_8h.html#ac0e202b5cb2a0adea56392860c4ffb86">NC_PUT_FLOAT</a></div><div class="ttdeci">#define NC_PUT_FLOAT(varname, ptr, hyperslab)</div><div class="ttdoc">Write a float array to a NetCDF file.</div><div class="ttdef"><b>Definition:</b> <a href="mptrac_8h_source.html#l01304">mptrac.h:1304</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae14d46547d2b1260b2ba857499b180d7" name="ae14d46547d2b1260b2ba857499b180d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae14d46547d2b1260b2ba857499b180d7">&#9670;&nbsp;</a></span>write_met_nc_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_met_nc_3d </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>varname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>var</em>[EX][EY][EP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>scl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a 3D meteorological variable to a NetCDF file. </p>
<p >This function writes a 3D meteorological variable, stored in the array <code>var</code>, to a NetCDF file with the specified variable name. The data is scaled by a factor <code>scl</code> before being written. The function handles memory allocation for the data copy, scaling, and freeing the allocated memory after writing the data to the NetCDF file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ncid</td><td>The NetCDF file ID. This is an integer that identifies the NetCDF file where the data will be written. It is assumed that this file has already been opened for writing. </td></tr>
    <tr><td class="paramname">varname</td><td>A pointer to a string containing the name of the variable in the NetCDF file where the data will be stored. </td></tr>
    <tr><td class="paramname">met</td><td>A pointer to a structure of type <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> that contains metadata about the meteorological field, including the dimensions <code>nx</code> (number of points in the x-direction), <code>ny</code> (number of points in the y-direction), and <code>np</code> (number of points in the third dimension, e.g., pressure levels). </td></tr>
    <tr><td class="paramname">var</td><td>A 3D array of dimensions <code>EX x EY x EP</code> containing the meteorological data to be written. The data is provided in the format <code>var[ix][iy][ip]</code>, where <code>ix</code> is the index in the x-direction, <code>iy</code> is the index in the y-direction, and <code>ip</code> is the index in the third dimension (e.g., vertical levels). </td></tr>
    <tr><td class="paramname">scl</td><td>A scaling factor applied to each element in the <code>var</code> array before writing to the NetCDF file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l12894">12894</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">12899</span>                   {</div>
<div class="line"><span class="lineno">12900</span> </div>
<div class="line"><span class="lineno">12901</span>  <span class="keywordtype">int</span> varid;</div>
<div class="line"><span class="lineno">12902</span>  <span class="keywordtype">size_t</span> start[4], count[4];</div>
<div class="line"><span class="lineno">12903</span> </div>
<div class="line"><span class="lineno">12904</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">12905</span>  <span class="keywordtype">float</span> *help;</div>
<div class="line"><span class="lineno">12906</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(help, <span class="keywordtype">float</span>,</div>
<div class="line"><span class="lineno">12907</span>        <a class="code hl_define" href="mptrac_8h.html#a6c2e35fdcd9091ccada629895fa1d034">EX</a> * <a class="code hl_define" href="mptrac_8h.html#a423a96c51fa2ea8a6406113803acbbc1">EY</a> * <a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>);</div>
<div class="line"><span class="lineno">12908</span> </div>
<div class="line"><span class="lineno">12909</span>  <span class="comment">/* Copy data... */</span></div>
<div class="line"><span class="lineno">12910</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>; ix++)</div>
<div class="line"><span class="lineno">12911</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>; iy++)</div>
<div class="line"><span class="lineno">12912</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; met-&gt;<a class="code hl_variable" href="structmet__t.html#a5d4eb4cd28aa5db1ec672368921c0b8f">np</a>; ip++)</div>
<div class="line"><span class="lineno">12913</span>        help[<a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ip, iy, met-&gt;<a class="code hl_variable" href="structmet__t.html#a3a066580dfee9253cfe22b1e4ebf73b9">ny</a>, ix, met-&gt;<a class="code hl_variable" href="structmet__t.html#a2bbd96a0a7184bc730c14323a067a760">nx</a>)] = scl * var[ix][iy][ip];</div>
<div class="line"><span class="lineno">12914</span> </div>
<div class="line"><span class="lineno">12915</span>  <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">12916</span>  <a class="code hl_define" href="mptrac_8h.html#ac0e202b5cb2a0adea56392860c4ffb86">NC_PUT_FLOAT</a>(varname, help, 0);</div>
<div class="line"><span class="lineno">12917</span> </div>
<div class="line"><span class="lineno">12918</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">12919</span>  free(help);</div>
<div class="line"><span class="lineno">12920</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d5476c104eaa958ba0564597bee9c3b" name="a8d5476c104eaa958ba0564597bee9c3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d5476c104eaa958ba0564597bee9c3b">&#9670;&nbsp;</a></span>write_prof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_prof </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes profile data to a specified file. </p>
<p >The <code>write_prof</code> function writes profile data to a file specified by the <code>filename</code> parameter. It takes control parameters (<code>ctl</code>), two meteorological data structures (<code>met0</code> and <code>met1</code>), an atmospheric data structure (<code>atm</code>), and a time value (<code>t</code>) as input.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the filename where the profile data will be written. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">met0</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure representing the first set of meteorological data. </td></tr>
    <tr><td class="paramname">met1</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure representing the second set of meteorological data. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure representing atmospheric data. </td></tr>
    <tr><td class="paramname">t</td><td>A double value representing the time at which the profile data is being written.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Initializes variables and allocates memory if it's the start of the simulation.</li>
<li>Reads observation data and creates a new output file if necessary.</li>
<li>Writes header information to the output file.</li>
<li>Sets grid box size and vertical coordinates.</li>
<li>Processes observations and model data within the specified time interval.</li>
<li>Calculates and writes output data for each grid cell.</li>
<li>Finalizes by closing the output file and freeing allocated memory if it's the end of the simulation.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function writes profile data to a file, including time, altitude, coordinates, atmospheric properties, observed data, and the number of observations.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l12924">12924</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">12930</span>                  {</div>
<div class="line"><span class="lineno">12931</span> </div>
<div class="line"><span class="lineno">12932</span>  <span class="keyword">static</span> FILE *out;</div>
<div class="line"><span class="lineno">12933</span> </div>
<div class="line"><span class="lineno">12934</span>  <span class="keyword">static</span> <span class="keywordtype">double</span> *mass, *obsmean, *rt, *rz, *rlon, *rlat, *robs, *area,</div>
<div class="line"><span class="lineno">12935</span>    dz, dlon, dlat, *lon, *lat, *z, *press, temp, vmr, h2o, o3;</div>
<div class="line"><span class="lineno">12936</span> </div>
<div class="line"><span class="lineno">12937</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> nobs, *obscount, ip, okay;</div>
<div class="line"><span class="lineno">12938</span> </div>
<div class="line"><span class="lineno">12939</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">12940</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;WRITE_PROF&quot;</span>, <span class="stringliteral">&quot;OUTPUT&quot;</span>);</div>
<div class="line"><span class="lineno">12941</span> </div>
<div class="line"><span class="lineno">12942</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno">12943</span>  <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a>) {</div>
<div class="line"><span class="lineno">12944</span> </div>
<div class="line"><span class="lineno">12945</span>    <span class="comment">/* Check quantity index for mass... */</span></div>
<div class="line"><span class="lineno">12946</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &lt; 0)</div>
<div class="line"><span class="lineno">12947</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Need quantity mass!&quot;</span>);</div>
<div class="line"><span class="lineno">12948</span> </div>
<div class="line"><span class="lineno">12949</span>    <span class="comment">/* Check molar mass... */</span></div>
<div class="line"><span class="lineno">12950</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> &lt;= 0)</div>
<div class="line"><span class="lineno">12951</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Specify molar mass!&quot;</span>);</div>
<div class="line"><span class="lineno">12952</span> </div>
<div class="line"><span class="lineno">12953</span>    <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">12954</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(lon, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12955</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fe06eb4b9baabf93694ed62d2956046">prof_nx</a>);</div>
<div class="line"><span class="lineno">12956</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(lat, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12957</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>);</div>
<div class="line"><span class="lineno">12958</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(area, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12959</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>);</div>
<div class="line"><span class="lineno">12960</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(z, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12961</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a>);</div>
<div class="line"><span class="lineno">12962</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(press, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12963</span>          ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a>);</div>
<div class="line"><span class="lineno">12964</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rt, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12965</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">12966</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rz, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12967</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">12968</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rlon, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12969</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">12970</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rlat, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12971</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">12972</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(robs, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">12973</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">12974</span> </div>
<div class="line"><span class="lineno">12975</span>    <span class="comment">/* Read observation data... */</span></div>
<div class="line"><span class="lineno">12976</span>    <a class="code hl_function" href="mptrac_8c.html#a1365b8fd93db0fc3fe4c467107710d03">read_obs</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a42d536f7e68997de273a245cff2af30b">prof_obsfile</a>, ctl, rt, rz, rlon, rlat, robs, &amp;nobs);</div>
<div class="line"><span class="lineno">12977</span> </div>
<div class="line"><span class="lineno">12978</span>    <span class="comment">/* Create new output file... */</span></div>
<div class="line"><span class="lineno">12979</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write profile data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno">12980</span>    <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">12981</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno">12982</span> </div>
<div class="line"><span class="lineno">12983</span>    <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno">12984</span>    fprintf(out,</div>
<div class="line"><span class="lineno">12985</span>            <span class="stringliteral">&quot;# $1 = time [s]\n&quot;</span></div>
<div class="line"><span class="lineno">12986</span>            <span class="stringliteral">&quot;# $2 = altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno">12987</span>            <span class="stringliteral">&quot;# $3 = longitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno">12988</span>            <span class="stringliteral">&quot;# $4 = latitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno">12989</span>            <span class="stringliteral">&quot;# $5 = pressure [hPa]\n&quot;</span></div>
<div class="line"><span class="lineno">12990</span>            <span class="stringliteral">&quot;# $6 = temperature [K]\n&quot;</span></div>
<div class="line"><span class="lineno">12991</span>            <span class="stringliteral">&quot;# $7 = volume mixing ratio [ppv]\n&quot;</span></div>
<div class="line"><span class="lineno">12992</span>            <span class="stringliteral">&quot;# $8 = H2O volume mixing ratio [ppv]\n&quot;</span></div>
<div class="line"><span class="lineno">12993</span>            <span class="stringliteral">&quot;# $9 = O3 volume mixing ratio [ppv]\n&quot;</span></div>
<div class="line"><span class="lineno">12994</span>            <span class="stringliteral">&quot;# $10 = observed BT index [K]\n&quot;</span></div>
<div class="line"><span class="lineno">12995</span>            <span class="stringliteral">&quot;# $11 = number of observations\n&quot;</span>);</div>
<div class="line"><span class="lineno">12996</span> </div>
<div class="line"><span class="lineno">12997</span>    <span class="comment">/* Set grid box size... */</span></div>
<div class="line"><span class="lineno">12998</span>    dz = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8fcaa080d02f579e45b99cd7e6a5a36e">prof_z1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4ef0c20dc2cdc73b2a3272e40a82efd4">prof_z0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a>;</div>
<div class="line"><span class="lineno">12999</span>    dlon = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abdbbc3e42fcbcf71714a8b86dd5b3729">prof_lon1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab5c52ba42d486204818e2bade09005c1">prof_lon0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fe06eb4b9baabf93694ed62d2956046">prof_nx</a>;</div>
<div class="line"><span class="lineno">13000</span>    dlat = (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab227d1f7a9235210bd3ba4e159398bfc">prof_lat1</a> - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abbea8b15d0f5ea43ddd48ebb6a248916">prof_lat0</a>) / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>;</div>
<div class="line"><span class="lineno">13001</span> </div>
<div class="line"><span class="lineno">13002</span>    <span class="comment">/* Set vertical coordinates... */</span></div>
<div class="line"><span class="lineno">13003</span>    for (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a>; iz++) {</div>
<div class="line"><span class="lineno">13004</span>      z[iz] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4ef0c20dc2cdc73b2a3272e40a82efd4">prof_z0</a> + dz * (iz + 0.5);</div>
<div class="line"><span class="lineno">13005</span>      press[iz] = <a class="code hl_define" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>(z[iz]);</div>
<div class="line"><span class="lineno">13006</span>    }</div>
<div class="line"><span class="lineno">13007</span> </div>
<div class="line"><span class="lineno">13008</span>    <span class="comment">/* Set horizontal coordinates... */</span></div>
<div class="line"><span class="lineno">13009</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fe06eb4b9baabf93694ed62d2956046">prof_nx</a>; ix++)</div>
<div class="line"><span class="lineno">13010</span>      lon[ix] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab5c52ba42d486204818e2bade09005c1">prof_lon0</a> + dlon * (ix + 0.5);</div>
<div class="line"><span class="lineno">13011</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>; iy++) {</div>
<div class="line"><span class="lineno">13012</span>      lat[iy] = ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abbea8b15d0f5ea43ddd48ebb6a248916">prof_lat0</a> + dlat * (iy + 0.5);</div>
<div class="line"><span class="lineno">13013</span>      area[iy] = dlat * dlon * <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(<a class="code hl_define" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a> * M_PI / 180.) * cos(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(lat[iy]));</div>
<div class="line"><span class="lineno">13014</span>    }</div>
<div class="line"><span class="lineno">13015</span>  }</div>
<div class="line"><span class="lineno">13016</span> </div>
<div class="line"><span class="lineno">13017</span>  <span class="comment">/* Set time interval... */</span></div>
<div class="line"><span class="lineno">13018</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = t - 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">13019</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t1 = t + 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">13020</span> </div>
<div class="line"><span class="lineno">13021</span>  <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">13022</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(mass, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">13023</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fe06eb4b9baabf93694ed62d2956046">prof_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a>);</div>
<div class="line"><span class="lineno">13024</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(obsmean, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">13025</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fe06eb4b9baabf93694ed62d2956046">prof_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>);</div>
<div class="line"><span class="lineno">13026</span>  <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(obscount, <span class="keywordtype">int</span>,</div>
<div class="line"><span class="lineno">13027</span>        ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fe06eb4b9baabf93694ed62d2956046">prof_nx</a> * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>);</div>
<div class="line"><span class="lineno">13028</span> </div>
<div class="line"><span class="lineno">13029</span>  <span class="comment">/* Loop over observations... */</span></div>
<div class="line"><span class="lineno">13030</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nobs; i++) {</div>
<div class="line"><span class="lineno">13031</span> </div>
<div class="line"><span class="lineno">13032</span>    <span class="comment">/* Check time... */</span></div>
<div class="line"><span class="lineno">13033</span>    <span class="keywordflow">if</span> (rt[i] &lt; t0)</div>
<div class="line"><span class="lineno">13034</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13035</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rt[i] &gt;= t1)</div>
<div class="line"><span class="lineno">13036</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">13037</span> </div>
<div class="line"><span class="lineno">13038</span>    <span class="comment">/* Check observation data... */</span></div>
<div class="line"><span class="lineno">13039</span>    <span class="keywordflow">if</span> (!isfinite(robs[i]))</div>
<div class="line"><span class="lineno">13040</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13041</span> </div>
<div class="line"><span class="lineno">13042</span>    <span class="comment">/* Calculate indices... */</span></div>
<div class="line"><span class="lineno">13043</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> ix = (int) ((rlon[i] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab5c52ba42d486204818e2bade09005c1">prof_lon0</a>) / dlon);</div>
<div class="line"><span class="lineno">13044</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iy = (int) ((rlat[i] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abbea8b15d0f5ea43ddd48ebb6a248916">prof_lat0</a>) / dlat);</div>
<div class="line"><span class="lineno">13045</span> </div>
<div class="line"><span class="lineno">13046</span>    <span class="comment">/* Check indices... */</span></div>
<div class="line"><span class="lineno">13047</span>    <span class="keywordflow">if</span> (ix &lt; 0 || ix &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fe06eb4b9baabf93694ed62d2956046">prof_nx</a> || iy &lt; 0 || iy &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>)</div>
<div class="line"><span class="lineno">13048</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13049</span> </div>
<div class="line"><span class="lineno">13050</span>    <span class="comment">/* Get mean observation index... */</span></div>
<div class="line"><span class="lineno">13051</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_define" href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>);</div>
<div class="line"><span class="lineno">13052</span>    obsmean[idx] += robs[i];</div>
<div class="line"><span class="lineno">13053</span>    obscount[idx]++;</div>
<div class="line"><span class="lineno">13054</span>  }</div>
<div class="line"><span class="lineno">13055</span> </div>
<div class="line"><span class="lineno">13056</span>  <span class="comment">/* Analyze model data... */</span></div>
<div class="line"><span class="lineno">13057</span>  <span class="keywordflow">for</span> (ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno">13058</span> </div>
<div class="line"><span class="lineno">13059</span>    <span class="comment">/* Check time... */</span></div>
<div class="line"><span class="lineno">13060</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1)</div>
<div class="line"><span class="lineno">13061</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13062</span> </div>
<div class="line"><span class="lineno">13063</span>    <span class="comment">/* Get indices... */</span></div>
<div class="line"><span class="lineno">13064</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> ix = (int) ((atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ab5c52ba42d486204818e2bade09005c1">prof_lon0</a>) / dlon);</div>
<div class="line"><span class="lineno">13065</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iy = (int) ((atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#abbea8b15d0f5ea43ddd48ebb6a248916">prof_lat0</a>) / dlat);</div>
<div class="line"><span class="lineno">13066</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iz = (int) ((<a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]) - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4ef0c20dc2cdc73b2a3272e40a82efd4">prof_z0</a>) / dz);</div>
<div class="line"><span class="lineno">13067</span> </div>
<div class="line"><span class="lineno">13068</span>    <span class="comment">/* Check indices... */</span></div>
<div class="line"><span class="lineno">13069</span>    <span class="keywordflow">if</span> (ix &lt; 0 || ix &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fe06eb4b9baabf93694ed62d2956046">prof_nx</a> ||</div>
<div class="line"><span class="lineno">13070</span>        iy &lt; 0 || iy &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a> || iz &lt; 0 || iz &gt;= ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a>)</div>
<div class="line"><span class="lineno">13071</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13072</span> </div>
<div class="line"><span class="lineno">13073</span>    <span class="comment">/* Get total mass in grid cell... */</span></div>
<div class="line"><span class="lineno">13074</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a>);</div>
<div class="line"><span class="lineno">13075</span>    mass[idx] += atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip];</div>
<div class="line"><span class="lineno">13076</span>  }</div>
<div class="line"><span class="lineno">13077</span> </div>
<div class="line"><span class="lineno">13078</span>  <span class="comment">/* Extract profiles... */</span></div>
<div class="line"><span class="lineno">13079</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix = 0; ix &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a4fe06eb4b9baabf93694ed62d2956046">prof_nx</a>; ix++)</div>
<div class="line"><span class="lineno">13080</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy = 0; iy &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>; iy++) {</div>
<div class="line"><span class="lineno">13081</span>      <span class="keywordtype">int</span> idx2 = <a class="code hl_define" href="mptrac_8h.html#a56fa16148a574bac429287eb4612aa2e">ARRAY_2D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>);</div>
<div class="line"><span class="lineno">13082</span>      <span class="keywordflow">if</span> (obscount[idx2] &gt; 0) {</div>
<div class="line"><span class="lineno">13083</span> </div>
<div class="line"><span class="lineno">13084</span>        <span class="comment">/* Check profile... */</span></div>
<div class="line"><span class="lineno">13085</span>        okay = 0;</div>
<div class="line"><span class="lineno">13086</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a>; iz++) {</div>
<div class="line"><span class="lineno">13087</span>          <span class="keywordtype">int</span> idx3 = <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a>);</div>
<div class="line"><span class="lineno">13088</span>          <span class="keywordflow">if</span> (mass[idx3] &gt; 0) {</div>
<div class="line"><span class="lineno">13089</span>            okay = 1;</div>
<div class="line"><span class="lineno">13090</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">13091</span>          }</div>
<div class="line"><span class="lineno">13092</span>        }</div>
<div class="line"><span class="lineno">13093</span>        <span class="keywordflow">if</span> (!okay)</div>
<div class="line"><span class="lineno">13094</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13095</span> </div>
<div class="line"><span class="lineno">13096</span>        <span class="comment">/* Write output... */</span></div>
<div class="line"><span class="lineno">13097</span>        fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">13098</span> </div>
<div class="line"><span class="lineno">13099</span>        <span class="comment">/* Loop over altitudes... */</span></div>
<div class="line"><span class="lineno">13100</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iz = 0; iz &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a>; iz++) {</div>
<div class="line"><span class="lineno">13101</span> </div>
<div class="line"><span class="lineno">13102</span>          <span class="comment">/* Get temperature, water vapor, and ozone... */</span></div>
<div class="line"><span class="lineno">13103</span>          <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno">13104</span>          <a class="code hl_function" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, t, press[iz],</div>
<div class="line"><span class="lineno">13105</span>                             lon[ix], lat[iy], &amp;temp, ci, cw, 1);</div>
<div class="line"><span class="lineno">13106</span>          <a class="code hl_function" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a135f6e1c898c2d206d9a032de0e7b579">h2o</a>, t, press[iz],</div>
<div class="line"><span class="lineno">13107</span>                             lon[ix], lat[iy], &amp;h2o, ci, cw, 0);</div>
<div class="line"><span class="lineno">13108</span>          <a class="code hl_function" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a5ce0fb589ddc187ab1191a9fd081a376">o3</a>, t, press[iz],</div>
<div class="line"><span class="lineno">13109</span>                             lon[ix], lat[iy], &amp;o3, ci, cw, 0);</div>
<div class="line"><span class="lineno">13110</span> </div>
<div class="line"><span class="lineno">13111</span>          <span class="comment">/* Calculate volume mixing ratio... */</span></div>
<div class="line"><span class="lineno">13112</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> idx3 = <a class="code hl_define" href="mptrac_8h.html#a0a81bdec7708d9599d0dcfa7a41caa26">ARRAY_3D</a>(ix, iy, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a83da7c4b38e4b6044636bfcab0a0f8c2">prof_ny</a>, iz, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a45940a490a88de1eee54ce2701db84aa">prof_nz</a>);</div>
<div class="line"><span class="lineno">13113</span>          vmr = <a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a> / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> * mass[idx3]</div>
<div class="line"><span class="lineno">13114</span>            / (<a class="code hl_define" href="mptrac_8h.html#ae088e183d18a16fd6ab469d48ce3f06a">RHO</a>(press[iz], temp) * area[iy] * dz * 1e9);</div>
<div class="line"><span class="lineno">13115</span> </div>
<div class="line"><span class="lineno">13116</span>          <span class="comment">/* Write output... */</span></div>
<div class="line"><span class="lineno">13117</span>          fprintf(out, <span class="stringliteral">&quot;%.2f %g %g %g %g %g %g %g %g %g %d\n&quot;</span>,</div>
<div class="line"><span class="lineno">13118</span>                  t, z[iz], lon[ix], lat[iy], press[iz], temp, vmr, h2o, o3,</div>
<div class="line"><span class="lineno">13119</span>                  obsmean[idx2] / obscount[idx2], obscount[idx2]);</div>
<div class="line"><span class="lineno">13120</span>        }</div>
<div class="line"><span class="lineno">13121</span>      }</div>
<div class="line"><span class="lineno">13122</span>    }</div>
<div class="line"><span class="lineno">13123</span> </div>
<div class="line"><span class="lineno">13124</span>  <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">13125</span>  free(mass);</div>
<div class="line"><span class="lineno">13126</span>  free(obsmean);</div>
<div class="line"><span class="lineno">13127</span>  free(obscount);</div>
<div class="line"><span class="lineno">13128</span> </div>
<div class="line"><span class="lineno">13129</span>  <span class="comment">/* Finalize... */</span></div>
<div class="line"><span class="lineno">13130</span>  <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a>) {</div>
<div class="line"><span class="lineno">13131</span> </div>
<div class="line"><span class="lineno">13132</span>    <span class="comment">/* Close output file... */</span></div>
<div class="line"><span class="lineno">13133</span>    fclose(out);</div>
<div class="line"><span class="lineno">13134</span> </div>
<div class="line"><span class="lineno">13135</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">13136</span>    free(lon);</div>
<div class="line"><span class="lineno">13137</span>    free(lat);</div>
<div class="line"><span class="lineno">13138</span>    free(area);</div>
<div class="line"><span class="lineno">13139</span>    free(z);</div>
<div class="line"><span class="lineno">13140</span>    free(press);</div>
<div class="line"><span class="lineno">13141</span>    free(rt);</div>
<div class="line"><span class="lineno">13142</span>    free(rz);</div>
<div class="line"><span class="lineno">13143</span>    free(rlon);</div>
<div class="line"><span class="lineno">13144</span>    free(rlat);</div>
<div class="line"><span class="lineno">13145</span>    free(robs);</div>
<div class="line"><span class="lineno">13146</span>  }</div>
<div class="line"><span class="lineno">13147</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_a8d5476c104eaa958ba0564597bee9c3b_cgraph.png" border="0" usemap="#amptrac_8h_a8d5476c104eaa958ba0564597bee9c3b_cgraph" alt=""/></div>
<map name="amptrac_8h_a8d5476c104eaa958ba0564597bee9c3b_cgraph" id="amptrac_8h_a8d5476c104eaa958ba0564597bee9c3b_cgraph">
<area shape="rect" title="Writes profile data to a specified file." alt="" coords="5,81,84,108"/>
<area shape="rect" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6" title="Interpolates meteorological data in 3D space and time." alt="" coords="132,56,267,83"/>
<area shape="rect" href="mptrac_8c.html#a1365b8fd93db0fc3fe4c467107710d03" title="Reads observation data from a file and stores it in arrays." alt="" coords="162,107,237,133"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="315,56,460,83"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="508,5,648,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="541,56,615,83"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="537,107,619,133"/>
<area shape="rect" href="mptrac_8c.html#a29da9a205ad3577ba3890f3e1e4350c3" title="Reads observation data from an ASCII file." alt="" coords="336,107,439,133"/>
<area shape="rect" href="mptrac_8c.html#a4536a82b3dc62081d26114c1250b1427" title="Reads observation data from a NetCDF file." alt="" coords="339,157,435,184"/>
</map>
</div>

</div>
</div>
<a id="af0cd0b75f7269ad20dc88ce4114ab5f1" name="af0cd0b75f7269ad20dc88ce4114ab5f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0cd0b75f7269ad20dc88ce4114ab5f1">&#9670;&nbsp;</a></span>write_sample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_sample </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmet__t.html">met_t</a> *&#160;</td>
          <td class="paramname"><em>met1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes sample data to a specified file. </p>
<p >The <code>write_sample</code> function writes sample data to a file specified by the <code>filename</code> parameter. It takes control parameters (<code>ctl</code>), two meteorological data structures (<code>met0</code> and <code>met1</code>), an atmospheric data structure (<code>atm</code>), and a time value (<code>t</code>) as input.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the filename where the sample data will be written. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">met0</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure representing the first set of meteorological data. </td></tr>
    <tr><td class="paramname">met1</td><td>A pointer to a <code><a class="el" href="structmet__t.html" title="Meteo data structure.">met_t</a></code> structure representing the second set of meteorological data. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure representing atmospheric data. </td></tr>
    <tr><td class="paramname">t</td><td>A double value representing the time at which the sample data is being written.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Initializes variables and allocates memory if it's the start of the simulation.</li>
<li>Reads observation data and kernel data if necessary.</li>
<li>Creates a new output file and writes header information to it.</li>
<li>Sets latitude range, squared radius, and area.</li>
<li>Processes observations and calculates sample data within the specified time interval.</li>
<li>Writes output data for each observation.</li>
<li>Finalizes by closing the output file and freeing allocated memory if it's the end of the simulation.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function writes sample data to a file, including time, altitude, coordinates, surface area, layer depth, number of particles, column density, volume mixing ratio, and observed data.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l13151">13151</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">13157</span>                  {</div>
<div class="line"><span class="lineno">13158</span> </div>
<div class="line"><span class="lineno">13159</span>  <span class="keyword">static</span> FILE *out;</div>
<div class="line"><span class="lineno">13160</span> </div>
<div class="line"><span class="lineno">13161</span>  <span class="keyword">static</span> <span class="keywordtype">double</span> area, dlat, rmax2, *rt, *rz, *rlon, *rlat, *robs, kz[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>],</div>
<div class="line"><span class="lineno">13162</span>    kw[<a class="code hl_define" href="mptrac_8h.html#adb5bf6fbe6405b09bad71e89e1da5850">EP</a>];</div>
<div class="line"><span class="lineno">13163</span> </div>
<div class="line"><span class="lineno">13164</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> nobs, nk;</div>
<div class="line"><span class="lineno">13165</span> </div>
<div class="line"><span class="lineno">13166</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">13167</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;WRITE_SAMPLE&quot;</span>, <span class="stringliteral">&quot;OUTPUT&quot;</span>);</div>
<div class="line"><span class="lineno">13168</span> </div>
<div class="line"><span class="lineno">13169</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno">13170</span>  <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a>) {</div>
<div class="line"><span class="lineno">13171</span> </div>
<div class="line"><span class="lineno">13172</span>    <span class="comment">/* Allocate... */</span></div>
<div class="line"><span class="lineno">13173</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rt, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">13174</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">13175</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rz, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">13176</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">13177</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rlon, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">13178</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">13179</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(rlat, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">13180</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">13181</span>    <a class="code hl_define" href="mptrac_8h.html#a9aee3e5daf3b1051597d21ab093adbd0">ALLOC</a>(robs, <span class="keywordtype">double</span>,</div>
<div class="line"><span class="lineno">13182</span>          <a class="code hl_define" href="mptrac_8h.html#a4e6d37e546b0cac9bffdd01ec84f53dd">NOBS</a>);</div>
<div class="line"><span class="lineno">13183</span> </div>
<div class="line"><span class="lineno">13184</span>    <span class="comment">/* Read observation data... */</span></div>
<div class="line"><span class="lineno">13185</span>    <a class="code hl_function" href="mptrac_8c.html#a1365b8fd93db0fc3fe4c467107710d03">read_obs</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a64cde624042ea4b8d6b841660ff28546">sample_obsfile</a>, ctl, rt, rz, rlon, rlat, robs, &amp;nobs);</div>
<div class="line"><span class="lineno">13186</span> </div>
<div class="line"><span class="lineno">13187</span>    <span class="comment">/* Read kernel data... */</span></div>
<div class="line"><span class="lineno">13188</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2c08850b82591f935ab0c498217b3d65">sample_kernel</a>[0] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><span class="lineno">13189</span>      <a class="code hl_function" href="mptrac_8c.html#a7a3277ab872141360b876c25b5643ba6">read_kernel</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a2c08850b82591f935ab0c498217b3d65">sample_kernel</a>, kz, kw, &amp;nk);</div>
<div class="line"><span class="lineno">13190</span> </div>
<div class="line"><span class="lineno">13191</span>    <span class="comment">/* Create output file... */</span></div>
<div class="line"><span class="lineno">13192</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write sample data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno">13193</span>    <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">13194</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno">13195</span> </div>
<div class="line"><span class="lineno">13196</span>    <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno">13197</span>    fprintf(out,</div>
<div class="line"><span class="lineno">13198</span>            <span class="stringliteral">&quot;# $1 = time [s]\n&quot;</span></div>
<div class="line"><span class="lineno">13199</span>            <span class="stringliteral">&quot;# $2 = altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno">13200</span>            <span class="stringliteral">&quot;# $3 = longitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno">13201</span>            <span class="stringliteral">&quot;# $4 = latitude [deg]\n&quot;</span></div>
<div class="line"><span class="lineno">13202</span>            <span class="stringliteral">&quot;# $5 = surface area [km^2]\n&quot;</span></div>
<div class="line"><span class="lineno">13203</span>            <span class="stringliteral">&quot;# $6 = layer depth [km]\n&quot;</span></div>
<div class="line"><span class="lineno">13204</span>            <span class="stringliteral">&quot;# $7 = number of particles [1]\n&quot;</span></div>
<div class="line"><span class="lineno">13205</span>            <span class="stringliteral">&quot;# $8 = column density [kg/m^2]\n&quot;</span></div>
<div class="line"><span class="lineno">13206</span>            <span class="stringliteral">&quot;# $9 = volume mixing ratio [ppv]\n&quot;</span></div>
<div class="line"><span class="lineno">13207</span>            <span class="stringliteral">&quot;# $10 = observed BT index [K]\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">13208</span> </div>
<div class="line"><span class="lineno">13209</span>    <span class="comment">/* Set latitude range, squared radius, and area... */</span></div>
<div class="line"><span class="lineno">13210</span>    dlat = <a class="code hl_define" href="mptrac_8h.html#af7f0e2b08c22c7da133b53aaad9861ff">DY2DEG</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af5696aca68db24fedc7bd265d4eb6d52">sample_dx</a>);</div>
<div class="line"><span class="lineno">13211</span>    rmax2 = <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af5696aca68db24fedc7bd265d4eb6d52">sample_dx</a>);</div>
<div class="line"><span class="lineno">13212</span>    area = M_PI * rmax2;</div>
<div class="line"><span class="lineno">13213</span>  }</div>
<div class="line"><span class="lineno">13214</span> </div>
<div class="line"><span class="lineno">13215</span>  <span class="comment">/* Set time interval for output... */</span></div>
<div class="line"><span class="lineno">13216</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = t - 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">13217</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t1 = t + 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">13218</span> </div>
<div class="line"><span class="lineno">13219</span>  <span class="comment">/* Loop over observations... */</span></div>
<div class="line"><span class="lineno">13220</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nobs; i++) {</div>
<div class="line"><span class="lineno">13221</span> </div>
<div class="line"><span class="lineno">13222</span>    <span class="comment">/* Check time... */</span></div>
<div class="line"><span class="lineno">13223</span>    <span class="keywordflow">if</span> (rt[i] &lt; t0)</div>
<div class="line"><span class="lineno">13224</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13225</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rt[i] &gt;= t1)</div>
<div class="line"><span class="lineno">13226</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">13227</span> </div>
<div class="line"><span class="lineno">13228</span>    <span class="comment">/* Calculate Cartesian coordinates... */</span></div>
<div class="line"><span class="lineno">13229</span>    <span class="keywordtype">double</span> x0[3];</div>
<div class="line"><span class="lineno">13230</span>    <a class="code hl_function" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(0, rlon[i], rlat[i], x0);</div>
<div class="line"><span class="lineno">13231</span> </div>
<div class="line"><span class="lineno">13232</span>    <span class="comment">/* Set pressure range... */</span></div>
<div class="line"><span class="lineno">13233</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> rp = <a class="code hl_define" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>(rz[i]);</div>
<div class="line"><span class="lineno">13234</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> ptop = <a class="code hl_define" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>(rz[i] + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a857fdeffae577ddb41500ef0c875020e">sample_dz</a>);</div>
<div class="line"><span class="lineno">13235</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> pbot = <a class="code hl_define" href="mptrac_8h.html#a5e1d0f42ad38aba63907665ccdd43b86">P</a>(rz[i] - ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a857fdeffae577ddb41500ef0c875020e">sample_dz</a>);</div>
<div class="line"><span class="lineno">13236</span> </div>
<div class="line"><span class="lineno">13237</span>    <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno">13238</span>    <span class="keywordtype">double</span> mass = 0;</div>
<div class="line"><span class="lineno">13239</span>    <span class="keywordtype">int</span> np = 0;</div>
<div class="line"><span class="lineno">13240</span> </div>
<div class="line"><span class="lineno">13241</span>    <span class="comment">/* Loop over air parcels... */</span></div>
<div class="line"><span class="lineno">13242</span>    <span class="comment">//#pragma omp parallel for default(shared) reduction(+:mass,np)</span></div>
<div class="line"><span class="lineno">13243</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno">13244</span> </div>
<div class="line"><span class="lineno">13245</span>      <span class="comment">/* Check time... */</span></div>
<div class="line"><span class="lineno">13246</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1)</div>
<div class="line"><span class="lineno">13247</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13248</span> </div>
<div class="line"><span class="lineno">13249</span>      <span class="comment">/* Check latitude... */</span></div>
<div class="line"><span class="lineno">13250</span>      <span class="keywordflow">if</span> (fabs(rlat[i] - atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]) &gt; dlat)</div>
<div class="line"><span class="lineno">13251</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13252</span> </div>
<div class="line"><span class="lineno">13253</span>      <span class="comment">/* Check horizontal distance... */</span></div>
<div class="line"><span class="lineno">13254</span>      <span class="keywordtype">double</span> x1[3];</div>
<div class="line"><span class="lineno">13255</span>      <a class="code hl_function" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], x1);</div>
<div class="line"><span class="lineno">13256</span>      <span class="keywordflow">if</span> (<a class="code hl_define" href="mptrac_8h.html#af003cf5f79f68880f39a9a95d69f19bb">DIST2</a>(x0, x1) &gt; rmax2)</div>
<div class="line"><span class="lineno">13257</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13258</span> </div>
<div class="line"><span class="lineno">13259</span>      <span class="comment">/* Check pressure... */</span></div>
<div class="line"><span class="lineno">13260</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a857fdeffae577ddb41500ef0c875020e">sample_dz</a> &gt; 0)</div>
<div class="line"><span class="lineno">13261</span>        <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &gt; pbot || atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip] &lt; ptop)</div>
<div class="line"><span class="lineno">13262</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13263</span> </div>
<div class="line"><span class="lineno">13264</span>      <span class="comment">/* Add mass... */</span></div>
<div class="line"><span class="lineno">13265</span>      <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a> &gt;= 0)</div>
<div class="line"><span class="lineno">13266</span>        mass +=</div>
<div class="line"><span class="lineno">13267</span>          <a class="code hl_function" href="mptrac_8c.html#ae61cf973263fcc45574daa27d0dec8cd">kernel_weight</a>(kz, kw, nk, atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]) * atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a084c47554ce3d8b615dfabc9abbb26d1">qnt_m</a>][ip];</div>
<div class="line"><span class="lineno">13268</span>      np++;</div>
<div class="line"><span class="lineno">13269</span>    }</div>
<div class="line"><span class="lineno">13270</span> </div>
<div class="line"><span class="lineno">13271</span>    <span class="comment">/* Calculate column density... */</span></div>
<div class="line"><span class="lineno">13272</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cd = mass / (1e6 * area);</div>
<div class="line"><span class="lineno">13273</span> </div>
<div class="line"><span class="lineno">13274</span>    <span class="comment">/* Calculate volume mixing ratio... */</span></div>
<div class="line"><span class="lineno">13275</span>    <span class="keywordtype">double</span> vmr = 0;</div>
<div class="line"><span class="lineno">13276</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> &gt; 0 &amp;&amp; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a857fdeffae577ddb41500ef0c875020e">sample_dz</a> &gt; 0) {</div>
<div class="line"><span class="lineno">13277</span>      <span class="keywordflow">if</span> (mass &gt; 0) {</div>
<div class="line"><span class="lineno">13278</span> </div>
<div class="line"><span class="lineno">13279</span>        <span class="comment">/* Get temperature... */</span></div>
<div class="line"><span class="lineno">13280</span>        <span class="keywordtype">double</span> temp;</div>
<div class="line"><span class="lineno">13281</span>        <a class="code hl_define" href="mptrac_8h.html#a3a1d95aec47889277a6bf1e25f366c24">INTPOL_INIT</a>;</div>
<div class="line"><span class="lineno">13282</span>        <a class="code hl_function" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6">intpol_met_time_3d</a>(met0, met0-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, met1, met1-&gt;<a class="code hl_variable" href="structmet__t.html#a60fe66c30f0f0b5abdb46f220e3137cf">t</a>, rt[i], rp,</div>
<div class="line"><span class="lineno">13283</span>                           rlon[i], rlat[i], &amp;temp, ci, cw, 1);</div>
<div class="line"><span class="lineno">13284</span> </div>
<div class="line"><span class="lineno">13285</span>        <span class="comment">/* Calculate volume mixing ratio... */</span></div>
<div class="line"><span class="lineno">13286</span>        vmr = <a class="code hl_define" href="mptrac_8h.html#a11702dcb3f3ec928229185eb96686127">MA</a> / ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0522c3f4f840a3fabbfa786c2dfba4b0">molmass</a> * cd / (<a class="code hl_define" href="mptrac_8h.html#ae088e183d18a16fd6ab469d48ce3f06a">RHO</a>(rp, temp) * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a857fdeffae577ddb41500ef0c875020e">sample_dz</a> * 1e3);</div>
<div class="line"><span class="lineno">13287</span>      }</div>
<div class="line"><span class="lineno">13288</span>    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">13289</span>      vmr = NAN;</div>
<div class="line"><span class="lineno">13290</span> </div>
<div class="line"><span class="lineno">13291</span>    <span class="comment">/* Write output... */</span></div>
<div class="line"><span class="lineno">13292</span>    fprintf(out, <span class="stringliteral">&quot;%.2f %g %g %g %g %g %d %g %g %g\n&quot;</span>, rt[i], rz[i],</div>
<div class="line"><span class="lineno">13293</span>            rlon[i], rlat[i], area, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a857fdeffae577ddb41500ef0c875020e">sample_dz</a>, np, cd, vmr, robs[i]);</div>
<div class="line"><span class="lineno">13294</span>  }</div>
<div class="line"><span class="lineno">13295</span> </div>
<div class="line"><span class="lineno">13296</span>  <span class="comment">/* Finalize...... */</span></div>
<div class="line"><span class="lineno">13297</span>  <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a>) {</div>
<div class="line"><span class="lineno">13298</span> </div>
<div class="line"><span class="lineno">13299</span>    <span class="comment">/* Close output file... */</span></div>
<div class="line"><span class="lineno">13300</span>    fclose(out);</div>
<div class="line"><span class="lineno">13301</span> </div>
<div class="line"><span class="lineno">13302</span>    <span class="comment">/* Free... */</span></div>
<div class="line"><span class="lineno">13303</span>    free(rt);</div>
<div class="line"><span class="lineno">13304</span>    free(rz);</div>
<div class="line"><span class="lineno">13305</span>    free(rlon);</div>
<div class="line"><span class="lineno">13306</span>    free(rlat);</div>
<div class="line"><span class="lineno">13307</span>    free(robs);</div>
<div class="line"><span class="lineno">13308</span>  }</div>
<div class="line"><span class="lineno">13309</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_af0cd0b75f7269ad20dc88ce4114ab5f1_cgraph.png" border="0" usemap="#amptrac_8h_af0cd0b75f7269ad20dc88ce4114ab5f1_cgraph" alt=""/></div>
<map name="amptrac_8h_af0cd0b75f7269ad20dc88ce4114ab5f1_cgraph" id="amptrac_8h_af0cd0b75f7269ad20dc88ce4114ab5f1_cgraph">
<area shape="rect" title="Writes sample data to a specified file." alt="" coords="5,107,104,133"/>
<area shape="rect" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="183,5,255,32"/>
<area shape="rect" href="mptrac_8c.html#a5819df4f969928e2f45144e44feb50a6" title="Interpolates meteorological data in 3D space and time." alt="" coords="152,56,287,83"/>
<area shape="rect" href="mptrac_8c.html#ae61cf973263fcc45574daa27d0dec8cd" title="Calculates the kernel weight based on altitude and given kernel data." alt="" coords="356,107,459,133"/>
<area shape="rect" href="mptrac_8c.html#a7a3277ab872141360b876c25b5643ba6" title="Reads kernel function data from a file and populates the provided arrays." alt="" coords="175,157,264,184"/>
<area shape="rect" href="mptrac_8c.html#a1365b8fd93db0fc3fe4c467107710d03" title="Reads observation data from a file and stores it in arrays." alt="" coords="182,208,257,235"/>
<area shape="rect" href="mptrac_8c.html#a72b3417d6665335c02591c365f88cad1" title="Interpolates meteorological variables in 3D space." alt="" coords="335,56,480,83"/>
<area shape="rect" href="mptrac_8c.html#af0880745f22b8f99b19eeecf984df11d" title="Adjusts longitude and latitude to ensure they fall within valid bounds." alt="" coords="528,5,668,32"/>
<area shape="rect" href="mptrac_8c.html#a4e1b87dc3c93a23c89f739adf10b60dc" title="Locate the index of the interval containing a given value in a sorted array." alt="" coords="561,107,635,133"/>
<area shape="rect" href="mptrac_8c.html#a2a3c8ab98f21179741b274439786726d" title="Locate the index of the interval containing a given value in a regular grid." alt="" coords="557,56,639,83"/>
<area shape="rect" href="mptrac_8c.html#a29da9a205ad3577ba3890f3e1e4350c3" title="Reads observation data from an ASCII file." alt="" coords="356,183,459,209"/>
<area shape="rect" href="mptrac_8c.html#a4536a82b3dc62081d26114c1250b1427" title="Reads observation data from a NetCDF file." alt="" coords="359,233,455,260"/>
</map>
</div>

</div>
</div>
<a id="aaf952d2078d652006af74cc8ac4cd913" name="aaf952d2078d652006af74cc8ac4cd913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf952d2078d652006af74cc8ac4cd913">&#9670;&nbsp;</a></span>write_station()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_station </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes station data to a specified file. </p>
<p >The <code>write_station</code> function writes station data to a file specified by the <code>filename</code> parameter. It takes control parameters (<code>ctl</code>), an atmospheric data structure (<code>atm</code>), and a time value (<code>t</code>) as input.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the filename where the station data will be written. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure representing atmospheric data. </td></tr>
    <tr><td class="paramname">t</td><td>A double value representing the time at which the station data is being written.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Initializes variables and opens a new file if it's the start of the simulation.</li>
<li>Writes header information to the output file.</li>
<li>Sets geolocation and search radius for station data.</li>
<li>Processes air parcels and writes station data within the specified time interval and search radius.</li>
<li>Writes station data for each air parcel satisfying the criteria.</li>
<li>Closes the output file if it's the end of the simulation.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function writes station data to a file, including time, altitude, longitude, latitude, and additional quantities specified in the control parameters.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l13313">13313</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">13317</span>                  {</div>
<div class="line"><span class="lineno">13318</span> </div>
<div class="line"><span class="lineno">13319</span>  <span class="keyword">static</span> FILE *out;</div>
<div class="line"><span class="lineno">13320</span> </div>
<div class="line"><span class="lineno">13321</span>  <span class="keyword">static</span> <span class="keywordtype">double</span> rmax2, x0[3], x1[3];</div>
<div class="line"><span class="lineno">13322</span> </div>
<div class="line"><span class="lineno">13323</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">13324</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;WRITE_STATION&quot;</span>, <span class="stringliteral">&quot;OUTPUT&quot;</span>);</div>
<div class="line"><span class="lineno">13325</span> </div>
<div class="line"><span class="lineno">13326</span>  <span class="comment">/* Init... */</span></div>
<div class="line"><span class="lineno">13327</span>  <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#aee3354b4dacf5d89944ae0b7faaa12c6">t_start</a>) {</div>
<div class="line"><span class="lineno">13328</span> </div>
<div class="line"><span class="lineno">13329</span>    <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno">13330</span>    <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write station data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno">13331</span> </div>
<div class="line"><span class="lineno">13332</span>    <span class="comment">/* Create new file... */</span></div>
<div class="line"><span class="lineno">13333</span>    <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">13334</span>      <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno">13335</span> </div>
<div class="line"><span class="lineno">13336</span>    <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno">13337</span>    fprintf(out,</div>
<div class="line"><span class="lineno">13338</span>            <span class="stringliteral">&quot;# $1 = time [s]\n&quot;</span></div>
<div class="line"><span class="lineno">13339</span>            <span class="stringliteral">&quot;# $2 = altitude [km]\n&quot;</span></div>
<div class="line"><span class="lineno">13340</span>            <span class="stringliteral">&quot;# $3 = longitude [deg]\n&quot;</span> <span class="stringliteral">&quot;# $4 = latitude [deg]\n&quot;</span>);</div>
<div class="line"><span class="lineno">13341</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++)</div>
<div class="line"><span class="lineno">13342</span>      fprintf(out, <span class="stringliteral">&quot;# $%i = %s [%s]\n&quot;</span>, (iq + 5),</div>
<div class="line"><span class="lineno">13343</span>              ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq], ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a7dadf2efadc0802bd2c77aa8c39908dc">qnt_unit</a>[iq]);</div>
<div class="line"><span class="lineno">13344</span>    fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">13345</span> </div>
<div class="line"><span class="lineno">13346</span>    <span class="comment">/* Set geolocation and search radius... */</span></div>
<div class="line"><span class="lineno">13347</span>    <a class="code hl_function" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(0, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0fafec241b4112fa64cb69fe09403ea8">stat_lon</a>, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a995505c06bd35ecba593f807c1eda591">stat_lat</a>, x0);</div>
<div class="line"><span class="lineno">13348</span>    rmax2 = <a class="code hl_define" href="mptrac_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a149be614c5eafb380c3c9f3ad6599971">stat_r</a>);</div>
<div class="line"><span class="lineno">13349</span>  }</div>
<div class="line"><span class="lineno">13350</span> </div>
<div class="line"><span class="lineno">13351</span>  <span class="comment">/* Set time interval for output... */</span></div>
<div class="line"><span class="lineno">13352</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = t - 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">13353</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t1 = t + 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">13354</span> </div>
<div class="line"><span class="lineno">13355</span>  <span class="comment">/* Loop over air parcels... */</span></div>
<div class="line"><span class="lineno">13356</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip++) {</div>
<div class="line"><span class="lineno">13357</span> </div>
<div class="line"><span class="lineno">13358</span>    <span class="comment">/* Check time... */</span></div>
<div class="line"><span class="lineno">13359</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1)</div>
<div class="line"><span class="lineno">13360</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13361</span> </div>
<div class="line"><span class="lineno">13362</span>    <span class="comment">/* Check time range for station output... */</span></div>
<div class="line"><span class="lineno">13363</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a5721f8afc611b607db92678bb063f42d">stat_t0</a> || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a370c0a527e721ea64cd67685abd7bc42">stat_t1</a>)</div>
<div class="line"><span class="lineno">13364</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13365</span> </div>
<div class="line"><span class="lineno">13366</span>    <span class="comment">/* Check station flag... */</span></div>
<div class="line"><span class="lineno">13367</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a508aa1f5e4ba701e86557f114999b314">qnt_stat</a> &gt;= 0)</div>
<div class="line"><span class="lineno">13368</span>      <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>) atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a508aa1f5e4ba701e86557f114999b314">qnt_stat</a>][ip])</div>
<div class="line"><span class="lineno">13369</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13370</span> </div>
<div class="line"><span class="lineno">13371</span>    <span class="comment">/* Get Cartesian coordinates... */</span></div>
<div class="line"><span class="lineno">13372</span>    <a class="code hl_function" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d">geo2cart</a>(0, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip], x1);</div>
<div class="line"><span class="lineno">13373</span> </div>
<div class="line"><span class="lineno">13374</span>    <span class="comment">/* Check horizontal distance... */</span></div>
<div class="line"><span class="lineno">13375</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="mptrac_8h.html#af003cf5f79f68880f39a9a95d69f19bb">DIST2</a>(x0, x1) &gt; rmax2)</div>
<div class="line"><span class="lineno">13376</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13377</span> </div>
<div class="line"><span class="lineno">13378</span>    <span class="comment">/* Set station flag... */</span></div>
<div class="line"><span class="lineno">13379</span>    <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a508aa1f5e4ba701e86557f114999b314">qnt_stat</a> &gt;= 0)</div>
<div class="line"><span class="lineno">13380</span>      atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a508aa1f5e4ba701e86557f114999b314">qnt_stat</a>][ip] = 1;</div>
<div class="line"><span class="lineno">13381</span> </div>
<div class="line"><span class="lineno">13382</span>    <span class="comment">/* Write data... */</span></div>
<div class="line"><span class="lineno">13383</span>    fprintf(out, <span class="stringliteral">&quot;%.2f %g %g %g&quot;</span>,</div>
<div class="line"><span class="lineno">13384</span>            atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip], <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]), atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]);</div>
<div class="line"><span class="lineno">13385</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">13386</span>      fprintf(out, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><span class="lineno">13387</span>      fprintf(out, ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a0811163b931ce18a07fbad57ea280a85">qnt_format</a>[iq], atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq][ip]);</div>
<div class="line"><span class="lineno">13388</span>    }</div>
<div class="line"><span class="lineno">13389</span>    fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">13390</span>  }</div>
<div class="line"><span class="lineno">13391</span> </div>
<div class="line"><span class="lineno">13392</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">13393</span>  <span class="keywordflow">if</span> (t == ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a649752813806c995ee09923a44d0e974">t_stop</a>)</div>
<div class="line"><span class="lineno">13394</span>    fclose(out);</div>
<div class="line"><span class="lineno">13395</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="mptrac_8h_aaf952d2078d652006af74cc8ac4cd913_cgraph.png" border="0" usemap="#amptrac_8h_aaf952d2078d652006af74cc8ac4cd913_cgraph" alt=""/></div>
<map name="amptrac_8h_aaf952d2078d652006af74cc8ac4cd913_cgraph" id="amptrac_8h_aaf952d2078d652006af74cc8ac4cd913_cgraph">
<area shape="rect" title="Writes station data to a specified file." alt="" coords="5,5,101,32"/>
<area shape="rect" href="mptrac_8c.html#ae3aea782dfca9019f3f2d169f8cc0f6d" title="Converts geographic coordinates (longitude, latitude, altitude) to Cartesian coordinates." alt="" coords="149,5,221,32"/>
</map>
</div>

</div>
</div>
<a id="ad9cf70f782a54ee8eb8fa87c80f936d2" name="ad9cf70f782a54ee8eb8fa87c80f936d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9cf70f782a54ee8eb8fa87c80f936d2">&#9670;&nbsp;</a></span>write_vtk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_vtk </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structctl__t.html">ctl_t</a> *&#160;</td>
          <td class="paramname"><em>ctl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structatm__t.html">atm_t</a> *&#160;</td>
          <td class="paramname"><em>atm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes VTK (Visualization Toolkit) data to a specified file. </p>
<p >The <code>write_vtk</code> function writes VTK data to a file specified by the <code>filename</code> parameter. It takes control parameters (<code>ctl</code>), an atmospheric data structure (<code>atm</code>), and a time value (<code>t</code>) as input.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>A string representing the filename where the VTK data will be written. </td></tr>
    <tr><td class="paramname">ctl</td><td>A pointer to a <code><a class="el" href="structctl__t.html" title="Control parameters.">ctl_t</a></code> structure containing control parameters. </td></tr>
    <tr><td class="paramname">atm</td><td>A pointer to an <code><a class="el" href="structatm__t.html" title="Air parcel data.">atm_t</a></code> structure representing atmospheric data. </td></tr>
    <tr><td class="paramname">t</td><td>A double value representing the time at which the VTK data is being written.</td></tr>
  </table>
  </dd>
</dl>
<p>The function performs the following steps:</p><ul>
<li>Sets a timer and logs information about writing VTK data.</li>
<li>Sets a time interval for output based on the specified time and control parameters.</li>
<li>Creates a new file and checks if the file creation was successful.</li>
<li>Counts the number of data points to be written.</li>
<li>Writes the VTK header, including metadata.</li>
<li>Writes point coordinates based on the sphere or Cartesian coordinate system.</li>
<li>Writes point data for each quantity specified in the control parameters.</li>
<li>Closes the output file.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function writes VTK data in ASCII format, including point coordinates and associated scalar data for visualization purposes.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Lars Hoffmann </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptrac_8c_source.html#l13399">13399</a> of file <a class="el" href="mptrac_8c_source.html">mptrac.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">13403</span>                  {</div>
<div class="line"><span class="lineno">13404</span> </div>
<div class="line"><span class="lineno">13405</span>  FILE *out;</div>
<div class="line"><span class="lineno">13406</span> </div>
<div class="line"><span class="lineno">13407</span>  <span class="comment">/* Set timer... */</span></div>
<div class="line"><span class="lineno">13408</span>  <a class="code hl_define" href="mptrac_8h.html#a2b61365bd73a3cf3c059940b7e008749">SELECT_TIMER</a>(<span class="stringliteral">&quot;WRITE_VTK&quot;</span>, <span class="stringliteral">&quot;OUTPUT&quot;</span>);</div>
<div class="line"><span class="lineno">13409</span> </div>
<div class="line"><span class="lineno">13410</span>  <span class="comment">/* Write info... */</span></div>
<div class="line"><span class="lineno">13411</span>  <a class="code hl_define" href="mptrac_8h.html#acaa1c3fa56061380a29889d703236251">LOG</a>(1, <span class="stringliteral">&quot;Write VTK data: %s&quot;</span>, filename);</div>
<div class="line"><span class="lineno">13412</span> </div>
<div class="line"><span class="lineno">13413</span>  <span class="comment">/* Set time interval for output... */</span></div>
<div class="line"><span class="lineno">13414</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t0 = t - 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">13415</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> t1 = t + 0.5 * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a718d3200f867d9018369f12f66464807">dt_mod</a>;</div>
<div class="line"><span class="lineno">13416</span> </div>
<div class="line"><span class="lineno">13417</span>  <span class="comment">/* Create file... */</span></div>
<div class="line"><span class="lineno">13418</span>  <span class="keywordflow">if</span> (!(out = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">13419</span>    <a class="code hl_define" href="mptrac_8h.html#a3e0ae69dee4a8bb2e616526b5ebe6875">ERRMSG</a>(<span class="stringliteral">&quot;Cannot create file!&quot;</span>);</div>
<div class="line"><span class="lineno">13420</span> </div>
<div class="line"><span class="lineno">13421</span>  <span class="comment">/* Count data points... */</span></div>
<div class="line"><span class="lineno">13422</span>  <span class="keywordtype">int</span> np = 0;</div>
<div class="line"><span class="lineno">13423</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af662f58ab4cdf46b8e28945ca541a9c1">vtk_stride</a>) {</div>
<div class="line"><span class="lineno">13424</span>    <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1)</div>
<div class="line"><span class="lineno">13425</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13426</span>    np++;</div>
<div class="line"><span class="lineno">13427</span>  }</div>
<div class="line"><span class="lineno">13428</span> </div>
<div class="line"><span class="lineno">13429</span>  <span class="comment">/* Write header... */</span></div>
<div class="line"><span class="lineno">13430</span>  fprintf(out,</div>
<div class="line"><span class="lineno">13431</span>          <span class="stringliteral">&quot;# vtk DataFile Version 3.0\n&quot;</span></div>
<div class="line"><span class="lineno">13432</span>          <span class="stringliteral">&quot;vtk output\n&quot;</span> <span class="stringliteral">&quot;ASCII\n&quot;</span> <span class="stringliteral">&quot;DATASET POLYDATA\n&quot;</span>);</div>
<div class="line"><span class="lineno">13433</span> </div>
<div class="line"><span class="lineno">13434</span>  <span class="comment">/* Write point coordinates... */</span></div>
<div class="line"><span class="lineno">13435</span>  fprintf(out, <span class="stringliteral">&quot;POINTS %d float\n&quot;</span>, np);</div>
<div class="line"><span class="lineno">13436</span>  <span class="keywordflow">if</span> (ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a17e569920568025af14e66d706651a18">vtk_sphere</a>) {</div>
<div class="line"><span class="lineno">13437</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af662f58ab4cdf46b8e28945ca541a9c1">vtk_stride</a>) {</div>
<div class="line"><span class="lineno">13438</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1)</div>
<div class="line"><span class="lineno">13439</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13440</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> radius = (<a class="code hl_define" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a> + <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]) * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad1c66733dc34e0eb4bff6dea1ad9aefe">vtk_scale</a></div>
<div class="line"><span class="lineno">13441</span>                             + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a78c2f172f67203ddfc2dfb9db913f51d">vtk_offset</a>) / <a class="code hl_define" href="mptrac_8h.html#a0600e3f227b6e9a3ae26f4d6e2a0581e">RE</a>;</div>
<div class="line"><span class="lineno">13442</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> coslat = cos(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]));</div>
<div class="line"><span class="lineno">13443</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> x = radius * coslat * cos(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip]));</div>
<div class="line"><span class="lineno">13444</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> y = radius * coslat * sin(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip]));</div>
<div class="line"><span class="lineno">13445</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> z = radius * sin(<a class="code hl_define" href="mptrac_8h.html#aa3616a5af1a14b0a5a1b2f542066ae45">DEG2RAD</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip]));</div>
<div class="line"><span class="lineno">13446</span>      fprintf(out, <span class="stringliteral">&quot;%g %g %g\n&quot;</span>, x, y, z);</div>
<div class="line"><span class="lineno">13447</span>    }</div>
<div class="line"><span class="lineno">13448</span>  } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">13449</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af662f58ab4cdf46b8e28945ca541a9c1">vtk_stride</a>) {</div>
<div class="line"><span class="lineno">13450</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1)</div>
<div class="line"><span class="lineno">13451</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13452</span>      fprintf(out, <span class="stringliteral">&quot;%g %g %g\n&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#a2c8ffb598109120ed6d1f8e79aeb3ff8">lon</a>[ip], atm-&gt;<a class="code hl_variable" href="structatm__t.html#a25ef7d304d5cfa54c5af30192620373b">lat</a>[ip],</div>
<div class="line"><span class="lineno">13453</span>              <a class="code hl_define" href="mptrac_8h.html#a58b4f1573922a1f73dd4bf014fd441bf">Z</a>(atm-&gt;<a class="code hl_variable" href="structatm__t.html#ae769ef14e4824d35f47ad9dec75a4087">p</a>[ip]) * ctl-&gt;<a class="code hl_variable" href="structctl__t.html#ad1c66733dc34e0eb4bff6dea1ad9aefe">vtk_scale</a> + ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a78c2f172f67203ddfc2dfb9db913f51d">vtk_offset</a>);</div>
<div class="line"><span class="lineno">13454</span>    }</div>
<div class="line"><span class="lineno">13455</span> </div>
<div class="line"><span class="lineno">13456</span>  <span class="comment">/* Write point data... */</span></div>
<div class="line"><span class="lineno">13457</span>  fprintf(out, <span class="stringliteral">&quot;POINT_DATA %d\n&quot;</span>, np);</div>
<div class="line"><span class="lineno">13458</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iq = 0; iq &lt; ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af189b70e15b3ed95191357717b80a2cc">nq</a>; iq++) {</div>
<div class="line"><span class="lineno">13459</span>    fprintf(out, <span class="stringliteral">&quot;SCALARS %s float 1\n&quot;</span> <span class="stringliteral">&quot;LOOKUP_TABLE default\n&quot;</span>,</div>
<div class="line"><span class="lineno">13460</span>            ctl-&gt;<a class="code hl_variable" href="structctl__t.html#a8a96f7d7b47b13cf7359afb9f513f690">qnt_name</a>[iq]);</div>
<div class="line"><span class="lineno">13461</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ip = 0; ip &lt; atm-&gt;<a class="code hl_variable" href="structatm__t.html#a473366004c7195d5c455373296ee1833">np</a>; ip += ctl-&gt;<a class="code hl_variable" href="structctl__t.html#af662f58ab4cdf46b8e28945ca541a9c1">vtk_stride</a>) {</div>
<div class="line"><span class="lineno">13462</span>      <span class="keywordflow">if</span> (atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &lt; t0 || atm-&gt;<a class="code hl_variable" href="structatm__t.html#a05da6b99657d420d7bf4b37a392b048c">time</a>[ip] &gt; t1)</div>
<div class="line"><span class="lineno">13463</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">13464</span>      fprintf(out, <span class="stringliteral">&quot;%g\n&quot;</span>, atm-&gt;<a class="code hl_variable" href="structatm__t.html#aa1c8de5772120f4a283c9cedcbe43fb7">q</a>[iq][ip]);</div>
<div class="line"><span class="lineno">13465</span>    }</div>
<div class="line"><span class="lineno">13466</span>  }</div>
<div class="line"><span class="lineno">13467</span> </div>
<div class="line"><span class="lineno">13468</span>  <span class="comment">/* Close file... */</span></div>
<div class="line"><span class="lineno">13469</span>  fclose(out);</div>
<div class="line"><span class="lineno">13470</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
